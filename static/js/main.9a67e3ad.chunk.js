(this["webpackJsonpcom.orbitalshift.app"]=this["webpackJsonpcom.orbitalshift.app"]||[]).push([[6],{104:function(e,t,n){e.exports=n(132)},110:function(e,t,n){var a={"./ion-action-sheet-ios.entry.js":[135,67],"./ion-action-sheet-md.entry.js":[136,68],"./ion-alert-ios.entry.js":[137,59],"./ion-alert-md.entry.js":[138,60],"./ion-app_8-ios.entry.js":[139,53],"./ion-app_8-md.entry.js":[140,54],"./ion-avatar_3-ios.entry.js":[141,8],"./ion-avatar_3-md.entry.js":[142,9],"./ion-back-button-ios.entry.js":[143,10],"./ion-back-button-md.entry.js":[144,11],"./ion-backdrop-ios.entry.js":[145,12],"./ion-backdrop-md.entry.js":[146,13],"./ion-button_2-ios.entry.js":[147,69],"./ion-button_2-md.entry.js":[148,70],"./ion-card_5-ios.entry.js":[149,14],"./ion-card_5-md.entry.js":[150,15],"./ion-checkbox-ios.entry.js":[151,16],"./ion-checkbox-md.entry.js":[152,17],"./ion-chip-ios.entry.js":[153,18],"./ion-chip-md.entry.js":[154,19],"./ion-col_3.entry.js":[155,20],"./ion-datetime_3-ios.entry.js":[156,57],"./ion-datetime_3-md.entry.js":[157,58],"./ion-fab_3-ios.entry.js":[158,21],"./ion-fab_3-md.entry.js":[159,22],"./ion-img.entry.js":[160,23],"./ion-infinite-scroll_2-ios.entry.js":[161,24],"./ion-infinite-scroll_2-md.entry.js":[162,25],"./ion-input-ios.entry.js":[163,26],"./ion-input-md.entry.js":[164,27],"./ion-item-option_3-ios.entry.js":[165,71],"./ion-item-option_3-md.entry.js":[166,72],"./ion-item_8-ios.entry.js":[167,73],"./ion-item_8-md.entry.js":[168,74],"./ion-loading-ios.entry.js":[169,28],"./ion-loading-md.entry.js":[170,29],"./ion-menu_3-ios.entry.js":[171,75],"./ion-menu_3-md.entry.js":[172,76],"./ion-modal-ios.entry.js":[173,55],"./ion-modal-md.entry.js":[174,56],"./ion-nav_2.entry.js":[175,66],"./ion-popover-ios.entry.js":[176,30],"./ion-popover-md.entry.js":[177,31],"./ion-progress-bar-ios.entry.js":[178,32],"./ion-progress-bar-md.entry.js":[179,33],"./ion-radio_2-ios.entry.js":[180,34],"./ion-radio_2-md.entry.js":[181,35],"./ion-range-ios.entry.js":[182,77],"./ion-range-md.entry.js":[183,78],"./ion-refresher_2-ios.entry.js":[184,61],"./ion-refresher_2-md.entry.js":[185,62],"./ion-reorder_2-ios.entry.js":[186,36],"./ion-reorder_2-md.entry.js":[187,37],"./ion-ripple-effect.entry.js":[188,38],"./ion-route_4.entry.js":[189,79],"./ion-searchbar-ios.entry.js":[190,80],"./ion-searchbar-md.entry.js":[191,81],"./ion-segment_2-ios.entry.js":[192,82],"./ion-segment_2-md.entry.js":[193,83],"./ion-select_3-ios.entry.js":[194,84],"./ion-select_3-md.entry.js":[195,85],"./ion-slide_2-ios.entry.js":[196,86],"./ion-slide_2-md.entry.js":[197,87],"./ion-spinner.entry.js":[198,39],"./ion-split-pane-ios.entry.js":[199,40],"./ion-split-pane-md.entry.js":[200,41],"./ion-tab-bar_2-ios.entry.js":[201,42],"./ion-tab-bar_2-md.entry.js":[202,43],"./ion-tab_2.entry.js":[203,44],"./ion-text.entry.js":[204,45],"./ion-textarea-ios.entry.js":[205,46],"./ion-textarea-md.entry.js":[206,47],"./ion-toast-ios.entry.js":[207,63],"./ion-toast-md.entry.js":[208,64],"./ion-toggle-ios.entry.js":[209,48],"./ion-toggle-md.entry.js":[210,49],"./ion-virtual-scroll.entry.js":[211,50]};function r(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],r=t[0];return n.e(t[1]).then((function(){return n(r)}))}r.keys=function(){return Object.keys(a)},r.id=110,e.exports=r},112:function(e,t,n){var a={"./ion-icon.entry.js":[215,90]};function r(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],r=t[0];return n.e(t[1]).then((function(){return n(r)}))}r.keys=function(){return Object.keys(a)},r.id=112,e.exports=r},130:function(e,t,n){},132:function(e,t,n){"use strict";n.r(t);var a,r,o=n(0),c=n.n(o),l=n(53),i=n.n(l),s=n(16),u=n(57),d=n(1),m=n(71),p=n(2),E=n(7),f=(n(9),n(6)),v=n(3),h=n.n(v),g=n(5),b=n(102),y=function(){return Object(b.a)("osKeyStore",1,{upgrade:function(e){e.createObjectStore("userStore"),e.createObjectStore("authItems")}})},O=function(){var e=Object(g.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y();case 2:return n=e.sent,e.next=5,n.put("userStore",t,"user");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(g.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y();case 2:return t=e.sent,e.next=5,t.get("userStore","user");case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=function(){var e=Object(g.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y();case 2:return t=e.sent,e.next=5,t.get("userStore","user").then((function(e){return e?e.access_token:void 0}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),C=function(){var e=Object(g.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y();case 2:return n=e.sent,e.next=5,n.put("authItems",t,"authItems");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=Object(g.a)(h.a.mark((function e(){var t,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y();case 2:return t=e.sent,e.next=5,t.get("authItems","authItems");case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S={getKeyStore:y,putUserState:O,getUserState:k,getAccessToken:j,putAuthItems:C,getAuthItems:I},T=n(38),N=n(60);n(133);function D(e){switch(e){case r.None:return"None";case r.Standard:return"Standard";case r.Premium:return"Premium";case r.Enterprise:return"Enterprise";default:return"Unknown"}}!function(e){e.Employee="Employee",e.Admin="Admin",e.LocationAdmin="Location Admin",e.BusinessAdmin="Business Admin",e.Orbital="Orbital"}(a||(a={})),function(e){e[e.None=-1]="None",e[e.Standard=0]="Standard",e[e.Premium=1]="Premium",e[e.Enterprise=2]="Enterprise"}(r||(r={}));var x,A,w,M,R,P,U={auth:{businessId:0,businessName:"",subscriptionType:r.None,locations:[],tags:[],payrollEvents:[],employeeId:0,loading:!1,role:a.Employee,lastRefresh:void 0},currentEvents:[],nextEvent:void 0,dailyNotes:[]};!function(e){e[e.HoursMinutes=0]="HoursMinutes",e[e.HoursAndDecimals=1]="HoursAndDecimals"}(x||(x={})),function(e){e[e.Unit=1]="Unit",e[e.Money=2]="Money"}(A||(A={})),function(e){e[e.None=0]="None",e[e.CanViewWages=1]="CanViewWages",e[e.CanEditPublishedTo=2]="CanEditPublishedTo",e[e.CanEditTemplates=4]="CanEditTemplates",e[e.CanEditSchedules=8]="CanEditSchedules",e[e.CanEditEmployeeClockEvents=16]="CanEditEmployeeClockEvents",e[e.CanEditOwnClockEvents=32]="CanEditOwnClockEvents",e[e.CanEditUserAccounts=64]="CanEditUserAccounts"}(w||(w={})),function(e){e[e.Both=0]="Both",e[e.Unpaid=1]="Unpaid",e[e.Paid=2]="Paid",e[e.None=3]="None"}(M||(M={})),function(e){e[e.UnscheduledUnpaid=0]="UnscheduledUnpaid",e[e.UnscheduledPaid=1]="UnscheduledPaid",e[e.Scheduled=2]="Scheduled"}(R||(R={})),function(e){e[e.FirstName=1]="FirstName",e[e.LastName=2]="LastName",e[e.EmploymentStart=3]="EmploymentStart",e[e.EarliestEventStart=4]="EarliestEventStart"}(P||(P={}));var L=n(12),F=n(13),B=function(){function e(){Object(L.a)(this,e),this.items={},this._count=0}return Object(F.a)(e,[{key:"containsKey",value:function(e){return this.items.hasOwnProperty(e)}},{key:"count",value:function(){return this._count}},{key:"add",value:function(e,t){this.items.hasOwnProperty(e)||this._count++,this.items[e]=t}},{key:"remove",value:function(e){var t=this.items[e];return delete this.items[e],this._count--,t}},{key:"item",value:function(e){return this.items[e]}},{key:"keys",value:function(){var e=[];for(var t in this.items)this.items.hasOwnProperty(t)&&e.push(t);return e}},{key:"values",value:function(){var e=[];for(var t in this.items)this.items.hasOwnProperty(t)&&e.push(this.items[t]);return e}}]),e}(),z={constants:{checkUnreadMessageCountTimer:3e4,refreshScheduleTimer:6e4,refreshTimeclockSettingsTimer:15e3,maxStaleAuthItemsInMinutes:15,minimumFeetForGeolocationUpdate:15},key:"prod",name:"",url:""},V=[Object(f.a)({},z,{key:"prod",name:"Production",url:"https://api.orbitalshift.com/"}),Object(f.a)({},z,{key:"sbx",name:"Sandbox",url:"https://sandboxapi.orbitalshift.com/"}),Object(f.a)({},z,{key:"loc",name:"Local",url:"http://localhost:54825/"}),Object(f.a)({},z,{key:"emu",name:"Local (Emu)",url:"http://10.0.2.2:54825/"}),Object(f.a)({},z,{key:"tst",name:"TestServer",url:"http://TestServer:8000/"})],_=new B;V.map((function(e){return _.add(e.key,e)}));var q={env:_,versionName:"2.0.0",versionCode:"6128",revisionHash:"f0424ac",buildDate:"Thu 05/07/2020 6:21P",appVersionString:"2.0.0.6128 (f0424ac)",hasCapacitor:Object(d.U)("capacitor"),platform:Object(d.U)("ios")?"ios":Object(d.U)("android")?"android":"other"},W=function(e){return e.isLoggedin?q.env.item(e.environment).constants:z.constants},G={settings:q,getApiUrl:function(e,t){return q.env.item(e.environment).url+t},getUserAndEnvironmentFromInput:function(e){if(e.length<4)return{username:e,env:q.env.item("prod")};var t=e.toLowerCase().substring(0,4),n=e.substring(4);switch(t){case"sbx ":return{username:n,env:q.env.item("sbx")};case"loc ":return{username:n,env:q.env.item("loc")};case"emu ":return{username:n,env:q.env.item("emu")};case"tst ":return{username:n,env:q.env.item("tst")};default:return{username:e,env:q.env.item("prod")}}}},Y={apiKey:"AIzaSyAS526InuG-53VGKi5SA780Mh0YwHkhMDE",authDomain:"orbital-shift-team-dashboard.firebaseapp.com",databaseURL:"https://orbital-shift-team-dashboard.firebaseio.com",projectId:"orbital-shift-team-dashboard",storageBucket:"orbital-shift-team-dashboard.appspot.com",messagingSenderId:"475985033328",appId:"1:475985033328:web:77740655a89e28de035cb5",measurementId:"G-TGE8788D28"};function J(e,t){N.analytics().logEvent(e,t)}function H(e,t){if(e.isLoggedin){var n=G.settings.env.item(e.environment);void 0!==e.username&&N.analytics().setUserId(e.username),N.analytics().setUserProperties({userRole:t.role,subscriptionType:D(t.subscriptionType),businessName:t.businessName,userName:e.username,version:G.settings.appVersionString,environment:n.name})}}var K,Q=function(){var e=Object(g.a)(h.a.mark((function e(t,n,a){var r,o,c,l;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=G.getApiUrl(t,n),console.log("API: "+n),e.prev=2,e.next=5,fetch(r,{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.access_token),AppVersion:G.settings.appVersionString}});case 5:if(o=e.sent,!(c=o.headers.get("content-type"))||-1===c.indexOf("application/json")){e.next=13;break}return e.next=10,o.json();case 10:return l=e.sent,J("api_succeeded",{method:"POST",baseUrl:n,username:t.username}),e.abrupt("return",l);case 13:J("api_succeeded",{method:"POST",baseUrl:n,username:t.username}),e.next=21;break;case 16:throw e.prev=16,e.t0=e.catch(2),J("api_err",Object(f.a)({method:"POST",baseUrl:n,username:null===t||void 0===t?void 0:t.username},a,{appVersion:G.settings.appVersionString})),console.error("Error calling post against url, "+n+": "+e.t0),e.t0;case 21:case"end":return e.stop()}}),e,null,[[2,16]])})));return function(t,n,a){return e.apply(this,arguments)}}(),X=function(){var e=Object(g.a)(h.a.mark((function e(t,n,a){var r,o,c,l;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=G.getApiUrl(t,n),console.log("API: "+n),e.prev=2,o=JSON.stringify(a),e.next=6,fetch(r,{method:"PUT",body:o,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.access_token),AppVersion:G.settings.appVersionString}});case 6:return c=e.sent,e.next=9,c.json();case 9:return l=e.sent,J("api_succeeded",{method:"PUT",baseUrl:n,username:t.username}),e.abrupt("return",l);case 14:throw e.prev=14,e.t0=e.catch(2),J("api_err",Object(f.a)({method:"PUT",baseUrl:n,username:null===t||void 0===t?void 0:t.username},a,{appVersion:G.settings.appVersionString})),console.error("Error calling putData against url, "+n+": "+e.t0),e.t0;case 19:case"end":return e.stop()}}),e,null,[[2,14]])})));return function(t,n,a){return e.apply(this,arguments)}}(),$={get:function(){var e=Object(g.a)(h.a.mark((function e(t,n,a){var r,o,c,l;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=G.getApiUrl(t,n),console.log("API: "+n),e.prev=2,o={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.access_token),AppVersion:G.settings.appVersionString},body:null},a&&(o.body=JSON.stringify(a)),e.next=7,fetch(r,o);case 7:return c=e.sent,e.next=10,c.json();case 10:return l=e.sent,J("api_succeeded",{method:"GET",baseUrl:n,username:t.username}),e.abrupt("return",l);case 15:throw e.prev=15,e.t0=e.catch(2),J("api_err",{method:"GET",baseUrl:n,username:null===t||void 0===t?void 0:t.username,appVersion:G.settings.appVersionString}),console.error("Error calling get against url, "+n+": "+e.t0),e.t0;case 20:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(t,n,a){return e.apply(this,arguments)}}(),post:Q,put:function(){var e=Object(g.a)(h.a.mark((function e(t,n,a){var r,o,c,l,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=G.getApiUrl(t,n),console.log("API: "+n),o={method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.access_token),AppVersion:G.settings.appVersionString}},a&&(o.body=JSON.stringify(a)),e.prev=4,e.next=7,fetch(r,o);case 7:if(c=e.sent,!(l=c.headers.get("content-type"))||-1===l.indexOf("application/json")){e.next=15;break}return e.next=12,c.json();case 12:return i=e.sent,J("api_succeeded",{method:"PUT",baseUrl:n,username:t.username}),e.abrupt("return",i);case 15:J("api_succeeded",{method:"PUT",baseUrl:n,username:t.username}),e.next=23;break;case 18:throw e.prev=18,e.t0=e.catch(4),J("api_err",Object(f.a)({method:"PUT",baseUrl:n,username:null===t||void 0===t?void 0:t.username},a,{appVersion:G.settings.appVersionString})),console.error("Error calling put against url, "+n+": "+e.t0),e.t0;case 23:case"end":return e.stop()}}),e,null,[[4,18]])})));return function(t,n,a){return e.apply(this,arguments)}}(),putData:X,del:function(){var e=Object(g.a)(h.a.mark((function e(t,n,a){var r,o,c,l;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=G.getApiUrl(t,n),console.log("API: "+n),o={method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.access_token),AppVersion:G.settings.appVersionString}},a&&(o.body=JSON.stringify(a)),e.prev=4,e.next=7,fetch(r,o);case 7:if(c=e.sent,!(l=c.headers.get("content-type"))||-1===l.indexOf("application/json")){e.next=14;break}return J("api_succeeded",{method:"DELETE",baseUrl:n,username:t.username}),e.next=13,c.json();case 13:return e.abrupt("return",e.sent);case 14:return J("api_succeeded",{method:"DELETE",baseUrl:n,username:t.username}),e.abrupt("return");case 18:throw e.prev=18,e.t0=e.catch(4),J("api_err",Object(f.a)({method:"DELETE",baseUrl:n,username:null===t||void 0===t?void 0:t.username},a,{appVersion:G.settings.appVersionString})),console.error("Error calling delete against url, "+n+": "+e.t0),e.t0;case 23:case"end":return e.stop()}}),e,null,[[4,18]])})));return function(t,n,a){return e.apply(this,arguments)}}()};!function(e){e[e.iOS=1]="iOS",e[e.Android=2]="Android"}(K||(K={}));var Z={subscribe:function(){var e=Object(g.a)(h.a.mark((function e(t,n){var a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v1/employee/notifications/subscribe",a="ios"===G.settings.platform?K.iOS:K.Android,J("pushNotifications_subscribeCalled",{token:n,operatingSystem:a,username:t.username,access_token:t.access_token}),e.next=5,$.putData(t,"api/v1/employee/notifications/subscribe",{TokenId:n,OperatingSystem:a});case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),unsubscribe:function(){var e=Object(g.a)(h.a.mark((function e(t,n){var a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v1/employee/notifications/unsubscribe",a="ios"===G.settings.platform?K.iOS:K.Android,e.next=4,$.putData(t,"api/v1/employee/notifications/unsubscribe",{TokenId:n,OperatingSystem:a});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),getTypesSelectedByUser:function(){var e=Object(g.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v1/employee/notifications/types",e.next=3,$.get(t,"api/v1/employee/notifications/types");case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),putTypes:function(){var e=Object(g.a)(h.a.mark((function e(t,n){var a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v1/employee/notifications/types",a={ids:n},e.next=4,$.put(t,"api/v1/employee/notifications/types",a);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),listTypes:function(){var e=Object(g.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v1/employee/notifications/list-types",e.next=3,$.get(t,"api/v1/employee/notifications/list-types");case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},ee=n(26),te=T.c.PushNotifications,ne=function(e,t,n){var a=Object(ee.a)({forceRefresh:!0});G.settings.hasCapacitor&&(te.register().then((function(){console.log("PushNotificationController: register called and returned")})),te.addListener("registration",(function(a){Z.subscribe(e,a.value),t(!0),n("Push registration success, token: "+a.value),J("pushNotifications_registered",{token:a.value,platform:G.settings.platform})})),te.addListener("registrationError",(function(e){n("Error on registration: "+JSON.stringify(e)),J("pushNotifications_registrationError",{error:e,platform:G.settings.platform})})),te.addListener("pushNotificationReceived",(function(e){var t;e&&(e.data&&e.data.MessageId?(n("NOTIFICATION: "+e.title+": "+e.body+" id:"+e.data.MessageId),a.push("/tabs/messages/"+e.data.MessageId),a.goForward()):n("NOTIFICATION: "+e.title+": "+e.body+" (no id)"),J("pushNotifications_receivedWhenOpen",{title:e.title,body:e.body,messageId:null!==(t=e.data.MessageId)&&void 0!==t?t:-123}))})),te.addListener("pushNotificationActionPerformed",(function(e){var t;e.notification.data&&e.notification.data.MessageId?(n("TAPPED ON NOTIFICATION: "+e.notification.title+": "+e.notification.body+" id:"+e.notification.data.MessageId),a.push("/tabs/messages/"+e.notification.data.MessageId),a.goForward()):n("TAPPED ON NOTIFICATION: "+e.notification.title+": "+e.notification.body+" (no id)"),J("pushNotifications_actionPerformed",{title:e.notification.title,body:e.notification.body,messageId:null!==(t=e.notification.data.MessageId)&&void 0!==t?t:-123})})))},ae={isLoggedin:!1,access_token:void 0,username:"",darkMode:!1,loading:!0,environment:"prod",isPushEnabled:!1},re={user:ae,logout:function(){var e=Object(g.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),userLoggedIn:function(e,t,n){return new Promise((function(){return ae}))},pushEnabled:function(e){}},oe=c.a.createContext(re),ce=function(e){var t=Object(o.useState)(Object(f.a)({},ae)),n=Object(p.a)(t,2),a=n[0],r=n[1];Object(o.useEffect)((function(){var e=!0;return Promise.all([S.getUserState()]).then((function(t){if(e){var n=t[0];r(n?Object(f.a)({},n,{loading:!1}):Object(f.a)({},a,{loading:!1}))}})),function(){e=!1}}),[]),Object(o.useEffect)((function(){a&&!a.isPushEnabled&&a.access_token&&a.access_token.length>0&&"other"!==G.settings.platform&&ne(a,l,(function(){}))}),[a.isPushEnabled,a.access_token]);var l=function(e){r(Object(f.a)({},a,{isPushEnabled:e}))},i=function(){var e=Object(g.a)(h.a.mark((function e(t,n,a){var o,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.getUserState();case 2:return o=e.sent,c={username:t,access_token:n,environment:a,isLoggedin:!0,darkMode:o?o.darkMode:ae.darkMode,loading:!1,isPushEnabled:!1},e.next=6,S.putUserState(c);case 6:return r(c),e.abrupt("return",c);case 8:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),s=function(){var e=Object(g.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(f.a)({},a,{isLoggedin:!1,access_token:void 0,latitude:void 0,longitude:void 0,isPushEnabled:!1,requestedGeoPermission:!1,refusedGeoPermission:!1}),r(t),e.next=4,S.putUserState(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return c.a.createElement(oe.Provider,{value:{user:a,userLoggedIn:i,logout:s,pushEnabled:l}},e.children)};var le,ie=function(){var e=Object(o.useState)(!1),t=Object(p.a)(e,2),n=t[0],a=t[1],r=Object(o.useState)({header:"",message:"",onDismiss:function(){}}),l=Object(p.a)(r,2),i=l[0],s=l[1];return{showAlert:function(e,t,n){s({header:e,message:t,onDismiss:n}),a(!0)},alertBoxJsx:c.a.createElement(d.b,{isOpen:n,onDidDismiss:function(){a(!1),i.onDismiss()},header:i.header,message:i.message,buttons:["OK"]})}},se=function(e){var t=e.list,n=e.selected,a=e.selectionChanged,r=function(e){if(!n||0===n.length)return!1;for(var t=0;t<n.length;t++)if(n[t].id===e)return!0;return!1};return t?c.a.createElement(d.o,null,c.a.createElement(d.r,null,c.a.createElement(d.o,{key:-1},c.a.createElement(d.Q,{mode:"md",key:-1,checked:(null===t||void 0===t?void 0:t.length)===(null===n||void 0===n?void 0:n.length),onClick:function(){return function(){var e=(null===t||void 0===t?void 0:t.length)!==(null===n||void 0===n?void 0:n.length);if((null===t||void 0===t?void 0:t.length)===(null===n||void 0===n?void 0:n.length)){if(e)return;a([])}else{if(!e)return;a(t?t.slice():null)}}()}}),c.a.createElement(d.p,null,"SELECT ALL")),t&&t.map((function(e){return c.a.createElement(d.o,{key:e.id},c.a.createElement(d.Q,{mode:"md",key:e.id,onClick:function(){!function(e){if(null!==n)if(!n.map((function(e){return e.id})).includes(e.id)){var t=n.slice();t.push(e),a(t)}else{var r=n.filter((function(t){return t.id!==e.id}));a(r)}}(e)},checked:r(e.id)}),c.a.createElement(d.p,null,e.name))})))):c.a.createElement("div",null,"Loading...")},ue=function(e){var t=e.onDismissModal,n=e.isOpen,a=Object(o.useContext)(oe).user,r=Object(o.useState)(null),l=Object(p.a)(r,2),i=l[0],s=l[1],u=Object(o.useState)(null),m=Object(p.a)(u,2),f=m[0],v=m[1];Object(o.useEffect)((function(){if(!n)return v(null),void s(null);var e=!0;return Promise.all([Z.getTypesSelectedByUser(a),Z.listTypes(a)]).then((function(t){e&&(v(t[0]),s(t[1]))})),function(){e=!1}}),[n,a]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(d.l,{className:"ion-no-border"},c.a.createElement(d.R,null,c.a.createElement(d.e,{slot:"start"},c.a.createElement(d.d,{onClick:function(){t()}},c.a.createElement(d.m,{icon:E.c,mode:"md",slot:"icon-only"}))),c.a.createElement(d.O,null,"Notifications"))),c.a.createElement(d.h,{class:"outer-content"},c.a.createElement(se,{list:i,selected:f,selectionChanged:function(e){var t=e.map((function(e){return e.id}));Z.putTypes(a,t).then((function(){v(e)}))}})),c.a.createElement(d.j,null,c.a.createElement(d.R,null)))},de=function(){var e=Object(o.useState)(!1),t=Object(p.a)(e,1)[0],n=c.a.useContext(oe).user,a=G.settings.env.item(n.environment),r="prod"!==a.key?n.username.substr(4):n.username,l=ie(),i=Object(o.useState)(!1),s=Object(p.a)(i,2),u=s[0],m=s[1];return c.a.createElement(d.u,{type:"overlay",disabled:t,contentId:"main"},c.a.createElement(d.l,{className:"ion-no-border"},c.a.createElement(d.R,null,c.a.createElement(d.O,null,"Menu"))),c.a.createElement(d.h,{className:"outer-content"},"prod"!==a.key&&c.a.createElement("div",{className:"username-header"},r.toUpperCase()," (",a.name.toUpperCase(),")"),"prod"===a.key&&c.a.createElement("div",{className:"username-header"},"User ",r),c.a.createElement(d.r,null,c.a.createElement(d.w,{"auto-hide":"false"},c.a.createElement(d.o,{button:!0,routerLink:"/account",routerDirection:"none"},c.a.createElement(d.p,null,"Settings"),c.a.createElement(d.m,{slot:"end",icon:E.v}))),c.a.createElement(d.w,{"auto-hide":"false"},c.a.createElement(d.o,{button:!0,onClick:function(){m(!0)}},c.a.createElement(d.p,null,"Notifications"),c.a.createElement(d.m,{slot:"end",icon:E.s}))),c.a.createElement(d.w,{"auto-hide":"false"},c.a.createElement(d.o,{button:!0,routerLink:"/account",routerDirection:"none"},c.a.createElement(d.p,null,"Submit a Ticket"),c.a.createElement(d.m,{slot:"end",icon:E.r}))),c.a.createElement(d.w,{"auto-hide":"false"},c.a.createElement(d.o,{button:!0,routerLink:"/logout",routerDirection:"none"},c.a.createElement(d.m,{slot:"end",icon:E.p}),c.a.createElement(d.p,null,"Logout")))),l.alertBoxJsx),c.a.createElement(d.j,null,c.a.createElement("div",{className:"debug-info"},"Capacitor: ",G.settings.hasCapacitor?"Yes":"No",c.a.createElement("br",null),"Build Date: ",G.settings.buildDate,c.a.createElement("br",null),"Version: ",G.settings.appVersionString)),c.a.createElement(d.x,{isOpen:u},c.a.createElement(ue,{onDismissModal:function(){m(!1)},isOpen:u})))},me=(n(120),n(121),n(122),n(123),n(124),n(125),n(126),n(127),n(128),n(129),n(130),{authenticateUser:function(){var e=Object(g.a)(h.a.mark((function e(t,n,a){var r,o,c,l;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Authenticating against ".concat(G.settings.env.item(a).name," (").concat(G.settings.env.item(a).url,")")),r=G.settings.env.item(a).url+"token",o="grant_type=password&username=".concat(t,"&password=").concat(n),e.prev=3,e.next=6,fetch(r,{method:"POST",body:o});case 6:return c=e.sent,e.next=9,c.json();case 9:if(!(l=e.sent).error&&!l.error_description){e.next=12;break}return e.abrupt("return",{loggedIn:!1,error:l.error_description,access_token:""});case 12:return e.abrupt("return",{loggedIn:!0,access_token:l.access_token});case 15:return e.prev=15,e.t0=e.catch(3),console.error("Error returned from authentication request: "+e.t0),e.abrupt("return",{loggedIn:!1,err:e.t0,error:"Error attempting to log in",access_token:""});case 19:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(t,n,a){return e.apply(this,arguments)}}(),getHomePageData:function(){var e=Object(g.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.get(t,"api/v3/home/get/0");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getAuthorizedItems:function(){var e=Object(g.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.get(t,"api/v3/home/get-auth");case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),pe=n(231);!function(e){e[e.Shift=1]="Shift",e[e.Unavailable=2]="Unavailable",e[e.Vacation=3]="Vacation",e[e.Cover=4]="Cover",e[e.Clock=6]="Clock",e[e.Absent=7]="Absent"}(le||(le={}));var Ee,fe=le;!function(e){e[e.Approved=1]="Approved",e[e.Request=2]="Request",e[e.RequestDenied=4]="RequestDenied"}(Ee||(Ee={}));var ve=Ee,he=function(e,t){return e&&e.locations&&0!==e.locations.length?t<=0?null:e.locations.filter((function(e){return e.id===t}))[0]:null},ge=function(e,t){if(!e||!e.locations||0===e.locations.length)throw new Error("getLocSettingsForLocationId: called with invalid auth parameter");return 0===t?e.locations[0].settings:e.locations.filter((function(e){return e.id===t}))[0].settings},be=he,ye=function(e,t){if(!e||!e.locations||0===e.locations.length)return null;if(t<=0)return null;var n=null;return e.locations.flatMap((function(e){return e.departments.map((function(e){return 1===e.positions.filter((function(e){return e.id===t})).length?(n=e,e):null}))})),n},Oe=function(e){return e===fe.Shift||e===fe.Cover||e===fe.Clock||e===fe.Absent},ke=function(e,t,n){return(e.locations.filter((function(e){return e.id===t}))[0].departments.filter((function(e){return e.id===n}))[0].adminAuth&w.CanEditSchedules)===w.CanEditSchedules},je=function(e,t){return e.locations.flatMap((function(e){return e.departments.filter((function(e){return e.id===t}))}))[0].adminAuth},Ce=function(e,t){return e.role===a.Admin&&e.locations.flatMap((function(e){return e.departments.filter((function(e){return e.id===t}))}))[0].positions.filter((function(e){return e.hasPosition})).length>0},Ie=function(e,t){var n=e.locations.flatMap((function(e){return e.departments.filter((function(e){return e.id===t}))}))[0];return(n.adminAuth&w.CanEditSchedules)===w.CanEditSchedules&&n.positions.filter((function(e){return e.hasPosition})).length>0},Se=function(e){return null!==e&&void 0!==e&&void 0!==e.locations&&null!==e.locations&&e.locations.length>0},Te=function(e,t){return e===fe.Shift&&t===ve.Approved||e===fe.Cover&&t===ve.Request||e===fe.Cover&&t===ve.RequestDenied},Ne=function(e,t){return!(!e||!e.locations||0===e.locations.length)&&(e.role!==a.Employee&&(e.role===a.BusinessAdmin||e.role===a.LocationAdmin||e.locations.flatMap((function(e){return e.departments.filter((function(e){return e.id===t}))}))[0].isDeptAdmin))},De=function(e,t){if(e.role===a.BusinessAdmin||e.role===a.LocationAdmin)return!0;if(e.role===a.Employee)return!1;var n=he(e,t);return!0===(null===n||void 0===n?void 0:n.adminAllDepts)},xe=function(e,t,n,r){if(!e||!e.locations||0===e.locations.length)return!1;if(e.role===a.Employee)return!1;if(e.role===a.LocationAdmin||e.role===a.BusinessAdmin)return!0;if(-1===n){var o=he(e,t);return!0===(null===o||void 0===o?void 0:o.adminAllDepts)}return(e.locations.flatMap((function(e){return e.departments.filter((function(e){return e.id===n}))}))[0].adminAuth&r)===r},Ae=function(e,t,n){var a=he(e,t);if(null===a)throw new Error('getSelectedDepartment: Could not find locationId "'.concat(t,'"'));if(-1===n)return{location:a,department:null};var r=a.departments.filter((function(e){return e.id===n}))[0];return{location:a,department:r}},we=function(e,t,n){var a=e.filter((function(e){return e.id===t}))[0],r=a.departments.flatMap((function(e){return e.positions.filter((function(e){return e.id===n}))}))[0];return{location:a,position:r}},Me=function(e,t){for(var n=0;n<e.length;n++)for(var a=0;a<e[n].departments.length;a++)for(var r=0;r<e[n].departments[a].positions.length;r++)if(e[n].departments[a].positions[r].id===t)return{location:e[n],position:e[n].departments[a].positions[r]};return{location:{},position:{}}},Re=function(e){for(var t=0;t<e.length;t++)if(e[t].settings.RequireGeoLocation)return!0;return!1},Pe={subscriptionType:r.None,businessId:0,businessName:"",employeeId:0,role:a.Employee,locations:[],loading:!1,payrollEvents:[],tags:[],lastRefresh:void 0},Ue={auth:Pe,refreshAuth:function(e,t){return new Promise((function(){}))},clearAuth:function(){var e=Object(g.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),authLoading:!1},Le=c.a.createContext(Ue);function Fe(e,t){return Be.apply(this,arguments)}function Be(){return(Be=Object(g.a)(h.a.mark((function e(t,n){var a,r,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isLoggedin){e.next=5;break}return a=Object(f.a)({},Pe),e.next=4,S.putAuthItems(a).then((function(){J("indexdb_authitems_cleared")}));case 4:return e.abrupt("return",a);case 5:if(n){e.next=12;break}return e.next=8,S.getAuthItems();case 8:if(r=e.sent,!(Se(r)&&void 0!==r.lastRefresh&&Object(pe.a)(new Date,r.lastRefresh)<W(t).maxStaleAuthItemsInMinutes)){e.next=12;break}return H(t,r),e.abrupt("return",r);case 12:return e.next=14,me.getAuthorizedItems(t);case 14:if(!((o=e.sent)&&o.locations&&o.locations.length>0)){e.next=23;break}return e.next=18,S.putAuthItems(Object(f.a)({},o,{lastRefresh:new Date}));case 18:return J("indexdb_authitems_put",{employeeId:o.employeeId}),H(t,o),e.abrupt("return",o);case 23:return e.abrupt("return",null);case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ze=function(e){var t=Object(o.useState)(Object(f.a)({},Pe)),n=Object(p.a)(t,2),a=n[0],r=n[1],l=Object(o.useState)(!1),i=Object(p.a)(l,2),s=i[0],u=i[1],d=function(){var e=Object(g.a)(h.a.mark((function e(t,n){var o,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u(!0),n.isLoggedin||(o=Object(f.a)({},Pe),r(o),S.putAuthItems(o).then((function(){J("indexdb_authitems_cleared")})),u(!1)),!(!t&&a.employeeId>0&&void 0!==a.lastRefresh&&Object(pe.a)(new Date,a.lastRefresh)<W(n).maxStaleAuthItemsInMinutes)){e.next=4;break}return e.abrupt("return",a);case 4:return e.next=6,Fe(n,t);case 6:return c=e.sent,u(!1),c&&r(c),e.abrupt("return",c);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),m=function(){var e=Object(g.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r(Pe),e.next=3,S.putAuthItems(Pe);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return c.a.createElement(Le.Provider,{value:{auth:a,refreshAuth:d,clearAuth:m,authLoading:s}},e.children)};function Ve(e,t){return e.length>0&&t.length>5}var _e,qe=function(e){var t=e.history,n=ie(),a=n.alertBoxJsx,r=n.showAlert,l=c.a.useContext(oe),i=l.user,s=l.userLoggedIn,u=l.logout,m=c.a.useContext(Le).refreshAuth,E=Object(o.useState)(!1),f=Object(p.a)(E,2),v=f[0],b=f[1],y=Object(o.useState)(""),O=Object(p.a)(y,2),k=O[0],j=O[1],C=Object(o.useState)(""),I=Object(p.a)(C,2),S=I[0],T=I[1],N=Object(o.useState)(""),D=Object(p.a)(N,1)[0],x=Object(o.useState)(""),A=Object(p.a)(x,1)[0],w=Object(o.useState)(!1),M=Object(p.a)(w,2),R=M[0],P=M[1],U=function(){var e=Object(g.a)(h.a.mark((function e(){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k&&S){e.next=2;break}return e.abrupt("return");case 2:n=G.getUserAndEnvironmentFromInput(k),b(!0),me.authenticateUser(n.username,S,n.env.key).then((function(e){if(e.loggedIn)s(k,e.access_token,n.env.key).then((function(e){m(!0,e).then((function(){J("login",{username:n.username,appVersion:G.settings.appVersionString,environment:n.env.name}),console.log("logged in to ".concat(n.env.name,": ").concat(n.username)),t.push("/tabs/schedule",{direction:"none"}),t.goForward(),b(!1)})).catch((function(){b(!1),r("Failed to log in","Could not retreive user data",(function(){u()}))}))})).catch((function(){b(!1),r("Failed to log in","Could not set access token",(function(){u()}))}));else{b(!1),J("login_failure",{username:n.username,appVersion:G.settings.appVersionString,environment:n.env.name});var a=e.error?e.error:"Could not log in";r("Failed to log in",a,(function(){T(""),P(!1)}))}}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(d.W)((function(){i.isLoggedin&&(t.push("/tabs/schedule",{direction:"forward"}),t.goForward())})),c.a.createElement(d.y,{id:"login-page"},c.a.createElement(d.h,{className:"login-content"},c.a.createElement("div",{className:"login-logo"},c.a.createElement("img",{className:"logo",src:"assets/img/OS Logo - 4pt Rounded _ 2 Tone Orange.svg",alt:"Orbital Shift Logo"})),c.a.createElement(d.t,{isOpen:v,onDidDismiss:function(){return b(!1)},spinner:"dots",message:"Logging in...",duration:0}),a,c.a.createElement(d.r,{className:"form-list"},c.a.createElement("div",{className:"item"},c.a.createElement("div",{className:"label"},"User"),c.a.createElement("div",{className:"field-container"},c.a.createElement("input",{className:"input",id:"username",name:"username",type:"text",value:k,onChange:function(e){var t;t=e.target.value,j(t),P(Ve(t,S))}}))),D.length>0&&c.a.createElement(d.M,{color:"light"},c.a.createElement("p",{className:"ion-padding-start"},D)),c.a.createElement("div",{className:"item"},c.a.createElement("div",{className:"label"},"Password"),c.a.createElement("div",{className:"field-container"},c.a.createElement("input",{className:"input",id:"password",name:"password",type:"password",value:S,onChange:function(e){var t;t=e.target.value,T(t),P(Ve(k,t))}}))),A.length>0&&c.a.createElement(d.M,{color:"light"},c.a.createElement("p",{className:"ion-padding-start"},A))),c.a.createElement(d.C,null,c.a.createElement(d.g,null,c.a.createElement(d.d,{className:"login-button",type:"submit",onClick:U,expand:"block",disabled:!R},"LOG IN")))))},We=n(219),Ge=n(220),Ye=n(100),Je=n(221),He=n(222),Ke=n(223),Qe=n(218);!function(e){e[e.All=-1]="All",e[e.Scheduled=-2]="Scheduled",e[e.DontWork=-3]="DontWork",e[e.ClockAndSched=-6]="ClockAndSched",e[e.Custom=0]="Custom"}(_e||(_e={}));var Xe=_e,$e=new Date(9e3,1,1);function Ze(e,t){return e===fe.Shift&&t===ve.Approved||e===fe.Cover&&t===ve.Request||e===fe.Cover&&t===ve.RequestDenied}function et(e,t){return e===fe.Absent&&t===ve.Approved}function tt(e,t,n,a){if(e>0&&t>0){if(e===n&&t===a)return!0}else if(e>0&&t===Xe.All){if(e===n)return!0}else{if(e!==Xe.All||t!==a)return e===Xe.Scheduled&&t===Xe.Scheduled?Ze(n,a)||et(n,a):e!==Xe.ClockAndSched||t!==Xe.ClockAndSched||(function(e,t){return Ze(e,t)||e===fe.Clock&&t===ve.Approved}(n,a)||et(n,a));if(t===a)return!0}return!1}var nt=n(97),at=n(230),rt=new Date(9e3,1,1);function ot(e){return void 0!==e.BusinessId}function ct(e){var t=Intl.DateTimeFormat().resolvedOptions().timeZone,n=Object(nt.a)(e,{timeZone:t});return Object(at.a)(n,"yyyy-MM-dd",{timeZone:t})+"T"+Object(at.a)(n,"HH:mm:ssXXX",{timeZone:t})}function lt(e){if(!e)return 0;var t,n,a=e.split(":");if(a[0].indexOf(".")>=0){var r=a[0].split(".");t=24*parseInt(r[0])+parseInt(r[1]),n=parseInt(a[1])}else t=parseInt(a[0]),n=parseInt(a[1]);return 60*t+n}function it(e){if(!e)return"(0m)";var t,n,a=e.split(":");if(a[0].indexOf(".")>=0){var r=a[0].split(".");t=24*parseInt(r[0])+parseInt(r[1]),n=parseInt(a[1])}else t=parseInt(a[0]),n=parseInt(a[1]);return t>0?"(".concat(t,"h ").concat(n,"m)"):"(".concat(n,"m)")}function st(e){return Object(Ye.a)(e,"EEE MMM d, yyyy").toUpperCase()}function ut(e){var t=Object(Ye.a)(Object(We.a)(e.BreakStart),"h:mmaaa").replace("M","");if(!e.BreakEnd||e.BreakEnd>rt)return t;var n=Object(Ye.a)(Object(We.a)(e.BreakEnd),"h:mmaaa").replace("M","");return"".concat(t," - ").concat(n)}function dt(e){var t,n=Object(Ye.a)(Object(We.a)(e.EventStart),"h:mmaaa").replace("M","");return t=!ot(e)&&e.IsClockedIn||ot(e)&&function(e){return e.EventTypeId===fe.Clock&&e.EventStatusId===ve.Approved&&Object(Qe.a)(e.EventEnd,$e)}(e)?Object(Ye.a)(new Date,"h:mmaaa").replace("M",""):Object(Ye.a)(Object(We.a)(e.EventEnd),"h:mmaaa").replace("M",""),"".concat(n," - ").concat(t)}function mt(e){var t=Object(Ye.a)(Object(We.a)(e.BreakStart),"h:mmaa").replace("M",""),n=e.BreakEnd?Object(Ye.a)(Object(We.a)(e.BreakEnd),"h:mmaa").replace("M",""):Object(Ye.a)(new Date,"h:mmaa").replace("M","");return"".concat(t," - ").concat(n)}function pt(e,t,n){var a=!n||n.indexOf("T")<0?0:lt(n.split("T")[1]),r=e;r.setHours(0,a,0,0);for(var o=0;Object(Ye.a)(r,"EEEE")!==t&&o<20;)r=Object(Ke.a)(r,-1),o++;return o>15&&console.error("Could not calculate week start based on date ".concat(e)+'and weekStartsOn "'.concat(t,'"')),r}function Et(e){return e.getFullYear()+"-"+vt(e.getMonth()+1,2)+"-"+vt(e.getDate(),2)+"T"+vt(e.getHours(),2)+":"+vt(e.getMinutes(),2)+":00"}function ft(e,t,n){var a=Number(e).toFixed(n).toString(),r="";0===a.indexOf("-")&&(a=a.substring(1),r="-");var o="0000000000"+a;return-1===a.indexOf(".")?r+o.substr(o.length-Math.max(a.length,t)):r+o.substr(o.length-Math.max(a.length,t+n+1))}function vt(e,t){var n="0000000000"+e;return n.substr(n.length-t)}var ht=n(73);function gt(e){return e.length>19?e.slice(0,19):e}var bt,yt={getScheduleEvent:function(){var e=Object(g.a)(h.a.mark((function e(t,n){var a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.get(t,"api/v2/employee/schedule-events/get/"+n);case 2:if(!(a=e.sent).error){e.next=5;break}return e.abrupt("return",null);case 5:return e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),getScheduleEventsByFilter:function(){var e=Object(g.a)(h.a.mark((function e(t,n){var a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(f.a)({start:Et(n.start),end:Et(n.end)},n),e.next=3,$.post(t,"api/v2/employee/schedule-events/filter",a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),getDailyNotesByFilter:function(){var e=Object(g.a)(h.a.mark((function e(t,n){var a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(f.a)({start:Et(n.start),end:Et(n.end)},n),e.next=3,$.post(t,"api/v2/daily-notes/filter",a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),updateScheduleEvent:function(){var e=Object(g.a)(h.a.mark((function e(t,n,a){var r,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={scheduleEventId:n.scheduleEventId,eventType:n.eventType,eventStatus:n.eventStatus,isConfirmed:n.isConfirmed,positionId:n.position.position.id,employeeId:n.employee.id,eventStart:gt(n.eventStart),eventEnd:gt(n.eventEnd),tagId:null===(r=n.tag)||void 0===r?void 0:r.id,eventBreaks:n.eventBreaks,isClockedIn:n.isClockedIn,breakStart:null,breakDuration:null,clockOutValue:n.clockoutValue,absentTime:n.absentTimeMinutes,notes:n.notes,sendMessage:!1,recurrenceId:n.recurrenceId,recurrenceStart:n.recurrenceStart,recurrenceEnd:n.recurrenceEnd,recurrenceType:n.recurrenceType,repeatInterval:n.repeatInterval,repeatWeekdays:n.repeatWeekdays,recurrenceUpdateType:a},e.next=3,$.post(t,"api/v2/employee/schedule-events/update",o);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),createScheduleEvent:function(){var e=Object(g.a)(h.a.mark((function e(t,n,a){var r,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={sceduleEventId:0,eventType:n.eventType,eventStatus:n.eventStatus,isConfirmed:n.isConfirmed,positionId:n.position.position.id,employeeId:n.employee.id,eventStart:gt(n.eventStart),eventEnd:gt(n.eventEnd),tagId:null===(r=n.tag)||void 0===r?void 0:r.id,eventBreaks:n.eventBreaks,isClockedIn:n.isClockedIn,breakStart:null,breakDuration:null,clockOutValue:n.clockoutValue,absentTime:n.absentTimeMinutes,notes:n.notes,sendMessage:!1,recurrenceId:n.recurrenceId,recurrenceStart:n.recurrenceStart,recurrenceEnd:n.recurrenceEnd,recurrenceType:n.recurrenceType,repeatInterval:n.repeatInterval,repeatWeekdays:n.repeatWeekdays,recurrenceUpdateType:a},e.next=3,$.post(t,"api/v2/employee/schedule-events/create",o);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),deleteScheduleEvent:function(){var e=Object(g.a)(h.a.mark((function e(t,n,a){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={scheduleEventId:n,recurrenceUpdateType:a,sendMessage:!1},e.next=3,$.post(t,"api/v2/employee/schedule-events/delete",r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}()},Ot={settingsLocId:0,dnLocIds:[],start:new Date,end:new Date,filterByEmployee:!1,filterByPosition:!0,positionIds:[],eventTypeId:-1,eventStatusId:-1,tagId:void 0},kt=n(98),jt=function(e){var t=e.startDate,n=e.setStartDate,a=Object(o.useRef)(t),r=function(e){Object(kt.a)(e,a.current)||(a.current=e,n(e))};return c.a.createElement("div",{className:"chooser"},c.a.createElement("div",{className:"top"},c.a.createElement("button",{onClick:function(){return r(Object(Ke.a)(t,-7))},className:"arrow",key:-1},c.a.createElement(d.m,{mode:"ios",icon:E.b})),c.a.createElement("div",{className:"month-year-container"},c.a.createElement("div",{className:"datetime-picker-container"},c.a.createElement(d.i,{className:"datetime-picker",displayFormat:"MMM YYYY",pickerFormat:"MMM D YYYY",min:"2005-01-01",max:"2030-01-01",value:t.toISOString(),onIonChange:function(e){r(Object(We.a)(e.detail.value))}}),c.a.createElement(d.m,{mode:"md",icon:E.k}))),c.a.createElement("button",{onClick:function(){return r(Object(Ke.a)(t,7))},className:"arrow",key:7},c.a.createElement(d.m,{mode:"ios",icon:E.e}))),c.a.createElement("div",{className:"weekday-list"},[0,1,2,3,4,5,6].map((function(e){var n=Object(Ke.a)(t,e),a=Object(Ge.a)(n)?"today":"not-today";return c.a.createElement("button",{key:e,className:"weekday-button",style:{outline:"none"}},c.a.createElement("div",null,c.a.createElement("div",{className:"weekday-abbr"},Object(Ye.a)(n,"EEE")),c.a.createElement("div",{className:a}),c.a.createElement("div",{className:"weekday-num"},Object(Ye.a)(n,"d"))))}))))},Ct=n(224);!function(e){e[e.None=0]="None",e[e.UndoCoverRequest=1]="UndoCoverRequest",e[e.CreateShiftRequest=2]="CreateShiftRequest",e[e.DeleteShiftRequest=3]="DeleteShiftRequest",e[e.CreateCoverRequest=4]="CreateCoverRequest",e[e.Delete=5]="Delete"}(bt||(bt={}));var It=function(e,t,n,r,o,c,l,i,s,u){var d=we(u.locations,c,i),m=Tt(u,d,n,t,!0),p=St(u,d,n),E={buttonText:"",enableConfirm:!0,isReadonly:!1,text:"",usage:bt.None,eventTypeOptionList:p,eventStatusOptionList:m};if(u.role===a.BusinessAdmin)return E;if(u.role===a.LocationAdmin)return Oe(e)&&0===u.locations.filter((function(e){return e.id===c})).length?null:E;var v=Object(We.a)(o),h=new Date,g=Object(Qe.a)(h,v),b=!1,y=je(u,l);if(u.role===a.Admin)if(n===u.employeeId){if(e===fe.Clock)return(y&w.CanEditOwnClockEvents)===w.CanEditOwnClockEvents?E:null;if((y&w.CanEditSchedules)===w.CanEditSchedules)return E;b=!0}else{if(e===fe.Clock)return(y&w.CanEditEmployeeClockEvents)===w.CanEditEmployeeClockEvents?E:null;if(ke(u,c,l))return E;if(!Ce(u,l))return null;b=!0}return u.role===a.Employee||b?n===u.employeeId?g||e===fe.Clock?null:e===fe.Shift?t===ve.Approved?Object(f.a)({},E,{buttonText:"Create Cover-Request",isReadonly:!0,usage:bt.CreateCoverRequest}):t===ve.Request?Object(f.a)({},E,{buttonText:"Undo Shift-Request",enableConfirm:!1,isReadonly:!0,text:"Click OK to remove your Shift-Request",usage:bt.DeleteShiftRequest}):null:e===fe.Cover?t===ve.Request?Object(f.a)({},E,{buttonText:"Undo Cover-Request",enableConfirm:!0,isReadonly:!0,usage:bt.UndoCoverRequest}):null:!Oe(e)&&Ie(u,l)?Object(f.a)({},E,{buttonText:"Delete Request",enableConfirm:!1,isReadonly:!0,text:"Click OK to delete this event",usage:bt.Delete}):null:e===fe.Cover&&t===ve.Request?Object(f.a)({},E,{buttonText:"Make Shift-Request",enableConfirm:!1,isReadonly:!0,text:"",usage:bt.CreateShiftRequest}):null:null},St=function(e,t,n){if(!e||!e.locations||0===e.locations.length||!t||!t.location||!t.location.settings)return[];var r=[{value:fe.Shift,text:"SHIFT",color:"green"}],o=t.location.settings,c=ye(e,t.position.id),l=je(e,c.id);if((e.role===a.BusinessAdmin||e.role===a.LocationAdmin||e.role===a.Admin&&(e.employeeId===n&&(l&w.CanEditOwnClockEvents)===w.CanEditOwnClockEvents||e.employeeId!==n&&(l&w.CanEditEmployeeClockEvents)===w.CanEditEmployeeClockEvents))&&r.push({value:fe.Clock,text:"CLOCK",color:"green"}),(e.role===a.BusinessAdmin||e.role===a.LocationAdmin||e.role===a.Admin&&(l&w.CanEditSchedules)===w.CanEditSchedules)&&r.push({value:fe.Cover,text:"COVER",color:"red"}),o.ShowUnavailableEventType&&r.push({value:fe.Unavailable,text:"UNAVAILABLE",color:"yellow"}),o.ShowVacationEventType&&r.push({value:fe.Vacation,text:"VACATION",color:"yellow"}),o.ShowAbsentEventType){var i=e.payrollEvents.filter((function(e){return e.positionIds.includes(t.position.id)&&!e.name.startsWith("--")})).map((function(e){return{value:e.id,text:e.name,color:"yellow"}}));return r.concat(i)}return r},Tt=function(e,t,n,r,o){var c=[],l=ye(e,t.position.id),i=je(e,l.id);if((e.role===a.LocationAdmin||e.role===a.BusinessAdmin||e.role===a.Admin&&(i&w.CanEditSchedules)===w.CanEditSchedules)&&c.push({value:ve.Approved,text:"APPROVED",color:"black"}),c.push({value:ve.Request,text:"REQUEST",color:"red"}),(e.role===a.LocationAdmin||e.role===a.BusinessAdmin||e.role===a.Admin&&(i&w.CanEditSchedules)===w.CanEditSchedules)&&c.push({value:ve.RequestDenied,text:"REQUEST-DENIED",color:"black"}),o&&0===c.filter((function(e){return e.value===r})).length)switch(r){case ve.Approved:c.push({value:ve.Approved,text:"APPROVED",color:"black"});break;case ve.Request:c.push({value:ve.Request,text:"REQUEST",color:"red"});break;case ve.RequestDenied:c.push({value:ve.RequestDenied,text:"REQUEST-DENIED",color:"black"})}return c},Nt={1:"#9CBA6A",2:"#BFBFBF",3:"#FFAD00",4:"#C41A26",6:"#677A46",7:"#FFAD00"},Dt={1:{color:"black"},2:{color:"#C41A26"},4:{color:"#BCBCBC"}},xt=function(e){var t=e.location,n=e.event,a=e.multiLocation,r=e.showEmployeeName,l=e.onEdit,i=Object(o.useContext)(Le).auth,s=r?{display:"inline-block"}:{display:"none"},u=Object(We.a)(n.EventStart),m=!!a||t.departments.filter((function(e){return e.positions.filter((function(e){return e.hasPosition}))})).length>1,p="";a&&n.AbbreviatedLocationName&&(p=n.AbbreviatedLocationName+"/"),m&&n.AbbreviatedDepartmentName&&(p+=n.AbbreviatedDepartmentName+"/"),p+=n.PositionName;var f={borderLeft:"7px solid ".concat(Nt[n.EventTypeId]," ")},v=Dt[n.EventStatusId];return c.a.createElement("button",{className:"card",onClick:function(){!function(){var e=It(n.EventTypeId,n.EventStatusId,n.EmployeeId,n.EventStart,n.EventEnd,n.LocationId,n.DepartmentId,n.PositionId,n.IsConfirmed,i);null!==e&&l(n,e)}()}},c.a.createElement("div",{className:"card-first-col"},c.a.createElement("div",{className:"day-name"},Object(Ye.a)(u,"EEE")," "),c.a.createElement("div",{className:"day-number"},Object(Ye.a)(u,"d"))),c.a.createElement("div",{className:"card-second-col",style:f},c.a.createElement("div",{className:"time-row"},n.IsClockedIn&&c.a.createElement(d.m,{icon:E.w}),c.a.createElement("span",{style:v},dt(n),"\xa0\xa0"),it(n.EventTypeId===fe.Absent?n.Time:n.EventDuration)),c.a.createElement("div",{className:"name-row",style:s},n.FirstName," ",n.LastName),c.a.createElement("div",{className:"dept-position-row"},p,"\xa0\xa0",n.Tag&&"~".concat(n.Tag))))};var At=function(){var e=Object(o.useState)(!1),t=Object(p.a)(e,2),n=t[0],a=t[1],r=Object(o.useState)({header:"",message:"",options:[],onDismiss:function(e){}}),l=Object(p.a)(r,2),i=l[0],s=l[1],u=function(e){a(!1),i.onDismiss(e)};return{showDialog:function(e,t,n,r){s({header:e,message:t,options:n,onDismiss:r}),a(!0)},dialogBoxJsx:c.a.createElement(d.x,{isOpen:n,cssClass:"mini-modal orbital-dialog-modal",onDidDismiss:function(){return u(null)}},c.a.createElement(d.h,{className:"modal-content"},c.a.createElement(d.l,{mode:"ios"},c.a.createElement(d.R,null,c.a.createElement(d.O,null,i.header))),c.a.createElement(d.k,null,i.options.map((function(e){return c.a.createElement(d.C,{key:e.value},c.a.createElement(d.g,{size:"12"},c.a.createElement(d.d,{expand:"block",color:e.color,className:"apply-button",onClick:function(){return u(e.value)}},e.text)))})),c.a.createElement(d.C,null,c.a.createElement(d.g,{size:"12"},c.a.createElement(d.d,{expand:"block",className:"cancel-button",onClick:function(){return u(null)}},"Cancel"))))))}},wt=function(e){var t=e.currentDepartment,n=e.onDepartmentUpdate,a=Object(o.useContext)(Le).auth,r=Object(o.useState)(t),l=Object(p.a)(r,2),i=l[0],s=l[1];if(a&&a.locations&&0!==a.locations.length){var u=null!==i.department?i.department.id:null;return c.a.createElement(c.a.Fragment,null,c.a.createElement(d.o,null,c.a.createElement(d.p,null,"Location"),c.a.createElement(d.F,{interface:"popover",style:{maxWidth:"100%"},value:i.location.id,onIonChange:function(e){return function(e){if(e){var t={location:a.locations.filter((function(t){return t.id===e}))[0],department:null};s(t),n(t)}}(e.detail.value)}},a.locations.map((function(e){return c.a.createElement(d.G,{key:e.id,value:e.id},e.name)})))),c.a.createElement(d.o,null,c.a.createElement(d.p,null,"Department"),c.a.createElement(d.F,{interface:"popover",style:{maxWidth:"100%"},value:u,onIonChange:function(e){return function(e){if(void 0!==e){var t={location:i.location,department:null===e?null:i.location.departments.filter((function(t){return t.id===e}))[0]};s(t),n(t)}}(e.detail.value)}},De(a,i.location.id)&&c.a.createElement(d.G,{key:-1,value:null},"All Departments"),i.location.departments.filter((function(e){return xe(a,i.location.id,e.id,w.CanEditSchedules)})).map((function(e){return c.a.createElement(d.G,{key:e.id,value:e.id},e.name)})))))}return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",null,"Loading"))},Mt=function(){var e=Object(g.a)(h.a.mark((function e(t,n,a,r,o){var c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.post(t,"api/v2/daily-notes/update",{dailyNoteId:n,date:Et(o),text:a,role:r});case 2:return c=e.sent,e.abrupt("return",c);case 4:case"end":return e.stop()}}),e)})));return function(t,n,a,r,o){return e.apply(this,arguments)}}(),Rt=function(){var e=Object(g.a)(h.a.mark((function e(t,n,a,r,o,c){var l;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.post(t,"api/v2/daily-notes/insert",{locId:n,depId:a,role:r,date:o,text:c});case 2:return l=e.sent,e.abrupt("return",l);case 4:case"end":return e.stop()}}),e)})));return function(t,n,a,r,o,c){return e.apply(this,arguments)}}(),Pt=function(){var e=Object(g.a)(h.a.mark((function e(t,n){var a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.post(t,"api/v2/daily-notes/delete/"+n);case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Ut={getDailyNote:function(){var e=Object(g.a)(h.a.mark((function e(t,n,a,r,o){var c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.post(t,"api/v2/daily-notes/get",{locId:n,depId:a,role:r,date:o});case 2:return c=e.sent,e.abrupt("return",c);case 4:case"end":return e.stop()}}),e)})));return function(t,n,a,r,o){return e.apply(this,arguments)}}(),updateDailyNote:Mt,insertDailyNote:Rt,deleteDailyNote:Pt};var Lt=function(){var e=Object(o.useState)(!1),t=Object(p.a)(e,2),n=t[0],a=t[1],r=Object(o.useState)({message:""}),l=Object(p.a)(r,2),i=l[0],s=l[1];return{showToast:function(e){s({message:e}),a(!0)},simpleToastJsx:c.a.createElement(d.P,{isOpen:n,onDidDismiss:function(){return a(!1)},position:"top",message:i.message,duration:1500})}};var Ft=function(e){var t=e.onCloseModal,n=e.isOpen,r=e.note,l=e.initialDate,i=Object(o.useState)(r),s=Object(p.a)(i,2),u=s[0],m=s[1],f=Lt(),v=ie(),h=Object(o.useContext)(oe).user,g=Object(o.useContext)(Le).auth,b=At(),y=Object(o.useState)(null!==r?r.Role:1),O=Object(p.a)(y,2),k=O[0],j=O[1],C=Object(o.useState)(null!==r?Ae(g,r.LocationId,r.DepartmentId):function(e){for(var t=0;t<e.locations.length;t++){var n=e.locations[t];if(n.adminAllDepts)return{location:n,department:null};for(var r=0;r<n.departments.length;r++){var o=n.departments[r];if(e.role===a.LocationAdmin||e.role===a.BusinessAdmin)return{location:n,department:o};if(o.isDeptAdmin)return{location:n,department:o}}}throw new Error("Could not find a department for this user to add a note")}(g)),I=Object(p.a)(C,2),S=I[0],T=I[1],N=Object(o.useState)(null!==r?r.Notes:""),D=Object(p.a)(N,2),x=D[0],A=D[1],w=Object(o.useRef)(null!==r?r.Notes.length:0),M=Object(o.useState)(null!==r?Object(We.a)(r.EventStart):l),R=Object(p.a)(M,2),P=R[0],U=R[1];Object(o.useEffect)((function(){var e=!0;return n&&null===u&&e&&L(S,k,P),function(){e=!1}}),[n,u]);var L=function(e,t,n){Ut.getDailyNote(h,e.location.id,null===e.department?-1:e.department.id,t,n).then((function(e){if("message"in e)e.error||m(null);else{if(null!==u&&u.DailyNoteId===e.DailyNoteId)return;a=u,(null===(n=e)&&null!==a||null!==n&&null===a||(null!==n||null!==a)&&((null===n||void 0===n?void 0:n.Role)!==(null===a||void 0===a?void 0:a.Role)||(null===n||void 0===n?void 0:n.DailyNoteId)!==(null===a||void 0===a?void 0:a.DailyNoteId)))&&m(e);var t=Object(We.a)(e.EventStart);Object(kt.a)(t,P)||U(t),(e.LocationId!==S.location.id||-1===e.DepartmentId&&null!==S.department||-1!==e.DepartmentId&&null===S.department||null!==S.department&&e.DepartmentId!==S.department.id)&&T(Ae(g,e.LocationId,e.DepartmentId)),e.Role!==k&&j(e.Role),e.Notes!==x&&(A(e.Notes),w.current=e.Notes.length)}var n,a}))},F=function(e,n,a,r,o){null===u&&0===x.length||null!==u&&u.Notes===x?o&&t(""):null!==u?(0===r.length&&Ut.deleteDailyNote(h,u.DailyNoteId).then((function(e){e.error?v.showAlert("Can't Delete Note",e.message,(function(){})):o?t("Note Deleted"):f.showToast("Note Deleted")})),Ut.updateDailyNote(h,u.DailyNoteId,r,n,a).then((function(e){e.error?v.showAlert("Can't Update Note",e.message,(function(){})):o?t("Note Updated"):f.showToast("Note Updated")}))):Ut.insertDailyNote(h,e.location.id,null===e.department?-1:e.department.id,n,a,r).then((function(e){e.error?v.showAlert("Can't Add Daily Note",e.message,(function(){})):o?t("Note Added"):f.showToast("Note Added")}))};return n&&g&&g.locations&&0!==g.locations.length?c.a.createElement(c.a.Fragment,null,c.a.createElement(d.l,{className:"ion-no-border"},c.a.createElement(d.R,null,c.a.createElement(d.e,{slot:"start"},c.a.createElement(d.d,{onClick:function(){null===u&&null!=x||null!==u&&u.Notes!==x?F(S,k,P,x,!0):t("")}},c.a.createElement(d.m,{icon:E.c,mode:"md",slot:"icon-only"}))),c.a.createElement(d.O,{className:"IonTitle--DailyNote"},"Daily Notes"))),c.a.createElement(d.h,{class:"edit-daily-modal-content"},c.a.createElement(d.r,null,c.a.createElement(wt,{currentDepartment:S,onDepartmentUpdate:function(e){e.location.id===S.location.id&&e.department===S.department||(T(e),F(S,k,P,x,!1),L(e,k,P))}}),c.a.createElement(d.o,null,c.a.createElement(d.p,null,"Viewable By"),c.a.createElement(d.F,{interface:"popover",value:k,onIonChange:function(e){var t;(t=e.detail.value)!==k&&(j(t),F(S,k,P,x,!1),L(S,t,P))}},c.a.createElement(d.G,{value:1,key:1},"Employees"),c.a.createElement(d.G,{value:2,key:2},"Admins"))),c.a.createElement(d.o,null,c.a.createElement(d.p,null,"Date"),c.a.createElement(d.i,{displayFormat:"DDDD M / DD / YYYY",pickerFormat:"MMM DD YYYY",min:"2005-01-01",max:"2030-01-01",value:P.toISOString(),onIonChange:function(e){!function(e){if(null!==e&&void 0!==e){var t=Object(We.a)(e);t!==P&&(U(t),F(S,k,P,x,!1),L(S,k,t))}}(e.detail.value)}})),c.a.createElement(d.o,null,c.a.createElement(d.N,{value:x,placeholder:"Enter a Note",rows:5,spellcheck:!0,wrap:"hard",debounce:50,onIonChange:function(e){var t;null!==(t=e.detail.value)&&void 0!==t&&(t.length!==w.current&&(w.current=t.length),t!==x&&A(t))}})),c.a.createElement("div",{className:"character-counter"},w.current,"/180"))),v.alertBoxJsx,b.dialogBoxJsx,f.simpleToastJsx):c.a.createElement(c.a.Fragment,null,c.a.createElement("div",null,"Loading"),v.alertBoxJsx)},Bt=function(e){var t=e.note,n=e.onForceRefresh,r=Object(We.a)(t.EventStart),l=-1===t.DepartmentId?"All Depts":t.DepartmentName,i=Object(o.useState)(!1),s=Object(p.a)(i,2),u=s[0],m=s[1],E=Object(o.useContext)(Le).auth;return c.a.createElement(c.a.Fragment,null,c.a.createElement("button",{className:"card daily-note",onClick:function(){if(E.role!==a.Employee)return!!xe(E,t.LocationId,t.DepartmentId,w.CanEditSchedules)&&void m(!0)}},c.a.createElement("div",{className:"card-first-col"},c.a.createElement("div",{className:"day-name"},Object(Ye.a)(r,"EEE")," "),c.a.createElement("div",{className:"day-number"},Object(Ye.a)(r,"d"))),c.a.createElement("div",{className:"card-second-col"},c.a.createElement("div",{className:"first-row"},l,": ",1===t.Role?"Employees":"Admins",c.a.createElement("br",null),t.Notes))),c.a.createElement(d.x,{isOpen:u,onDidDismiss:function(){return m(!1)}},c.a.createElement(Ft,{isOpen:u,note:t,onCloseModal:function(e){return n(e),void m(!1)},initialDate:new Date,newNoteClicked:!0})))};var zt=function(e){var t=e.date,n=e.onForceRefresh,r=Object(o.useState)(!1),l=Object(p.a)(r,2),i=l[0],s=l[1];if(!function(e){if(e.role===a.Employee)return!1;if(e.role===a.BusinessAdmin||e.role===a.LocationAdmin)return!0;for(var t=0;t<e.locations.length;t++){var n=e.locations[t];if(n.adminAllDepts)return!0;for(var r=0;r<n.departments.length;r++)if(n.departments[r].isDeptAdmin)return!0}return!1}(Object(o.useContext)(Le).auth))return c.a.createElement("span",null);return c.a.createElement(c.a.Fragment,null,c.a.createElement("button",{className:"add-daily-note-button",onClick:function(){s(!0)}},"+ Daily Note"),c.a.createElement(d.x,{isOpen:i,onDidDismiss:function(){return s(!1)}},c.a.createElement(Ft,{isOpen:i,note:null,initialDate:t,onCloseModal:function(e){var t;t=e,s(!1),n(t)},newNoteClicked:!0})))},Vt=function(e){var t=e.locations,n=e.header,a=e.events,r=e.notes,o=e.showEmployeeNames,l=e.onEdit,i=e.dailyNotesAddButtonDate,s=e.onForceRefresh,u=t.filter((function(e){return e.departments.filter((function(e){return e.positions.filter((function(e){return e.hasPosition}))}))})).length>1;return 0===a.length?c.a.createElement("div",null):c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"event-list-header"},n,null!==i&&c.a.createElement(zt,{onForceRefresh:s,date:i})),c.a.createElement("div",null,r.map((function(e){return c.a.createElement(Bt,{onForceRefresh:s,key:e.DailyNoteId,note:e,location:t.filter((function(t){return t.id===e.LocationId}))[0]})}))),c.a.createElement("div",null,a.map((function(e){return c.a.createElement(xt,{onEdit:l,key:e.ScheduleEventId,event:e,location:t.filter((function(t){return t.id===e.LocationId}))[0],multiLocation:u,showEmployeeName:o})}))))},_t=function(e,t,n,a){var r=new B;if(0===e.length&&0===t.length)return r;var o=new Date(2199,1,1);if(e.length>0&&(o=pt(Object(We.a)(e[0].EventStart),n.DayWeekStartsOn,n.DayStartTime)),t.length>0){var c=pt(Object(We.a)(t[0].EventStart),n.DayWeekStartsOn,n.DayStartTime);Object(Ct.a)(c,o)&&(o=c)}var l=Object(Ke.a)(o,6),i="".concat(Object(Ye.a)(o,"MMM d")," - ").concat(Object(Ye.a)(l,"MMM d")).toUpperCase()+" "+function(e){if(e<60)return"(".concat(e,"m)");var t="(".concat(Math.floor(e/60),"h");return e%60===0?t+")":t+" ".concat(e%60,"m)")}(a.map((function(e){return lt(e.time)})).reduce((function(e,t){return e+t}),0));return r.add(i,{events:e,notes:t,date:o}),r},qt=function(e){var t=e.events,n=e.listType,a=e.notes,r=e.hoursPerDay,o=e.auth,l=e.onEdit,i=e.onForceRefresh;if(0===t.length)return c.a.createElement("div",null,"No Events");var s=new B;switch(n){case"requests":s=function(e,t,n){var a=new B;return a.add("MY REQUESTS",{events:e.filter((function(e){return e.EmployeeId===n})),notes:[],date:null}),a.add("CO-WORKERS",{events:e.filter((function(e){return e.EmployeeId!==n})),notes:[],date:null}),a}(t,0,o.employeeId);break;case"my":s=_t(t,a,o.locations[0].settings,r);break;default:s=function(e,t){var n=new B;return e.map((function(e){var a=Object(Ye.a)(Object(We.a)(e.EventStart).setHours(0,0,0,0),"MMM d, yyyy").toUpperCase();if(!n.containsKey(a)){var r=t.filter((function(e){return Object(Ye.a)(Object(We.a)(e.EventStart).setHours(0,0,0,0),"MMM d, yyyy").toUpperCase()===a}));n.add(a,{notes:r,events:[],date:Object(We.a)(e.EventStart)})}return n.item(a).events.push(e),a})),n}(t,a)}return c.a.createElement(c.a.Fragment,null,s.keys().map((function(e){return c.a.createElement(Vt,{onEdit:l,key:e,header:e,locations:o.locations,events:s.item(e).events,notes:s.item(e).notes,showEmployeeNames:"my"!==n&&"MY REQUESTS"!==e,showTotalDuration:"requests"!==n,dailyNotesAddButtonDate:s.item(e).date,onForceRefresh:i})})))},Wt=function(e,t){if(!e||!e.locations||0===e.locations.length)return[];var n=e.locations[0].settings,a=[{value:fe.Shift,text:"SHIFT",color:"green"},{value:fe.Cover,text:"COVER",color:"red"}];if(t&&a.unshift({value:-1,text:"ALL",color:"black"}),a.push({value:fe.Clock,text:"CLOCK",color:"green"}),n.ShowUnavailableEventType&&a.push({value:fe.Unavailable,text:"UNAVAILABLE",color:"yellow"}),n.ShowVacationEventType&&a.push({value:fe.Vacation,text:"VACATION",color:"yellow"}),n.ShowAbsentEventType){var r=[],o={};return e.locations.flatMap((function(e){return e.departments.flatMap((function(t){return t.positions.map((function(t){return o[t.id]=e}))}))})),e.payrollEvents.map((function(e){return e.name.startsWith("--")?null:(t?e.positionIds.some((function(e){return t.positionIds.indexOf(e)>=0}))&&r.push({value:e.id,text:"".concat(e.name," (").concat(o[e.positionIds[0]].name,")"),color:"yellow"}):r.push({value:e.id,text:"".concat(e.name," (").concat(o[e.positionIds[0]].name,")"),color:"yellow"}),e)})),r.sort((function(e,t){return e.text>t.text?1:-1})),a.concat(r)}return a},Gt={areEqual:function(e,t){if(!e&&t||e&&!t)return!1;if(!e&&!t)return!0;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!Gt.contains(t,e[n]))return!1;return!0},contains:function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return!0;return!1},containsAny:function(e,t){for(var n=0;n<e.length;n++)if(t.includes(e[n]))return!0;return!1},unique:function(e){var t=[];return e.map((function(e){Gt.contains(t,e)||t.push(e)})),t},uniqueObject:function(e,t){var n=[];return e.map((function(e){for(var a=!1,r=0;r<n.length;r++)if(t(n[r],e)){a=!0;break}a||n.push(e)})),n}},Yt=Gt,Jt=function(e){var t=e.auth,n=e.filter,a=e.onDismissModal,r=e.onCancelModal,l=e.isOpen,i=Object(o.useState)(n),s=Object(p.a)(i,2),u=s[0],m=s[1],v=Object(o.useState)(!1),h=Object(p.a)(v,2),g=h[0],b=h[1],y=Object(o.useState)(Xe.ClockAndSched),O=Object(p.a)(y,2),k=O[0],j=O[1],C=Object(o.useState)(Wt(t,n)),I=Object(p.a)(C,2),S=I[0],T=I[1],N=Object(o.useState)(t.locations.map((function(e){return""+e.id}))),D=Object(p.a)(N,2),x=D[0],A=D[1],w=Object(o.useState)(t.locations.flatMap((function(e){return e.departments})).map((function(e){return""+e.id}))),M=Object(p.a)(w,2),R=M[0],P=M[1],U=Object(o.useState)(t.locations.flatMap((function(e){return e.departments})).flatMap((function(e){return e.positions})).map((function(e){return""+e.id}))),L=Object(p.a)(U,2),F=L[0],B=L[1],z=Object(o.useState)(!1),V=Object(p.a)(z,2),_=V[0],q=V[1];Object(o.useEffect)((function(){m(n)}),[n]),Object(o.useEffect)((function(){l&&q(!1)}),[l]);var W=function(e){return Object(f.a)({},Ot,{start:n.start,end:n.end,tagId:-1,positionIds:e.locations.flatMap((function(e){return e.departments.flatMap((function(e){return e.positions.map((function(e){return e.id}))}))})),dnLocIds:e.locations.map((function(e){return e.id})),settingsLocId:e.locations[0].id})},G=function(e){var t,n;j(e),q(!0),m((t=u,(n=e)===Xe.Custom?Object(f.a)({},t,{eventTypeId:-1,eventStatusId:-1}):Object(f.a)({},t,{eventTypeId:n,eventStatusId:n}))),b(e===Xe.Custom)};return c.a.createElement(c.a.Fragment,null,c.a.createElement(d.l,{className:"ion-no-border"},c.a.createElement(d.R,null,c.a.createElement(d.e,{slot:"start"},c.a.createElement(d.d,{onClick:function(){r()}},c.a.createElement(d.m,{icon:E.c,mode:"md",slot:"icon-only"}))),c.a.createElement(d.O,null,"Filter"),c.a.createElement(d.e,{slot:"end"},c.a.createElement(d.d,{onClick:function(){b(!1),j(Xe.ClockAndSched),T(Wt(t,n)),A(t.locations.map((function(e){return""+e.id}))),P(t.locations.flatMap((function(e){return e.departments})).map((function(e){return""+e.id}))),B(t.locations.flatMap((function(e){return e.departments})).flatMap((function(e){return e.positions})).map((function(e){return""+e.id}))),m(W(t)),q(!0)}},"RESET")))),c.a.createElement(d.h,{class:"outer-content"},c.a.createElement(d.o,null,c.a.createElement(d.p,null,"Events"),c.a.createElement(d.F,{value:k,onIonChange:function(e){return G(e.detail.value)},interface:"action-sheet"},c.a.createElement(d.G,{value:Xe.ClockAndSched},"Clock + Sched"),c.a.createElement(d.G,{value:Xe.Scheduled},"Scheduled"),c.a.createElement(d.G,{value:Xe.DontWork},"Don't Work"),c.a.createElement(d.G,{value:Xe.Custom},"Custom"),c.a.createElement(d.G,{value:Xe.All},"All"))),g&&c.a.createElement(d.o,null,c.a.createElement(d.p,null,"Type"),c.a.createElement(d.F,{value:u.eventTypeId,onIonChange:function(e){return m(Object(f.a)({},u,{eventTypeId:e.detail.value}))},interface:"action-sheet"},S.map((function(e){return c.a.createElement(d.G,{key:e.value,value:e.value},e.text)})))),g&&c.a.createElement(d.o,null,c.a.createElement(d.p,null,"Status"),c.a.createElement(d.F,{value:u.eventStatusId,onIonChange:function(e){return m(Object(f.a)({},u,{eventStatusId:e.detail.value}))},interface:"action-sheet"},c.a.createElement(d.G,{value:-1},"All"),c.a.createElement(d.G,{value:1},"Approved"),c.a.createElement(d.G,{value:2},"Request"),c.a.createElement(d.G,{value:4},"Request Denied"))),c.a.createElement(d.o,null,c.a.createElement(d.p,null,"Tags"),c.a.createElement(d.F,{value:u.tagId||-1,onIonChange:function(e){m(Object(f.a)({},u,{tagId:e.detail.value})),q(!0)},interface:"action-sheet"},c.a.createElement(d.G,{key:-1,value:-1},"ALL"),t.tags.map((function(e){return c.a.createElement(d.G,{key:e.id,value:e.id},"~",e.name)})))),t.locations.length>1&&c.a.createElement(d.o,null,c.a.createElement(d.p,null,"Locations"),c.a.createElement(d.F,{multiple:!0,onIonChange:function(e){return n=e.detail.value,A(n),q(!0),P(t.locations.filter((function(e){return n.indexOf(e.id.toString())>=0})).flatMap((function(e){return e.departments})).map((function(e){return""+e.id}))),void T(Wt(t,u));var n},value:x},t.locations.map((function(e){return c.a.createElement(d.G,{key:e.id,value:e.id.toString()},e.name)})))),t.locations.flatMap((function(e){return e.departments})).length>1&&c.a.createElement(d.o,null,c.a.createElement(d.p,null,"Departments"),c.a.createElement(d.F,{multiple:!0,onIonChange:function(e){return n=e.detail.value,P(n),q(!0),void B(t.locations.filter((function(e){return x.indexOf(e.id.toString())>=0})).flatMap((function(e){return e.departments})).flatMap((function(e){return e.positions})).map((function(e){return""+e.id})));var n},value:R},t.locations.filter((function(e){return x.indexOf(e.id.toString())>=0})).map((function(e){return e.departments.map((function(t){return c.a.createElement(d.G,{key:t.id,value:t.id.toString()},e.abbr,"/",t.name)}))})))),t.locations.flatMap((function(e){return e.departments})).flatMap((function(e){return e.positions})).length>1&&c.a.createElement(d.o,null,c.a.createElement(d.p,null,"Positions"),c.a.createElement(d.F,{multiple:!0,onIonChange:function(e){return t=e.detail.value,B(t),void q(!0);var t},value:F},t.locations.filter((function(e){return x.indexOf(e.id.toString())>=0})).flatMap((function(e){return e.departments})).filter((function(e){return R.indexOf(e.id.toString())>=0})).map((function(e){return e.positions.map((function(e){return c.a.createElement(d.G,{key:e.id,value:e.id.toString()},e.name)}))}))))),c.a.createElement(d.j,null,c.a.createElement(d.d,{className:"apply-button",expand:"block",onClick:function(){var e=F.map((function(e){return parseInt(e)})),n=W(t),r=Object(f.a)({},u,{positionIds:e}),o=!(n.eventTypeId===r.eventTypeId&&n.eventStatusId===r.eventStatusId&&n.tagId===r.tagId&&Yt.areEqual(n.positionIds,r.positionIds));a(r,o)},disabled:!_},"APPLY FILTER")))};var Ht=function(e){var t=Object(o.useRef)(null),n={ionicRefresherJsx:c.a.createElement(d.z,{slot:"fixed",ref:t,onIonRefresh:e},c.a.createElement(d.A,{pullingIcon:"arrow-dropdown",pullingText:"Pull down to refresh",refreshingSpinner:"dots",refreshingText:"Refreshing..."}))};return Object(f.a)({},n)},Kt=function(e){var t=e.auth,n=e.editorValues,r=e.update,l=e.eventTypes,i=e.eventStatuses,s=Object(o.useState)(fe.Shift),u=Object(p.a)(s,2),m=u[0],E=u[1],f=Object(o.useState)(ve.Approved),v=Object(p.a)(f,2),h=v[0],g=v[1],b=Object(o.useState)("Ex: 00:00"),y=Object(p.a)(b,2),O=y[0],k=y[1],j=Object(o.useState)(null),C=Object(p.a)(j,2),I=C[0],S=C[1],T=Object(o.useState)(null),N=Object(p.a)(T,2),D=N[0],A=N[1];Object(o.useEffect)((function(){-1!==n.scheduleEventId&&(t.role===a.Employee&&n.scheduleEventId<=0&&h!==ve.Request&&r({type:"TYPESTATUS-UPDATED",eventType:m,eventStatus:ve.Request,absentId:n.absentId,absentTimeMinutes:n.absentTimeMinutes}),n.absentId?E(n.absentId):E(n.eventType),g(n.eventStatus))}),[t,n.eventType,n.eventStatus,n.position,n.absentId,n.scheduleEventId]),Object(o.useEffect)((function(){-1!==n.scheduleEventId&&I&&A(null===n.absentTimeMinutes?null:function(e,t){if(e.TimeFormat===x.HoursMinutes){if(null===t)return"00:00";var n=Math.floor(t/60),a=t%60;return"".concat(vt(n,2),":").concat(vt(a,2))}return null===t?"0":ft(t/60,e.TimeFormatDigits,e.TimeFormatDecimals)}(I,n.absentTimeMinutes))}),[I,n.absentTimeMinutes,n.scheduleEventId]),Object(o.useEffect)((function(){if(-1!==n.scheduleEventId&&(!I||n.locationId!==I.LocationId)&&t&&t.locations&&0!==t.locations.length){var e=ge(t,n.locationId);S(e),k(e.TimeFormat===x.HoursMinutes?"Ex: 00:00":"Ex: 0.0")}}),[n.locationId,n.scheduleEventId]),Object(o.useEffect)((function(){n.scheduleEventId>0&&g(n.eventStatus)}),[n.eventStatus,n.scheduleEventId]);var w=function(e){if(void 0===e&&(e=null),null!=e){var t=function(e,t){if(!t||0===t.length)return 0;if(e.TimeFormat===x.HoursMinutes){if(!/^\d*(:\d{2})?$/.test(t))return 0;if(":"===t[0])return parseInt(t.substring(1));var n=t.split(":");return 1===n.length?60*parseInt(t):60*parseInt(n[0])+parseInt(n[1])}return/^\d+(.\d*)?$/.test(t)?Math.round(60*parseFloat(t)):0}(I,e);t!==n.absentTimeMinutes&&r({type:"TYPESTATUS-UPDATED",eventType:m,eventStatus:h,absentId:m>=100?m:void 0,absentTimeMinutes:t})}else r({type:"TYPESTATUS-UPDATED",eventType:m,eventStatus:h,absentId:m>=100?m:void 0,absentTimeMinutes:null})};return c.a.createElement(c.a.Fragment,null,c.a.createElement(d.C,{className:"edit-row"},c.a.createElement(d.g,{size:"3"},c.a.createElement(d.p,{className:"label"},"Type")),c.a.createElement(d.g,{size:"9"},c.a.createElement(d.F,{className:"select",interface:"popover",disabled:n.isReadonly,value:m,onIonChange:function(e){!function(e){if(e!==n.eventType){E(e);var t=e!==fe.Absent&&e<100?null:n.absentTimeMinutes;r({type:"TYPESTATUS-UPDATED",eventType:e,eventStatus:h,absentId:e>=100?e:void 0,absentTimeMinutes:t})}}(e.detail.value)}},l.map((function(e){return c.a.createElement(d.G,{key:e.value,value:e.value},e.text)}))))),c.a.createElement(d.C,{className:"edit-row"},c.a.createElement(d.g,{size:"3"},c.a.createElement(d.p,{className:"label"},"Status")),c.a.createElement(d.g,{size:"9"},c.a.createElement(d.F,{className:"select",interface:"popover",disabled:n.isReadonly||t.role===a.Employee&&n.scheduleEventId<=0,value:h,onIonChange:function(e){var t;(t=e.detail.value)!==n.eventStatus&&(g(t),r({type:"TYPESTATUS-UPDATED",eventType:m,eventStatus:t,absentId:m>=100?m:void 0,absentTimeMinutes:n.absentTimeMinutes}))}},i&&i.map((function(e){return c.a.createElement(d.G,{key:e.value,value:e.value},e.text)}))))),c.a.createElement(d.C,{className:m>100?"visible edit-row":"invisible"},c.a.createElement(d.g,{size:"3"},c.a.createElement(d.p,{className:"label"},"Hours")),c.a.createElement(d.g,{size:"9"},c.a.createElement(d.n,{className:"input-textbox",placeholder:O,disabled:n.isReadonly,value:D,onIonChange:function(e){e.detail.value&&A(e.detail.value)},onIonBlur:function(){w(D)}}))))},Qt=function(e){var t=e.auth,n=e.editorValues,a=e.update,r=Object(o.useState)([]),l=Object(p.a)(r,2),i=l[0],s=l[1],u=Object(o.useRef)(null);Object(o.useEffect)((function(){-1!==n.scheduleEventId&&t&&t.locations&&t.locations.length>0&&s(function(e){var t=e.length>1;return e.flatMap((function(e){return e.departments.flatMap((function(n){return n.positions.map((function(a){var r=e.departments.length>1,o="";return t&&(o+=(e.abbr?e.abbr:e.name)+"/"),r&&(o+=(n.abbr?n.abbr:n.name)+"/"),o+=a.name,{id:a.id,name:o}}))}))}))}(t.locations))}),[t,n.scheduleEventId]);return c.a.createElement(d.C,{className:"edit-row"},c.a.createElement(d.g,{size:"3"},c.a.createElement(d.p,{className:"label"},"Position")),c.a.createElement(d.g,{size:"9"},c.a.createElement(d.F,{className:"select",interface:"popover",disabled:n.isReadonly,value:n.position.position.id,onIonChange:function(e){return function(e){if(e!==u.current&&e!==n.position.position.id){var r=Me(t.locations,e);a({type:"POSITION-UPDATED",selectedPosition:r})}}(e.detail.value)}},i.map((function(e){return c.a.createElement(d.G,{key:e.id,value:e.id},e.name)})))))},Xt={getEmployeesByLocationIdPositionIdAndActiveDateRange:function(){var e=Object(g.a)(h.a.mark((function e(t,n,a,r,o,c){var l;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l={locId:n,posId:a,start:Et(r),end:Et(o),sort:c},e.next=3,$.post(t,"api/v2/employees/at-position",l);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n,a,r,o,c){return e.apply(this,arguments)}}(),getEmployeeListForCommunication:function(){var e=Object(g.a)(h.a.mark((function e(t,n,a,r,o,c){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.post(t,"api/v2/employees/get-communication-list",{locId:n,depId:a,posId:r,channel:o,role:c});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n,a,r,o,c){return e.apply(this,arguments)}}()};function $t(e){var t=Object(o.useState)(!1),n=Object(p.a)(t,2),a=n[0],r=n[1],l=c.a.createElement(d.t,{isOpen:a,onDidDismiss:function(){return r(!1)},spinner:"dots",message:e,duration:1e4});return{showLoading:a,setShowLoading:r,showLoadingJsx:l}}var Zt,en=function(e){var t=e.auth,n=e.editorValues,a=e.update,r=Object(o.useState)([]),l=Object(p.a)(r,2),i=l[0],s=l[1],u=$t("Please wait..."),m=Object(o.useContext)(oe).user,E=Object(o.useRef)(null);Object(o.useEffect)((function(){m&&m.isLoggedin&&-1!==n.scheduleEventId&&(J("edit_event_get_employeeList",{user:m.username}),u.setShowLoading(!0),f(n))}),[m,n.position.position.id,n.scheduleEventId]);var f=function(e){Xt.getEmployeesByLocationIdPositionIdAndActiveDateRange(m,n.position.location.id,n.position.position.id,Object(We.a)(n.eventStart),Object(We.a)(n.eventEnd),n.position.location.settings.EmployeeSort).then((function(r){s(r);var o=r.map((function(e){return e.id}));if(0===n.scheduleEventId&&o.includes(t.employeeId)){E.current=t.employeeId;var c=r.filter((function(e){return e.id===t.employeeId}))[0];a({type:"EMPLOYEE-UPDATED",employee:{id:c.id,name:c.name}})}else{var l=o.includes(e.employee.id)?e.employee.id:-1;E.current=l,-1===l&&a({type:"EMPLOYEE-UPDATED",employee:{id:l,name:"SELECT EMPLOYEE"}})}u.setShowLoading(!1)}))};return 0===i.length?c.a.createElement(c.a.Fragment,null,c.a.createElement(d.C,{className:"edit-row"},c.a.createElement(d.g,{size:"3"},c.a.createElement(d.p,{className:"label"},"Employee")),c.a.createElement(d.g,{size:"9"},c.a.createElement(d.F,{className:"select",interface:"popover",value:-5},c.a.createElement(d.G,{key:"-5",value:"-5"},n.employee.name)))),u.showLoadingJsx):c.a.createElement(c.a.Fragment,null,c.a.createElement(d.C,{className:"edit-row"},c.a.createElement(d.g,{size:"3"},c.a.createElement(d.p,{className:"label"},"Employee")),c.a.createElement(d.g,{size:"9"},c.a.createElement(d.F,{className:"select",interface:"popover",disabled:n.isReadonly,value:n.employee.id,onIonChange:function(e){!function(e){if(-5!==e&&e!==n.employee.id&&e!==E.current){E.current=e;var t=i.filter((function(t){return t.id===e}))[0];a(-1===e?{type:"EMPLOYEE-UPDATED",employee:{id:-1,name:"SELECT EMPLOYEE"}}:{type:"EMPLOYEE-UPDATED",employee:{id:e,name:t.name}})}}(e.detail.value)}},c.a.createElement(d.G,{key:-1,value:-1},"Select Employee"),i.map((function(e){return c.a.createElement(d.G,{key:e.id,value:e.id},e.name)}))))),u.showLoadingJsx)},tn=function(e){var t=e.editorValues,n=e.update;return c.a.createElement(c.a.Fragment,null,c.a.createElement(d.C,{className:"edit-row"},c.a.createElement(d.g,{size:"3"},c.a.createElement(d.p,{className:"label"},"Start")),c.a.createElement(d.g,{size:"9"},c.a.createElement(d.i,{className:"select",displayFormat:"M/D/YY h:mma",disabled:t.isReadonly,pickerFormat:"MMM DD YYYY h:mm A",min:"2005-01-01",max:"2030-01-01",minuteValues:"0,5,10,15,20,25,30,35,40,45,50,55",value:t.eventStart,onIonChange:function(e){var a;(a=e.detail.value)&&Object(We.a)(a)!==Object(We.a)(t.eventStart)&&n({type:"START-UPDATED",eventStart:a})}}))),c.a.createElement(d.C,{className:"edit-row"},c.a.createElement(d.g,{size:"3"},c.a.createElement(d.p,{className:"label"},"End")),c.a.createElement(d.g,{size:"9"},c.a.createElement(d.i,{className:"select",displayFormat:"M/D/YY h:mma",disabled:t.isReadonly||t.isClockedIn,pickerFormat:"MMM DD YYYY h:mm A",min:"2005-01-01",max:"2030-01-01",minuteValues:"0,5,10,15,20,25,30,35,40,45,50,55",value:t.eventEnd,onIonChange:function(e){var a;(a=e.detail.value)&&Object(We.a)(a)!==Object(We.a)(t.eventEnd)&&n({type:"END-UPDATED",eventEnd:a})}}))))},nn=n(30),an=n(225),rn=n(226),on=n(227),cn=function(e,t,n){var a=e,r=t,o=!1;return n.map((function(e){var t=Object(an.a)(Object(We.a)(e.BreakStart),3),n=e.BreakEnd?Object(an.a)(Object(We.a)(e.BreakEnd),-3):new Date(2200,1,1);return a<n&&r>t&&(o=!0),o})),o},ln=function(e){var t=e.onCancel,n=e.onAdd,a=e.currentBreaks,r=e.eventStart,l=e.eventEnd,i=Object(o.useState)(Object(rn.a)(Object(on.a)(new Date,12),0)),s=Object(p.a)(i,2),u=s[0],m=s[1],E=Object(o.useState)(Object(rn.a)(Object(on.a)(new Date,13),0)),f=Object(p.a)(E,2),v=f[0],h=f[1],g=Object(o.useState)(!1),b=Object(p.a)(g,2),y=b[0],O=b[1],k=Object(o.useState)(!1),j=Object(p.a)(k,2),C=j[0],I=j[1],S=Object(o.useState)(""),T=Object(p.a)(S,2),N=T[0],D=T[1],x=Object(o.useState)(!0),A=Object(p.a)(x,2),w=A[0],M=A[1],R=ie();return c.a.createElement(c.a.Fragment,null,c.a.createElement(d.l,{mode:"ios"},c.a.createElement(d.R,null,c.a.createElement(d.O,null,"Add Break"))),c.a.createElement(d.h,null,c.a.createElement(d.k,null,c.a.createElement(d.C,null,c.a.createElement(d.g,{className:"label",size:"3"},"Start"),c.a.createElement(d.g,{size:"9"},c.a.createElement(d.i,{className:"select",displayFormat:"h:mm a",pickerFormat:"h:mm A",min:"2005-01-01",max:"2030-01-01",minuteValues:"0,5,10,15,20,25,30,35,40,45,50,55",value:u.toISOString(),onIonChange:function(e){return function(e){var t=Object(We.a)(e);m(t),Object(Ct.a)(t,v)?Object(We.a)(r)>t?(M(!1),D("Start before Event begins")):cn(t,v,a)?(M(!1),D("Pre-existing break overlaps")):(M(!0),D("")):(M(!1),D("Start must be before End"))}(e.detail.value)}}))),c.a.createElement(d.C,null,c.a.createElement(d.g,{className:"label",size:"3"},"End"),c.a.createElement(d.g,{size:"9"},c.a.createElement(d.i,{className:"select",displayFormat:"h:mm a",pickerFormat:"h:mm A",min:"2005-01-01",max:"2030-01-01",minuteValues:"0,5,10,15,20,25,30,35,40,45,50,55",value:v.toISOString(),onIonChange:function(e){return function(e){var t=Object(We.a)(e);h(t),Object(Qe.a)(t,u)?t>Object(We.a)(l)?(M(!1),D("End after Event ends")):cn(u,t,a)?(M(!1),D("Pre-existing break overlaps")):(M(!0),D("")):(M(!1),D("End must be after Start"))}(e.detail.value)}}))),c.a.createElement(d.C,null,c.a.createElement(d.g,{size:"3"},c.a.createElement(d.f,{className:"checkbox",checked:y,onIonChange:function(e){O(e.detail.checked)}})),c.a.createElement(d.g,{className:"label",size:"9"},"Restricted Break")),c.a.createElement(d.C,null,c.a.createElement(d.g,{size:"3"},c.a.createElement(d.f,{className:"checkbox",onIonChange:function(e){I(e.detail.checked)}})),c.a.createElement(d.g,{className:"label",size:"9"},"Paid Break")),c.a.createElement(d.C,null,c.a.createElement(d.g,{size:"12",className:"error-message"},N)))),c.a.createElement(d.j,null,c.a.createElement(d.d,{expand:"block",color:"secondary",onClick:function(){u>v?R.showAlert("Invalid Start / End","Break Start cannot come after Break End.",(function(){})):n(u,v,y,C)},disabled:!w},"ADD"),c.a.createElement(d.d,{expand:"block",onClick:t},"CANCEL")),R.alertBoxJsx)},sn=function(e){var t=e.editorValues,n=e.update,a=Object(o.useState)([]),r=Object(p.a)(a,2),l=r[0],i=r[1],s=Object(o.useState)(!1),u=Object(p.a)(s,2),m=u[0],f=u[1];Object(o.useEffect)((function(){-1!==t.scheduleEventId&&i(t.eventBreaks)}),[t.eventBreaks,t.scheduleEventId]);return t.eventType===fe.Clock||Te(t.eventType,t.eventStatus)?c.a.createElement(c.a.Fragment,null,c.a.createElement(d.C,{className:"edit-row"},c.a.createElement(d.g,{size:"3"},c.a.createElement(d.p,{className:"label"},"(B)reaks")),c.a.createElement(d.g,{size:"2"},c.a.createElement(d.d,{size:"small",color:"light",disabled:t.isReadonly,onClick:function(){f(!0)}},c.a.createElement(d.m,{slot:"icon-only",icon:E.a,color:"dark"})))),c.a.createElement(d.C,null,c.a.createElement(d.g,{size:"3"}),c.a.createElement(d.g,{size:"9"},l&&l.map((function(e){return c.a.createElement("div",{key:e.BreakStart,className:"break-div"},"(B) ",ut(e),e.IsPaidBreak?c.a.createElement(d.m,{className:"paid-icon",icon:E.q}):c.a.createElement("span",null),function(e){return e.IsRestricted?c.a.createElement(d.m,{className:"restricted-icon",icon:E.o}):c.a.createElement("span",null)}(e),c.a.createElement("button",{disabled:t.isReadonly,onClick:function(){!function(e){var t=l.filter((function(t){return t.BreakStart!==e}));i(t),n({type:"EVENTBREAKS-UPDATED",breaks:t})}(e.BreakStart)}},c.a.createElement(d.m,{slot:"icon-only",mode:"ios",icon:E.y,color:"gray"})))})))),c.a.createElement(d.C,null,c.a.createElement(d.g,{size:"12"},c.a.createElement("div",{style:{borderBottom:"1px solid #ddd",width:"100%"}}))),c.a.createElement(d.x,{isOpen:m,cssClass:"mini-modal add-break-modal",onDidDismiss:function(){return f(!1)}},c.a.createElement(ln,{onCancel:function(){f(!1)},onAdd:function(e,a,r,o){f(!1);var c={BreakStart:Et(e),BreakEnd:Et(a),IsRestricted:r,IsPaidBreak:o,ScheduleEventId:t.scheduleEventId},s=[].concat(Object(nn.a)(l),[c]);i(s),n({type:"EVENTBREAKS-UPDATED",breaks:s})},currentBreaks:l,eventStart:t.eventStart,eventEnd:t.eventEnd}))):c.a.createElement("div",null)},un=function(e){var t=e.auth,n=e.editorValues,a=e.update,r=Object(o.useState)(-1),l=Object(p.a)(r,2),i=l[0],s=l[1],u=Object(o.useState)([]),m=Object(p.a)(u,2),E=m[0],f=m[1];Object(o.useEffect)((function(){if(-1!==n.scheduleEventId&&t&&t.locations&&t.locations.length>0){var e=t.tags.filter((function(e){return e.positionIds.includes(n.position.position.id)})).map((function(e){return{id:e.id,name:e.name}}));f(e);var a=e.map((function(e){return e.id}));a.includes(i)||(n.tag&&n.tag.id&&a.includes(n.tag.id)?s(n.tag.id):s(-1))}}),[t,n.position,n.scheduleEventId]);return c.a.createElement(d.C,{className:"edit-row"},c.a.createElement(d.g,{size:"3"},c.a.createElement(d.p,{className:"label"},"~Tag")),c.a.createElement(d.g,{size:"9"},c.a.createElement(d.F,{className:"select",interface:"popover",disabled:n.isReadonly,value:i,onIonChange:function(e){!function(e){if(s(e),e!==n.tag.id)if(-1===e)a({type:"TAG-UPDATED",tag:{id:-1,name:"NONE"}});else{var t=E.filter((function(t){return t.id===e}))[0];a({type:"TAG-UPDATED",tag:t})}}(e.detail.value)}},c.a.createElement(d.G,{value:-1},"NONE"),E.map((function(e){return c.a.createElement(d.G,{key:e.id,value:e.id},e.name)})))))},dn=function(e){var t=e.auth,n=e.editorValues,a=e.update,r=Object(o.useState)(!1),l=Object(p.a)(r,2),i=l[0],s=l[1],u=Object(o.useState)(!1),m=Object(p.a)(u,2),f=m[0],v=m[1];Object(o.useEffect)((function(){-1!==n.scheduleEventId&&t&&t.locations&&t.locations.length>0&&s(n.isConfirmed)}),[t,n.eventStart,n.eventEnd,n.isClockedIn,n.scheduleEventId]),Object(o.useEffect)((function(){if(-1!==n.scheduleEventId){var e=n.eventType===fe.Shift&&n.eventStatus===ve.Approved||n.eventType===fe.Cover&&(n.eventStatus===ve.Request||n.eventStatus===ve.RequestDenied);v(e)}}),[n.eventType,n.eventStatus,n.scheduleEventId]);return f?c.a.createElement(c.a.Fragment,null,c.a.createElement(d.g,{size:"3"},c.a.createElement(d.p,{className:"label"},"Confirm")),c.a.createElement(d.g,{size:"3"},c.a.createElement(d.f,{checked:i,onIonChange:function(e){var t;(t=e.detail.checked)!==i&&f&&(s(t),a({type:"CONFIRM-UPDATED",isConfirmed:t}))}}),c.a.createElement(d.m,{className:"icon-right-of-checkbox",icon:E.m}))):c.a.createElement(c.a.Fragment,null)},mn=function(e){var t=e.auth,n=e.editorValues,a=e.update,r=Object(o.useState)(!1),l=Object(p.a)(r,2),i=l[0],s=l[1],u=Object(o.useState)(!1),m=Object(p.a)(u,2),f=m[0],v=m[1];Object(o.useEffect)((function(){-1!==n.scheduleEventId&&t&&t.locations&&t.locations.length>0&&s(n.isClockedIn)}),[t,n.eventStart,n.eventEnd,n.isClockedIn,n.scheduleEventId]),Object(o.useEffect)((function(){-1!==n.scheduleEventId&&v(n.eventType===fe.Clock)}),[n.eventType,n.eventStatus,n.scheduleEventId]);return f?c.a.createElement(c.a.Fragment,null,c.a.createElement(d.g,{size:"3"},c.a.createElement(d.p,{className:"label"},"Clocked In")),c.a.createElement(d.g,{size:"3"},c.a.createElement(d.f,{checked:i,onIonChange:function(e){var t;(t=e.detail.checked)!==i&&f&&(s(t),a({type:"ISCLOCKEDIN-UPDATED",isClockedIn:t}))}}),c.a.createElement(d.m,{className:"icon-right-of-checkbox",icon:E.w}))):c.a.createElement(c.a.Fragment,null)},pn=n(228);!function(e){e[e.Daily=0]="Daily",e[e.Weekly=1]="Weekly",e[e.MonthlyByDayOfMonth=2]="MonthlyByDayOfMonth",e[e.MonthlyByDayOfWeek=3]="MonthlyByDayOfWeek",e[e.Yearly=4]="Yearly"}(Zt||(Zt={}));var En=function(e,t){return e.locations.filter((function(e){return e.id===t}))[0]},fn=function(e,t){return e.locations.flatMap((function(e){return e.departments.flatMap((function(e){return e.positions.filter((function(e){return e.id===t}))}))}))[0]},vn=function(e,t){var n=Object(We.a)(e),a=Object(We.a)(t);return!!Object(pn.a)(n,a)||Object(Qe.a)(a,n)};function hn(e,t){return Object(f.a)({},On,{eventStatus:t.EventStatusId,eventType:t.EventTypeId,eventStart:t.EventStart,eventEnd:t.EventEnd,notes:t.Notes,isClockedIn:t.IsClockedIn,isConfirmed:t.IsConfirmed,scheduleEventId:t.ScheduleEventId,position:we(e.locations,t.LocationId,t.PositionId),employee:{id:t.EmployeeId,name:t.FirstName+" "+t.LastName},eventBreaks:t.EventBreaks})}var gn,bn=function(e,t,n){if(!n)return!0;if(!t.ClockOutValueLabel||0===t.ClockOutValueLabel.length)return!1;return/^\d*(\.\d{0,2})?$/.test(n)},yn=function(e){return e.validEventStartEnd&&e.validEmployee&&e.validTag&&e.validEventTypeStatus&&e.validClockoutValue&&e.validRecurrenceStartEnd&&e.validRepeatInterval&&e.validRepeatWeekdays},On={scheduleEventId:-1,locationId:0,isUpdating:!1,eventType:fe.Shift,eventStatus:ve.Approved,isConfirmed:!1,position:{location:{},position:{}},employee:{id:-1,name:"SELECT EMPLOYEE"},eventStart:Et(Object(on.a)(Object(rn.a)(new Date,0),8)),eventEnd:Et(Object(on.a)(Object(rn.a)(new Date,0),17)),tag:{id:-1,name:"SELECT TAG"},eventBreaks:[],isClockedIn:!1,isDirty:!1,valid:!0,validEventStartEnd:!0,validEmployee:!0,validTag:!0,validEventTypeStatus:!0,validClockoutValue:!0,validRecurrenceStartEnd:!0,validRepeatInterval:!0,validRepeatWeekdays:!0,absentId:void 0,absentName:void 0,absentTimeMinutes:null,notes:"",clockoutValue:void 0,isReadonly:!1},kn=function(e,t){switch(console.log("REDUCER: ACTION =",t.type,"   Current State Emp =",e.employee.id),t.type){case"BEGIN-UPDATE":var n=t.ev,a=t.auth,r=function(e){return Object(We.a)(e.EventEnd)>new Date(2199,1,1)}(n);return{scheduleEventId:n.ScheduleEventId,locationId:n.LocationId,isUpdating:!1,eventType:n.EventTypeId,eventStatus:n.EventStatusId,isConfirmed:void 0!==n.ConfirmedBy&&null!==n.ConfirmedBy,position:{location:En(a,n.LocationId),position:fn(a,n.PositionId)},employee:{id:n.EmployeeId,name:n.FirstName+" "+n.LastName},eventStart:n.EventStart,eventEnd:r?Et(new Date):n.EventEnd,tag:{id:n.TagId?n.TagId:-1,name:""},eventBreaks:n.EventBreaks,isClockedIn:r,isDirty:!1,valid:!0,validEventStartEnd:!0,validEmployee:!0,validTag:!0,validEventTypeStatus:!0,validClockoutValue:!0,absentName:n.AbsentName,absentId:n.AbsentId,absentTimeMinutes:n.AbsentTimeMinutes?n.AbsentTimeMinutes:null,notes:n.Notes,clockoutValue:n.ClockOutValue,isReadonly:t.eventEditAuth.isReadonly,recurrenceId:n.EventRecurrenceId,recurrenceStart:n.EventRecurrenceStart,recurrenceEnd:n.EventRecurrenceEnd,recurrenceType:n.RepeatType,repeatInterval:n.RepeatInterval,repeatWeekdays:n.RepeatWeekdays,validRecurrenceStartEnd:!0,validRepeatInterval:!0,validRepeatWeekdays:!0};case"CANCEL":return On;case"POSITION-UPDATED":var o=t.selectedPosition;return Object(f.a)({},e,{position:o,isDirty:!0});case"CREATE-EVENT":var c=t.auth.locations[0];return Object(f.a)({},On,{position:{location:c,position:c.departments[0].positions[0]},scheduleEventId:0,isDirty:!0});case"SET-READONLY":return Object(f.a)({},e,{isReadonly:t.isReadonly});case"TYPESTATUS-UPDATED":var l=e.isClockedIn&&t.eventType===fe.Clock&&t.eventStatus===ve.Approved,i=Object(f.a)({},e,{eventType:t.eventType,eventStatus:t.eventStatus,absentId:t.absentId,absentTimeMinutes:t.absentTimeMinutes,isClockedIn:l,isDirty:!0,validEventTypeStatus:!(t.absentId&&null===t.absentTimeMinutes)});return i.valid=yn(i),i;case"CLOCKOUTVALUE-UPDATED":var s=Object(f.a)({},e,{clockoutValue:t.clockoutValue,validClockoutValue:bn(0,t.locSettings,t.clockoutValue),isDirty:!0});return s.valid=yn(s),s;case"EMPLOYEE-UPDATED":var u=Object(f.a)({},e,{employee:t.employee,isDirty:!0,validEmployee:t.employee.id>0});return u.valid=yn(u),u;case"START-UPDATED":var d=Object(f.a)({},e,{eventStart:t.eventStart,isDirty:!0,validEventStartEnd:vn(t.eventStart,e.eventEnd)});return d.valid=yn(d),d;case"END-UPDATED":var m=Object(f.a)({},e,{eventEnd:t.eventEnd,isDirty:!0,validEventStartEnd:vn(e.eventStart,t.eventEnd)});return m.valid=yn(m),m;case"EVENTBREAKS-UPDATED":return Object(f.a)({},e,{eventBreaks:t.breaks,isDirty:!0});case"TAG-UPDATED":var p=Object(f.a)({},e,{tag:t.tag,isDirty:!0,validTag:!0});return p.valid=yn(p),p;case"CONFIRM-UPDATED":var E=Object(f.a)({},e,{isConfirmed:t.isConfirmed,isDirty:!0});return E.valid=yn(E),E;case"NOTES-UPDATED":return Object(f.a)({},e,{notes:t.notes,isDirty:!0});case"ISCLOCKEDIN-UPDATED":var v=Object(f.a)({},e,{isClockedIn:t.isClockedIn,isDirty:!0});if(t.isClockedIn){var h=Et(new Date);v.eventEnd=h}return v.valid=yn(v),v;case"REPEATING-UPDATED":var g=Object(f.a)({},e,{recurrenceStart:t.recurrenceStart,recurrenceEnd:t.recurrenceEnd,recurrenceType:t.recurrenceType,repeatInterval:t.repeatInterval,repeatWeekdays:t.repeatWeekDays,isDirty:!0});return g.recurrenceStart&&(g.repeatInterval===Zt.Weekly?g.validRepeatWeekdays=null!==g.repeatWeekdays&&void 0!==g.repeatWeekdays&&g.repeatWeekdays.length>0:(g.repeatWeekdays=void 0,g.validRepeatWeekdays=!0),g.recurrenceEnd?g.validRecurrenceStartEnd=Object(Ct.a)(Object(We.a)(g.recurrenceStart),Object(We.a)(g.recurrenceEnd)):g.validRecurrenceStartEnd=!1,g.validRepeatInterval=null!==g.repeatInterval&&void 0!==g.repeatInterval&&g.repeatInterval>0),g.valid=yn(g),g;default:return console.error("ERROR in editorValueReducer, could not find action for "+t.type),e}},jn=function(e){var t=e.editorValues,n=e.update;return c.a.createElement(d.C,{className:"edit-row"},c.a.createElement(d.g,{size:"3"},c.a.createElement(d.p,{className:"label"},"Notes")),c.a.createElement(d.g,{size:"9"},c.a.createElement(d.N,{className:"textarea",maxlength:200,rows:4,value:t.notes,disabled:t.isReadonly,onIonChange:function(e){return(a=e.detail.value)||(a=""),void(a!==t.notes&&n({type:"NOTES-UPDATED",notes:a}));var a}})))},Cn=function(e){var t=e.auth,n=e.editorValues,a=e.update,r=Object(o.useState)(!1),l=Object(p.a)(r,2),i=l[0],s=l[1],u=Object(o.useState)(null),m=Object(p.a)(u,2),E=m[0],f=m[1];Object(o.useEffect)((function(){if(!(0===n.locationId||E&&n.locationId===E.LocationId)&&t&&t.locations&&0!==t.locations.length&&n.locationId){var e=ge(t,n.locationId);f(e)}}),[n.locationId,t]),Object(o.useEffect)((function(){E&&s(void 0!==E.ClockOutValueLabel&&null!==E.ClockOutValueLabel&&E.ClockOutValueLabel.length>0&&n.eventType===fe.Clock&&!n.isClockedIn)}),[n.eventType,n.isClockedIn,E]);return i&&null!==E?c.a.createElement(d.C,{className:"edit-row"},c.a.createElement(d.g,{size:"3"},c.a.createElement(d.p,{className:"label"},E.ClockOutValueLabel)),c.a.createElement(d.g,{size:"9"},c.a.createElement(d.n,{className:"input-textbox",value:n.clockoutValue,onIonChange:function(e){return null===(t=e.detail.value)&&(t=void 0),void(t!==n.clockoutValue&&a({type:"CLOCKOUTVALUE-UPDATED",locSettings:E,clockoutValue:t}));var t}}))):c.a.createElement("div",null)},In={undoCoverRequest:function(){var e=Object(g.a)(h.a.mark((function e(t,n){var a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="api/v1/employee/schedule-events/cover-request/undo?scheduleEventId=".concat(n),e.next=3,$.put(t,a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),createCoverRequest:function(){var e=Object(g.a)(h.a.mark((function e(t,n,a,r,o,c,l){var i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v1/employee/schedule-events/cover-request/submit",i={ScheduleEventId:n,LocationId:a,BusinessId:r,BroadcastCoverRequestMessage:o,CoverMessage:c,DirectToEmployeeId:l},e.next=4,$.put(t,"api/v1/employee/schedule-events/cover-request/submit",i);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n,a,r,o,c,l){return e.apply(this,arguments)}}(),makeShiftRequest:function(){var e=Object(g.a)(h.a.mark((function e(t,n,a,r,o,c){var l;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v2/requests/shift-request/submit",l={ScheduleEventId:n,LocationId:a,BusinessId:r,BroadcastCoverRequestMessage:o,CoverMessage:c},e.next=4,$.put(t,"api/v2/requests/shift-request/submit",l);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n,a,r,o,c){return e.apply(this,arguments)}}(),removeShiftRequest:function(){var e=Object(g.a)(h.a.mark((function e(t,n,a,r,o,c){var l;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v1/employee/schedule-events/delete",l={LocationId:n,ScheduleEventId:a,EventTypeId:r,EventStatusId:o,RecUpdateType:c},e.next=4,$.post(t,"api/v1/employee/schedule-events/delete",l);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n,a,r,o,c){return e.apply(this,arguments)}}(),deleteEvent:function(){var e=Object(g.a)(h.a.mark((function e(t,n,a,r,o,c){var l;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v1/employee/schedule-events/delete",l={LocationId:n,ScheduleEventId:a,EventTypeId:r,EventStatusId:o,RecUpdateType:c},e.next=4,$.post(t,"api/v1/employee/schedule-events/delete",l);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n,a,r,o,c){return e.apply(this,arguments)}}(),getCoverRequestListItems:function(){var e=Object(g.a)(h.a.mark((function e(t,n,a){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v2/requests/transfers/to-list",r={scheduleEventId:n,directCoverList:a},e.next=4,$.post(t,"api/v2/requests/transfers/to-list",r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}()},Sn=function(e){var t=e.onCancel,n=e.onOk,a=e.eventEditAuth,r=e.locSettings,l=e.scheduleEventId,i=Object(o.useContext)(oe).user,s=Object(o.useState)(""),u=Object(p.a)(s,2),m=u[0],E=u[1],f=Object(o.useState)(null),v=Object(p.a)(f,2),h=v[0],g=v[1],b=Object(o.useState)(null),y=Object(p.a)(b,2),O=y[0],k=y[1];Object(o.useEffect)((function(){a.usage===bt.CreateCoverRequest&&l>0&&In.getCoverRequestListItems(i,l,!0).then((function(e){k(e),e&&e.length>0&&g(e[0].value)}))}),[l,a.usage]);return a.usage===bt.None?c.a.createElement("div",null):c.a.createElement(c.a.Fragment,null,c.a.createElement(d.h,null,c.a.createElement(d.l,{mode:"ios"},c.a.createElement(d.R,null,c.a.createElement(d.O,null,a.buttonText))),c.a.createElement(d.k,null,c.a.createElement(d.C,{hidden:!r.EnableDirectCoverRequest||a.usage!==bt.CreateCoverRequest},c.a.createElement(d.g,{className:"label",size:"3"},"To"),c.a.createElement(d.g,{size:"9"},c.a.createElement(d.F,{className:"select",value:h,onIonChange:function(e){g(parseInt(e.detail.value))}},O&&O.map((function(e){return c.a.createElement(d.G,{key:e.value,value:e.value,disabled:e.disabled},e.text)}))))),c.a.createElement(d.C,{hidden:a.usage===bt.CreateCoverRequest},c.a.createElement(d.g,{size:"12"},c.a.createElement("div",{className:"usage-message"},a.text))),c.a.createElement(d.C,{hidden:a.usage!==bt.CreateCoverRequest},c.a.createElement(d.g,{className:"label",size:"3"},"Notes"),c.a.createElement(d.g,{size:"9"},c.a.createElement(d.N,{className:"select",maxlength:200,rows:4,value:m,onIonChange:function(e){E(e.detail.value)}}))),c.a.createElement(d.C,null,c.a.createElement(d.g,{className:"label",size:"3"}),c.a.createElement(d.g,{size:"9",className:"error-message"},c.a.createElement("div",null))))),c.a.createElement(d.j,null,c.a.createElement(d.d,{expand:"block",color:"secondary",onClick:function(){n(h,null!==m&&void 0!==m?m:"",!1)}},"OK"),c.a.createElement(d.d,{expand:"block",onClick:t},"CANCEL")))},Tn=function(e){var t=e.auth,n=e.cancelEditModal,a=e.eventType,r=e.eventStatus,l=e.scheduleEventId,i=e.locationId,s=e.eventEditAuth,u=Object(o.useContext)(oe).user,m=Object(o.useState)(!1),E=Object(p.a)(m,2),f=E[0],v=E[1],h=ie(),g=function(e){v(!1),n(e)};return!s||!t||!t.locations||0===t.locations.length||s.usage===bt.None||l<=0?c.a.createElement("div",null):c.a.createElement(c.a.Fragment,null,c.a.createElement(d.d,{className:"apply-button",expand:"block",onClick:function(){v(!0)}},s.buttonText),c.a.createElement(d.x,{isOpen:f,cssClass:"mini-modal event-request-modal",onDidDismiss:function(){return v(!1)}},c.a.createElement(Sn,{onCancel:function(){v(!1)},onOk:function(e,t,n){switch(s.usage){case bt.CreateCoverRequest:In.createCoverRequest(u,l,i,0,n,t,e).then((function(){g("Cover-Request Created")}));break;case bt.CreateShiftRequest:In.makeShiftRequest(u,l,i,0,n,t).then((function(e){e.error?h.showAlert("Shift-Request Failed",e.message,(function(){})):g(e.message)}));break;case bt.DeleteShiftRequest:In.removeShiftRequest(u,i,l,a,r,void 0).then((function(){g("Shift-Request Removed")}));break;case bt.UndoCoverRequest:In.undoCoverRequest(u,l).then((function(){g("Removed Cover-Request")}));break;case bt.Delete:In.deleteEvent(u,i,l,a,r,void 0).then((function(){g("Deleted")}))}},auth:t,eventEditAuth:s,scheduleEventId:l,locSettings:ge(t,i)}),h.alertBoxJsx))},Nn=n(229),Dn=function(e){var t=e.locSettings,n=e.editorValues,a=e.update,r=Object(o.useState)([!1,!1,!1,!1,!1,!1,!1]),l=Object(p.a)(r,2),i=l[0],s=l[1];if(Object(o.useEffect)((function(){if(n.repeatWeekdays){for(var e=[!1,!1,!1,!1,!1,!1,!1],t=0;t<n.repeatWeekdays.length;t++)e[parseInt(n.repeatWeekdays[t])]=!0;s(e)}else s([!1,!1,!1,!1,!1,!1,!1])}),[n.repeatWeekdays]),null===t)return c.a.createElement("div",null);var u=pt(new Date,t.DayWeekStartsOn,t.DayStartTime);return c.a.createElement("div",{className:"weeklist-container"},[0,1,2,3,4,5,6].map((function(e){var t=Object(Ke.a)(u,e),r=Object(Nn.a)(t);return c.a.createElement("span",{key:e,className:"day"},c.a.createElement(d.f,{className:"day-checkbox",disabled:n.isReadonly,onClick:function(){return function(e){var t=i.slice();t[e]=!i[e],s(t);for(var r="",o=0;o<t.length;o++)t[o]&&(r+=o);a({type:"REPEATING-UPDATED",repeatWeekDays:r,repeatInterval:n.repeatInterval,recurrenceType:n.recurrenceType,recurrenceEnd:n.recurrenceEnd,recurrenceStart:n.recurrenceStart})}(r)},checked:i[r]}),c.a.createElement("span",{className:"day-abbr"},Object(Ye.a)(t,"EE").substr(0,2)))})))},xn=function(e){var t=e.auth,n=e.editorValues,a=e.update,r=Object(o.useState)(null),l=Object(p.a)(r,2),i=l[0],s=l[1],u=Object(o.useState)(!1),m=Object(p.a)(u,2),f=m[0],v=m[1],h=Object(o.useState)(!1),g=Object(p.a)(h,2),b=g[0],y=g[1];return Object(o.useEffect)((function(){-1!==n.scheduleEventId&&(n.locationId>0?s(ge(t,n.locationId)):0===n.locationId&&s(t.locations[0].settings))}),[n.locationId,n.scheduleEventId]),Object(o.useEffect)((function(){-1!==n.scheduleEventId&&v(n.eventType===fe.Shift||n.eventType===fe.Unavailable)}),[n.eventType,n.scheduleEventId]),Object(o.useEffect)((function(){f&&-1!==n.scheduleEventId&&n.recurrenceStart&&y(!0)}),[b,f,n.recurrenceStart,n.scheduleEventId]),f?c.a.createElement(c.a.Fragment,null,c.a.createElement(d.C,null,c.a.createElement(d.g,{size:"3"},c.a.createElement(d.p,{className:"label"},"(R)epeats")),c.a.createElement(d.g,{size:"2"},c.a.createElement(d.f,{checked:b,onClick:function(){a(b?{type:"REPEATING-UPDATED",repeatWeekDays:void 0,repeatInterval:void 0,recurrenceType:void 0,recurrenceEnd:void 0,recurrenceStart:void 0}:{type:"REPEATING-UPDATED",repeatWeekDays:void 0,repeatInterval:1,recurrenceType:Zt.Weekly,recurrenceEnd:void 0,recurrenceStart:Et(new Date)}),y(!b)},disabled:n.isReadonly}))),b&&c.a.createElement(c.a.Fragment,null,c.a.createElement(d.C,{className:"edit-row"},c.a.createElement(d.g,{size:"1"},c.a.createElement(d.m,{icon:E.i,mode:"md"})),c.a.createElement(d.g,{size:"5"},c.a.createElement(d.i,{value:n.recurrenceStart,className:"select",displayFormat:"M/D/YY",pickerFormat:"MMM DD YYYY",disabled:n.isReadonly,min:"2005-01-01",max:"2030-01-01",onIonChange:function(e){var t;t=e.detail.value,a(t?{type:"REPEATING-UPDATED",repeatWeekDays:n.repeatWeekdays,repeatInterval:n.repeatInterval,recurrenceType:n.recurrenceType,recurrenceEnd:n.recurrenceEnd,recurrenceStart:t}:{type:"REPEATING-UPDATED",repeatWeekDays:n.repeatWeekdays,repeatInterval:n.repeatInterval,recurrenceType:n.recurrenceType,recurrenceEnd:n.recurrenceEnd,recurrenceStart:void 0})}})),c.a.createElement(d.g,{size:"1"},c.a.createElement(d.m,{icon:E.i,mode:"md",style:{textAlign:"right"}})),c.a.createElement(d.g,{size:"5"},c.a.createElement(d.i,{value:n.recurrenceEnd,className:"select",displayFormat:"M/D/YY",pickerFormat:"MMM DD YYYY",disabled:n.isReadonly,min:"2005-01-01",max:"2030-01-01",onIonChange:function(e){var t;t=e.detail.value,a(t?{type:"REPEATING-UPDATED",repeatWeekDays:n.repeatWeekdays,repeatInterval:n.repeatInterval,recurrenceType:n.recurrenceType,recurrenceEnd:t,recurrenceStart:n.recurrenceStart}:{type:"REPEATING-UPDATED",repeatWeekDays:n.repeatWeekdays,repeatInterval:n.repeatInterval,recurrenceType:n.recurrenceType,recurrenceEnd:void 0,recurrenceStart:n.recurrenceStart})}}))),c.a.createElement(d.C,{className:"edit-row"},c.a.createElement(d.g,{size:"1"},c.a.createElement(d.m,{icon:E.u,mode:"md"})),c.a.createElement(d.g,{size:"5"},c.a.createElement(d.F,{className:"select",value:n.recurrenceType,disabled:n.isReadonly,onIonChange:function(e){var t;t=e.detail.value,a(t?{type:"REPEATING-UPDATED",repeatWeekDays:n.repeatWeekdays,repeatInterval:n.repeatInterval,recurrenceType:parseInt(t),recurrenceEnd:n.recurrenceEnd,recurrenceStart:n.recurrenceStart}:{type:"REPEATING-UPDATED",repeatWeekDays:n.repeatWeekdays,repeatInterval:n.repeatInterval,recurrenceType:void 0,recurrenceEnd:n.recurrenceEnd,recurrenceStart:n.recurrenceStart})}},c.a.createElement(d.G,{value:Zt.Weekly},"Weekly"),c.a.createElement(d.G,{value:Zt.MonthlyByDayOfMonth},"Monthly (Day of Month)"),c.a.createElement(d.G,{value:Zt.MonthlyByDayOfWeek},"Monthly (Day of Week)"))),c.a.createElement(d.g,{size:"1"},"#"),c.a.createElement(d.g,{size:"5"},c.a.createElement(d.n,{className:"input-textbox",disabled:n.isReadonly,value:n.repeatInterval?n.repeatInterval.toString():void 0,onIonChange:function(e){return t=e.detail.value,void a(t?{type:"REPEATING-UPDATED",repeatWeekDays:n.repeatWeekdays,repeatInterval:parseInt(t),recurrenceType:n.recurrenceType,recurrenceEnd:n.recurrenceEnd,recurrenceStart:n.recurrenceStart}:{type:"REPEATING-UPDATED",repeatWeekDays:n.repeatWeekdays,repeatInterval:void 0,recurrenceType:n.recurrenceType,recurrenceEnd:n.recurrenceEnd,recurrenceStart:n.recurrenceStart});var t}}))),c.a.createElement(d.C,null,c.a.createElement(d.g,{size:"12"},c.a.createElement(Dn,{locSettings:i,editorValues:n,update:a}))))):c.a.createElement("span",null)};!function(e){e[e.UpdateSingleEvent=0]="UpdateSingleEvent",e[e.UpdateEntireSeries=1]="UpdateEntireSeries",e[e.UpdateSeriesForward=2]="UpdateSeriesForward"}(gn||(gn={}));var An=function(e){var t=e.onSelect,n=e.updateType;if("NO"===n)return c.a.createElement("div",null);var a=function(e){t(e)},r="UPDATE"===n?"Update Repeating":"Delete Repeating";return c.a.createElement(c.a.Fragment,null,c.a.createElement(d.l,{mode:"ios"},c.a.createElement(d.R,null,c.a.createElement(d.O,null,r))),c.a.createElement(d.h,null,c.a.createElement(d.k,null,c.a.createElement(d.C,null,c.a.createElement(d.g,{size:"12"},c.a.createElement(d.d,{expand:"block",color:"danger",className:"apply-button",onClick:function(){return a(gn.UpdateSingleEvent)}},"This event"))),c.a.createElement(d.C,null,c.a.createElement(d.g,{size:"12"},c.a.createElement(d.d,{expand:"block",color:"danger",className:"apply-button",onClick:function(){return a(gn.UpdateEntireSeries)}},"Entire series"))),c.a.createElement(d.C,null,c.a.createElement(d.g,{size:"12"},c.a.createElement(d.d,{expand:"block",color:"danger",className:"apply-button",onClick:function(){return a(gn.UpdateSeriesForward)}},"This event forward"))))),c.a.createElement(d.j,null,c.a.createElement(d.d,{expand:"block",className:"cancel-button",onClick:function(){return a(null)}},"Cancel")))};var wn=function(e){var t=e.auth,n=e.scheduleEventId,a=e.onDismissModal,r=e.onCancelModal,l=e.isOpen,i=e.eventEditAuth,s=e.initialEvent,u=$t("Please wait..."),m=ie(),f=c.a.useContext(oe).user,v=Object(o.useReducer)(kn,s),h=Object(p.a)(v,2),g=h[0],b=h[1],y=Object(o.useState)(null),O=Object(p.a)(y,2),k=O[0],j=O[1],C=Object(o.useState)(null),I=Object(p.a)(C,2),S=I[0],T=I[1],N=Object(o.useState)("NO"),D=Object(p.a)(N,2),x=D[0],A=D[1],w=Object(o.useState)("NONE"),M=Object(p.a)(w,2),R=M[0],P=M[1],U=null!==n,L=At(),F="New Event",B="CREATE";U&&(F="Edit Event",B="UPDATE"),Object(o.useEffect)((function(){l&&t&&t.locations&&0!==t.locations.length&&(!n||null!==k&&n===k.ScheduleEventId?(null!==k&&j(null),b({type:"CREATE-EVENT",auth:t})):(u.setShowLoading(!0),J("edit_event_get_scheduleevent",{user:f.username,scheduleEventId:n}),yt.getScheduleEvent(f,n).then((function(e){u.setShowLoading(!1),e?(!function(e){if(e.EventStart=ct(e.EventStart),e.EventEnd=ct(e.EventEnd),e.EventBreaks)for(var t=0;t<e.EventBreaks.length;t++)e.EventBreaks[t].BreakStart=ct(e.EventBreaks[t].BreakStart),e.EventBreaks[t].BreakEnd&&ct(e.EventBreaks[t].BreakEnd)}(e),j(e),b({type:"BEGIN-UPDATE",ev:e,auth:t,eventEditAuth:i})):m.showAlert("No Event","The event may have been removed or you no longer have access",q)}))))}),[n,f,l,t]),Object(o.useEffect)((function(){null!==S&&"NONE"!==R&&("CREATEUPDATE"===R?z():V(null!==g.recurrenceId&&void 0!==g.recurrenceId))}),[S,R]);var z=function(){var e=0===g.scheduleEventId?yt.createScheduleEvent:yt.updateScheduleEvent,t=0===g.scheduleEventId?"edit_event_create":"edit_event_update";e(f,g,S).then((function(e){e.error?m.showAlert("Cannot update",e.message,(function(){a("Could not update event")})):(J(t,{user:f.username,scheduleEventId:n}),a("Event Updated"))}))},V=function(e){var t=function(){yt.deleteScheduleEvent(f,g.scheduleEventId,S).then((function(e){e.error?m.showAlert("Cannot delete",e.message,(function(){a("Could not delete event")})):(J("edit_event_delete",{user:f.username,scheduleEventId:n}),a("Deleted Event"))}))};e?t():L.showDialog("Delete event?","",[{text:"Delete",color:"danger",value:1}],(function(e){1===e&&t()}))},_=function(e){A("NO"),T(e),null===e&&P("NONE")},q=function(){b({type:"CANCEL"}),Object(ee.a)().push("/tabs/schedule"),r()};return l&&t&&t.locations&&0!==t.locations.length?c.a.createElement(c.a.Fragment,null,c.a.createElement(d.l,{className:"ion-no-border"},c.a.createElement(d.R,null,c.a.createElement(d.e,{slot:"start"},c.a.createElement(d.d,{onClick:q},c.a.createElement(d.m,{icon:E.c,mode:"md",slot:"icon-only"}))),c.a.createElement(d.O,null,F))),c.a.createElement(d.h,{class:"outer-content"},c.a.createElement(d.k,null,c.a.createElement(Kt,{editorValues:g,update:b,auth:t,eventTypes:i.eventTypeOptionList,eventStatuses:i.eventStatusOptionList}),c.a.createElement(d.C,{className:"edit-row"},c.a.createElement(dn,{auth:t,editorValues:g,update:b}),c.a.createElement(mn,{auth:t,editorValues:g,update:b})),c.a.createElement(d.C,{className:"edit-row"},c.a.createElement(d.g,{size:"12"},c.a.createElement("div",{style:{width:"100%",borderBottom:"1px solid #ddd"}}))),c.a.createElement(Qt,{auth:t,editorValues:g,update:b}),c.a.createElement(en,{auth:t,editorValues:g,update:b}),c.a.createElement(tn,{auth:t,editorValues:g,update:b}),c.a.createElement(xn,{auth:t,editorValues:g,update:b}),c.a.createElement(d.C,{className:"edit-row"},c.a.createElement(d.g,{size:"12"},c.a.createElement("div",{style:{width:"100%",borderBottom:"1px solid #ddd"}}))),c.a.createElement(sn,{auth:t,editorValues:g,update:b}),c.a.createElement(un,{auth:t,editorValues:g,update:b}),c.a.createElement(Cn,{auth:t,editorValues:g,update:b}),c.a.createElement(jn,{auth:t,editorValues:g,update:b})),m.alertBoxJsx,L.dialogBoxJsx,u.showLoadingJsx,c.a.createElement(d.x,{isOpen:"NO"!==x,onDidDismiss:function(){_(null)},cssClass:"mini-modal recurrence-update-modal"},c.a.createElement(An,{onSelect:_,updateType:x}))),c.a.createElement(d.j,null,c.a.createElement(Tn,{auth:t,eventType:g.eventType,eventEnd:g.eventEnd,eventStatus:g.eventStatus,eventEmployeeId:g.employee.id,eventPositionId:g.position.position.id,scheduleEventId:g.scheduleEventId,locationId:g.locationId,eventEditAuth:i,update:b,cancelEditModal:function(e){return a(e)},setUsageText:function(){}}),c.a.createElement(d.d,{className:"apply-button",expand:"block",onClick:function(){P("CREATEUPDATE"),g.recurrenceId?null!==S?z():A("UPDATE"):z()},disabled:!g.isDirty||!g.valid,hidden:g.isReadonly},B),c.a.createElement(d.d,{className:"delete-button",expand:"block",onClick:function(){P("DELETE"),g.recurrenceId?null!==S?V(!0):A("DELETE"):V(null!==g.recurrenceId&&void 0!==g.recurrenceId)},hidden:g.isReadonly||g.scheduleEventId<=0},"DELETE"))):c.a.createElement(c.a.Fragment,null,c.a.createElement("div",null,"Loading"),m.alertBoxJsx)},Mn=n(15),Rn=n.n(Mn),Pn=function(e){var t=e.threeRows;return c.a.createElement("button",{className:"card"},c.a.createElement("div",{className:"card-first-col"},c.a.createElement("div",{className:"day-name"},c.a.createElement(Rn.a,null)," "),c.a.createElement("div",{className:"day-number"},c.a.createElement(Rn.a,null))),c.a.createElement("div",{style:{padding:"3px"}},c.a.createElement(Rn.a,{width:5,height:45})),c.a.createElement("div",{className:"card-second-col"},c.a.createElement("div",{className:"time-row"},c.a.createElement("span",null,c.a.createElement(Rn.a,{width:150,height:9}),"\xa0\xa0"),c.a.createElement(Rn.a,null)),t&&c.a.createElement("div",null,c.a.createElement(Rn.a,{width:80,height:10})),c.a.createElement("div",{className:"dept-position-row"},c.a.createElement(Rn.a,{width:150,height:10}),"\xa0\xa0")))},Un=function(){return c.a.createElement("div",null,c.a.createElement("span",{className:"no-messagesOrEvents-text"},"No Events"))};function Ln(e,t,n){var a=Object(o.useRef)();Object(o.useEffect)((function(){a.current=e}),[e]),Object(o.useEffect)((function(){if(null!==n){var e=setInterval((function(){a.current&&t&&a.current()}),n);return function(){return clearInterval(e)}}}),[n,t])}var Fn=[],Bn=[];var zn,Vn=function(e){var t=e.match,n=c.a.useContext(oe).user,r=c.a.useContext(Le),l=r.auth,i=r.refreshAuth,s=Lt(),u=Ht((function(e){Ge(l,_e,e)})),m=Object(o.useState)("filter-not-applied"),v=Object(p.a)(m,2),h=v[0],g=v[1],b=l&&l.locations&&l.locations.length>0?pt(Object(ht.a)(new Date),l.locations[0].settings.DayWeekStartsOn,l.locations[0].settings.DayStartTime):pt(Object(ht.a)(new Date),"Monday",""),y=Object(o.useState)(Fn),O=Object(p.a)(y,2),k=O[0],j=O[1],C=Object(o.useState)(Bn),I=Object(p.a)(C,2),S=I[0],T=I[1],N=Object(o.useState)([]),D=Object(p.a)(N,2),x=D[0],A=D[1],M=Object(o.useState)(Fn),R=Object(p.a)(M,2),P=R[0],U=R[1],L=Object(o.useState)(Bn),F=Object(p.a)(L,2),B=F[0],z=F[1],V=Object(o.useState)([]),_=Object(p.a)(V,2),q=_[0],G=_[1],Y=Object(o.useState)(Fn),J=Object(p.a)(Y,2),H=J[0],K=J[1],Q=Object(o.useState)(Bn),X=Object(p.a)(Q,2),$=X[0],Z=X[1],ee=Object(o.useState)([]),te=Object(p.a)(ee,2),ne=te[0],ae=te[1],re=Object(o.useState)(!0),ce=Object(p.a)(re,2),le=ce[0],ie=ce[1],se=Object(o.useState)(!1),ue=Object(p.a)(se,2),de=ue[0],me=ue[1],pe=Object(o.useState)("my"),Ee=Object(p.a)(pe,2),fe=Ee[0],he=Ee[1],ge=Object(o.useState)(!1),be=Object(p.a)(ge,2),ye=be[0],Oe=be[1],ke=Object(o.useState)(!1),je=Object(p.a)(ke,2),Ce=je[0],Ie=je[1],Te=Object(o.useState)(null),Ne=Object(p.a)(Te,2),De=Ne[0],xe=Ne[1],Ae=Object(o.useState)(On),we=Object(p.a)(Ae,2),Me=we[0],Re=we[1],Pe=Object(o.useState)(null),Ue=Object(p.a)(Pe,2),Fe=Ue[0],Be=Ue[1],ze=Object(o.useState)(Object(f.a)({},Ot,{start:b,end:Object(Ke.a)(b,6),positionIds:l.locations.flatMap((function(e){return e.departments.flatMap((function(e){return e.positions.map((function(e){return e.id}))}))})),filterByEmployee:!0})),Ve=Object(p.a)(ze,2),_e=Ve[0],qe=Ve[1];Object(d.W)((function(){me(!0)})),Object(d.X)((function(){me(!1)})),Ln((function(){i(!1,n).then((function(e){e&&Ge(e,_e)}))}),de&&!Ce&&!ye,W(n).refreshScheduleTimer),Object(o.useEffect)((function(){var e=Object(f.a)({},_e,{positionIds:l.locations.flatMap((function(e){return e.departments.flatMap((function(e){return e.positions.map((function(e){return e.id}))}))})),dnLocIds:l.locations.map((function(e){return e.id})),settingsLocId:l.locations[0].id});qe(e),("my"===fe&&0===k.length||"requests"===fe&&0===P.length||"all"===fe&&0===H.length)&&(ie(!0),Ge(l,e))}),[n]),Object(o.useEffect)((function(){t.params.scheduleEventId&&(xe(parseInt(t.params.scheduleEventId)),Ie(!0))}),[t.params.scheduleEventId]);var We=Object(o.useCallback)((function(e,t){xe(e.ScheduleEventId),Be(t),Re(hn(l,e)),Ie(!0)}),[l.locations]);if(!Se(l))return console.log("auth items not valid yet"),c.a.createElement("div",null);var Ge=function(e,t,a){var r=Object(f.a)({},t,{filterByEmployee:!1,eventTypeId:Xe.All,eventStatusId:Xe.All});yt.getScheduleEventsByFilter(n,r).then((function(n){ie(!1),a&&a.detail.complete(),j(function(e,t,n){return e.filter((function(e){return tt(n.eventTypeId,n.eventStatusId,e.EventTypeId,e.EventStatusId)&&e.EmployeeId===t.employeeId}))}(n.events,e,t)),T(n.dailyNotes),A(n.hoursPerDay),U(n.events.filter((function(e){return e.EventStatusId===ve.Request}))),z([]),G(n.hoursPerDay),K(function(e,t){return e.filter((function(e){return tt(t.eventTypeId,t.eventStatusId,e.EventTypeId,e.EventStatusId)}))}(n.events,t)),Z(n.dailyNotes),ae(n.hoursPerDay)}))},Ye=function(e){he(e)},Je=function(e){e&&e.length>0&&s.showToast(e),Ge(l,_e)};return c.a.createElement(d.y,{id:"schedule-page"},c.a.createElement(d.l,{className:"ion-no-border"},c.a.createElement(d.R,{mode:"md"},c.a.createElement(d.e,{slot:"start"},c.a.createElement(d.v,null)),c.a.createElement(d.O,{slot:"start"},"Schedule"),c.a.createElement(d.e,{slot:"end"},c.a.createElement(d.d,{onClick:function(){xe(null),Be(function(e){for(var t=e.locations[0],n=e.locations[0].departments[0],r=e.locations[0].departments[0].positions[0],o=!1,c=0;c<e.locations.length&&!o;c++)for(var l=0;l<e.locations[c].departments.length&&!o;l++)for(var i=0;i<e.locations[c].departments[l].positions.length&&!o;i++)e.locations[c].departments[l].positions[i].hasPosition&&(t=e.locations[c],n=e.locations[c].departments[l],r=e.locations[c].departments[l].positions[i],o=!0);var s={location:t,position:r},u=ve.Request;(e.role===a.BusinessAdmin||e.role===a.LocationAdmin||e.role===a.Admin&&(n.adminAuth&w.CanEditSchedules)===w.CanEditSchedules)&&(u=ve.Approved);var d=Tt(e,s,e.employeeId,u,!1),m=St(e,s,e.employeeId);return{buttonText:"",enableConfirm:!0,isReadonly:!1,text:"",usage:bt.None,eventTypeOptionList:m,eventStatusOptionList:d}}(l)),Ie(!0)}},c.a.createElement(d.m,{icon:E.a,mode:"md",slot:"icon-only"})),c.a.createElement(d.d,{onClick:function(){return Oe(!0)}},c.a.createElement("div",{className:h},"\xb7"),c.a.createElement(d.m,{icon:E.n,mode:"ios",slot:"icon-only"}))))),c.a.createElement(d.D,{mode:"md",value:fe},c.a.createElement(d.E,{mode:"md",value:"my",onClick:function(){return Ye("my")}},"MY"),c.a.createElement(d.E,{mode:"md",value:"requests",onClick:function(){return Ye("requests")}},"REQUESTS"),c.a.createElement(d.E,{mode:"md",value:"all",onClick:function(){return Ye("all")}},"ALL")),c.a.createElement(jt,{startDate:pt(_e.start,l.locations[0].settings.DayWeekStartsOn,l.locations[0].settings.DayStartTime),setStartDate:function(e){if(e!==_e.start){var t=Object(f.a)({},_e,{start:e,end:Object(Ke.a)(e,6)});qe(t),ie(!0),Ge(l,t)}}}),c.a.createElement(d.h,null,u.ionicRefresherJsx,!le&&"my"===fe&&0===(null===k||void 0===k?void 0:k.length)&&c.a.createElement(Un,null),!le&&"my"===fe&&(null===k||void 0===k?void 0:k.length)>0&&c.a.createElement(qt,{events:k,listType:fe,notes:S,hoursPerDay:x,auth:l,onEdit:We,onForceRefresh:Je}),!le&&"requests"===fe&&0===P.length&&c.a.createElement(Un,null),!le&&"requests"===fe&&P.length>0&&c.a.createElement(qt,{events:P,listType:fe,notes:B,hoursPerDay:q,auth:l,onEdit:We,onForceRefresh:Je}),!le&&"all"===fe&&0===(null===H||void 0===H?void 0:H.length)&&c.a.createElement(Un,null),!le&&"all"===fe&&(null===H||void 0===H?void 0:H.length)>0&&c.a.createElement(qt,{events:H,listType:fe,notes:$,hoursPerDay:ne,auth:l,onEdit:We,onForceRefresh:Je}),le&&c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{style:{marginTop:"10px"}}),c.a.createElement(Rn.a,{height:24,width:220}),c.a.createElement("br",null),c.a.createElement(Pn,{threeRows:"my"!==fe}),c.a.createElement(Pn,{threeRows:"my"!==fe}),c.a.createElement(Pn,{threeRows:"my"!==fe}))),s.simpleToastJsx,c.a.createElement(d.x,{isOpen:ye,onDidDismiss:function(){return Oe(!1)}},c.a.createElement(Jt,{filter:_e,auth:l,onDismissModal:function(e,t){qe(e),g(t?"filter-applied":"filter-not-applied"),Oe(!1),ie(!0),Ge(l,e)},isOpen:ye,onCancelModal:function(){return Oe(!1)}})),c.a.createElement(d.x,{isOpen:Ce,onDidDismiss:function(){return Ie(!1)}},c.a.createElement(wn,{isOpen:Ce,auth:l,onCancelModal:function(){return Ie(!1)},onDismissModal:function(e){return function(e){e&&s.showToast(e),Ge(l,_e),Ie(!1)}(e)},scheduleEventId:De,initialEvent:Me,eventEditAuth:Fe})))};!function(e){e[e.MatchingShift=1]="MatchingShift",e[e.AnyShift=2]="AnyShift",e[e.NoShift=3]="NoShift"}(zn||(zn={}));var _n,qn,Wn=function(e){var t=e.auth,n=e.onDismissModal,a=e.tcData,r=Object(o.useState)([]),l=Object(p.a)(r,2),i=l[0],s=l[1],u={key:"Cancel",name:"",breakType:R.UnscheduledUnpaid};return Object(o.useEffect)((function(){if(0!==t.locations.length&&a.ClockedInScheduleEvent){var e=t.locations.filter((function(e){return e.id===a.ClockedInScheduleEvent.LocationId}))[0].settings,n=[];switch(a.ScheduleEventsForClockIn.length>0&&a.ScheduleEventsForClockIn[0].EventBreaks.map((function(e){return n.push({key:e.BreakStart,name:mt(e),breakType:R.Scheduled})})),e.UnscheduledBreakOptions){case M.Both:n.push({key:"UnScheduledUnpaid",name:"Unscheduled",breakType:R.UnscheduledUnpaid}),n.push({key:"UnScheduledPaid",name:"Unscheduled $",breakType:R.UnscheduledPaid});break;case M.Paid:n.push({key:"UnScheduledPaid",name:"Unscheduled $",breakType:R.UnscheduledPaid});break;case M.Unpaid:n.push({key:"UnScheduledUnpaid",name:"Unscheduled",breakType:R.UnscheduledUnpaid})}s(n)}}),[a,t]),c.a.createElement(c.a.Fragment,null,c.a.createElement(d.l,{className:"ion-no-border"},c.a.createElement(d.R,null,c.a.createElement(d.e,{slot:"start"},c.a.createElement(d.d,{onClick:function(){return n(u)}},c.a.createElement(d.m,{icon:E.c,mode:"md",slot:"icon-only"}))),c.a.createElement(d.O,null,"Choose Break"))),c.a.createElement(d.h,{class:"outer-content"},i.map((function(e){return c.a.createElement(d.d,{className:"apply-button",expand:"block",key:e.key,color:"secondary",onClick:function(){n(e)}},e.name)}))),c.a.createElement(d.j,null,c.a.createElement(d.d,{className:"cancel-button",expand:"block",color:"tertiary",onClick:function(){return n(u)}},"CANCEL")))},Gn={getTimeClockSettings:function(){var e=Object(g.a)(h.a.mark((function e(t,n,a){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.get(t,"api/v1/employee/timeclock/?lat=".concat(n,"&lng=").concat(a));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),clockIn:function(){var e=Object(g.a)(h.a.mark((function e(t,n,a,r,o){var c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c="/api/v2/employee/timeclock/clockin/".concat(n,"/").concat(a,"?lat=").concat(r,"&lng=").concat(o),e.next=3,$.post(t,c,{});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n,a,r,o){return e.apply(this,arguments)}}(),clockOut:function(){var e=Object(g.a)(h.a.mark((function e(t,n,a,r){var o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={ClockOutValue:r,TimeClockBreak:null,BreakStart:null},e.next=3,$.post(t,"/api/v2/employee/timeclock/clockout?lat=".concat(n,"&lng=").concat(a),o);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}(),switchPositionOrTag:function(){var e=Object(g.a)(h.a.mark((function e(t,n,a,r,o,c){var l,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l="/api/v2/employee/timeclock/switch/".concat(n,"/").concat(a,"?lat=").concat(r,"&lng=").concat(o),i={ClockOutValue:c,TimeClockBreak:null,BreakStart:null},e.next=4,$.post(t,l,i);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n,a,r,o,c){return e.apply(this,arguments)}}(),startBreak:function(){var e=Object(g.a)(h.a.mark((function e(t,n,a,r,o,c,l){var i,s;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i="/api/v2/employee/timeclock/startbreak?lat=".concat(o,"&lng=").concat(c),s={clockEventId:n.ScheduleEventId,shiftEventId:a?a.ScheduleEventId:null,shiftBreakStart:l,breakType:r},e.next=4,$.post(t,i,s);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n,a,r,o,c,l){return e.apply(this,arguments)}}(),endBreak:function(){var e=Object(g.a)(h.a.mark((function e(t,n,a,r,o){var c,l;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=a?a.ScheduleEventId:"",l=null!==a?"/api/v2/employee/timeclock/endbreak/".concat(n.ScheduleEventId,"/").concat(c,"?lat=").concat(r,"&lng=").concat(o):"/api/v2/employee/timeclock/endbreak/".concat(n.ScheduleEventId,"/-1?lat=").concat(r,"&lng=").concat(o),e.next=4,$.post(t,l,{});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n,a,r,o){return e.apply(this,arguments)}}(),getGeoLocations:function(){var e=Object(g.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/api/v2/employee/timeclock/geolocations",e.next=3,$.get(t,"/api/v2/employee/timeclock/geolocations");case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};!function(e){e[e.Success=0]="Success",e[e.BreakAlreadyExists=1]="BreakAlreadyExists",e[e.AlreadyOnBreak=2]="AlreadyOnBreak",e[e.ErrorInsertingBreak=3]="ErrorInsertingBreak",e[e.UserNotAtSpecifiedLocation=4]="UserNotAtSpecifiedLocation",e[e.EventDoesNotMatchCurrentUser=5]="EventDoesNotMatchCurrentUser",e[e.InvalidUnscheduledBreak=6]="InvalidUnscheduledBreak"}(_n||(_n={})),function(e){e[e.Success=0]="Success",e[e.CannotEndRestrictedBreakEarly=1]="CannotEndRestrictedBreakEarly",e[e.ErrorUpdatingEventBreak=2]="ErrorUpdatingEventBreak",e[e.UserNotAtSpecifiedLocation=3]="UserNotAtSpecifiedLocation",e[e.EventDoesNotMatchCurrentUser=4]="EventDoesNotMatchCurrentUser",e[e.BreakNoLongerExists=5]="BreakNoLongerExists"}(qn||(qn={}));var Yn=function(e){var t=e.onCancel,n=e.onOk,a=e.locSettings,r=Object(o.useState)(void 0),l=Object(p.a)(r,2),i=l[0],s=l[1];return c.a.createElement(c.a.Fragment,null,c.a.createElement(d.l,{mode:"ios"},c.a.createElement(d.R,null,c.a.createElement(d.O,null,"Clock Out"))),c.a.createElement(d.h,null,c.a.createElement(d.k,null,c.a.createElement(d.C,null,c.a.createElement(d.g,{className:"label",size:"12"},a.ClockOutValueLabel)),c.a.createElement(d.C,null,c.a.createElement(d.g,{size:"2"}),c.a.createElement(d.g,{size:"8"},c.a.createElement(d.n,{placeholder:"Enter value",type:"number",className:"input",autoCorrect:"off",clearInput:!0,value:null===i||void 0===i?void 0:i.toString(),onIonChange:function(e){var t;(t=e.detail.value)?s(parseFloat(t)):void 0!==i&&s(void 0)}})),c.a.createElement(d.g,{size:"2"})))),c.a.createElement(d.j,null,c.a.createElement(d.d,{expand:"block",onClick:function(){n(i)},className:"clockout-button"},"CLOCK OUT"),c.a.createElement(d.d,{expand:"block",className:"cancel-button",onClick:t},"CANCEL")))},Jn=function(e){var t=e.tcData,n=e.locSettings,a=e.selectedPosId,r=e.selectedTagId,l=e.onSwitch,i=Object(o.useState)(!0),s=Object(p.a)(i,2),u=s[0],m=s[1],E=c.a.createElement("span",null);return Object(o.useEffect)((function(){if(t.UserClockedIn){var e=t.ClockedInScheduleEvent.PositionId,n=t.ClockedInScheduleEvent.TagId;n||(n=-1),m(e===a&&n===r)}}),[t.UserClockedIn,t.ClockedInScheduleEvent,a,r]),(n.ClockInWithDifferentTag||n.EnablePositionChangeForEmployeePosition)&&t.UserClockedIn?c.a.createElement("div",{className:"switch-button-container"},c.a.createElement(d.d,{className:"switch-button",disabled:u,color:"secondary",expand:"block",onClick:l},"SWITCH")):E};function Hn(e,t,n){if(!e||!t||0===n.length)return"";if(!google||!google.maps||!google.maps.geometry||!google.maps.geometry.spherical||!google.maps.geometry.spherical.computeDistanceBetween)return"";for(var a=new google.maps.LatLng(e,t),r=null,o=999999999,c=0;c<n.length;c++){var l=n[c];if(l.lat&&l.lng){var i=new google.maps.LatLng(l.lat,l.lng),s=3.28084*google.maps.geometry.spherical.computeDistanceBetween(a,i)-l.proximity;s<o&&(o=s,r=l)}}if(999999999===o)return"";if(o<0)return"At "+r.locationName;var u=189394e-9*o;return u>.1?"".concat(Math.round(10*(u+Number.EPSILON))/10," mi to ").concat(r.locationName):"".concat(Math.round(o)," ft to ").concat(r.locationName)}function Kn(e){return null!==e&&(void 0!==e.coords.latitude&&void 0!==e.coords.longitude)}var Qn=function(e){var t=e.pos,n=Object(o.useRef)(null),a=Object(o.useRef)(),r=Object(o.useRef)(),l=c.a.useContext(oe).user,i=Object(o.useState)(""),s=Object(p.a)(i,2),u=s[0],m=s[1],f=Object(o.useState)([]),v=Object(p.a)(f,2),h=v[0],g=v[1],b=Object(o.useState)(!1),y=Object(p.a)(b,2),O=y[0],k=y[1];return Object(o.useEffect)((function(){if(null!==n.current&&Kn(t))if(void 0===a.current)a.current=new google.maps.Map(n.current,{center:{lat:t.coords.latitude,lng:t.coords.longitude},zoom:16,disableDefaultUI:!0,fullscreenControl:!1}),function(){Kn(t)&&(r.current=new google.maps.Circle({strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.25,radius:6.5,center:{lat:t.coords.latitude,lng:t.coords.longitude},map:a.current}));Gn.getGeoLocations(l).then((function(e){g(e),e.forEach((function(e){var t=new google.maps.InfoWindow({content:"<h5>".concat(e.addr,"</h5>")});if(e.lat&&e.lng){var n=new google.maps.LatLng(e.lat,e.lng),r=new google.maps.Marker({position:n,map:a.current,title:e.addr});new google.maps.Circle({strokeColor:"#FF0000",strokeOpacity:.5,strokeWeight:1,fillColor:"#DD0000",fillOpacity:.2,radius:.3048*e.proximity,center:n,map:a.current}),r.addListener("click",(function(){t.open(a.current,r)}))}})),Kn(t)&&m(Hn(t.coords.latitude,t.coords.longitude,e))}))}(),google.maps.event.addListenerOnce(a.current,"idle",(function(){n.current&&n.current.classList.add("show-map")}));else{if(a.current&&Kn(t)){var e=new google.maps.LatLng(t.coords.latitude,t.coords.longitude);a.current.setCenter(e),r.current&&r.current.setMap(null),r.current=new google.maps.Circle({strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.25,radius:6.5,center:e,map:a.current})}m(Hn(t.coords.latitude,t.coords.longitude,h))}}),[t,google,google.maps]),c.a.createElement(c.a.Fragment,null,c.a.createElement(d.d,{className:"map-button",onClick:function(){null!==t&&(k(!O),m(Hn(t.coords.latitude,t.coords.longitude,h)))}},u,c.a.createElement(d.m,{id:"show-map-button",icon:O?E.d:E.f})),c.a.createElement("div",{id:"map-container",hidden:!O},c.a.createElement("div",{ref:n,className:"map-canvas"})))};var Xn=function(){var e=Object(o.useState)(!1),t=Object(p.a)(e,2),n=t[0],a=t[1],r=Object(o.useState)({message:"",onCancel:function(){},onYes:function(){}}),l=Object(p.a)(r,2),i=l[0],s=l[1];return{showDialog:function(e,t,n){s({message:e,onYes:t,onCancel:n}),a(!0)},dialogJsx:c.a.createElement(d.b,{isOpen:n,onDidDismiss:function(){a(!1)},message:i.message,buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:i.onCancel},{text:"Yes",handler:i.onYes}]})}},$n={enableHighAccuracy:!0,maximumAge:1e3};var Zn=function(e){var t=e.updateCallback,n=e.isShowing,a=c.a.useContext(oe).user,r=c.a.useContext(Le).auth,l=Object(o.useState)(""),i=Object(p.a)(l,2),s=i[0],u=i[1],d=Object(o.useState)(null),m=Object(p.a)(d,2),E=m[0],f=m[1],v=Xn(),h=Lt();return Object(o.useEffect)((function(){var e;Re(r.locations)&&(n?u(function(e){var t=function(t){if(t&&t.coords){var n=!1;if(null===E)n=!0;else if(function(){var e=!(void 0===google||void 0===google.maps||void 0===google.maps.geometry||void 0===google.maps.geometry.spherical||void 0===google.maps.geometry.spherical.computeDistanceBetween||void 0===google.maps.LatLng);return e||console.log("WARNING: google maps not yet loaded"),e}()){var r=new google.maps.LatLng(E.coords.latitude,E.coords.longitude),o=new google.maps.LatLng(t.coords.latitude,t.coords.longitude);n=3.28084*google.maps.geometry.spherical.computeDistanceBetween(r,o)>W(a).minimumFeetForGeolocationUpdate}else n=!0;n&&(console.log("GEO: position changed"),f(t),e(t.coords.latitude,t.coords.longitude))}},n=function(t){console.log("GEO: Could not get geolocation, error code "+t.code),1===t.code&&e()},r="";if(G.settings.hasCapacitor&&T.a.isPluginAvailable("Geolocation")){console.log("GEO: Using Cap plugin to watch position");try{r=T.b.watchPosition($n,t),T.b.getCurrentPosition($n).then((function(e){t(e)}))}catch(o){n({code:1})}}else{if(!navigator||!navigator.geolocation)return console.log("GEO: Location unavailable via cap/nav"),"";console.log("GEO: Using browser API"),r=navigator.geolocation.watchPosition(t,n,$n),navigator.geolocation.getCurrentPosition((function(e){t(e)}))}return console.log("GEO: start watching, watchId "+r),r}(t)):(""!==(e=s)&&(G.settings.hasCapacitor&&T.a.isPluginAvailable("Geolocation")?T.b.clearWatch({id:e}).then((function(){console.log("GEO: cleared watchId ".concat(e," from Capacitor plugin"))})):navigator&&navigator.geolocation&&(navigator.geolocation.clearWatch(e),console.log("GEO: cleared watchId ".concat(e," from browser API")))),f(null),u("")))}),[n,a.isLoggedin]),c.a.createElement(c.a.Fragment,null,r&&r.locations&&r.locations.length>0&&Re(r.locations)&&c.a.createElement(Qn,{pos:E}),v.dialogJsx,h.simpleToastJsx)},ea=function(e){var t=e.onUpdate,n=e.refreshToggle,a=c.a.useContext(oe).user,r=c.a.useContext(Le).auth,l=Object(o.useState)([]),i=Object(p.a)(l,2),s=i[0],u=i[1],m=Object(o.useState)(0),v=Object(p.a)(m,2),h=v[0],g=v[1],b=Object(o.useRef)(0),y=Object(o.useState)(!1),O=Object(p.a)(y,2),k=O[0],j=O[1],C=Object(o.useState)([]),I=Object(p.a)(C,2),S=I[0],T=I[1],N=Object(o.useState)(null),D=Object(p.a)(N,2),x=D[0],A=D[1],w=Object(o.useRef)(null),P=Object(o.useState)("START BREAK"),U=Object(p.a)(P,2),L=U[0],F=U[1],B=Object(o.useState)({}),z=Object(p.a)(B,2),V=z[0],_=z[1],q=Object(o.useState)(!1),G=Object(p.a)(q,2),Y=G[0],J=G[1],H=Object(o.useState)(!1),K=Object(p.a)(H,2),Q=K[0],X=K[1],$=Object(o.useState)("Please wait..."),Z=Object(p.a)($,2),ee=Z[0],te=Z[1],ne=Object(o.useState)({show:!1,header:"Alert",message:""}),ae=Object(p.a)(ne,2),re=ae[0],ce=ae[1],le=Object(o.useState)(null),ie=Object(p.a)(le,2),se=ie[0],ue=ie[1],de=Object(o.useState)(!1),me=Object(p.a)(de,2),pe=me[0],Ee=me[1],fe=Object(o.useState)(!1),ve=Object(p.a)(fe,2),he=ve[0],ge=ve[1],be=Object(o.useState)(!1),ye=Object(p.a)(be,2),Oe=ye[0],ke=ye[1],je=Lt(),Ce=Object(o.useState)(void 0),Ie=Object(p.a)(Ce,2),Se=Ie[0],Te=Ie[1],Ne=Object(o.useState)(void 0),De=Object(p.a)(Ne,2),xe=De[0],Ae=De[1];Object(d.W)((function(){ke(!0)})),Object(d.X)((function(){ke(!1)})),Object(o.useEffect)((function(){he!==n&&ge(n),we(Se,xe)}),[n]),Object(o.useEffect)((function(){if(se&&r&&r.locations&&0!==r.locations.length&&se.ShowTimeClock){var e,t=Yt.unique(se.PositionsToClockInto.map((function(e){return e.LocationId}))),n=Yt.unique(se.PositionsToClockInto.map((function(e){return e.DepartmentId})));e=t.length>1?se.PositionsToClockInto.map((function(e){return{id:e.PositionId,name:e.PositionNameWithLocAndDeptAbbreviation}})):n.length>1?se.PositionsToClockInto.map((function(e){return{id:e.PositionId,name:e.PositionNameWithDeptAbbreviation}})):se.PositionsToClockInto.map((function(e){return{id:e.PositionId,name:e.PositionName}}));var a=h;0===a&&(se.UserClockedIn?(a=se.ClockedInScheduleEvent.PositionId,g(a)):se.ScheduleEventsForClockIn&&se.ScheduleEventsForClockIn.length>0?(a=se.ScheduleEventsForClockIn[0].PositionId,g(a)):e.length>0?(a=e[0].id,g(a)):a=0);var o=se.UserClockedIn?se.ClockedInScheduleEvent.LocationId:0!==a?r.locations.filter((function(e){return e.departments.flatMap((function(e){return e.positions.flatMap((function(e){return e.id===a}))}))}))[0].id:r.locations[0].id,c=r.locations.filter((function(e){return e.id===o}))[0].settings;_(c),c.EnableEnhancedBreakManagement&&(c.UnscheduledBreakOptions!==M.None||se.ClockedInScheduleEvent.EventBreaks&&se.ClockedInScheduleEvent.EventBreaks.length>0)?F(se.UserClockedIn&&se.CurrentEventBreak?"END BREAK":"START BREAK"):F("NONE"),u(e),Me(a)}}),[r,se,Se,xe]),Ln((function(){we(Se,xe)}),Oe,W(a).refreshTimeclockSettingsTimer);var we=function(e,t){Gn.getTimeClockSettings(a,e,t).then((function(e){ue(e)}))},Me=function(e){if(!se)return-1;var t=se.UserClockedIn?se.ClockedInScheduleEvent.LocationId:r.locations.filter((function(t){return t.departments.flatMap((function(t){return t.positions.flatMap((function(t){return t.id===e}))}))}))[0].id;if(!(r.locations.filter((function(e){return e.id===t}))[0].settings.ClockInWithDifferentTag&&se.TagsPerPosition[e]&&se.TagsPerPosition[e].length>1))return j(!1),-1;j(!0);var n=se.TagsPerPosition[e].map((function(e){return{id:e.TagId,name:e.TagName}}));n.unshift({id:-1,name:"NONE"}),T(n);var a=-1;return se.UserClockedIn?a=se.ClockedInScheduleEvent.TagId?se.ClockedInScheduleEvent.TagId:(se.ClockedInScheduleEvent.TagId,-1):se.TagsPerPosition[e]&&se.TagsPerPosition[e].length>0&&(a=se.ScheduleEventsForClockIn&&se.ScheduleEventsForClockIn[0]&&se.ScheduleEventsForClockIn[0].TagId?se.ScheduleEventsForClockIn[0].TagId:-1),A(a),a},Re=function(e,t){ce({show:!0,header:e,message:t})},Pe=function(e){pe&&Ee(!1),te("Clocking Out..."),X(!0),Gn.clockOut(a,Se,xe,e).then((function(e){X(!1),0===e.ClockOutResponseCode?(je.showToast("Clocked out at "+Object(Ye.a)(Object(We.a)(e.ClockOutEvent.EventEnd),"h:mmaaa")),t(),we(Se,xe)):Re("Could not Clock Out","Unable to Clock out, ".concat(e.Message))}))};return r&&se?c.a.createElement(c.a.Fragment,null,c.a.createElement(d.j,null,c.a.createElement(d.k,null,je.simpleToastJsx,c.a.createElement(d.t,{isOpen:Q,onDidDismiss:function(){return X(!1)},spinner:"dots",message:ee}),c.a.createElement("div",{className:"clock-controls"},c.a.createElement(d.C,null,c.a.createElement(d.g,{className:"ion-no-padding",size:"12"},c.a.createElement(Zn,{updateCallback:function(e,t){Se!==e&&Te(e),xe!==t&&Ae(t),we(e,t)},isShowing:Oe}))),se.PositionsToClockInto&&se.PositionsToClockInto.length>1&&c.a.createElement(d.C,null,c.a.createElement(d.g,{size:"3"},c.a.createElement(d.p,null,"Position")),c.a.createElement(d.g,{size:"9"},c.a.createElement(d.F,{className:"select",mode:"ios",interface:"action-sheet",onIonChange:function(e){var t;(t=e.detail.value)!==h&&t!==b.current&&(g(t),Me(t))},disabled:!((se.UserClockedIn&&se.UserMayClockOut||!se.UserClockedIn&&se.UserMayClockIn)&&V.ClockInRequirement!==zn.MatchingShift),value:h},s.map((function(e){return c.a.createElement(d.G,{key:e.id,value:e.id},e.name)}))))),k&&c.a.createElement(d.C,{className:"button"},c.a.createElement(d.g,{size:"3"},c.a.createElement(d.p,null,"~Tag")),c.a.createElement(d.g,{size:"9"},c.a.createElement(d.F,{className:"select",mode:"ios",interface:"action-sheet",onIonChange:function(e){var t;(t=e.detail.value)!==x&&t!==w.current&&A(t)},disabled:!((se.UserClockedIn&&se.UserMayClockOut||!se.UserClockedIn&&se.UserMayClockIn)&&V.ClockInRequirement!==zn.MatchingShift),value:x},S.map((function(e){return c.a.createElement(d.G,{key:e.id,value:e.id},e.name)}))))),c.a.createElement(d.C,null,c.a.createElement(d.g,{className:"ion-no-padding",size:"12"},c.a.createElement(Jn,{tcData:se,locSettings:V,selectedPosId:h,selectedTagId:x,onSwitch:function(){te("Switching..."),X(!0),Gn.switchPositionOrTag(a,h,x,Se,xe).then((function(e){X(!1),e.AllowedToSwitchPositions||e.AllowedToSwitchTags?(je.showToast("Switched"),t(),we(Se,xe)):Re("Could not switch","".concat(e.ClockInMessage," ").concat(e.ClockOutMessage))}))}}))),!se.UserClockedIn&&c.a.createElement(d.C,null,c.a.createElement(d.g,{className:"ion-no-padding",size:"12"},c.a.createElement(d.d,{className:"clockin-button",onClick:function(){te("Clocking in..."),X(!0),Gn.clockIn(a,h,x,Se,xe).then((function(e){X(!1),0===e.ClockInResponseCode?(je.showToast("Clocked in at "+Object(Ye.a)(Object(We.a)(e.ClockInEvent.EventStart),"h:mmaaa")),t(),we(Se,xe)):Re("Could not Clock In","Unable to Clock in, ".concat(e.Message))}))},disabled:!se.UserMayClockIn},c.a.createElement(d.m,{mode:"md",icon:E.w})," CLOCK IN"))),se.UserClockedIn&&c.a.createElement(d.C,null,c.a.createElement(d.g,{className:"clockout-button-container ion-no-padding"},c.a.createElement(d.d,{className:"clockout-button",disabled:!se.UserMayClockOut,expand:"block",onClick:function(){V.ClockOutValueLabel?Ee(!0):Pe()}},c.a.createElement(d.m,{mode:"md",icon:E.w}),"CLOCK OUT"," "),"NONE"!==L&&c.a.createElement(d.d,{onClick:function(){if("NONE"!==L&&se)return"END BREAK"===L?(te("Ending Break..."),X(!0),void Gn.endBreak(a,se.ClockedInScheduleEvent,se.ScheduleEventsForClockIn.length>0?se.ScheduleEventsForClockIn[0]:null,Se,xe).then((function(e){X(!1),e.EndBreakResponseCode===qn.Success?(je.showToast("Ended break at ".concat(Object(Ye.a)(Object(We.a)(e.BreakEnd),"h:mmaaa"))),t(),we(Se,xe)):Re("Did not come off break",e.Message)}))):void(V.UnscheduledBreakOptions!==M.None||se.ClockedInScheduleEvent.EventBreaks&&se.ClockedInScheduleEvent.EventBreaks.length>0?J(!0):Re("No implemented","Not implemented in ClockPanel.tsx for this scenario"))},expand:"block",className:"break-button",disabled:!se.UserMayClockOut},c.a.createElement(d.m,{icon:E.h}),L)))))),c.a.createElement(d.x,{isOpen:Y,cssClass:"mini-modal break-selector-modal"},c.a.createElement(Wn,{auth:r,tcData:se,onDismissModal:function(e){return n=e,void(se&&(J(!1),"Cancel"!==n.key&&(te("Starting Break..."),X(!0),Gn.startBreak(a,se.ClockedInScheduleEvent,se.ScheduleEventsForClockIn[0],n.breakType,Se,xe,n.breakType===R.Scheduled?n.key:void 0).then((function(e){X(!1),e.StartBreakResponseCode===_n.Success?(je.showToast("Break started at "+Object(Ye.a)(Object(We.a)(e.BreakStart),"h:mmaaa")),t(),we(Se,xe)):Re("Could not start break","Unable to start break, ".concat(e.Message))})))));var n}})),c.a.createElement(d.x,{cssClass:"mini-modal clockout-modal",isOpen:pe,onDidDismiss:function(){Ee(!1)}},c.a.createElement(Yn,{onCancel:function(){Ee(!1)},onOk:Pe,locSettings:V})),c.a.createElement(d.b,{isOpen:re.show,onDidDismiss:function(){return ce(Object(f.a)({},re,{show:!1}))},header:re.header,message:re.message,buttons:["OK"]})):c.a.createElement("div",null,"Loading...")};var ta=function(e){var t,n,a=e.startDate,r=e.endDate,o=e.onNextPayPeriod,l=e.onPrevPayPeriod,i=null===a||null===r?"":(n=r,(t=a)&&n?t.getMonth()!==n.getMonth()?Object(Ye.a)(t,"MMM d").toUpperCase()+" - "+Object(Ye.a)(Object(Ke.a)(n,-1),"MMM d").toUpperCase():Object(Ye.a)(t,"MMM d").toUpperCase()+" - "+Object(Ye.a)(Object(Ke.a)(n,-1),"d"):" ");return c.a.createElement("div",{className:"chooser"},c.a.createElement("div",{className:"top"},c.a.createElement("button",{onClick:l,className:"arrow",key:-1},c.a.createElement(d.m,{mode:"ios",icon:E.b})),c.a.createElement("div",{className:"month-year-container"},c.a.createElement("div",{className:"datetime-picker-container"},c.a.createElement("div",{className:"datetime-picker"},i))),c.a.createElement("button",{onClick:o,className:"arrow",key:7},c.a.createElement(d.m,{mode:"ios",icon:E.e}))))},na={getPayPeriodDateForEmployee:function(){var e=Object(g.a)(h.a.mark((function e(t,n,a){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Et(a),e.next=3,$.get(t,"api/v2/payroll/get/"+n+"/"+r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}()};function aa(e,t){return function(e,t){if("00:00:00"===t.ActualTime)return e.TimeFormat===x.HoursMinutes?"00:00":ft(0,e.TimeFormatDigits,e.TimeFormatDecimals);if(e.TimeFormat===x.HoursMinutes){var n=t.ActualTime.split(":");if(3!==n.length)return t.ActualTime;if(n[0].includes(".")){var a=n[0].split("."),r=24*parseInt(a[0])+parseInt(a[1]);return"".concat(r,":").concat(n[1])}var o=parseInt(n[0]);return"".concat(o,":").concat(n[1])}return ft(t.ActualHours,e.TimeFormatDigits,e.TimeFormatDecimals)}(e,t)}var ra=function(e){var t=e.time,n=e.locSettings,a=e.fontColor;if(null===t)return c.a.createElement("span",null," -- ");var r=0===t.ActualHours?"#ddd":a;return c.a.createElement("span",{style:{color:r}},aa(n,t))};var oa=function(e){var t=e.onClose,n=e.data,a=e.locSettings,r=Object(o.useContext)(Le).auth;return n?c.a.createElement(c.a.Fragment,null,c.a.createElement(d.l,{mode:"ios"},c.a.createElement(d.R,null,c.a.createElement(d.O,null,st(Object(We.a)(n.date))))),c.a.createElement(d.h,null,c.a.createElement(d.k,null,n.regular.ActualHours>0&&c.a.createElement(d.C,null,c.a.createElement(d.g,{size:"7"},"Regular"),c.a.createElement(d.g,{size:"5"},c.a.createElement(ra,{time:n.regular,locSettings:a,fontColor:"black"}))),n.dailyOvertime.ActualHours>0&&c.a.createElement(d.C,null,c.a.createElement(d.g,{size:"7"},"Daily Overtime"),c.a.createElement(d.g,{size:"5"},c.a.createElement(ra,{time:n.dailyOvertime,locSettings:a,fontColor:"red"}))),n.weeklyOvertime.ActualHours>0&&c.a.createElement(d.C,null,c.a.createElement(d.g,{size:"7"},"Weekly Overtime"),c.a.createElement(d.g,{size:"5"},c.a.createElement(ra,{time:n.weeklyOvertime,locSettings:a,fontColor:"red"}))),n.special.ActualHours>0&&c.a.createElement(d.C,null,c.a.createElement(d.g,{size:"7"},"Special Dates"),c.a.createElement(d.g,{size:"5"},c.a.createElement(ra,{time:n.special,locSettings:a,fontColor:"black"}))),n.timePerAbsent&&n.timePerAbsent.map((function(e){return c.a.createElement(d.C,{key:e.absentId},c.a.createElement(d.g,{size:"7"},function(e,t){return e.payrollEvents.filter((function(e){return e.id===t}))[0].name}(r,e.absentId)),c.a.createElement(d.g,{size:"5"},c.a.createElement(ra,{time:e.time,locSettings:a,fontColor:"#AD850C"})))})))),c.a.createElement(d.j,null,c.a.createElement(d.d,{expand:"block",onClick:t},"CLOSE"))):c.a.createElement("div",null,"loading")};var ca,la=function(e){var t,n=e.payrollRow,a=e.colsToDisplay,r=e.colSize,l=Object(o.useContext)(Le).auth,i=ge(l,l.locations[0].id),s=Object(o.useState)(!1),u=Object(p.a)(s,2),m=u[0],E=u[1];return null===n?c.a.createElement(d.C,null,c.a.createElement(d.g,{size:"3"},c.a.createElement(Rn.a,{width:50})),c.a.createElement(d.g,{size:"3"},c.a.createElement(Rn.a,{width:50})),c.a.createElement(d.g,{size:"3"},c.a.createElement(Rn.a,{width:50})),c.a.createElement(d.g,{size:"3"},c.a.createElement(Rn.a,{width:50}))):c.a.createElement(c.a.Fragment,null,c.a.createElement(d.C,null,c.a.createElement(d.g,{size:r},c.a.createElement("button",{className:"payperiod-list-buttons",onClick:function(){return E(!0)}},(t=n.date,Object(Ye.a)(Object(We.a)(t),"EEE d")))),c.a.createElement(d.g,{size:r,color:"secondary",hidden:(a&ca.Regular)!==ca.Regular},c.a.createElement(ra,{time:null===n||void 0===n?void 0:n.regular,locSettings:i,fontColor:"black"})),c.a.createElement(d.g,{size:r,hidden:(a&ca.DailyOvertime)!==ca.DailyOvertime},c.a.createElement(ra,{time:null===n||void 0===n?void 0:n.dailyOvertime,locSettings:i,fontColor:"red"})),c.a.createElement(d.g,{size:r,hidden:(a&ca.WeeklyOvertime)!==ca.WeeklyOvertime},c.a.createElement(ra,{time:null===n||void 0===n?void 0:n.weeklyOvertime,locSettings:i,fontColor:"red"})),c.a.createElement(d.g,{size:r,hidden:(a&ca.Special)!==ca.Special},c.a.createElement(ra,{time:null===n||void 0===n?void 0:n.special,locSettings:i,fontColor:"black"})),c.a.createElement(d.g,{size:r,hidden:(a&ca.Absent)!==ca.Absent},c.a.createElement(ra,{time:null===n||void 0===n?void 0:n.absent,locSettings:i,fontColor:"black"}))),c.a.createElement(d.x,{cssClass:"mini-modal detail-modal",isOpen:m,onDidDismiss:function(){return E(!1)}},c.a.createElement(oa,{onClose:function(){return E(!1)},locSettings:i,data:n})))};!function(e){e[e.None=0]="None",e[e.Regular=1]="Regular",e[e.DailyOvertime=2]="DailyOvertime",e[e.WeeklyOvertime=4]="WeeklyOvertime",e[e.Special=8]="Special",e[e.Absent=16]="Absent",e[e.All=31]="All"}(ca||(ca={}));var ia=function(e){var t=e.payrollData,n=Object(o.useContext)(Le).auth,a=ge(n,n.locations[0].id),r=Object(o.useState)(ca.None),l=Object(p.a)(r,2),i=l[0],s=l[1],u=Object(o.useState)("3"),m=Object(p.a)(u,2),E=m[0],f=m[1];return Object(o.useEffect)((function(){if(t){var e=function(e){var t=ca.Regular,n=2;return e.totalDailyOvertime.ActualHours>0&&(t|=ca.DailyOvertime,n++),e.totalWeeklyOvertime.ActualHours>0&&(t|=ca.WeeklyOvertime,n++),e.totalSpecial.ActualHours>0&&(t|=ca.Special,n++),e.totalAbsent.ActualHours>0&&(t|=ca.Absent,n++),{cols:t,count:n}}(t),n=e.count,a=e.cols;s(a),f(n>=5?"2":"3")}}),[t]),null===t?c.a.createElement("div",{className:"grid-container"},c.a.createElement(d.k,{class:"ion-text-end"},c.a.createElement(d.C,{className:"list-header",class:"ion-text-center"},c.a.createElement(d.g,{size:"3"},c.a.createElement(Rn.a,{width:60})),c.a.createElement(d.g,{size:"3"},c.a.createElement(Rn.a,{width:60})),c.a.createElement(d.g,{size:"3"},c.a.createElement(Rn.a,{width:60})),c.a.createElement(d.g,{size:"3"},c.a.createElement(Rn.a,{width:60}))),[1,2,3,4,5,6,7,8,9,10].map((function(e){return c.a.createElement(la,{payrollRow:null,colSize:"3",colsToDisplay:ca.None,key:e})})))):c.a.createElement("div",{className:"grid-container"},c.a.createElement(d.k,{class:"ion-text-end"},c.a.createElement(d.C,{className:"list-header",class:"ion-text-center"},c.a.createElement(d.g,{size:E},"DATE"),c.a.createElement(d.g,{size:E,hidden:(i&ca.Regular)!==ca.Regular},"REG"),c.a.createElement(d.g,{size:E,hidden:(i&ca.DailyOvertime)!==ca.DailyOvertime},"DAILY OT"),c.a.createElement(d.g,{size:E,hidden:(i&ca.WeeklyOvertime)!==ca.WeeklyOvertime},"WKLY OT"),c.a.createElement(d.g,{size:E,hidden:(i&ca.Special)!==ca.Special},"SPECIAL"),c.a.createElement(d.g,{size:E,hidden:(i&ca.Absent)!==ca.Absent},"ABSENT")),null===t||void 0===t?void 0:t.list.map((function(e){return c.a.createElement(la,{key:e.date,payrollRow:e,colsToDisplay:i,colSize:E})})),c.a.createElement(d.C,{className:"list-footer"},c.a.createElement(d.g,{size:E},"TOTAL"),c.a.createElement(d.g,{size:E,hidden:(i&ca.Regular)!==ca.Regular},c.a.createElement(ra,{time:null===t||void 0===t?void 0:t.totalRegular,locSettings:a,fontColor:"black"})),c.a.createElement(d.g,{size:E,hidden:(i&ca.DailyOvertime)!==ca.DailyOvertime},c.a.createElement(ra,{time:null===t||void 0===t?void 0:t.totalDailyOvertime,locSettings:a,fontColor:"red"})),c.a.createElement(d.g,{size:E,hidden:(i&ca.WeeklyOvertime)!==ca.WeeklyOvertime},c.a.createElement(ra,{time:null===t||void 0===t?void 0:t.totalWeeklyOvertime,locSettings:a,fontColor:"red"})),c.a.createElement(d.g,{size:E,hidden:(i&ca.Special)!==ca.Special},c.a.createElement(ra,{time:null===t||void 0===t?void 0:t.totalSpecial,locSettings:a,fontColor:"black"})),c.a.createElement(d.g,{size:E,hidden:(i&ca.Absent)!==ca.Absent},c.a.createElement(ra,{time:null===t||void 0===t?void 0:t.totalAbsent,locSettings:a,fontColor:"black"})))))},sa=function(e){var t=e.date,n=c.a.useContext(oe).user,a=c.a.useContext(Le).auth,r=Object(o.useState)(null),l=Object(p.a)(r,2),i=l[0],s=l[1],u=Object(o.useState)(null),m=Object(p.a)(u,2),E=m[0],f=m[1],v=Object(o.useState)(null),h=Object(p.a)(v,2),g=h[0],b=h[1],y=Object(o.useState)(null),O=Object(p.a)(y,2),k=O[0],j=O[1],C=ie(),I=Ht((function(e){S(e)}));function S(e){na.getPayPeriodDateForEmployee(n,a.locations[0].id,i).then((function(t){t.error?C.showAlert("Error","Could not retrieve Payroll data: "+t.message,(function(){})):(f(Object(We.a)(t.start)),b(Object(We.a)(t.end)),j(t),e&&e.detail.complete())}))}Object(o.useEffect)((function(){var e=t;null===t&&(e=new Date),s(e)}),[t]),Object(o.useEffect)((function(){null!=i&&S()}),[i]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(ta,{startDate:E,endDate:g,onNextPayPeriod:function(){s(Object(Ke.a)(g,1))},onPrevPayPeriod:function(){s(Object(Ke.a)(E,-1))}}),c.a.createElement(d.h,null,I.ionicRefresherJsx,a&&a.locations&&a.locations.length>0&&c.a.createElement(ia,{payrollData:k}),C.alertBoxJsx))},ua=function(e){var t=e.authItems,n=e.oneLine,a=e.dailyNote;return a?c.a.createElement("button",{className:"card daily-note"},c.a.createElement("div",{className:"event-color-col"}),c.a.createElement("div",{className:"card-second-col"},c.a.createElement("div",{className:"dept-position-row"},function(e,t){var n="";return t.locations.length>=1&&(n=t.locations.filter((function(t){return t.id===e.LocationId}))[0].abbr+"/"),-1===e.DepartmentId?n+"All Departments":n+e.DepartmentName}(a,t)),c.a.createElement("div",{className:n?"note-text-row-oneline":"note-text-row"},a.Notes))):c.a.createElement("div",null)},da={1:"#9CBA6A",2:"#BFBFBF",3:"#FFAD00",4:"#C41A26",6:"#677A46",7:"#FFAD00"},ma={1:{color:"black"},2:{color:"#C41A26"},4:{color:"#BCBCBC"}};var pa=function(e){var t=e.event,n=e.locations,a=e.onEdit,r=Object(o.useContext)(Le).auth;if(!t||!r||!r.locations||0===r.locations.length)return c.a.createElement("div",null);var l,i=new Date(9e3,1,1),s=t.EventTypeId===fe.Clock&&t.EventStatusId===ve.Approved&&t.IsClockedIn,u=t.EventTypeId===fe.Clock&&t.EventStatusId===ve.Approved&&t.EventBreaks.filter((function(e){return!e.BreakEnd||e.BreakEnd>i})).length>0,m=ma[t.EventStatusId],p=s&&u?E.h:E.w,f=s?c.a.createElement("div",{className:"time-row"},c.a.createElement(d.m,{icon:p}),c.a.createElement("span",{style:m},(l=t,Object(Ye.a)(Object(We.a)(l.EventStart),"h:mmaaa").replace("M","")))," ",it(t.EventTypeId===fe.Absent?t.Time:t.EventDuration)," "):c.a.createElement("div",{className:"time-row"},c.a.createElement("span",{style:m},function(e){var t=Object(Ye.a)(Object(We.a)(e.EventStart),"h:mmaaa").replace("M",""),n=Object(Ye.a)(Object(We.a)(e.EventEnd),"h:mmaaa").replace("M","");return"".concat(t," - ").concat(n)}(t))," ",it(t.EventDuration)," "),v=t.Tag?" ~"+t.Tag:"",h={borderLeft:"7px solid ".concat(da[t.EventTypeId]," ")};return c.a.createElement("button",{onClick:function(){var e=It(t.EventTypeId,t.EventStatusId,t.EmployeeId,t.EventStart,t.EventEnd,t.LocationId,t.DepartmentId,t.PositionId,t.IsConfirmed,r);null!==e&&a(t,e)},className:"card"},c.a.createElement("div",{className:"card-second-col",style:h},f,c.a.createElement("div",{className:"dept-position-row"},function(e,t){var n=e.filter((function(e){return e.id===t.LocationId}))[0],a=e.filter((function(e){return e.departments.filter((function(e){return e.positions.filter((function(e){return e.hasPosition}))}))})).length>1,r=!!a||n.departments.filter((function(e){return e.positions.filter((function(e){return e.hasPosition}))})).length>1,o="";return a&&(t.AbbreviatedLocationName?o=t.AbbreviatedLocationName+"/":t.LocationAbbreviation&&(o=t.LocationAbbreviation+"/")),r&&(t.AbbreviatedDepartmentName?o+=t.AbbreviatedDepartmentName+"/":t.DepartmentAbbreviation&&(o+=t.DepartmentAbbreviation+"/")),o+=t.PositionName}(n,t)," ",v),t.EventBreaks&&t.EventBreaks.map((function(e){return c.a.createElement("div",{key:e.BreakStart,className:"break-div"},"(B) ",ut(e))}))))},Ea=function(){return c.a.createElement("button",{className:"card"},c.a.createElement("div",{style:{paddingLeft:"20px",paddingRight:"2px"}},c.a.createElement(Rn.a,{width:5,height:40})),c.a.createElement("div",{className:"card-second-col"},c.a.createElement(Rn.a,{width:150}),c.a.createElement("div",{className:"dept-position-row"},c.a.createElement(Rn.a,{width:150}))))},fa=function(e){var t=e.refreshToggle,n=e.onUpdate,a=Object(o.useState)(U),r=Object(p.a)(a,2),l=r[0],i=r[1],s=Ht((function(e){V(e)})),u=c.a.useContext(oe).user,m=ie(),E=Object(o.useState)(!1),f=Object(p.a)(E,2),v=f[0],h=f[1],g=Object(o.useState)(null),b=Object(p.a)(g,2),y=b[0],O=b[1],k=Object(o.useState)(null),j=Object(p.a)(k,2),C=j[0],I=j[1],S=Object(o.useState)(On),T=Object(p.a)(S,2),N=T[0],D=T[1],x=Object(o.useState)(!1),A=Object(p.a)(x,2),w=A[0],M=A[1],R=Object(o.useState)(!1),P=Object(p.a)(R,2),L=P[0],F=P[1],B=Object(o.useContext)(Le).auth;Object(d.W)((function(){F(!0)})),Object(d.X)((function(){F(!1)})),Ln((function(){V()}),L&&!v,W(u).refreshScheduleTimer);var z=function(e,t){O(e.ScheduleEventId),I(t),D(hn(B,e)),h(!0)};function V(e){try{me.getHomePageData(u).then((function(t){console.log("ClockTodayTab.getData: got homepage data"),i(t),M(!1),e&&(e.detail.complete(),n())}))}catch(e){console.log("Error in ClockTodayTab.getData: "+e.message)}}Object(o.useEffect)((function(){u&&u.isLoggedin&&(M(!0),V(void 0))}),[t]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(d.h,{className:"outer-content"},s.ionicRefresherJsx,c.a.createElement(d.r,{className:"todaylist",lines:"none"},c.a.createElement(d.s,{className:"list-header",mode:"ios"},c.a.createElement(d.p,{className:"label-list-header",mode:"ios"},st(new Date))),w&&(l.dailyNotes&&l.dailyNotes.length>0||l.currentEvents&&l.currentEvents.length>0)&&c.a.createElement(d.H,{className:"center",name:"dots"}),w&&(!l.dailyNotes||0===l.dailyNotes.length||!l.currentEvents||0===l.currentEvents.length)&&c.a.createElement(c.a.Fragment,null,c.a.createElement(Ea,null),c.a.createElement(Ea,null)),l.dailyNotes&&l.dailyNotes.map((function(e){return c.a.createElement(d.o,{key:e.DailyNoteId},c.a.createElement(ua,{authItems:l.auth,oneLine:!1,dailyNote:e}))})),l.currentEvents.map((function(e){return c.a.createElement(d.o,{key:e.ScheduleEventId},c.a.createElement(pa,{onEdit:z,locations:l.auth.locations,event:e}))})))),c.a.createElement(d.x,{isOpen:v,onDidDismiss:function(){return h(!1)}},c.a.createElement(wn,{isOpen:v,auth:l.auth,onCancelModal:function(){return h(!1)},onDismissModal:function(){return V(void 0),void h(!1)},scheduleEventId:y,eventEditAuth:C,initialEvent:N})),m.alertBoxJsx)},va=function(){var e=Object(o.useState)("today"),t=Object(p.a)(e,2),n=t[0],a=t[1],r=Object(o.useState)(!1),l=Object(p.a)(r,2),i=l[0],s=l[1],u=Object(o.useState)(!1),m=Object(p.a)(u,2),E=m[0],f=m[1];return c.a.createElement(d.y,null,c.a.createElement(d.l,{className:"ion-no-border"},c.a.createElement(d.R,{mode:"md"},c.a.createElement(d.e,{slot:"start"},c.a.createElement(d.v,null)),c.a.createElement(d.O,{slot:"start"},"Clock"))),c.a.createElement(d.D,{mode:"md",onIonChange:function(e){return t=e.detail.value,void a(t);var t}},c.a.createElement(d.E,{mode:"md",value:"today"},"TODAY"),c.a.createElement(d.E,{mode:"md",value:"pay-periods"},"PAY PERIOD")),"today"===n&&c.a.createElement(fa,{refreshToggle:i,onUpdate:function(){console.log("onTodayPanelUpdate"),f(!E)}}),"pay-periods"===n&&c.a.createElement(sa,{date:null}),c.a.createElement(d.j,null,"today"===n&&c.a.createElement(ea,{refreshToggle:E,onUpdate:function(){s(!i)}})))},ha=function(e){var t=e.message,n=e.onMessageClick;if(!t)return c.a.createElement("div",null);var a=t.isViewed?"normal":"bold";return c.a.createElement("button",{className:"message",onClick:n},c.a.createElement("div",{className:"top-line"},c.a.createElement("span",{className:"subject",style:{fontWeight:a}},t.isPinned&&c.a.createElement(d.m,{icon:E.g,style:{color:"gray"}}),t.subject),c.a.createElement("span",{className:"time"},function(e){var t=Object(We.a)(e),n=new Date;return Object(Ge.a)(t)?Object(Ye.a)(t,"h:mmaaa").replace("M",""):Object(Je.a)(n,t)<7?Object(Ye.a)(t,"EEE"):Object(He.a)(t,n)?Object(Ye.a)(t,"MMM d"):Object(Ye.a)(t,"M/d/yyyy")}(t.deliveryDateTime)," ")),c.a.createElement("div",{className:"bottom-line"},t.previewLine))},ga=function(e){var t=e.onDismissModal,n=e.onCancelModal,a=e.filterData,r=Object(o.useState)({msgTypeIds:a.msgTypes?a.msgTypes.map((function(e){return e.messageTypeId})):[],employeeId:-1}),l=Object(p.a)(r,2),i=l[0],s=l[1],u=function(){n()};return c.a.createElement(c.a.Fragment,null,c.a.createElement(d.l,{className:"ion-no-border"},c.a.createElement(d.R,null,c.a.createElement(d.e,{slot:"start"},c.a.createElement(d.d,{onClick:u},c.a.createElement(d.m,{icon:E.c,mode:"md",slot:"icon-only"}))),c.a.createElement(d.O,null,"Filter"),c.a.createElement(d.e,{slot:"end"},c.a.createElement(d.d,{onClick:function(){s({msgTypeIds:a.msgTypes.map((function(e){return e.messageTypeId})),employeeId:-1})}},"RESET ALL")))),c.a.createElement(d.h,{class:"outer-content"},c.a.createElement(d.o,null,c.a.createElement(d.p,null,"From"),c.a.createElement(d.F,{value:i.employeeId,onIonChange:function(e){return s(Object(f.a)({},i,{employeeId:e.detail.value}))},interface:"action-sheet"},c.a.createElement(d.G,{key:-1,value:-1},"EVERYONE"),a&&a.employees&&a.employees.map((function(e){return c.a.createElement(d.G,{key:e.employeeId,value:e.employeeId},e.name)})))),c.a.createElement(d.o,null,c.a.createElement(d.p,null,"Message Types")),a.msgTypes&&c.a.createElement(se,{list:a.msgTypes.map((function(e){return{id:e.messageTypeId,name:e.name,description:""}})),selected:a.msgTypes.filter((function(e){return i.msgTypeIds.includes(e.messageTypeId)})).map((function(e){return{id:e.messageTypeId,name:e.name,description:""}})),selectionChanged:function(e){s(Object(f.a)({},i,{msgTypeIds:e.map((function(e){return e.id}))}))}})),c.a.createElement(d.j,null,c.a.createElement(d.d,{className:"apply-button",expand:"block",onClick:function(){t(i)}},"APPLY FILTER"),c.a.createElement(d.d,{className:"apply-button",expand:"block",onClick:u,color:"tertiary"},"BACK")))},ba=new B;[{id:1,typeName:"CoverRequestMessage",description:"Cover-Request"},{id:2,typeName:"CoverApprovedMessage",description:"Cover-Approved"},{id:3,typeName:"DirectCoverRequestMessage",description:"Direct Cover-Request"},{id:5,typeName:"ShiftRequestMessage",description:"Shift-Request"},{id:6,typeName:"ShiftRequestDeniedMessage",description:"Shift-Denied"},{id:10,typeName:"ShiftRequestReceivedMessage",description:"Shift-Request Received"},{id:20,typeName:"NoClockInAlertMessage",description:"No Clock In Alert"},{id:21,typeName:"NoClockOutAlertMessage",description:"No Clock Out Alert"},{id:22,typeName:"LateClockInMessage",description:"Late Clock In Alert"},{id:23,typeName:"EarlyClockOutAlertMessage",description:"Early Clock Out Alert"},{id:50,typeName:"ScheduleEventUpdatedMessage",description:"Schedule Event Updated"},{id:60,typeName:"PublishedScheduleUpdatedMessage",description:"Published Schedule Updated"},{id:80,typeName:"PasswordRecoveryMessage",description:"Password Recovery"},{id:81,typeName:"VerifyCellPhoneMessage",description:"Verify Cell Phone"},{id:82,typeName:"VerifyCellPhoneCompleteMessage",description:"Verify Cell Phone Completed"},{id:83,typeName:"VerifyEmailMessage",description:"Verify Email"},{id:100,typeName:"CustomMessage",description:"Custom Messages"},{id:101,typeName:"WeeklyScheduleForEmployeeMessage",description:"Employee Weekly Schedule"},{id:555,typeName:"WelcomeMessage",description:"Welcome"},{id:603,typeName:"UpdatePaymentInformationMessage",description:"Update Payment Information"},{id:700,typeName:"UpgradeSubscriptionMessage",description:"Upgrade Subscription (to Orbital)"},{id:701,typeName:"FailedSignupMessage",description:"Failed Signup"},{id:702,typeName:"GenericErrorMessage",description:"Error Message"},{id:704,typeName:"SignupMessage",description:"Signup Completed"},{id:705,typeName:"DatesOutOfSyncMessage",description:"Dates Out of Sync"},{id:708,typeName:"CancelSubscriptionMessage",description:"Canceled Subscription  "}].map((function(e){return ba.add(""+e.id,e)}));var ya={getUserMessage:function(){var e=Object(g.a)(h.a.mark((function e(t,n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.get(t,"api/v2/employee/messages/"+n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),getUserMessages:function(){var e=Object(g.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.get(t,"api/v2/employee/messages");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getReadCount:function(){var e=Object(g.a)(h.a.mark((function e(t,n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.get(t,"api/v1/employee/messages/"+n+"/readCount");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),setIsPinned:function(){var e=Object(g.a)(h.a.mark((function e(t,n,a){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.post(t,"api/v1/employee/messages/"+n+"/togglePin",{isPinned:a});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),setIsViewed:function(){var e=Object(g.a)(h.a.mark((function e(t,n,a){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.post(t,"api/v1/employee/messages/"+n+"/toggleView",{isViewed:a});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),deleteMessage:function(){var e=Object(g.a)(h.a.mark((function e(t,n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.del(t,"api/v1/employee/messages/"+n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),getUnreadCount:function(){var e=Object(g.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isLoggedin){e.next=2;break}return e.abrupt("return",0);case 2:return e.next=4,$.get(t,"api/v2/employee/messages/unreadCount");case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),sendMessage:function(){var e=Object(g.a)(h.a.mark((function e(t,n,a,r,o){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.post(t,"api/v2/employee/messages/send",{locId:n,channel:a,empIds:r,text:o});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n,a,r,o){return e.apply(this,arguments)}}()},Oa=c.a.createContext({unreadMessagesCount:0,refreshCount:function(){}}),ka=function(e){var t=Object(o.useContext)(oe).user,n=Object(o.useState)({unreadMessagesCount:0}),a=Object(p.a)(n,2),r=a[0],l=a[1];function i(){t.isLoggedin&&ya.getUnreadCount(t).then((function(e){e!==r.unreadMessagesCount&&l({unreadMessagesCount:e})}))}return Object(o.useEffect)((function(){t.isLoggedin&&i()}),[t.isLoggedin]),Ln((function(){i()}),!0,W(t).checkUnreadMessageCountTimer),c.a.createElement(Oa.Provider,{value:{refreshCount:function(){i()},unreadMessagesCount:r.unreadMessagesCount}},e.children)},ja=function(e){var t=e.message,n=e.onCloseModal,a=e.updateMessages,r=ie(),l=Xn(),i=c.a.useContext(oe).user,s=c.a.useContext(Le).auth,u=Object(o.useState)(null),m=Object(p.a)(u,2),f=m[0],v=m[1],h=Object(o.useState)(null),g=Object(p.a)(h,2),b=g[0],y=g[1],O=Object(o.useState)(null),k=Object(p.a)(O,2),j=k[0],C=k[1],I=Object(o.useState)(null),S=Object(p.a)(I,2),T=S[0],N=S[1],D=Object(o.useState)(!1),x=Object(p.a)(D,2),A=x[0],w=x[1],M=Object(o.useContext)(Oa).refreshCount;Object(o.useEffect)((function(){t&&(t.scheduleEventId?yt.getScheduleEvent(i,t.scheduleEventId).then((function(e){if(e){v(e);var t=It(e.EventTypeId,e.EventStatusId,e.EmployeeId,e.EventStart,e.EventEnd,e.LocationId,e.DepartmentId,e.PositionId,null!==e.ConfirmedBy&&void 0!==e.ConfirmedBy&&e.ConfirmedBy,s);y(t)}})):f&&(v(null),N(null)),ya.getReadCount(i,t.messageId).then((function(e){C(e)})),t.isViewed||ya.setIsViewed(i,t.messageId,!0).then((function(){a({type:"UPDATE-VIEWED",msgId:t.messageId,isViewed:!0})})),w(t.isPinned))}),[null===t||void 0===t?void 0:t.messageId]);var R,P=function(e){(null===t||void 0===t?void 0:t.isViewed)||M(),n(e)};return t&&s&&s.locations&&0!==s.locations.length?c.a.createElement(c.a.Fragment,null,c.a.createElement(d.l,{className:"ion-no-border"},c.a.createElement(d.R,null,c.a.createElement(d.e,{slot:"start"},c.a.createElement(d.d,{onClick:function(){P(null)}},c.a.createElement(d.m,{icon:E.c,mode:"md",slot:"icon-only"}))),c.a.createElement(d.e,{slot:"end"},c.a.createElement(d.d,{onClick:function(){!function(){var e=!A;ya.setIsPinned(i,t.messageId,e).then((function(){w(e),a({type:"UPDATE-PINNED",msgId:t.messageId,isPinned:e})}))}()}},c.a.createElement(d.m,{icon:E.g,style:A?{color:"black"}:{color:"lightgray"}})),c.a.createElement(d.d,{onClick:function(){l.showDialog("Delete this message?",(function(){ya.deleteMessage(i,t.messageId).then((function(){a({type:"DELETE",msgId:t.messageId}),P("Message Deleted")}))}),(function(){}))}},c.a.createElement(d.m,{icon:E.y}))))),c.a.createElement(d.h,{class:"outer-contentMessage"},c.a.createElement(d.k,null,c.a.createElement(d.C,{class:"messageIonRow-header"},c.a.createElement(d.g,{class:"messageHeaderSubject",size:"12"},t.subject),c.a.createElement(d.g,{class:"messageHeaderDetails",size:"12"},"From: ",t.fromEmployeeFirstName," ",t.fromEmployeeLastName),c.a.createElement(d.g,{class:"messageHeaderDetails",size:"9"},(R=t.deliveryDateTime,Object(Ye.a)(Object(We.a)(R),"M/d EEE h:mmaa").replace("M",""))),c.a.createElement(d.g,{class:"readCounter",size:"3"},null!==j&&c.a.createElement("span",null,j," Read"))),c.a.createElement("div",null),c.a.createElement(d.C,{class:"messageIonRow-content"},c.a.createElement(d.g,{class:"messageBlock",size:"12"},c.a.createElement("div",{dangerouslySetInnerHTML:{__html:null===t||void 0===t?void 0:t.messageText}}))),null!==T&&c.a.createElement(d.C,null,c.a.createElement(d.g,{size:"12"},T))),r.alertBoxJsx,l.dialogJsx),c.a.createElement(d.j,null,null!==f&&c.a.createElement(Tn,{auth:s,eventEnd:f.EventEnd,eventType:f.EventTypeId,eventStatus:f.EventStatusId,eventEmployeeId:f.EmployeeId,eventPositionId:f.PositionId,scheduleEventId:f.ScheduleEventId,locationId:f.LocationId,update:function(){},cancelEditModal:P,eventEditAuth:b,setUsageText:N}),c.a.createElement(d.d,{className:"apply-button",expand:"block",onClick:function(){P(null)},color:"tertiary"},"BACK"))):c.a.createElement(c.a.Fragment,null,c.a.createElement("div",null,"Loading"),r.alertBoxJsx)};function Ca(e,t){var n=be(e,t);if(null===n)throw new Error("Can't find location");return{location:n,department:null,position:null}}var Ia=function(e){var t,n=e.currentPosition,r=e.onPositionUpdate,l=Object(o.useContext)(Le).auth,i=Object(o.useState)(n),s=Object(p.a)(i,2),u=s[0],m=s[1],E=function(e){if(void 0!==e){var t=function(e,t,n){if(null===n)return Ca(e,t.location.id);var a=t.location.departments.filter((function(e){return e.id===n}))[0];return{location:t.location,department:a,position:null}}(l,u,e);m(t),r(t)}};return l&&l.locations&&0!==l.locations.length?c.a.createElement(c.a.Fragment,null,c.a.createElement(d.o,null,c.a.createElement(d.p,null,"Location"),c.a.createElement(d.F,{interface:"popover",style:{maxWidth:"100%"},value:u.location.id,onIonChange:function(e){return function(e){if(e){var t=Ca(l,e);m(t),r(t)}}(e.detail.value)}},l.locations.filter((function(e){return function(e,t){return e.role===a.LocationAdmin||e.role===a.BusinessAdmin||e.role!==a.Employee&&void 0!==t.departments.find((function(e){return e.isDeptAdmin}))}(l,e)})).map((function(e){return c.a.createElement(d.G,{key:e.id,value:e.id},e.name)})))),c.a.createElement(d.o,null,c.a.createElement(d.p,null,"Department"),c.a.createElement(d.F,{interface:"popover",style:{maxWidth:"100%"},value:null===u.department?null:u.department.id,onIonChange:function(e){return E(e.detail.value)}},c.a.createElement(d.G,{key:-1,value:null},"All Departments"),u.location.departments&&u.location.departments.filter((function(e){return Ne(l,e.id)})).map((function(e){return c.a.createElement(d.G,{key:e.id,value:e.id},e.name)})))),c.a.createElement(d.o,null,c.a.createElement(d.p,null,"Position"),c.a.createElement(d.F,{interface:"popover",style:{maxWidth:"100%"},value:null===u.position?null:u.position.id,onIonChange:function(e){return function(e){if(void 0!==e){var t=function(e,t,n){if(null===n)return{location:t.location,department:t.department,position:null};var a=t.department.positions.filter((function(e){return e.id===n}))[0];return{location:t.location,department:t.department,position:a}}(0,u,e);m(t),r(t)}}(e.detail.value)}},c.a.createElement(d.G,{key:-1,value:null},"All Positions"),(t=u,null!==t.department?t.department.positions:t.location.departments.flatMap((function(e){return e.positions}))).map((function(e){return c.a.createElement(d.G,{key:e.id,value:e.id},null===u.department?ye(l,e.id).abbr+"/"+e.name:e.name)}))))):c.a.createElement(c.a.Fragment,null,c.a.createElement("div",null,"Loading"))},Sa=c.a.createElement(d.m,{icon:E.r}),Ta=c.a.createElement(d.m,{icon:E.t}),Na=c.a.createElement(d.m,{icon:E.s});function Da(e,t){switch(t){case-1:return e.hasEmail||e.hasText||e.hasPush;case 1:return e.hasEmail;case 2:return e.hasText;case 3:return e.hasPush;default:return!1}}var xa=function(e){var t=e.onOk,n=e.employeeList,a=e.selectedEmployeeList,r=e.channel,l=Object(o.useState)([]),i=Object(p.a)(l,2),s=i[0],u=i[1],m=Object(o.useState)(!1),E=Object(p.a)(m,2),v=E[0],h=E[1];return Object(o.useEffect)((function(){var e=n.map((function(e){return{id:e.id,name:e.name,hasEmail:e.hasEmail,hasText:e.hasText,hasPush:e.hasPush,isChecked:a.some((function(t){return t.id===e.id}))}}));u(e)}),[n,a]),c.a.createElement(c.a.Fragment,null,c.a.createElement(d.l,{mode:"ios"},c.a.createElement(d.R,null,c.a.createElement(d.O,null,"Employees"))),c.a.createElement(d.h,null,c.a.createElement(d.k,null,c.a.createElement(d.C,{key:-1},c.a.createElement(d.g,{size:"3"},c.a.createElement(d.f,{className:"checkbox",checked:v,onClick:function(){var e=!v,t=s.map((function(t){return Da(t,r)?Object(f.a)({},t,{isChecked:e}):Object(f.a)({},t,{isChecked:!1})}));u(t),h(e)}})),c.a.createElement(d.g,{className:"label",size:"6"},"Select All"),c.a.createElement(d.g,{size:"1"},Sa),c.a.createElement(d.g,{size:"1"},Ta),c.a.createElement(d.g,{size:"1"},Na)),s.map((function(e){return c.a.createElement(d.C,{key:e.id},c.a.createElement(d.g,{size:"3"},c.a.createElement(d.f,{className:"checkbox",checked:e.isChecked,disabled:!Da(e,r),onClick:function(){!function(e){var t=0,a=s.map((function(n){return Da(n,r)?n.isChecked?n.id===e?Object(f.a)({},n,{isChecked:!1}):(t++,Object(f.a)({},n,{isChecked:Da(n,r)})):n.id===e?(t++,Object(f.a)({},n,{isChecked:Da(n,r)})):Object(f.a)({},n,{isChecked:!1}):Object(f.a)({},n,{isChecked:!1})})),o=n.filter((function(e){return Da(e,r)})).length;h(t===o),u(a)}(e.id)}})),c.a.createElement(d.g,{className:"label",size:"6"},e.name),c.a.createElement(d.g,{size:"1"},e.hasEmail&&Sa),c.a.createElement(d.g,{size:"1"},e.hasText&&Ta),c.a.createElement(d.g,{size:"1"},e.hasText&&Na))})))),c.a.createElement(d.j,null,c.a.createElement(d.d,{expand:"block",color:"secondary",onClick:function(){t(s.filter((function(e){return e.isChecked})))}},"OK")))},Aa=[{id:-1,text:"All Channels"},{id:1,text:"Email"},{id:2,text:"Text"},{id:3,text:"Push Notification"}];var wa=function(e){var t=e.onUpdate,n=Object(o.useContext)(oe).user,r=Object(o.useContext)(Le).auth,l=Object(o.useState)("All"),i=Object(p.a)(l,2),s=i[0],u=i[1],m=Object(o.useState)(function(e){for(var t=0;t<e.locations.length;t++){var n=e.locations[t];if(n.adminAllDepts)return{location:n,department:null,position:null};for(var a=0;a<n.departments.length;a++){var r=n.departments[a];if(r.isDeptAdmin)return{location:n,department:r,position:null}}}throw new Error("Could not find a department where this user could send messages")}(r)),E=Object(p.a)(m,2),f=E[0],v=E[1],h=Object(o.useState)(-1),g=Object(p.a)(h,2),b=g[0],y=g[1],O=Object(o.useState)([]),k=Object(p.a)(O,2),j=k[0],C=k[1],I=Object(o.useState)([]),S=Object(p.a)(I,2),T=S[0],N=S[1],D=Object(o.useState)(!1),x=Object(p.a)(D,2),A=x[0],w=x[1],M=$t("Retreiving employee list");function R(e,t,a,r,o){M.setShowLoading(!0),Xt.getEmployeeListForCommunication(n,e,t,a,r,o).then((function(e){N(e)})).finally((function(){M.setShowLoading(!1)}))}var P;return Object(o.useEffect)((function(){r.locations&&r.locations.length>0&&R(r.locations[0].id,-1,-1,0,"All")}),[r.locations]),r&&r.locations&&0!==r.locations.length?c.a.createElement(c.a.Fragment,null,c.a.createElement(d.o,null,c.a.createElement(d.p,null,"Role"),c.a.createElement(d.F,{interface:"popover",value:s,onIonChange:function(e){var t;(t=e.detail.value)!==s&&(u(t),C([]),R(f.location.id,null===f.department?-1:f.department.id,null===f.position?-1:f.position.id,b,t))}},c.a.createElement(d.G,{value:"All",key:-1},"All"),c.a.createElement(d.G,{value:a.BusinessAdmin,key:2},"Business Admin"),c.a.createElement(d.G,{value:a.LocationAdmin,key:3},"Location Admin"),c.a.createElement(d.G,{value:a.Admin,key:4},"Admin"),c.a.createElement(d.G,{value:a.Employee,key:5},"Employee"))),c.a.createElement(Ia,{currentPosition:f,onPositionUpdate:function(e){v(e),C([]),R(e.location.id,null===e.department?-1:e.department.id,null===e.position?-1:e.position.id,b,s)}}),c.a.createElement(d.o,null,c.a.createElement(d.p,null,"Send To"),c.a.createElement(d.F,{interface:"popover",value:b,onIonChange:function(e){var t;null!==(t=e.detail.value)&&void 0!==t&&t!==b&&(C([]),y(t))}},Aa.map((function(e){return c.a.createElement(d.G,{key:e.id,value:e.id},e.text)})))),c.a.createElement(d.o,null,c.a.createElement(d.p,null,"Employees (",T.filter((function(e){return Da(e,b)})).length," ","/ ",T.length,")"),c.a.createElement(d.d,{className:"button-selectEmployees-messages",onClick:function(){return w(!0)}},0===(P=j).length?"None Selected":1===P.length?P[0].name:"".concat(P.length," Selected"))),M.showLoadingJsx,c.a.createElement(d.x,{cssClass:"mini-modal add-break-modal",onDidDismiss:function(){return w(!1)},isOpen:A},c.a.createElement(xa,{channel:b,onOk:function(e){C(e),w(!1),t(e,f.location.id,b)},employeeList:T,selectedEmployeeList:j}))):c.a.createElement(c.a.Fragment,null,c.a.createElement("div",null,"Loading"))},Ma=function(e){var t=e.onCloseModal,n=e.isOpen,a=Object(o.useContext)(oe).user,r=Object(o.useContext)(Le).auth,l=Object(o.useState)(""),i=Object(p.a)(l,2),s=i[0],u=i[1],m=Object(o.useState)([]),f=Object(p.a)(m,2),v=f[0],h=f[1],g=Object(o.useState)(0),b=Object(p.a)(g,2),y=b[0],O=b[1],k=Object(o.useState)(0),j=Object(p.a)(k,2),C=j[0],I=j[1],S=$t("Sending"),T=ie();return n&&r&&r.locations&&0!==r.locations.length?c.a.createElement(c.a.Fragment,null,c.a.createElement(d.l,{className:"ion-no-border"},c.a.createElement(d.R,null,c.a.createElement(d.e,{slot:"start"},c.a.createElement(d.d,{onClick:function(){return t("")}},c.a.createElement(d.m,{icon:E.c,mode:"md",slot:"icon-only"}))),c.a.createElement(d.O,{className:"IonTitle--DailyNote"},"New Message"))),c.a.createElement(d.h,{class:"edit-daily-modal-content"},c.a.createElement(d.r,null,c.a.createElement(wa,{onUpdate:function(e,t,n){h(e.map((function(e){return e.id}))),t!==y&&O(t),n!==C&&I(n)}}),c.a.createElement(d.o,null,c.a.createElement(d.N,{value:s,placeholder:"Enter Message",rows:5,spellcheck:!0,wrap:"hard",debounce:250,onIonChange:function(e){var t;null!==(t=e.detail.value)&&void 0!==t&&t!==s&&u(t)}}))),S.showLoadingJsx),c.a.createElement(d.j,null,c.a.createElement(d.d,{className:"apply-button",expand:"block",onClick:function(){S.setShowLoading(!0),ya.sendMessage(a,y,C,v,s).then((function(e){S.setShowLoading(!1),e.error?T.showAlert("Could not send","Could not send message. "+e.message,(function(){})):1===v.length?t("Message sent"):t("Messages sent")}))},disabled:0===v.length||0===s.length||S.showLoading},"Send"))):c.a.createElement("div",null,"Loading")},Ra=[],Pa=function(e,t){switch(console.log("REDUCER: ACTION =",t.type),t.type){case"LOADED-FROM-API":return t.data;case"CLEAR":return[];case"UPDATE-PINNED":return e.map((function(e){return e.messageId===t.msgId?Object(f.a)({},e,{isPinned:t.isPinned}):e}));case"UPDATE-VIEWED":return e.map((function(e){return e.messageId===t.msgId?Object(f.a)({},e,{isViewed:t.isViewed}):e}));case"DELETE":return e.filter((function(e){return e.messageId!==t.msgId}))}},Ua=function(e){var t=e.match,n=e.history,a=c.a.useContext(oe).user,r=c.a.useContext(Le),l=r.auth,i=r.refreshAuth,s=c.a.useContext(Oa).unreadMessagesCount;Object(o.useEffect)((function(){l&&l.locations&&0!==l.locations.length||i(!1,a)}),[l]);var u=Ht((function(e){J(e)})),m=Object(o.useState)(!1),f=Object(p.a)(m,2),v=f[0],h=f[1],g=Object(o.useState)(!0),b=Object(p.a)(g,2),y=b[0],O=b[1],k=Object(o.useReducer)(Pa,[]),j=Object(p.a)(k,2),C=j[0],I=j[1],S=Object(o.useState)(Ra),T=Object(p.a)(S,2),N=T[0],D=T[1],x=Object(o.useState)({}),A=Object(p.a)(x,2),w=A[0],M=A[1],R=Object(o.useState)({}),P=Object(p.a)(R,2),U=P[0],L=P[1],F=Object(o.useState)(null),B=Object(p.a)(F,2),z=B[0],V=B[1],_=Lt(),q=Object(o.useState)(!1),W=Object(p.a)(q,2),G=W[0],Y=W[1];Object(o.useEffect)((function(){if(a&&a.isLoggedin&&l&&l.locations&&l.locations.length>0)return J(void 0)}),[a.isLoggedin,s,l]),Object(o.useEffect)((function(){H(U,C)}),[C]),Object(o.useEffect)((function(){t.params.messageId&&null===z&&ya.getUserMessage(a,parseInt(t.params.messageId)).then((function(e){e||(_.showToast("The requested message has been removed"),n.push("/tabs/messages/")),V(e)}))}),[t.params.messageId]);var J=function(e){var t=!0;return 0===C.length&&!1===y&&O(!0),ya.getUserMessages(a).then((function(n){t&&(I({type:"LOADED-FROM-API",data:n}),H(U,n),O(!1),e&&e.detail.complete())})),function(){t=!1}},H=function(e,t){e&&e.msgTypeIds?-1!==e.employeeId?e.msgTypeIds.length>0?D(t.filter((function(t){return t.fromEmployeeId===e.employeeId&&Yt.contains(e.msgTypeIds,t.messageTypeId)}))):D(t.filter((function(t){return t.fromEmployeeId===e.employeeId}))):e.msgTypeIds.length>0?(console.log(e.msgTypeIds),D(t.filter((function(t){return Yt.contains(e.msgTypeIds,t.messageTypeId)})))):D(t):D(t)};return c.a.createElement(d.y,null,c.a.createElement(d.l,{className:"ion-no-border"},c.a.createElement(d.R,{mode:"md"},c.a.createElement(d.e,{slot:"start"},c.a.createElement(d.v,null)),c.a.createElement(d.O,{slot:"start"},"Messages"),c.a.createElement(d.e,{slot:"end"},c.a.createElement(d.d,{hidden:void 0===l.locations.find((function(e){return e.departments.find((function(e){return Ne(l,e.id)}))})),onClick:function(){Y(!0)}},c.a.createElement(d.m,{icon:E.a,mode:"md",slot:"icon-only"})),c.a.createElement(d.d,{onClick:function(){var e=Yt.uniqueObject(C.map((function(e){return{employeeId:e.fromEmployeeId,name:e.fromEmployeeFirstName+" "+e.fromEmployeeLastName}})),(function(e,t){return e.employeeId===t.employeeId})),t=Yt.uniqueObject(C.map((function(e){return{messageTypeId:e.messageTypeId,name:ba.item(String(e.messageTypeId)).description}})),(function(e,t){return e.messageTypeId===t.messageTypeId}));M({msgTypes:t,employees:e}),h(!0)}},c.a.createElement(d.m,{icon:E.n,mode:"ios",slot:"icon-only"}))))),c.a.createElement(d.h,{className:"outer-content"},u.ionicRefresherJsx,y&&c.a.createElement(c.a.Fragment,null,[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21].map((function(e){return c.a.createElement("div",{key:e,style:{margin:"10px 8px"}},c.a.createElement(Rn.a,{width:360,height:45}))}))),!y&&0===N.length&&c.a.createElement("div",{className:"no-messagesOrEvents-text"},"No Messages"),c.a.createElement("div",{className:"message-list"},!y&&N.length>0&&N.filter((function(e){return e.isPinned})).map((function(e){return c.a.createElement(ha,{key:e.messageId,message:e,onMessageClick:function(){return V(e)}})}))),c.a.createElement("div",{className:"message-list"},!y&&N.length>0&&N.filter((function(e){return!e.isPinned})).map((function(e){return c.a.createElement(ha,{key:e.messageId,message:e,onMessageClick:function(){return V(e)}})})))),c.a.createElement(d.x,{isOpen:v},c.a.createElement(ga,{filterData:w,onDismissModal:function(e){L(e),H(e,C),h(!1)},onCancelModal:function(){return h(!1)}})),c.a.createElement(d.x,{isOpen:null!==z},c.a.createElement(ja,{message:z,updateMessages:I,onCloseModal:function(e){V(null),e&&_.showToast(e)}})),c.a.createElement(d.x,{isOpen:G},c.a.createElement(Ma,{onCloseModal:function(e){Y(!1),null!==e&&e.length>0&&_.showToast(e),setTimeout((function(){J()}),4e3)},isOpen:G})),_.simpleToastJsx)},La=function(){var e=Object(o.useContext)(Oa).unreadMessagesCount;return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:e?"hasMessages":"noMessages"},e),c.a.createElement(d.m,{icon:E.l}),c.a.createElement(d.p,null,"Messages"))},Fa=function(){return c.a.createElement(d.L,null,c.a.createElement(d.B,null,c.a.createElement(s.b,{exact:!0,path:"/tabs",to:"/tabs/schedule"}),c.a.createElement(s.c,{path:"/tabs/schedule/:scheduleEventId",render:function(e){return c.a.createElement(Vn,e)}}),c.a.createElement(s.c,{path:"/tabs/schedule",render:function(e){return c.a.createElement(Vn,e)},exact:!0}),c.a.createElement(s.c,{path:"/tabs/messages/:messageId",render:function(e){return c.a.createElement(Ua,e)}}),c.a.createElement(s.c,{path:"/tabs/messages",render:function(e){return c.a.createElement(Ua,e)},exact:!0}),c.a.createElement(s.c,{path:"/tabs/clock",render:function(){return c.a.createElement(va,null)},exact:!0})),c.a.createElement(d.J,{slot:"bottom"},c.a.createElement(d.K,{key:"1",tab:"schedule",href:"/tabs/schedule"},c.a.createElement(d.m,{icon:E.j}),c.a.createElement(d.p,null,"Schedule")),c.a.createElement(d.K,{key:"2",tab:"clock",href:"/tabs/clock"},c.a.createElement(d.m,{icon:E.x}),c.a.createElement(d.p,null,"Clock")),c.a.createElement(d.K,{key:"3",tab:"map",href:"/tabs/messages"},c.a.createElement(La,null))))},Ba=function(){var e=c.a.useContext(oe).user;return e.loading?c.a.createElement("div",null):e.isLoggedin?c.a.createElement(Fa,null):c.a.createElement(s.b,{to:"/login"})},za=function(e){var t=e.history,n=c.a.useContext(oe),a=n.user,r=n.logout,o=c.a.useContext(Le).clearAuth;return Object(d.V)((function(){Promise.all([o(),r()]).then((function(){J("logout",{user:a.username}),console.log("logged out (".concat(a.username,")")),setTimeout((function(){t.push("/login",{direction:"none"}),t.goForward()}),250)}))})),c.a.createElement(d.y,{id:"logout-page"},c.a.createElement(d.h,{className:"login-content"},c.a.createElement("div",{className:"login-logo"},c.a.createElement("img",{className:"logo",src:"assets/img/OS Logo - 4pt Rounded _ 2 Tone Orange.svg",alt:"Orbital Shift Logo"})),c.a.createElement(d.r,{className:"form-list"},c.a.createElement("div",{className:"item"},c.a.createElement("div",{className:"label"},"User")))))},Va=n(74),_a=function(){var e,t=Object(o.useContext)(oe).user,n=Object(o.useContext)(Le),a=n.auth,r=n.refreshAuth;return Object(o.useEffect)((function(){G.settings.hasCapacitor&&Va.a.lock(Va.a.ORIENTATIONS.PORTRAIT).then((function(){console.log("screen locked to portrait")})),console.log("firebase initialized"),N.initializeApp(Y),J("app_render",{vers:G.settings.appVersionString,platform:G.settings.platform})}),[]),Object(o.useEffect)((function(){t.isLoggedin&&!Se(a)&&r(!1,t)}),[t.isLoggedin,a,r,t]),e=t.isLoggedin?t.isLoggedin&&Se(a)?c.a.createElement(c.a.Fragment,null,c.a.createElement(s.c,{path:"/tabs",render:function(e){return c.a.createElement(Ba,e)}}),c.a.createElement(s.c,{path:"/",exact:!0},c.a.createElement(s.b,{to:"/tabs/schedule"}))):c.a.createElement(c.a.Fragment,null,"..."):c.a.createElement(c.a.Fragment,null,c.a.createElement(s.c,{path:"/tabs",render:function(e){return c.a.createElement(Ba,e)}}),c.a.createElement(s.c,{path:"/",exact:!0},c.a.createElement(s.b,{to:"/tabs/schedule"}))),c.a.createElement(d.c,null,c.a.createElement(m.a,null,c.a.createElement(m.a,null,c.a.createElement(d.I,{contentId:"main"},c.a.createElement(de,null),c.a.createElement(d.B,{id:"main"},c.a.createElement(s.c,{path:"/login",render:function(e){return c.a.createElement(qe,e)}}),c.a.createElement(s.c,{path:"/logout",render:function(e){return c.a.createElement(za,e)}}),e)))))},qa=function(){return c.a.createElement(u.a,null,c.a.createElement(ce,null,c.a.createElement(ze,null,c.a.createElement(ka,null,c.a.createElement(_a,null)))))};i.a.render(c.a.createElement(qa,null),document.getElementById("root"))},9:function(e,t,n){}},[[104,7,51]]]);
//# sourceMappingURL=main.9a67e3ad.chunk.js.map