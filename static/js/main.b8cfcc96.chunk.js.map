{"version":3,"sources":["../node_modules/@ionic/core/dist/esm-es5 lazy /^/.*/.entry/.js$/ include: /.entry/.js$/ exclude: /.system/.entry/.js$/ groupOptions: {} namespace object","../node_modules/@ionic/react/node_modules/ionicons/dist/esm-es5 lazy /^/.*/.entry/.js$/ include: /.entry/.js$/ exclude: /.system/.entry/.js$/ groupOptions: {} namespace object","data/dbStore.ts","util/logger.ts","util/KeyedCollection.ts","api/environment.ts","enums/DeviceOperatingSystem.ts","api/OrbitalApiHelper.ts","api/PushNotificationsAPI.ts","util/push-notifications-controller.ts","context/ApplicationUserContext.tsx","hooks/useDialogBox.tsx","components/ToggleListEx.tsx","components/NotificationSettingsModal.tsx","components/Menu.tsx","orbital-interfaces/authorized-items.ts","api/UserAPI.ts","enums/EventType.ts","enums/EventStatus.ts","util/authitems-helper.ts","context/AuthorizedItemsContext.tsx","pages/Login.tsx","util/time-helper.ts","components/EditEvent/EditEventAuthorization.ts","api/ScheduleEventsAPI.ts","orbital-interfaces/EventFilter.ts","components/SchedulePageComponents/WeekChooser.tsx","components/SchedulePageComponents/EventCard.tsx","hooks/useOrbitalDialogBox.tsx","components/SchedulePageComponents/DailyNoteDepartmentSelector.tsx","api/DailyNotesAPI.ts","hooks/useSimpleToast.tsx","components/SchedulePageComponents/EditDailyNoteModal.tsx","components/SchedulePageComponents/DailyNoteCard.tsx","components/SchedulePageComponents/AddDailyNoteButton.tsx","enums/EventGroup.ts","components/SchedulePageComponents/EventListSection.tsx","components/SchedulePageComponents/EventList.tsx","util/event-helper.ts","util/array-helper.ts","components/SchedulePageComponents/ScheduleFilterModal.tsx","hooks/useIonicRefresher.tsx","components/EditEvent/editor/EventTypeStatusEditor.tsx","components/EditEvent/editor/EventPositionEditor.tsx","api/EmployeesAPI.ts","hooks/useShowLoading.tsx","components/EditEvent/editor/EventEmployeeEditor.tsx","enums/RecurrenceType.ts","components/EditEvent/editor/EventStartEndEditor.tsx","components/EditEvent/editor/AddBreakModal.tsx","components/EditEvent/editor/EventBreakEditor.tsx","components/EditEvent/editor/EventTagEditor.tsx","components/EditEvent/editor/EventConfirmEditor.tsx","components/EditEvent/editor/EventIsClockedInEditor.tsx","components/EditEvent/EditEventModalState.ts","enums/RecurrenceUpdateType.ts","components/EditEvent/editor/EventNotesEditor.tsx","components/EditEvent/editor/EventClockoutValueEditor.tsx","api/RequestsAPI.ts","components/EditEvent/editor/EventRequestModal.tsx","components/EditEvent/editor/EventRequestEditor.tsx","components/EditEvent/editor/WeekdayList.tsx","components/EditEvent/editor/RecurringEventSection.tsx","components/EditEvent/RecurrenceUpdateTypeSelector.tsx","components/EditEvent/EditEventModal.tsx","components/SchedulePageComponents/EventCardSkeleton.tsx","components/SchedulePageComponents/NoEventsToShow.tsx","hooks/useInterval.ts","util/scheduleevent-helper.ts","pages/SchedulePage.tsx","enums/ClockInRequirement.ts","components/ClockPageComponents/BreakSelectorModal.tsx","enums/StartBreakResponseCode.ts","enums/EndBreakResponseCode.ts","api/TimeClockAPI.ts","components/ClockPageComponents/ClockoutModal.tsx","components/ClockPageComponents/SwitchPositionOrTagButton.tsx","components/ClockPageComponents/Map.tsx","hooks/useYesOrCancelDialogBox.tsx","components/ClockPageComponents/GeoLocationComponent.tsx","components/ClockPageComponents/ClockPanel.tsx","components/ClockPageComponents/PayrollPeriodChooser.tsx","api/PayrollPeriodAPI.ts","components/ClockPageComponents/PayrollOrbitalTimeItem.tsx","components/ClockPageComponents/PayrollDetailModal.tsx","components/ClockPageComponents/PayrollDetailRow.tsx","components/ClockPageComponents/PayrollDetailList.tsx","components/ClockPageComponents/PayrollPeriodsTab.tsx","components/TodayDailyNoteCard.tsx","components/TodayEventCard.tsx","components/TodayEventCardSkeleton.tsx","components/ClockPageComponents/ClockTodayTab.tsx","pages/ClockPage.tsx","components/MessagesPageComponents/MessageItem.tsx","components/MessagesPageComponents/MessagesFilterModal.tsx","orbital-interfaces/MessageTypes.ts","api/MessageAPI.ts","context/MessagesContext.tsx","components/MessagesPageComponents/ViewMessageModal.tsx","components/MessagesPageComponents/create/PositionSelector.tsx","components/MessagesPageComponents/create/EmployeeSelectorModal.tsx","components/MessagesPageComponents/create/EmployeesSelector.tsx","components/MessagesPageComponents/create/CreateMessageModal.tsx","pages/MessagesPage.tsx","pages/MessagesTabButton.tsx","pages/MainTabs.tsx","components/AuthGate.tsx","pages/Logout.tsx","App.tsx","index.tsx"],"names":["map","webpackAsyncContext","req","__webpack_require__","o","Promise","resolve","then","e","Error","code","ids","id","keys","Object","module","exports","getKeyStore","openDB","upgrade","db","createObjectStore","putUserState","state","a","put","getUserState","get","getAccessToken","access_token","undefined","putAuthItems","auth","getAuthItems","authItems","firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","log","eventName","eventParams","firebase","logEvent","KeyedCollection","items","_count","key","this","hasOwnProperty","value","val","keySet","prop","push","values","defaults","constants","checkUnreadMessageCountTimer","refreshScheduleTimer","refreshTimeclockSettingsTimer","maxStaleAuthItemsInMinutes","name","url","envTypes","environments","et","add","DeviceOperatingSystem","settings","env","versionName","versionCode","revisionHash","buildDate","appVersionString","hasCapacitor","isPlatform","platform","getConstants","user","isLoggedin","item","environment","getApiUrl","endpoint","getUserAndEnvironmentFromInput","input","length","username","envKey","toLowerCase","substring","post","baseUrl","data","console","fetch","method","body","JSON","stringify","headers","Authorization","AppVersion","response","contentType","indexOf","json","results","appVersion","error","putData","dataString","options","del","subscribe","token","operatingSystem","iOS","Android","apiHelper","TokenId","OperatingSystem","unsubscribe","getTypesSelectedByUser","putTypes","typeIds","listTypes","PushNotifications","Plugins","pushEnabled","showMessage","history","createBrowserHistory","forceRefresh","register","addListener","pushApi","notification","MessageId","title","goForward","messageId","INITIAL_APPLICATION_USER","darkMode","loading","latitude","longitude","lastLocationUpdate","isPushEnabled","requestedGeoPermission","refusedGeoPermission","geoPositionOptions","enableHighAccuracy","maximumAge","INITIAL_APPLICATION_USER_CONTEXT","logout","userLoggedIn","u","at","startWatchPosition","callback","clearWatchPosition","s","requestGeoPermission","setRefusedGeoPermission","refused","ApplicationUserContext","React","createContext","ApplicationUserContextProvider","props","useState","userState","internalSetUserState","Capacitor","isPluginAvailable","Geolocation","getCurrentPosition","navigator","geolocation","pos","newState","Date","useEffect","mounted","all","PushController","enabled","currentState","Provider","watchPositionCallBack","position","coords","positionChanged","reason","google","maps","geometry","spherical","computeDistanceBetween","oldPos","LatLng","newPos","distance","errCallback","err","watchId","watchPosition","clearWatch","parseInt","children","useDialogBox","isOpen","setIsOpen","header","message","onDismiss","alertData","setAlertData","showAlert","alertBoxJsx","onDidDismiss","buttons","ToggleListEx","list","selected","selectionChanged","isItemChecked","i","mode","checked","onClick","slice","onAllChanged","toggle","n","includes","newList","newlist","filter","r","itemToggle","NotificationSettingsModal","onDismissModal","useContext","notifications","setNotifications","selectedNotifications","setSelectedNotifications","isSubscribed","responses","className","slot","icon","arrowBackOutline","class","newSelected","Role","Menu","lat","lng","disableMenu","userName","substr","dlg","showNotificationsModal","setShowNotificationsModal","type","disabled","contentId","toUpperCase","auto-hide","button","routerLink","routerDirection","mail","logOut","format","authenticateUser","password","error_description","loggedIn","getHomePageData","getAuthorizedItems","result","TimeFormat","ClockOutValueType","AdminAuthorization","UnscheduledBreakOptions","BreakType","EmployeeSort","initialHomePageData","locations","tags","payrollEvents","employeeId","role","Employee","lastRefresh","currentEvents","nextEvent","dailyNotes","EventType","EventStatus","getLocationFromLocationId","locationId","l","loc","positionId","foundDepartment","flatMap","departments","d","positions","p","eventType","Shift","Cover","Clock","Absent","departmentId","adminAuth","CanEditSchedules","Admin","hasPosition","dept","eventStatus","Approved","Request","RequestDenied","BusinessAdmin","LocationAdmin","isDeptAdmin","location","adminAllDepts","locId","depId","department","posId","locPosId","depPosId","posPosId","RequireGeoLocation","INITIAL_AUTHORIZED_ITEMS","INITIAL_AUTHITEMS_CONTEXT","refreshAuth","force","newUser","clearAuth","authLoading","AuthorizedItemsContext","empty","authFromStore","authHelper","differenceInMinutes","UserAPI","authFromApi","AuthorizedItemsContextProvider","internalSetAuth","setLoading","newAuth","validate","Login","showLoading","setShowLoading","setUsername","setPassword","usernameErrors","passwordErrors","loginEnabled","setLoginEnabled","login","envUser","direction","msg","useIonViewWillEnter","src","alt","spinner","duration","onChange","newUsername","target","color","newPassword","expand","noEndTime","getDurationFromTimeSpan","timespan","hrs","min","tok","split","hrTok","getDurationStringFromTimeSpan","getDateString","date","getBreakStartEnd","brk","start","parseISO","BreakStart","replace","BreakEnd","end","getEventBreakStartEndString","getWeekStart","weekStartsOn","dayStart","dayStartMinutes","newDate","setHours","counter","addDays","formatDateTimeAsMvcString","getFullYear","padZeroes","getMonth","getDate","getHours","getMinutes","formatDecimal","num","digits","decimals","Number","toFixed","toString","negative","Math","max","digitCount","EventEditEnum","getScheduleEvent","scheduleEventId","getScheduleEventsByFilter","filterToSend","getDailyNotesByFilter","updateScheduleEvent","eventValues","recurrenceUpdateType","isConfirmed","employee","eventStart","eventEnd","tagId","tag","eventBreaks","isClockedIn","breakStart","breakDuration","clockOutValue","clockoutValue","absentTime","absentTimeMinutes","notes","sendMessage","recurrenceId","recurrenceStart","recurrenceEnd","recurrenceType","repeatInterval","repeatWeekdays","createScheduleEvent","sceduleEventId","deleteScheduleEvent","initialEventFilter","settingsLocId","dnLocIds","filterByEmployee","filterByPosition","positionIds","eventTypeId","eventStatusId","WeekChooser","startDate","setStartDate","dateRef","useRef","onDateChanged","isSameDay","current","arrowBack","displayFormat","pickerFormat","toISOString","onIonChange","detail","caretDown","arrowForward","thisDate","isTodayClass","isToday","style","outline","getEventEditAuthorization","eventEmployeeId","eventLocationId","eventDepartmentId","eventPositionId","eventConfirmed","selectedPosition","eventStatusOptions","getEventStatusOptionsList","eventTypeOptions","getEventTypeOptionsList","retVal","buttonText","enableConfirm","isReadonly","text","usage","None","eventTypeOptionList","eventStatusOptionList","endOfEvent","now","afterEnd","isAfter","employeeEvent","CanEditOwnClockEvents","CanEditEmployeeClockEvents","CreateCoverRequest","DeleteShiftRequest","UndoCoverRequest","Delete","CreateShiftRequest","locSettings","ShowUnavailableEventType","Unavailable","ShowVacationEventType","Vacation","ShowAbsentEventType","peTypes","pe","startsWith","concat","isEditingExistingEvent","es","colorMap","1","2","3","4","6","7","statusTimeColor","EventCard","event","multiLocation","showEmployeeName","onEdit","displayNameStyle","display","eventStartDate","EventStart","multiDepartment","posDisplay","AbbreviatedLocationName","AbbreviatedDepartmentName","PositionName","eventTypeBorder","borderLeft","EventTypeId","timeColor","EventStatusId","eventEditAuth","EmployeeId","EventEnd","LocationId","DepartmentId","PositionId","IsConfirmed","onUserClick","IsClockedIn","time","ev","getEventInformationStartEnd","Time","EventDuration","FirstName","LastName","Tag","useOrbitalDialogBox","selection","dialogData","setDialogData","onButtonClick","showDialog","dialogOptions","dialogBoxJsx","cssClass","opt","size","DailyNoteDepartmentSelector","currentDepartment","onDepartmentUpdate","selectedDepartment","setSelectedDepartment","selectedDepartmentId","interface","maxWidth","newSelection","updateLocation","updateDepartment","dep","updateDailyNote","dailyNoteId","insertDailyNote","deleteDailyNote","getDailyNote","useSimpleToast","toastData","setToastData","showToast","simpleToastJsx","EditDailyNoteModal","onCloseModal","note","initialDate","originalNote","setOriginalNote","toast","dialog","selectedRole","setSelectedRole","curLoc","j","curDep","getFirstAvailableDepartment","Notes","noteText","setNoteText","noteCharCountRef","selectedDate","setSelectedDate","isMounted","fetchDailyNote","notesApi","res","DailyNoteId","right","left","newStart","updateBackend","isClosing","newRole","dateStr","onDateSelected","placeholder","rows","spellcheck","wrap","debounce","newText","onForceRefresh","noteDate","deptName","DepartmentName","showEditModal","setShowEditModal","newNoteClicked","EventGroup","AddDailyNoteButton","canAddNote","toastMessage","EventListSection","events","showEmployeeNames","dailyNotesAddButtonDate","DailyNoteCard","ScheduleEventId","getSegmentsForMy","locationSettings","hoursPerDay","segments","weekStart","DayWeekStartsOn","DayStartTime","notesStart","isBefore","weekEnd","minutes","str","floor","getDurationString","h","reduce","prev","cur","EventList","listType","getSegmentsForRequests","containsKey","thisDatesNotes","getSegmentsForAll","seg","showTotalDuration","getEventTypeOptions","unshift","p2l","some","sort","p1","p2","arrayHelper","areEqual","a1","a2","contains","arr","containsAny","arr1","arr2","unique","newArr","uniqueObject","filt","found","ScheduleFilterModal","onCancelModal","myFilter","setMyFilter","showCustomEventTypes","setShowCustomEventTypes","ClockAndSched","eventGroup","setEventGroup","eventTypeList","setEventTypeList","locationIds","setLocationIds","departmentIds","setDepartmentIds","setPositionIds","isDirty","setIsDirty","getDefaultFilter","onEventGroupSelect","f","group","Custom","Scheduled","DontWork","All","multiple","locIds","deptIds","abbr","posIds","selectedPositionIds","defaultFilter","returnedFilter","filterApplied","useIonicRefresher","doRefresh","ionRefresherRef","ionicRefresherJsx","ref","onIonRefresh","pullingIcon","pullingText","refreshingSpinner","refreshingText","EventTypeStatusEditor","editorValues","update","eventTypes","eventStatuses","selectedEventTypeId","setSelectedEventTypeId","selectedEventStatusId","setSelectedEventStatusId","absentHoursPlaceholderText","setAbsentHoursPlaceholderText","setLocSettings","absentTimeString","setAbsentTimeString","absentId","HoursMinutes","hours","TimeFormatDigits","TimeFormatDecimals","getTimeStringFromMinutes","newLocSettings","onAbsentTimeChange","test","round","parseFloat","getMinutesFromTimeString","newEventType","newAbsentMinutes","onEventTypeChange","newEventStatus","onIonBlur","EventPositionEditor","setSelectedPosition","positionList","setPositionList","selPos","isMultiLoc","isMultiDep","createPositionList","updatePosition","getEmployeesByLocationIdPositionIdAndActiveDateRange","getEmployeeListForCommunication","channel","useShowLoading","showLoadingJsx","RecurrenceType","EventEmployeeEditor","employeeList","setEmployeeList","selectedEmployeeId","setSelectedEmployeeId","getEmployees","employeeAPI","employees","empIds","thisEmp","newSelectedEmployeeId","emp","EventStartEndEditor","minuteValues","newEventStart","newEventEnd","hasOverlap","breaks","startA","endA","startB","addMinutes","endB","AddBreakModal","onCancel","onAdd","currentBreaks","setMinutes","endDate","setEndDate","isRestricted","setIsRestricted","isPaid","setIsPaid","errorMessage","setErrorMessage","isValid","setIsValid","alert","newStartDate","onStartUpdate","newEnd","newEndDate","onEndUpdate","EventBreakEditor","breakList","setBreakList","showBreakModal","setShowBreakModal","IsPaidBreak","logoUsd","b","IsRestricted","lockClosed","showRestricted","newBreakList","onDeleteBreak","trash","borderBottom","width","EventTagEditor","selectedTagId","setSelectedTagId","tagList","setTagList","t","tagIds","onUpdateTag","EventConfirmEditor","setIsConfirmed","showConfirmed","setShowConfirmed","isConfirmable","checkmark","EventIsClockedInEditor","setIsClockedIn","showIsClockedIn","setShowIsClockedIn","getLocationById","getPositionById","getValidStartEnd","startStr","endStr","isEqual","getEditorValuesFromEventInformation","INITIAL_EDITOR_VAUES","EventBreaks","RecurrenceUpdateType","isClockoutValueValid","ClockOutValueLabel","isAllValid","v","validEventStartEnd","validEmployee","validTag","validEventTypeStatus","validClockoutValue","validRecurrenceStartEnd","validRepeatInterval","validRepeatWeekdays","isUpdating","valid","absentName","editorValueReducer","action","getIsClockedIn","ConfirmedBy","TagId","AbsentName","AbsentId","AbsentTimeMinutes","ClockOutValue","EventRecurrenceId","EventRecurrenceStart","EventRecurrenceEnd","RepeatType","RepeatInterval","RepeatWeekdays","newTypeStatusState","newClockoutValueState","newStartState","newEndState","newTagState","newConfirmState","newClockedInState","newRepeatState","repeatWeekDays","Weekly","EventNotesEditor","maxlength","newNote","EventClockoutValueEditor","isVisible","setIsVisible","newValue","undoCoverRequest","createCoverRequest","businessId","broadCastMessage","coverMessage","toEmployeeId","BusinessId","BroadcastCoverRequestMessage","CoverMessage","DirectToEmployeeId","makeShiftRequest","removeShiftRequest","recUpdateType","RecUpdateType","deleteEvent","getCoverRequestListItems","isDirectCoverList","directCoverList","EventRequestModal","onOk","setNotes","coverList","setCoverList","requestAPI","hidden","EnableDirectCoverRequest","cover","EventRequestEditor","cancelEditModal","showRequestModal","setShowRequestModal","onComplete","reqApi","WeekdayList","checkList","setCheckList","dayOfWeek","getDay","newCheckState","onCheckboxChecked","RecurringEventSection","isChecked","setIsChecked","calendar","textAlign","refresh","MonthlyByDayOfMonth","MonthlyByDayOfWeek","RecurrenceUpdateTypeSelector","onSelect","updateType","choice","titleText","UpdateSingleEvent","UpdateEntireSeries","UpdateSeriesForward","EditEventModal","initialEvent","useReducer","updateEditorValues","scheduleEvent","setScheduleEvent","setRecurrenceUpdateType","showRecurrenceUpdateTypeSelector","setShowRecurrenceUpdateTypeSelector","buttonClicked","setButtonClicked","isEditing","scheduleEventApi","createOrUpdate","skipPrompt","goDelete","onRecurrenceUpdateTypeSelect","setUsageText","EventCardSkeleton","threeRows","padding","height","NoEventsToShow","useInterval","isRunning","delay","savedProps","setInterval","clearInterval","isShiftTypeEvent","isAbsentExpenseEvent","eventMatchesFilter","eventTypeFilter","eventStatusFilter","isTimeClockEvent","initialEvents","initialDailyNotes","ClockInRequirement","SchedulePage","match","refresher","getScheduleEvents","filterAppliedClass","setFilterAppliedClass","startOfDay","myScheduleEvents","setMyScheduleEvents","myDailyNotes","setMyDailyNotes","myHoursPerDay","setMyHoursPerDay","requestScheduleEvents","setRequestScheduleEvents","requestDailyNotes","setRequestDailyNotes","requestHoursPerDay","setRequestHoursPerDay","allScheduleEvents","setAllScheduleEvents","allDailyNotes","setAllDailyNotes","allHoursPerDay","setAllHoursPerDay","isShowing","setIsShowing","segment","setSegment","showFilterModal","setShowFilterModal","showEventModal","setShowEventModal","editEventId","setEditEventId","initialEditEvent","setInitialEditEvent","setEventEditAuth","setFilter","useIonViewWillLeave","newFilter","params","apiFilter","ScheduleEventsAPI","complete","getMyScheduleEvents","getAllScheduleEvents","onEventClick","useCallback","newEventEditAuth","onSegmentChange","segmentName","hasPositionFound","k","initialStatus","getEventNewAuthorization","funnel","marginTop","onEventUpdated","StartBreakResponseCode","EndBreakResponseCode","BreakSelectionModal","tcData","cancelOption","breakType","UnscheduledUnpaid","ClockedInScheduleEvent","ScheduleEventsForClockIn","Both","UnscheduledPaid","Paid","Unpaid","getTimeClockSettings","clockIn","clockOut","clockoutDataModel","TimeClockBreak","switchPositionOrTag","startBreak","clockEvent","shiftEvent","breakStartOptions","clockEventId","shiftEventId","shiftBreakStart","endBreak","getGeoLocations","ClockoutModal","setClockoutValue","autoCorrect","clearInput","SwitchPositionOrTagButton","selectedPosId","onSwitch","setDisabled","hiddenJsx","UserClockedIn","curPosId","curTagId","ClockInWithDifferentTag","EnablePositionChangeForEmployeePosition","calculateNearestLocationMessage","userPos","closestLocation","minDistance","locPos","proximity","locationName","miles","EPSILON","Map","mapEle","userCircle","setMessage","geoLocations","setGeoLocations","showMap","setShowMap","center","zoom","disableDefaultUI","fullscreenControl","Circle","strokeColor","strokeOpacity","strokeWeight","fillColor","fillOpacity","radius","timeclockApi","clockLocations","forEach","markerData","infoWindow","InfoWindow","content","addr","marker","Marker","open","addMarkers","addListenerOnce","classList","setCenter","setMap","arrowDownCircle","arrowUpCircle","useYesOrCancelDialogBox","onYes","dialogJsx","handler","GeoLocationComponent","updateCallback","yesCancelDlg","watchPositionId","setWatchPositionId","setTimeout","ClockPanel","onUpdate","refreshToggle","posList","setPosList","setSelectedPosId","tagSwitchingEnabled","setTagSwitchingEnabled","breakSetting","setBreakSetting","showBreakSelectorModal","setShowBreakSelectorModal","loadingMessage","setLoadingMessage","show","showAlertData","setShowAlertData","setTCData","showClockoutModal","setShowClockoutModal","setRefresh","updateTimeClockData","ShowTimeClock","plist","uniqueLocationIds","PositionsToClockInto","uniqueDeptIds","PositionNameWithLocAndDeptAbbreviation","PositionNameWithDeptAbbreviation","curLocId","EnableEnhancedBreakManagement","CurrentEventBreak","setTags","timeClockApi","currentPositionId","TagsPerPosition","TagName","clockout","ClockOutResponseCode","ClockOutEvent","Message","newVal","UserMayClockOut","UserMayClockIn","MatchingShift","AllowedToSwitchPositions","AllowedToSwitchTags","ClockInMessage","ClockOutMessage","ClockInResponseCode","ClockInEvent","paddingRight","paddingLeft","Success","cafe","BreakSelectorModal","PayrollPeriodChooser","onNextPayPeriod","onPrevPayPeriod","payPeriodDateText","getPayPeriodDateForEmployee","getHoursString","locsettings","ActualTime","dayHourTok","ActualHours","getTimeStringFromOrbitalTime","PayrollOrbitalTimeItem","fontColor","displayColor","PayrollDetailModal","onClose","regular","dailyOvertime","weeklyOvertime","special","timePerAbsent","hpa","getAbsentName","ColumnEnum","PayrollDetailRow","payrollRow","colsToDisplay","colSize","showDetailModal","setShowDetailModal","Regular","DailyOvertime","WeeklyOvertime","Special","absent","PayrollDetailList","payrollData","setColsToDisplay","setColSize","cols","count","totalDailyOvertime","totalWeeklyOvertime","totalSpecial","totalAbsent","getColumnsToDisplay","x","row","totalRegular","PayrollPeriodsTab","currentDate","setCurrentDate","setPayrollData","getData","PayrollPeriodAPI","TodayNoteCard","oneLine","dailyNote","getDeptName","TodayEventCard","onClock","onBreak","displayIcon","rangeDisplay","getEventStartEnd","thisLocation","LocationAbbreviation","DepartmentAbbreviation","getPosition","TodayEventCardSkeleton","ClockTodayTab","homePageData","setHomePageData","isLoading","setIsLoading","lines","TodayDailyNoteCard","ClockPage","setRefreshToggle","refreshTimeClockToggle","setRefreshTimeClockToggle","MessageItem","onMessageClick","fontWeightForSubject","isViewed","fontWeight","isPinned","bookmark","subject","differenceInDays","isSameYear","messageDateString","deliveryDateTime","previewLine","MessagesFilterModal","filterData","msgTypeIds","msgTypes","mt","messageTypeId","filterResult","setFilterResult","description","messageTypes","typeName","getUserMessage","msgId","getUserMessages","getReadCount","setIsPinned","setIsViewed","deleteMessage","getUnreadCount","MessagesContext","unreadMessagesCount","refreshCount","MessagesContextProvider","messagesState","internalSetMessagesState","messagesApi","newUnreadCount","ViewMessagetModal","updateMessages","readCount","setReadCount","usageText","pinned","setPinned","scheduleEventAPI","messageAPI","newReadCount","newPinValue","onPinnedClick","fromEmployeeFirstName","fromEmployeeLastName","dangerouslySetInnerHTML","__html","messageText","setPositionForLocation","PositionSelector","sel","currentPosition","onPositionUpdate","setPositionForDepartment","find","isAdminAtLocation","setPositionForPosition","emailIcon","textIcon","phonePortrait","pushIcon","isEmployeeEnabled","hasEmail","hasText","hasPush","EmployeeSelectorModal","selectedEmployeeList","setList","isAllChecked","setIsAllChecked","empId","checkCount","allCheckCount","onEmployeeChecked","messageChannels","EmployeesSelector","getFirstAvailablePosition","selectedChannel","setSelectedChannel","selectedEmployees","setSelectedEmployees","showEmployeeModal","setShowEmployeeModal","fetchEmployees","employeeApi","finally","selList","posEx","newChannelId","newEmployeeList","CreateMessageModal","setMessageText","employeeIds","setEmployeeIds","setLocationId","setChannel","sendingMessage","newEmpList","newLocId","newChannel","messageApi","initialMessages","messagesReducer","m","MessagesPage","refreshMessages","isLoadingMessages","setIsLoadingMessages","messages","filteredMessages","setFilteredMessages","setFilterData","viewMessage","setViewMessage","showCreateMessage","setShowCreateMessage","filterMessages","msgs","fromEmployeeId","y","String","margin","updatedFilter","MessagesTabButton","chatbubblesOutline","MainTabs","exact","path","to","render","routeProps","tab","href","calendarOutline","timeOutline","AuthGate","Logout","useIonViewDidEnter","MyApp","ScreenOrientation","lock","ORIENTATIONS","PORTRAIT","vers","App","ReactDOM","document","getElementById"],"mappings":"6JAAA,IAAIA,EAAM,CACT,kCAAmC,CAClC,IACA,IAED,iCAAkC,CACjC,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,8BAA+B,CAC9B,IACA,GAED,6BAA8B,CAC7B,IACA,GAED,iCAAkC,CACjC,IACA,IAED,gCAAiC,CAChC,IACA,IAED,8BAA+B,CAC9B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,8BAA+B,CAC9B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,8BAA+B,CAC9B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,yBAA0B,CACzB,IACA,IAED,uBAAwB,CACvB,IACA,IAED,gCAAiC,CAChC,IACA,IAED,+BAAgC,CAC/B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,qBAAsB,CACrB,IACA,IAED,uCAAwC,CACvC,IACA,IAED,sCAAuC,CACtC,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,mCAAoC,CACnC,IACA,IAED,kCAAmC,CAClC,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,uBAAwB,CACvB,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,kCAAmC,CAClC,IACA,IAED,iCAAkC,CACjC,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,iCAAkC,CACjC,IACA,IAED,gCAAiC,CAChC,IACA,IAED,+BAAg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","file":"static/js/main.b8cfcc96.chunk.js","sourcesContent":["var map = {\n\t\"./ion-action-sheet-ios.entry.js\": [\n\t\t131,\n\t\t67\n\t],\n\t\"./ion-action-sheet-md.entry.js\": [\n\t\t132,\n\t\t68\n\t],\n\t\"./ion-alert-ios.entry.js\": [\n\t\t133,\n\t\t59\n\t],\n\t\"./ion-alert-md.entry.js\": [\n\t\t134,\n\t\t60\n\t],\n\t\"./ion-app_8-ios.entry.js\": [\n\t\t135,\n\t\t53\n\t],\n\t\"./ion-app_8-md.entry.js\": [\n\t\t136,\n\t\t54\n\t],\n\t\"./ion-avatar_3-ios.entry.js\": [\n\t\t137,\n\t\t8\n\t],\n\t\"./ion-avatar_3-md.entry.js\": [\n\t\t138,\n\t\t9\n\t],\n\t\"./ion-back-button-ios.entry.js\": [\n\t\t139,\n\t\t10\n\t],\n\t\"./ion-back-button-md.entry.js\": [\n\t\t140,\n\t\t11\n\t],\n\t\"./ion-backdrop-ios.entry.js\": [\n\t\t141,\n\t\t12\n\t],\n\t\"./ion-backdrop-md.entry.js\": [\n\t\t142,\n\t\t13\n\t],\n\t\"./ion-button_2-ios.entry.js\": [\n\t\t143,\n\t\t69\n\t],\n\t\"./ion-button_2-md.entry.js\": [\n\t\t144,\n\t\t70\n\t],\n\t\"./ion-card_5-ios.entry.js\": [\n\t\t145,\n\t\t14\n\t],\n\t\"./ion-card_5-md.entry.js\": [\n\t\t146,\n\t\t15\n\t],\n\t\"./ion-checkbox-ios.entry.js\": [\n\t\t147,\n\t\t16\n\t],\n\t\"./ion-checkbox-md.entry.js\": [\n\t\t148,\n\t\t17\n\t],\n\t\"./ion-chip-ios.entry.js\": [\n\t\t149,\n\t\t18\n\t],\n\t\"./ion-chip-md.entry.js\": [\n\t\t150,\n\t\t19\n\t],\n\t\"./ion-col_3.entry.js\": [\n\t\t151,\n\t\t20\n\t],\n\t\"./ion-datetime_3-ios.entry.js\": [\n\t\t152,\n\t\t57\n\t],\n\t\"./ion-datetime_3-md.entry.js\": [\n\t\t153,\n\t\t58\n\t],\n\t\"./ion-fab_3-ios.entry.js\": [\n\t\t154,\n\t\t21\n\t],\n\t\"./ion-fab_3-md.entry.js\": [\n\t\t155,\n\t\t22\n\t],\n\t\"./ion-img.entry.js\": [\n\t\t156,\n\t\t23\n\t],\n\t\"./ion-infinite-scroll_2-ios.entry.js\": [\n\t\t157,\n\t\t24\n\t],\n\t\"./ion-infinite-scroll_2-md.entry.js\": [\n\t\t158,\n\t\t25\n\t],\n\t\"./ion-input-ios.entry.js\": [\n\t\t159,\n\t\t26\n\t],\n\t\"./ion-input-md.entry.js\": [\n\t\t160,\n\t\t27\n\t],\n\t\"./ion-item-option_3-ios.entry.js\": [\n\t\t161,\n\t\t71\n\t],\n\t\"./ion-item-option_3-md.entry.js\": [\n\t\t162,\n\t\t72\n\t],\n\t\"./ion-item_8-ios.entry.js\": [\n\t\t163,\n\t\t73\n\t],\n\t\"./ion-item_8-md.entry.js\": [\n\t\t164,\n\t\t74\n\t],\n\t\"./ion-loading-ios.entry.js\": [\n\t\t165,\n\t\t28\n\t],\n\t\"./ion-loading-md.entry.js\": [\n\t\t166,\n\t\t29\n\t],\n\t\"./ion-menu_3-ios.entry.js\": [\n\t\t167,\n\t\t75\n\t],\n\t\"./ion-menu_3-md.entry.js\": [\n\t\t168,\n\t\t76\n\t],\n\t\"./ion-modal-ios.entry.js\": [\n\t\t169,\n\t\t55\n\t],\n\t\"./ion-modal-md.entry.js\": [\n\t\t170,\n\t\t56\n\t],\n\t\"./ion-nav_2.entry.js\": [\n\t\t171,\n\t\t66\n\t],\n\t\"./ion-popover-ios.entry.js\": [\n\t\t172,\n\t\t30\n\t],\n\t\"./ion-popover-md.entry.js\": [\n\t\t173,\n\t\t31\n\t],\n\t\"./ion-progress-bar-ios.entry.js\": [\n\t\t174,\n\t\t32\n\t],\n\t\"./ion-progress-bar-md.entry.js\": [\n\t\t175,\n\t\t33\n\t],\n\t\"./ion-radio_2-ios.entry.js\": [\n\t\t176,\n\t\t34\n\t],\n\t\"./ion-radio_2-md.entry.js\": [\n\t\t177,\n\t\t35\n\t],\n\t\"./ion-range-ios.entry.js\": [\n\t\t178,\n\t\t77\n\t],\n\t\"./ion-range-md.entry.js\": [\n\t\t179,\n\t\t78\n\t],\n\t\"./ion-refresher_2-ios.entry.js\": [\n\t\t180,\n\t\t61\n\t],\n\t\"./ion-refresher_2-md.entry.js\": [\n\t\t181,\n\t\t62\n\t],\n\t\"./ion-reorder_2-ios.entry.js\": [\n\t\t182,\n\t\t36\n\t],\n\t\"./ion-reorder_2-md.entry.js\": [\n\t\t183,\n\t\t37\n\t],\n\t\"./ion-ripple-effect.entry.js\": [\n\t\t184,\n\t\t38\n\t],\n\t\"./ion-route_4.entry.js\": [\n\t\t185,\n\t\t79\n\t],\n\t\"./ion-searchbar-ios.entry.js\": [\n\t\t186,\n\t\t80\n\t],\n\t\"./ion-searchbar-md.entry.js\": [\n\t\t187,\n\t\t81\n\t],\n\t\"./ion-segment_2-ios.entry.js\": [\n\t\t188,\n\t\t82\n\t],\n\t\"./ion-segment_2-md.entry.js\": [\n\t\t189,\n\t\t83\n\t],\n\t\"./ion-select_3-ios.entry.js\": [\n\t\t190,\n\t\t84\n\t],\n\t\"./ion-select_3-md.entry.js\": [\n\t\t191,\n\t\t85\n\t],\n\t\"./ion-slide_2-ios.entry.js\": [\n\t\t192,\n\t\t86\n\t],\n\t\"./ion-slide_2-md.entry.js\": [\n\t\t193,\n\t\t87\n\t],\n\t\"./ion-spinner.entry.js\": [\n\t\t194,\n\t\t39\n\t],\n\t\"./ion-split-pane-ios.entry.js\": [\n\t\t195,\n\t\t40\n\t],\n\t\"./ion-split-pane-md.entry.js\": [\n\t\t196,\n\t\t41\n\t],\n\t\"./ion-tab-bar_2-ios.entry.js\": [\n\t\t197,\n\t\t42\n\t],\n\t\"./ion-tab-bar_2-md.entry.js\": [\n\t\t198,\n\t\t43\n\t],\n\t\"./ion-tab_2.entry.js\": [\n\t\t199,\n\t\t44\n\t],\n\t\"./ion-text.entry.js\": [\n\t\t200,\n\t\t45\n\t],\n\t\"./ion-textarea-ios.entry.js\": [\n\t\t201,\n\t\t46\n\t],\n\t\"./ion-textarea-md.entry.js\": [\n\t\t202,\n\t\t47\n\t],\n\t\"./ion-toast-ios.entry.js\": [\n\t\t203,\n\t\t63\n\t],\n\t\"./ion-toast-md.entry.js\": [\n\t\t204,\n\t\t64\n\t],\n\t\"./ion-toggle-ios.entry.js\": [\n\t\t205,\n\t\t48\n\t],\n\t\"./ion-toggle-md.entry.js\": [\n\t\t206,\n\t\t49\n\t],\n\t\"./ion-virtual-scroll.entry.js\": [\n\t\t207,\n\t\t50\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 106;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./ion-icon.entry.js\": [\n\t\t211,\n\t\t90\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 108;\nmodule.exports = webpackAsyncContext;","import { ApplicationUser } from \"../context/ApplicationUserContext\";\r\nimport { AuthorizedItems } from \"../orbital-interfaces/authorized-items\";\r\nimport { openDB, DBSchema, IDBPDatabase } from \"idb\";\r\n\r\nconst DB_NAME = \"osKeyStore\";\r\nconst DB_VERSION = 1;\r\n\r\ninterface OSKeyStore extends DBSchema {\r\n  userStore: {\r\n    key: \"user\";\r\n    value: ApplicationUser;\r\n  };\r\n  authItems: {\r\n    key: \"authItems\";\r\n    value: AuthorizedItems;\r\n  };\r\n}\r\n\r\n// -----------------------------------------------------------------------------------------\r\nconst getKeyStore = (): Promise<IDBPDatabase<OSKeyStore>> => {\r\n  return openDB<OSKeyStore>(DB_NAME, DB_VERSION, {\r\n    upgrade(db) {\r\n      db.createObjectStore(\"userStore\");\r\n      db.createObjectStore(\"authItems\");\r\n    },\r\n  });\r\n};\r\n\r\n// -----------------------------------------------------------------------------------------\r\nconst putUserState = async (state: ApplicationUser) => {\r\n  const db = await getKeyStore();\r\n  await db.put(\"userStore\", state, \"user\");\r\n};\r\n\r\n// -----------------------------------------------------------------------------------------\r\nconst getUserState = async (): Promise<ApplicationUser | undefined> => {\r\n  const db = await getKeyStore();\r\n  return await db.get(\"userStore\", \"user\");\r\n};\r\n\r\n// -----------------------------------------------------------------------------------------\r\nconst getAccessToken = async (): Promise<string | undefined> => {\r\n  const db = await getKeyStore();\r\n  return await db.get(\"userStore\", \"user\").then((state) => {\r\n    return state ? state.access_token : undefined;\r\n  });\r\n};\r\n\r\n// -----------------------------------------------------------------------------------------\r\nconst putAuthItems = async (auth: AuthorizedItems) => {\r\n  const db = await getKeyStore();\r\n  await db.put(\"authItems\", auth, \"authItems\");\r\n};\r\n\r\nconst getAuthItems = async () => {\r\n  const db = await getKeyStore();\r\n  const authItems = await db.get(\"authItems\", \"authItems\");\r\n  return authItems;\r\n};\r\n\r\nexport default {\r\n  getKeyStore,\r\n  putUserState,\r\n  getUserState,\r\n  getAccessToken,\r\n  putAuthItems,\r\n  getAuthItems,\r\n};\r\n","import * as firebase from \"firebase/app\";\r\nimport \"firebase/analytics\";\r\n\r\nconst firebaseConfig = {\r\n  apiKey: \"AIzaSyAS526InuG-53VGKi5SA780Mh0YwHkhMDE\",\r\n  authDomain: \"orbital-shift-team-dashboard.firebaseapp.com\",\r\n  databaseURL: \"https://orbital-shift-team-dashboard.firebaseio.com\",\r\n  projectId: \"orbital-shift-team-dashboard\",\r\n  storageBucket: \"orbital-shift-team-dashboard.appspot.com\",\r\n  messagingSenderId: \"475985033328\",\r\n  appId: \"1:475985033328:web:77740655a89e28de035cb5\",\r\n  measurementId: \"G-TGE8788D28\",\r\n};\r\n\r\n// ------------------------------------------------------------------------------------------------\r\nexport function initialize() {\r\n  console.log(\"firebase initialized\");\r\n  firebase.initializeApp(firebaseConfig);\r\n}\r\n\r\n// ------------------------------------------------------------------------------------------------\r\nexport function log(eventName: string, eventParams?: any) {\r\n  firebase.analytics().logEvent(eventName, eventParams);\r\n}\r\n","export interface IKeyedCollection<T> {\r\n  add(key: string, value: T): void;\r\n  containsKey(key: string): boolean;\r\n  count(): number;\r\n  item(key: string): T;\r\n  keys(): string[];\r\n  remove(key: string): T;\r\n  values(): T[];\r\n}\r\n\r\nexport class KeyedCollection<T> implements IKeyedCollection<T> {\r\n  private items: { [index: string]: T } = {};\r\n\r\n  private _count: number = 0;\r\n\r\n  public containsKey(key: string): boolean {\r\n    return this.items.hasOwnProperty(key);\r\n  }\r\n\r\n  public count(): number {\r\n    return this._count;\r\n  }\r\n\r\n  public add(key: string, value: T) {\r\n    if (!this.items.hasOwnProperty(key)) this._count++;\r\n\r\n    this.items[key] = value;\r\n  }\r\n\r\n  public remove(key: string): T {\r\n    const val = this.items[key];\r\n    delete this.items[key];\r\n    this._count--;\r\n    return val;\r\n  }\r\n\r\n  public item(key: string): T {\r\n    return this.items[key];\r\n  }\r\n\r\n  public keys(): string[] {\r\n    const keySet: string[] = [];\r\n\r\n    for (const prop in this.items) {\r\n      if (this.items.hasOwnProperty(prop)) {\r\n        keySet.push(prop);\r\n      }\r\n    }\r\n\r\n    return keySet;\r\n  }\r\n\r\n  public values(): T[] {\r\n    const values: T[] = [];\r\n\r\n    for (const prop in this.items) {\r\n      if (this.items.hasOwnProperty(prop)) {\r\n        values.push(this.items[prop]);\r\n      }\r\n    }\r\n\r\n    return values;\r\n  }\r\n}\r\n","import { KeyedCollection } from \"../util/KeyedCollection\";\r\nimport { ApplicationUser } from \"../context/ApplicationUserContext\";\r\nimport { isPlatform } from \"@ionic/react\";\r\n\r\nexport interface Constants {\r\n  checkUnreadMessageCountTimer: number;\r\n  refreshScheduleTimer: number;\r\n  refreshTimeclockSettingsTimer: number;\r\n  maxStaleAuthItemsInMinutes: number;\r\n}\r\n\r\nexport interface EnvironmentType {\r\n  constants: Constants;\r\n  key: string;\r\n  name: string;\r\n  url: string;\r\n}\r\n\r\nconst defaults: EnvironmentType = {\r\n  constants: {\r\n    checkUnreadMessageCountTimer: 30 * 1000, // how often to get just the unread messages\r\n    refreshScheduleTimer: 60 * 1000, // how often to refresh events on Schedule/Clock Page\r\n    refreshTimeclockSettingsTimer: 15 * 1000, // how often to get timclock settings on clock panel\r\n    maxStaleAuthItemsInMinutes: 15, // how many minutes before we force auth items to refresh from api\r\n  },\r\n\r\n  key: \"prod\",\r\n  name: \"\",\r\n  url: \"\",\r\n};\r\n\r\nconst envTypes: EnvironmentType[] = [\r\n  {\r\n    ...defaults,\r\n    key: \"prod\",\r\n    name: \"Production\",\r\n    url: \"https://api.orbitalshift.com/\",\r\n  },\r\n  {\r\n    ...defaults,\r\n    key: \"sbx\",\r\n    name: \"Sandbox\",\r\n    url: \"https://sandboxapi.orbitalshift.com/\",\r\n  },\r\n  { ...defaults, key: \"loc\", name: \"Local\", url: \"http://localhost:54825/\" },\r\n  {\r\n    ...defaults,\r\n    key: \"emu\",\r\n    name: \"Local (Emu)\",\r\n    url: \"http://10.0.2.2:54825/\",\r\n  },\r\n  {\r\n    ...defaults,\r\n    key: \"tst\",\r\n    name: \"TestServer\",\r\n    url: \"http://TestServer:8000/\",\r\n  },\r\n];\r\n\r\nconst environments = new KeyedCollection<EnvironmentType>();\r\nenvTypes.map((et) => environments.add(et.key, et));\r\n\r\n// ------------------------------------------------------------------------------------------------\r\n// NOTE: versionName, versionCode, and revisionHash should be set to _REPLACE_XXXXX_XXX_ strings\r\n//       that get replaced when 'build' is run from the command line.\r\n//       See OSROOT/_buildenv/BuildModule/CommandLineFunctions.psm1\r\nconst settings = {\r\n  env: environments,\r\n  versionName: \"2.0.0\",\r\n  versionCode: \"6120\",\r\n  revisionHash: \"24c58ab\",\r\n  buildDate: \"Mon 05/04/2020 10:57A\",\r\n  // eslint-disable-next-line max-len\r\n  appVersionString: `2.0.0.6120 (24c58ab)`,\r\n  hasCapacitor: isPlatform(\"capacitor\"),\r\n  platform: isPlatform(\"ios\")\r\n    ? \"ios\"\r\n    : isPlatform(\"android\")\r\n    ? \"android\"\r\n    : \"other\",\r\n};\r\n\r\n// ------------------------------------------------------------------------------------------------\r\nconst getApiUrl = (user: ApplicationUser, endpoint: string): string => {\r\n  return settings.env.item(user.environment).url + endpoint;\r\n};\r\n\r\n// ------------------------------------------------------------------------------------------------\r\nconst getUserAndEnvironmentFromInput = (\r\n  input: string\r\n): { username: string; env: EnvironmentType } => {\r\n  if (input.length < 4) {\r\n    return { username: input, env: settings.env.item(\"prod\") };\r\n  }\r\n\r\n  const envKey = input.toLowerCase().substring(0, 4);\r\n  const username = input.substring(4);\r\n  switch (envKey) {\r\n    case \"sbx \":\r\n      return { username, env: settings.env.item(\"sbx\") };\r\n    case \"loc \":\r\n      return { username, env: settings.env.item(\"loc\") };\r\n    case \"emu \":\r\n      return { username, env: settings.env.item(\"emu\") };\r\n    case \"tst \":\r\n      return { username, env: settings.env.item(\"tst\") };\r\n    default:\r\n      return { username: input, env: settings.env.item(\"prod\") };\r\n  }\r\n};\r\n\r\n// ------------------------------------------------------------------------------------------------\r\nexport const getConstants = (user: ApplicationUser): Constants => {\r\n  if (!user.isLoggedin) {\r\n    return defaults.constants;\r\n  }\r\n\r\n  return settings.env.item(user.environment).constants;\r\n};\r\n\r\nexport default {\r\n  settings,\r\n  getApiUrl,\r\n  getUserAndEnvironmentFromInput,\r\n};\r\n","export enum DeviceOperatingSystem {\r\n  iOS = 1,\r\n  Android = 2,\r\n}\r\n","import { ApplicationUser } from \"../context/ApplicationUserContext\";\r\nimport env from \"./environment\";\r\nimport { log } from \"../util/logger\";\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst post = async (user: ApplicationUser, baseUrl: string, data?: any) => {\r\n  const url = env.getApiUrl(user, baseUrl);\r\n  console.log(\"API: \" + baseUrl);\r\n\r\n  try {\r\n    const response = await fetch(url, {\r\n      method: \"POST\",\r\n      body: JSON.stringify(data),\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        Authorization: `Bearer ${user.access_token}`,\r\n        AppVersion: env.settings.appVersionString,\r\n      },\r\n    });\r\n\r\n    const contentType = response.headers.get(\"content-type\");\r\n    if (contentType && contentType.indexOf(\"application/json\") !== -1) {\r\n      const results = await response.json();\r\n      log(\"api_succeeded\", {\r\n        method: \"POST\",\r\n        baseUrl,\r\n        username: user.username,\r\n      });\r\n      return results;\r\n    }\r\n\r\n    log(\"api_succeeded\", { method: \"POST\", baseUrl, username: user.username });\r\n  } catch (err) {\r\n    log(\"api_err\", {\r\n      method: \"POST\",\r\n      baseUrl,\r\n      username: user?.username,\r\n      ...data,\r\n      appVersion: env.settings.appVersionString,\r\n    });\r\n    console.error(\"Error calling post against url, \" + baseUrl + \": \" + err);\r\n    throw err;\r\n  }\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst putData = async (user: ApplicationUser, baseUrl: string, data: any) => {\r\n  const url = env.getApiUrl(user, baseUrl);\r\n  console.log(\"API: \" + baseUrl);\r\n\r\n  try {\r\n    const dataString = JSON.stringify(data);\r\n\r\n    const response = await fetch(url, {\r\n      method: \"PUT\",\r\n      body: dataString,\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        Authorization: `Bearer ${user.access_token}`,\r\n        AppVersion: env.settings.appVersionString,\r\n      },\r\n    });\r\n\r\n    const results = await response.json();\r\n    log(\"api_succeeded\", { method: \"PUT\", baseUrl, username: user.username });\r\n    return results;\r\n  } catch (err) {\r\n    log(\"api_err\", {\r\n      method: \"PUT\",\r\n      baseUrl,\r\n      username: user?.username,\r\n      ...data,\r\n      appVersion: env.settings.appVersionString,\r\n    });\r\n    console.error(\"Error calling putData against url, \" + baseUrl + \": \" + err);\r\n    throw err;\r\n  }\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst get = async (user: ApplicationUser, baseUrl: string, data?: any) => {\r\n  const url = env.getApiUrl(user, baseUrl);\r\n  console.log(\"API: \" + baseUrl);\r\n\r\n  try {\r\n    const options = {\r\n      method: \"GET\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        Authorization: `Bearer ${user.access_token}`,\r\n        AppVersion: env.settings.appVersionString,\r\n      },\r\n      body: null as null | string,\r\n    };\r\n\r\n    if (data) {\r\n      options.body = JSON.stringify(data);\r\n    }\r\n\r\n    const response = await fetch(url, options);\r\n    const results = await response.json();\r\n    log(\"api_succeeded\", { method: \"GET\", baseUrl, username: user.username });\r\n    return results;\r\n  } catch (err) {\r\n    log(\"api_err\", {\r\n      method: \"GET\",\r\n      baseUrl,\r\n      username: user?.username,\r\n      appVersion: env.settings.appVersionString,\r\n    });\r\n    console.error(\"Error calling get against url, \" + baseUrl + \": \" + err);\r\n    throw err;\r\n  }\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst put = async (user: ApplicationUser, baseUrl: string, data?: any) => {\r\n  const url = env.getApiUrl(user, baseUrl);\r\n  console.log(\"API: \" + baseUrl);\r\n\r\n  const options = {\r\n    method: \"PUT\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      Authorization: `Bearer ${user.access_token}`,\r\n      AppVersion: env.settings.appVersionString,\r\n    },\r\n  } as any;\r\n\r\n  if (data) {\r\n    options.body = JSON.stringify(data!);\r\n  }\r\n\r\n  try {\r\n    const response = await fetch(url, options);\r\n    const contentType = response.headers.get(\"content-type\");\r\n    if (contentType && contentType.indexOf(\"application/json\") !== -1) {\r\n      const results = await response.json();\r\n      log(\"api_succeeded\", { method: \"PUT\", baseUrl, username: user.username });\r\n      return results;\r\n    }\r\n\r\n    log(\"api_succeeded\", { method: \"PUT\", baseUrl, username: user.username });\r\n  } catch (err) {\r\n    log(\"api_err\", {\r\n      method: \"PUT\",\r\n      baseUrl,\r\n      username: user?.username,\r\n      ...data,\r\n      appVersion: env.settings.appVersionString,\r\n    });\r\n    console.error(\"Error calling put against url, \" + baseUrl + \": \" + err);\r\n    throw err;\r\n  }\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst del = async (user: ApplicationUser, baseUrl: string, data?: any) => {\r\n  const url = env.getApiUrl(user, baseUrl);\r\n  console.log(\"API: \" + baseUrl);\r\n\r\n  const options = {\r\n    method: \"DELETE\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      Authorization: `Bearer ${user.access_token}`,\r\n      AppVersion: env.settings.appVersionString,\r\n    },\r\n  } as any;\r\n\r\n  if (data) {\r\n    options.body = JSON.stringify(data!);\r\n  }\r\n\r\n  try {\r\n    const response = await fetch(url, options);\r\n    const contentType = response.headers.get(\"content-type\");\r\n    if (contentType && contentType.indexOf(\"application/json\") !== -1) {\r\n      log(\"api_succeeded\", {\r\n        method: \"DELETE\",\r\n        baseUrl,\r\n        username: user.username,\r\n      });\r\n      return await response.json();\r\n    }\r\n\r\n    log(\"api_succeeded\", {\r\n      method: \"DELETE\",\r\n      baseUrl,\r\n      username: user.username,\r\n    });\r\n    return;\r\n  } catch (err) {\r\n    log(\"api_err\", {\r\n      method: \"DELETE\",\r\n      baseUrl,\r\n      username: user?.username,\r\n      ...data,\r\n      appVersion: env.settings.appVersionString,\r\n    });\r\n    console.error(\"Error calling delete against url, \" + baseUrl + \": \" + err);\r\n    throw err;\r\n  }\r\n};\r\n\r\nexport default {\r\n  get,\r\n  post,\r\n  put,\r\n  putData,\r\n  del,\r\n};\r\n","import { ApplicationUser } from \"../context/ApplicationUserContext\";\r\nimport apiHelper from \"./OrbitalApiHelper\";\r\nimport { DeviceOperatingSystem } from \"../enums/DeviceOperatingSystem\";\r\nimport { NotificationTypeModel } from \"../orbital-interfaces/NotificationTypeModel\";\r\nimport env from \"./environment\";\r\nimport { log } from \"../util/logger\";\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst subscribe = async (user: ApplicationUser, token: string) => {\r\n  const url = `api/v1/employee/notifications/subscribe`;\r\n  const operatingSystem =\r\n    env.settings.platform === \"ios\"\r\n      ? DeviceOperatingSystem.iOS\r\n      : DeviceOperatingSystem.Android;\r\n\r\n  log(\"pushNotifications_subscribeCalled\", {\r\n    token,\r\n    operatingSystem,\r\n    username: user.username,\r\n    access_token: user.access_token,\r\n  });\r\n\r\n  return await apiHelper.putData(user, url, {\r\n    TokenId: token,\r\n    OperatingSystem: operatingSystem,\r\n  });\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst unsubscribe = async (user: ApplicationUser, token: string) => {\r\n  const url = `api/v1/employee/notifications/unsubscribe`;\r\n  const operatingSystem =\r\n    env.settings.platform === \"ios\"\r\n      ? DeviceOperatingSystem.iOS\r\n      : DeviceOperatingSystem.Android;\r\n\r\n  return await apiHelper.putData(user, url, {\r\n    TokenId: token,\r\n    OperatingSystem: operatingSystem,\r\n  });\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst getTypesSelectedByUser = async (user: ApplicationUser) => {\r\n  const url = `api/v1/employee/notifications/types`;\r\n  return (await apiHelper.get(user, url)) as NotificationTypeModel[];\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst putTypes = async (user: ApplicationUser, typeIds: number[]) => {\r\n  const url = `api/v1/employee/notifications/types`;\r\n  const data = {\r\n    ids: typeIds,\r\n  };\r\n\r\n  return (await apiHelper.put(user, url, data)) as void;\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst listTypes = async (user: ApplicationUser) => {\r\n  const url = `api/v1/employee/notifications/list-types`;\r\n\r\n  // NOTE: the API no longer really uses passed-in data since the\r\n  // \"Communications rewrite\"\r\n\r\n  return (await apiHelper.get(user, url)) as NotificationTypeModel[];\r\n};\r\n\r\nexport default {\r\n  subscribe,\r\n  unsubscribe,\r\n  getTypesSelectedByUser,\r\n  putTypes,\r\n  listTypes,\r\n};\r\n","import {\r\n  Plugins,\r\n  PushNotification,\r\n  PushNotificationToken,\r\n  PushNotificationActionPerformed,\r\n} from \"@capacitor/core\";\r\nimport { log } from \"./logger\";\r\nimport env from \"../api/environment\";\r\nimport pushApi from \"../api/PushNotificationsAPI\";\r\nimport { ApplicationUser } from \"../context/ApplicationUserContext\";\r\nimport { createBrowserHistory } from \"history\";\r\n\r\nconst { PushNotifications } = Plugins;\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst register = (\r\n  user: ApplicationUser,\r\n  pushEnabled: (enabled: boolean) => void,\r\n  showMessage: (msg: string) => void\r\n) => {\r\n  const history = createBrowserHistory({ forceRefresh: true });\r\n\r\n  if (!env.settings.hasCapacitor) {\r\n    // TODO: web push instead of capacitor\r\n    return;\r\n  }\r\n\r\n  PushNotifications.register().then(() => {\r\n    console.log(\"PushNotificationController: register called and returned\");\r\n  });\r\n\r\n  // On succcess, we should be able to receive notifications\r\n  PushNotifications.addListener(\r\n    \"registration\",\r\n    (token: PushNotificationToken) => {\r\n      pushApi.subscribe(user, token.value);\r\n      pushEnabled(true);\r\n      showMessage(\"Push registration success, token: \" + token.value);\r\n      log(\"pushNotifications_registered\", {\r\n        token: token.value,\r\n        platform: env.settings.platform,\r\n      });\r\n    }\r\n  );\r\n\r\n  // Some issue with your setup and push will not work\r\n  PushNotifications.addListener(\"registrationError\", (error: any) => {\r\n    showMessage(\"Error on registration: \" + JSON.stringify(error));\r\n    log(\"pushNotifications_registrationError\", {\r\n      error,\r\n      platform: env.settings.platform,\r\n    });\r\n  });\r\n\r\n  // Show us the notification payload if the app is open on our device\r\n  PushNotifications.addListener(\r\n    \"pushNotificationReceived\",\r\n    (notification: PushNotification) => {\r\n      if (notification) {\r\n        if (notification.data && notification.data.MessageId) {\r\n          showMessage(\r\n            \"NOTIFICATION: \" +\r\n              notification.title +\r\n              \": \" +\r\n              notification.body +\r\n              \" id:\" +\r\n              notification.data.MessageId\r\n          );\r\n          history.push(\"/tabs/messages/\" + notification.data.MessageId);\r\n          history.goForward();\r\n        } else {\r\n          showMessage(\r\n            \"NOTIFICATION: \" +\r\n              notification.title +\r\n              \": \" +\r\n              notification.body +\r\n              \" (no id)\"\r\n          );\r\n        }\r\n\r\n        log(\"pushNotifications_receivedWhenOpen\", {\r\n          title: notification.title,\r\n          body: notification.body,\r\n          messageId: notification.data.MessageId ?? -123,\r\n        });\r\n      }\r\n\r\n      /*\r\n      let notif = this.state.notifications;\r\n      notif.push({ id: notification.id, title: notification.title, body: notification.body })\r\n      this.setState({\r\n        notifications: notif\r\n      })\r\n      */\r\n    }\r\n  );\r\n\r\n  // Method called when tapping on a notification\r\n  PushNotifications.addListener(\r\n    \"pushNotificationActionPerformed\",\r\n    (notification: PushNotificationActionPerformed) => {\r\n      if (\r\n        notification.notification.data &&\r\n        notification.notification.data.MessageId\r\n      ) {\r\n        showMessage(\r\n          \"TAPPED ON NOTIFICATION: \" +\r\n            notification.notification.title +\r\n            \": \" +\r\n            notification.notification.body +\r\n            \" id:\" +\r\n            notification.notification.data.MessageId\r\n        );\r\n        history.push(\r\n          \"/tabs/messages/\" + notification.notification.data.MessageId\r\n        );\r\n        history.goForward();\r\n      } else {\r\n        showMessage(\r\n          \"TAPPED ON NOTIFICATION: \" +\r\n            notification.notification.title +\r\n            \": \" +\r\n            notification.notification.body +\r\n            \" (no id)\"\r\n        );\r\n      }\r\n\r\n      log(\"pushNotifications_actionPerformed\", {\r\n        title: notification.notification.title,\r\n        body: notification.notification.body,\r\n        messageId: notification.notification.data.MessageId ?? -123,\r\n      });\r\n    }\r\n  );\r\n};\r\n\r\nexport default {\r\n  register,\r\n};\r\n","/* eslint-disable */\r\nimport React, { useState, useEffect } from \"react\";\r\nimport db from \"../data/dbStore\";\r\nimport { Capacitor, Geolocation, GeolocationPosition } from \"@capacitor/core\";\r\nimport { log } from \"../util/logger\";\r\n\r\nimport PushController from \"../util/push-notifications-controller\";\r\nimport env from \"../api/environment\";\r\n\r\nexport interface ApplicationUser {\r\n  isLoggedin: boolean;\r\n  access_token?: string;\r\n  username?: string;\r\n  darkMode: boolean;\r\n  loading: boolean;\r\n  latitude?: number;\r\n  longitude?: number;\r\n  lastLocationUpdate?: Date;\r\n  environment: string;\r\n  isPushEnabled: boolean;\r\n  requestedGeoPermission: boolean;\r\n  refusedGeoPermission: boolean;\r\n}\r\n\r\nexport interface IApplicationUserContext {\r\n  user: ApplicationUser;\r\n  logout: () => Promise<void>;\r\n  userLoggedIn: (\r\n    username: string,\r\n    access_token: string,\r\n    environment: string\r\n  ) => Promise<ApplicationUser>;\r\n  startWatchPosition: (\r\n    callback: (lat?: number, lng?: number, err?: string) => void\r\n  ) => string;\r\n  clearWatchPosition: (watchId: string) => void;\r\n  pushEnabled: (enabled: boolean) => void;\r\n  requestGeoPermission: () => void;\r\n  setRefusedGeoPermission: (refused: boolean) => void;\r\n}\r\n\r\n// Possible values for code, https://developer.mozilla.org/en-US/docs/Web/API/GeolocationPositionError\r\n// 1: PERMISSION_DENIED\r\n// 2: POSITION_UNAVAILABLE\r\n// 3: TIMEOUT\r\ninterface GeolocationPositionError {\r\n  code: number;\r\n}\r\n\r\nconst INITIAL_APPLICATION_USER: ApplicationUser = {\r\n  isLoggedin: false,\r\n  access_token: undefined,\r\n  username: \"\",\r\n  darkMode: false,\r\n  loading: true,\r\n  latitude: undefined,\r\n  longitude: undefined,\r\n  lastLocationUpdate: undefined,\r\n  environment: \"prod\",\r\n  isPushEnabled: false,\r\n  requestedGeoPermission: false,\r\n  refusedGeoPermission: false,\r\n};\r\n\r\nconst geoPositionOptions = {\r\n  enableHighAccuracy: true,\r\n  maximumAge: 1000,\r\n};\r\n\r\nconst INITIAL_APPLICATION_USER_CONTEXT = {\r\n  user: INITIAL_APPLICATION_USER,\r\n  logout: async () => {},\r\n  userLoggedIn: (u: string, at: string, e: string) => {\r\n    return new Promise<ApplicationUser>(() => {\r\n      return INITIAL_APPLICATION_USER;\r\n    });\r\n  },\r\n  startWatchPosition: (callback: (lat: number, lng: number) => void) => {\r\n    return \"\";\r\n  },\r\n  clearWatchPosition: (s: string) => {},\r\n  pushEnabled: (e: boolean) => {},\r\n  requestGeoPermission: () => {},\r\n  setRefusedGeoPermission: (refused: boolean) => {},\r\n};\r\n\r\nexport const ApplicationUserContext = React.createContext<\r\n  IApplicationUserContext\r\n>(INITIAL_APPLICATION_USER_CONTEXT);\r\n\r\nexport const ApplicationUserContextProvider = (props: any) => {\r\n  const [userState, internalSetUserState] = useState({\r\n    ...INITIAL_APPLICATION_USER,\r\n  });\r\n\r\n  // ----------------------------------------------------------------------------------------------\r\n  function startWatchPosition(\r\n    callback: (lat?: number, lng?: number, err?: string) => void\r\n  ): string {\r\n    const watchPositionCallBack = (position: GeolocationPosition) => {\r\n      if (!position || !position.coords) {\r\n        return;\r\n      }\r\n\r\n      let reason = \"unknown\";\r\n      let positionChanged: boolean;\r\n      if (\r\n        google &&\r\n        google.maps &&\r\n        google.maps.geometry &&\r\n        google.maps.geometry.spherical &&\r\n        google.maps.geometry.spherical.computeDistanceBetween &&\r\n        userState.latitude &&\r\n        userState.longitude\r\n      ) {\r\n        if (userState.latitude && userState.longitude) {\r\n          const oldPos = new google.maps.LatLng(\r\n            userState.latitude,\r\n            userState.longitude\r\n          );\r\n          const newPos = new google.maps.LatLng(\r\n            position.coords.latitude,\r\n            position.coords.longitude\r\n          );\r\n          const distance =\r\n            google.maps.geometry.spherical.computeDistanceBetween(\r\n              oldPos,\r\n              newPos\r\n            ) * 3.28084;\r\n          positionChanged = distance > 2.0; // we've change donly if distance is greater than 3 feet\r\n          reason = \"distance greater than 2 feet (\" + distance + \")\";\r\n        } else {\r\n          positionChanged = true;\r\n          reason = \"original lat/lng were empty\";\r\n        }\r\n      } else {\r\n        positionChanged =\r\n          userState.latitude !== position.coords.latitude ||\r\n          userState.longitude !== position.coords.longitude;\r\n        reason = \"position different\";\r\n      }\r\n\r\n      if (positionChanged) {\r\n        console.log(\r\n          \"Position changed, calling callback and setting user state, \" + reason\r\n        );\r\n        const newState = {\r\n          ...userState,\r\n          latitude: position.coords.latitude,\r\n          longitude: position.coords.longitude,\r\n          lastLocationUpdate: new Date(),\r\n        };\r\n        internalSetUserState(newState);\r\n        callback(position.coords.latitude, position.coords.longitude);\r\n      }\r\n    };\r\n\r\n    const errCallback = (err: GeolocationPositionError) => {\r\n      console.log(\"Could not get geolocation, error code \" + err.code);\r\n      if (err.code === 1) {\r\n        // permission denied\r\n        callback(\r\n          undefined,\r\n          undefined,\r\n          \"Could not get location: permission denied\"\r\n        );\r\n      }\r\n    };\r\n\r\n    let watchId = \"\";\r\n    if (\r\n      env.settings.hasCapacitor &&\r\n      Capacitor.isPluginAvailable(\"Geolocation\")\r\n    ) {\r\n      console.log(\"ApplicatinUserContext: Using Cap plugin to watch position\");\r\n      try {\r\n        watchId = Geolocation.watchPosition(\r\n          geoPositionOptions,\r\n          watchPositionCallBack\r\n        );\r\n      } catch (err) {\r\n        errCallback({ code: 1 });\r\n      }\r\n    } else if (navigator && navigator.geolocation) {\r\n      console.log(\"ApplicatinUserContext: Using browser API\");\r\n      watchId = navigator.geolocation.watchPosition(\r\n        // @ts-ignore  (watchPositionCallBack's GeolocationPosition param is wonky between Cap & Nav\r\n        watchPositionCallBack,\r\n        errCallback,\r\n        geoPositionOptions\r\n      );\r\n    } else {\r\n      console.log(\r\n        \"ApplicationUserContext.startWatchPosition: Geolocation unavailable via cap/nav\"\r\n      );\r\n      return \"\";\r\n    }\r\n\r\n    console.log(\"ApplicationUserContext.startWatchPosition: start \" + watchId);\r\n    return watchId;\r\n  }\r\n\r\n  // ----------------------------------------------------------------------------------------------\r\n  function clearWatchPosition(watchId: string) {\r\n    if (watchId === \"\") {\r\n      return;\r\n    }\r\n\r\n    if (\r\n      env.settings.hasCapacitor &&\r\n      Capacitor.isPluginAvailable(\"Geolocation\")\r\n    ) {\r\n      Geolocation.clearWatch({ id: watchId }).then(() => {\r\n        console.log(\r\n          \"ApplicationUserContext.stopWatchPosition: cleared \" +\r\n            watchId +\r\n            \" from Capacitor plugin\"\r\n        );\r\n      });\r\n    } else if (navigator && navigator.geolocation) {\r\n      navigator.geolocation.clearWatch(parseInt(watchId));\r\n      console.log(\r\n        \"ApplicationUserContext.stopWatchPosition: cleared browser API watchId \" +\r\n          watchId\r\n      );\r\n    }\r\n  }\r\n\r\n  // ----------------------------------------------------------------------------------------------\r\n  const requestGeoPermission = async () => {\r\n    if (userState.requestedGeoPermission) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      if (\r\n        env.settings.hasCapacitor &&\r\n        Capacitor.isPluginAvailable(\"Geolocation\")\r\n      ) {\r\n        console.log(\r\n          \"ApplicationUserContext: request geolocation permission via cap\"\r\n        );\r\n        await Geolocation.getCurrentPosition(geoPositionOptions);\r\n      } else if (navigator && navigator.geolocation) {\r\n        console.log(\r\n          \"ApplicationUserContext: request geolocation permission via nav\"\r\n        );\r\n        await navigator.geolocation.getCurrentPosition((pos) => {});\r\n      } else {\r\n        console.log(\"Could not request geolocation through Cap or nav\");\r\n      }\r\n\r\n      const newState = {\r\n        ...userState,\r\n        latitude: undefined,\r\n        longitude: undefined,\r\n        lastLocationUpdate: new Date(),\r\n        requestedGeoPermission: true,\r\n      };\r\n\r\n      await db.putUserState(newState);\r\n      internalSetUserState(newState);\r\n      console.log(\"ApplicationUserContext: RequestedGeoPermission set to true\");\r\n    } catch (err) {\r\n      const newState = {\r\n        ...userState,\r\n        latitude: undefined,\r\n        longitude: undefined,\r\n        lastLocationUpdate: new Date(),\r\n        requestedGeoPermission: true,\r\n      };\r\n\r\n      await db.putUserState(newState);\r\n      internalSetUserState(newState);\r\n      console.log(\"ApplicationUserContext: RequestedGeoPermission set to true\");\r\n    }\r\n  };\r\n\r\n  // ----------------------------------------------------------------------------------------------\r\n  const setRefusedGeoPermission = async (refused: boolean) => {\r\n    const newState = {\r\n      ...userState,\r\n      refusedGeoPermission: refused,\r\n    };\r\n\r\n    await db.putUserState(newState);\r\n    internalSetUserState(newState);\r\n  };\r\n\r\n  // ----------------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    let mounted = true;\r\n\r\n    Promise.all([db.getUserState()]).then((response) => {\r\n      if (mounted) {\r\n        const newState = response[0];\r\n        if (newState) {\r\n          internalSetUserState({ ...newState, loading: false });\r\n        } else {\r\n          internalSetUserState({ ...userState, loading: false });\r\n        }\r\n      }\r\n    });\r\n    return () => {\r\n      mounted = false;\r\n    };\r\n\r\n    // eslint-disable-next-line\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (\r\n      userState &&\r\n      !userState.isPushEnabled &&\r\n      userState.access_token &&\r\n      userState.access_token.length > 0 &&\r\n      env.settings.platform !== \"other\"\r\n    ) {\r\n      PushController.register(userState, pushEnabled, () => {});\r\n    }\r\n\r\n    // eslint-disable-next-line\r\n  }, [userState.isPushEnabled, userState.access_token]);\r\n\r\n  // ----------------------------------------------------------------------------------------------\r\n  const pushEnabled = (enabled: boolean) => {\r\n    internalSetUserState({ ...userState, isPushEnabled: enabled });\r\n  };\r\n\r\n  // ----------------------------------------------------------------------------------------------\r\n  const userLoggedIn = async (\r\n    username: string,\r\n    access_token: string,\r\n    environment: string\r\n  ): Promise<ApplicationUser> => {\r\n    const currentState = await db.getUserState();\r\n    const newState = {\r\n      username,\r\n      access_token,\r\n      environment,\r\n      isLoggedin: true,\r\n      darkMode: currentState\r\n        ? currentState.darkMode\r\n        : INITIAL_APPLICATION_USER.darkMode,\r\n      loading: false,\r\n      latitude: undefined,\r\n      longitude: undefined,\r\n      isPushEnabled: false,\r\n      requestedGeoPermission: false,\r\n      refusedGeoPermission: false,\r\n    };\r\n\r\n    await db.putUserState(newState);\r\n    internalSetUserState(newState);\r\n    return newState;\r\n  };\r\n\r\n  // ----------------------------------------------------------------------------------------------\r\n  const logout = async () => {\r\n    const newState = {\r\n      ...userState,\r\n      isLoggedin: false,\r\n      access_token: undefined,\r\n      latitude: undefined,\r\n      longitude: undefined,\r\n      isPushEnabled: false,\r\n      requestedGeoPermission: false,\r\n      refusedGeoPermission: false,\r\n    };\r\n    internalSetUserState(newState);\r\n    await db.putUserState(newState);\r\n  };\r\n\r\n  return (\r\n    <ApplicationUserContext.Provider\r\n      value={{\r\n        user: userState,\r\n        userLoggedIn,\r\n        logout,\r\n        startWatchPosition,\r\n        clearWatchPosition,\r\n        pushEnabled,\r\n        requestGeoPermission,\r\n        setRefusedGeoPermission,\r\n      }}\r\n    >\r\n      {props.children}\r\n    </ApplicationUserContext.Provider>\r\n  );\r\n};\r\n","import { IonAlert } from \"@ionic/react\";\r\nimport React, { useState } from \"react\";\r\n\r\nfunction useDialogBox() {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [alertData, setAlertData] = useState({\r\n    header: \"\",\r\n    message: \"\",\r\n    onDismiss: () => {},\r\n  });\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const showAlert = (\r\n    header: string,\r\n    message: string,\r\n    onDismiss: () => void\r\n  ) => {\r\n    setAlertData({\r\n      header,\r\n      message,\r\n      onDismiss,\r\n    });\r\n\r\n    setIsOpen(true);\r\n  };\r\n\r\n  const alertBoxJsx = (\r\n    <IonAlert\r\n      isOpen={isOpen}\r\n      onDidDismiss={() => {\r\n        setIsOpen(false);\r\n        alertData.onDismiss();\r\n      }}\r\n      header={alertData.header}\r\n      message={alertData.message}\r\n      buttons={[\"OK\"]}\r\n    />\r\n  );\r\n\r\n  return {\r\n    showAlert,\r\n    alertBoxJsx,\r\n  };\r\n}\r\n\r\nexport default useDialogBox;\r\n","import React from \"react\";\r\nimport { IonItem, IonToggle, IonList, IonLabel } from \"@ionic/react\";\r\nimport { NotificationTypeModel } from \"../orbital-interfaces/NotificationTypeModel\";\r\n\r\ninterface ToggleListExProps {\r\n  list: NotificationTypeModel[] | null;\r\n  selected: NotificationTypeModel[] | null;\r\n  selectionChanged(newSelected: NotificationTypeModel[] | null): void;\r\n}\r\n\r\nconst ToggleListEx: React.FC<ToggleListExProps> = ({\r\n  list,\r\n  selected,\r\n  selectionChanged,\r\n}: ToggleListExProps) => {\r\n  // ----------------------------------------------------------------------------------------------\r\n  const isItemChecked = (id: number) => {\r\n    if (!selected || selected.length === 0) {\r\n      return false;\r\n    }\r\n\r\n    for (let i = 0; i < selected.length; i++) {\r\n      if (selected[i].id === id) {\r\n        return true;\r\n      }\r\n    }\r\n\r\n    return false;\r\n  };\r\n\r\n  // ----------------------------------------------------------------------------------------------\r\n  const onAllChanged = () => {\r\n    const checked = list?.length !== selected?.length;\r\n\r\n    if (list?.length === selected?.length) {\r\n      if (checked) {\r\n        return;\r\n      }\r\n\r\n      const newSelected = [] as NotificationTypeModel[];\r\n      selectionChanged(newSelected);\r\n    } else {\r\n      if (!checked) {\r\n        return;\r\n      }\r\n\r\n      selectionChanged(list ? list.slice() : null);\r\n    }\r\n  };\r\n\r\n  // ----------------------------------------------------------------------------------------------\r\n  const itemToggle = (item: NotificationTypeModel) => {\r\n    if (selected === null) {\r\n      return;\r\n    }\r\n\r\n    const checked = !selected.map((n) => n.id).includes(item.id);\r\n\r\n    if (checked) {\r\n      const newList = selected.slice();\r\n      newList.push(item);\r\n      selectionChanged(newList);\r\n    } else {\r\n      const newlist = selected.filter((r) => r.id !== item.id);\r\n      selectionChanged(newlist);\r\n    }\r\n  };\r\n\r\n  if (!list) {\r\n    return <div>Loading...</div>;\r\n  }\r\n\r\n  return (\r\n    <IonItem>\r\n      <IonList>\r\n        <IonItem key={-1}>\r\n          <IonToggle\r\n            mode=\"md\"\r\n            key={-1}\r\n            checked={list?.length === selected?.length}\r\n            onClick={() => onAllChanged()}\r\n          />\r\n          <IonLabel>SELECT ALL</IonLabel>\r\n        </IonItem>\r\n        {list &&\r\n          list.map((toggle) => (\r\n            <IonItem key={toggle.id}>\r\n              <IonToggle\r\n                mode=\"md\"\r\n                key={toggle.id}\r\n                onClick={() => {\r\n                  itemToggle(toggle);\r\n                }}\r\n                checked={isItemChecked(toggle.id)}\r\n              />\r\n              <IonLabel>{toggle.name}</IonLabel>\r\n            </IonItem>\r\n          ))}\r\n      </IonList>\r\n    </IonItem>\r\n  );\r\n};\r\n\r\nexport default ToggleListEx;\r\n","import React, { useContext, useEffect, useState } from \"react\";\r\nimport {\r\n  IonButton,\r\n  IonButtons,\r\n  IonIcon,\r\n  IonContent,\r\n  IonFooter,\r\n  IonHeader,\r\n  IonTitle,\r\n  IonToolbar,\r\n} from \"@ionic/react\";\r\nimport { arrowBackOutline } from \"ionicons/icons\";\r\nimport ToggleListEx from \"../components/ToggleListEx\";\r\nimport pushApi from \"../api/PushNotificationsAPI\";\r\nimport { ApplicationUserContext } from \"../context/ApplicationUserContext\";\r\nimport { NotificationTypeModel } from \"../orbital-interfaces/NotificationTypeModel\";\r\n\r\ninterface NotificationSettingsModalProps {\r\n  onDismissModal: () => void;\r\n  isOpen: boolean;\r\n}\r\n\r\nconst NotificationSettingsModal: React.FC<NotificationSettingsModalProps> = ({\r\n  onDismissModal,\r\n  isOpen,\r\n}: NotificationSettingsModalProps) => {\r\n  const { user } = useContext(ApplicationUserContext);\r\n  const [notifications, setNotifications] = useState(\r\n    null as NotificationTypeModel[] | null\r\n  );\r\n  const [selectedNotifications, setSelectedNotifications] = useState(\r\n    null as NotificationTypeModel[] | null\r\n  );\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (!isOpen) {\r\n      setSelectedNotifications(null);\r\n      setNotifications(null);\r\n      return;\r\n    }\r\n\r\n    let isSubscribed = true;\r\n\r\n    Promise.all([\r\n      pushApi.getTypesSelectedByUser(user),\r\n      pushApi.listTypes(user),\r\n    ]).then((responses) => {\r\n      if (!isSubscribed) {\r\n        return;\r\n      }\r\n\r\n      setSelectedNotifications(responses[0]);\r\n      setNotifications(responses[1]);\r\n    });\r\n\r\n    return () => {\r\n      isSubscribed = false;\r\n    };\r\n  }, [isOpen, user]);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onCancel = () => {\r\n    onDismissModal();\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onSelectionChanged = (newSelected: NotificationTypeModel[]) => {\r\n    const ids = newSelected.map((n) => n.id);\r\n    pushApi.putTypes(user, ids).then(() => {\r\n      setSelectedNotifications(newSelected);\r\n    });\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <IonHeader className=\"ion-no-border\">\r\n        <IonToolbar>\r\n          <IonButtons slot=\"start\">\r\n            <IonButton onClick={onCancel}>\r\n              <IonIcon icon={arrowBackOutline} mode=\"md\" slot=\"icon-only\" />\r\n            </IonButton>\r\n          </IonButtons>\r\n          <IonTitle>Notifications</IonTitle>\r\n        </IonToolbar>\r\n      </IonHeader>\r\n\r\n      <IonContent class=\"outer-content\">\r\n        <ToggleListEx\r\n          list={notifications}\r\n          selected={selectedNotifications}\r\n          selectionChanged={onSelectionChanged}\r\n        />\r\n      </IonContent>\r\n\r\n      <IonFooter>\r\n        <IonToolbar />\r\n      </IonFooter>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default NotificationSettingsModal;\r\n","import {\r\n  IonContent,\r\n  IonHeader,\r\n  IonIcon,\r\n  IonItem,\r\n  IonLabel,\r\n  IonList,\r\n  IonMenu,\r\n  IonModal,\r\n  IonMenuToggle,\r\n  IonTitle,\r\n  IonToolbar,\r\n  IonFooter,\r\n} from \"@ionic/react\";\r\nimport { settings, notifications, mail, logOut } from \"ionicons/icons\";\r\nimport React, { useState } from \"react\";\r\n// import \"./Menu.scss\";\r\nimport \"../global-styles.scss\";\r\nimport { ApplicationUserContext } from \"../context/ApplicationUserContext\";\r\nimport env from \"../api/environment\";\r\nimport useDialogBox from \"../hooks/useDialogBox\";\r\nimport NotificationSettingsModal from \"./NotificationSettingsModal\";\r\nimport { format } from \"date-fns\";\r\n\r\nfunction getGeoString(lat?: number, lng?: number): string {\r\n  if (!lat || !lng) {\r\n    return \"N/A\";\r\n  }\r\n\r\n  return `${lat}/${lng}`;\r\n}\r\n\r\nconst Menu: React.FC = () => {\r\n  const [disableMenu] = useState(false);\r\n  const { user } = React.useContext(ApplicationUserContext);\r\n  const environment = env.settings.env.item(user.environment);\r\n  const userName =\r\n    environment.key !== \"prod\" ? user.username!.substr(4) : user.username!;\r\n  const dlg = useDialogBox();\r\n  const [showNotificationsModal, setShowNotificationsModal] = useState(false);\r\n\r\n  /* tslint:disable:jsx-no-lambda */\r\n  return (\r\n    <IonMenu type=\"overlay\" disabled={disableMenu} contentId=\"main\">\r\n      <IonHeader className=\"ion-no-border\">\r\n        <IonToolbar>\r\n          <IonTitle>Menu</IonTitle>\r\n        </IonToolbar>\r\n      </IonHeader>\r\n      <IonContent class=\"outer-content\">\r\n        {environment.key !== \"prod\" && (\r\n          <div className=\"header\">\r\n            {userName.toUpperCase()} ({environment.name.toUpperCase()})\r\n          </div>\r\n        )}\r\n        {environment.key === \"prod\" && <div className=\"header\">{userName}</div>}\r\n        <IonList>\r\n          <IonMenuToggle auto-hide=\"false\">\r\n            <IonItem button={true} routerLink=\"/account\" routerDirection=\"none\">\r\n              <IonLabel>Settings</IonLabel>\r\n              <IonIcon slot=\"end\" icon={settings} />\r\n            </IonItem>\r\n          </IonMenuToggle>\r\n\r\n          <IonMenuToggle auto-hide=\"false\">\r\n            <IonItem\r\n              button={true}\r\n              onClick={() => {\r\n                setShowNotificationsModal(true);\r\n              }}\r\n            >\r\n              <IonLabel>Notifications</IonLabel>\r\n              <IonIcon slot=\"end\" icon={notifications} />\r\n            </IonItem>\r\n          </IonMenuToggle>\r\n          {/* KENKEN: TODO: Add 'My Account' and 'Legend' menu items in menu\r\n          <IonMenuToggle auto-hide=\"false\">\r\n            <IonItem button={true} routerLink=\"/account\" routerDirection=\"none\">\r\n              <IonLabel>My Account</IonLabel>\r\n              <IonIcon slot=\"end\" icon={person} />\r\n            </IonItem>\r\n          </IonMenuToggle>\r\n          <IonMenuToggle auto-hide=\"false\">\r\n            <IonItem button={true} routerLink=\"/account\" routerDirection=\"none\">\r\n              <IonLabel>Legend</IonLabel>\r\n              <IonIcon slot=\"end\" icon={colorPalette} />\r\n            </IonItem>\r\n          </IonMenuToggle>\r\n          */}\r\n          <IonMenuToggle auto-hide=\"false\">\r\n            <IonItem button={true} routerLink=\"/account\" routerDirection=\"none\">\r\n              <IonLabel>Submit a Ticket</IonLabel>\r\n              <IonIcon slot=\"end\" icon={mail} />\r\n            </IonItem>\r\n          </IonMenuToggle>\r\n          <IonMenuToggle auto-hide=\"false\">\r\n            <IonItem button={true} routerLink=\"/logout\" routerDirection=\"none\">\r\n              <IonIcon slot=\"end\" icon={logOut} />\r\n              <IonLabel>Logout</IonLabel>\r\n            </IonItem>\r\n          </IonMenuToggle>\r\n        </IonList>\r\n        {dlg.alertBoxJsx}\r\n      </IonContent>\r\n      <IonFooter className=\"footer\">\r\n        <div className=\"debug-info\">\r\n          Geo: {getGeoString(user.latitude, user.longitude)}\r\n          <br />\r\n          Updated:{\" \"}\r\n          {user.lastLocationUpdate\r\n            ? format(user.lastLocationUpdate, \"M/d EEE h:mmaa\")\r\n            : \"N/A\"}\r\n          <br />\r\n          Capacitor: {env.settings.hasCapacitor ? \"Yes\" : \"No\"}\r\n          <br />\r\n          Build Date: {env.settings.buildDate}\r\n          <br />\r\n          Version: {env.settings.appVersionString}\r\n        </div>\r\n      </IonFooter>\r\n\r\n      <IonModal isOpen={showNotificationsModal}>\r\n        <NotificationSettingsModal\r\n          onDismissModal={() => {\r\n            setShowNotificationsModal(false);\r\n          }}\r\n          isOpen={showNotificationsModal}\r\n        />\r\n      </IonModal>\r\n    </IonMenu>\r\n  );\r\n};\r\n\r\nexport default Menu;\r\n","import { ClockInRequirement } from \"../enums/ClockInRequirement\";\r\nimport { EventInformation } from \"./TEC\";\r\nimport { DailyNotes } from \"./DailyNotes\";\r\n\r\nexport interface HomePageDataGet {\r\n  auth: AuthorizedItems;\r\n  currentEvents: EventInformation[];\r\n  nextEvent?: EventInformation;\r\n  dailyNotes: DailyNotes[];\r\n}\r\n\r\nexport enum Role {\r\n  Employee = \"Employee\",\r\n  Admin = \"Admin\",\r\n  LocationAdmin = \"Location Admin\",\r\n  BusinessAdmin = \"Business Admin\",\r\n  Orbital = \"Orbital\",\r\n}\r\n\r\nexport const initialHomePageData: HomePageDataGet = {\r\n  auth: {\r\n    locations: [],\r\n    tags: [],\r\n    payrollEvents: [],\r\n    employeeId: 0,\r\n    loading: false,\r\n    role: Role.Employee,\r\n    lastRefresh: undefined,\r\n  },\r\n  currentEvents: [],\r\n  nextEvent: undefined,\r\n  dailyNotes: [],\r\n};\r\n\r\nexport enum TimeFormat {\r\n  HoursMinutes = 0, // 05:59\r\n  HoursAndDecimals = 1, // 5.99\r\n}\r\n\r\nexport enum ClockOutValueType {\r\n  Unit = 1,\r\n  Money = 2,\r\n}\r\n\r\nexport enum AdminAuthorization {\r\n  None = 0,\r\n  CanViewWages = 1,\r\n  CanEditPublishedTo = 2,\r\n  CanEditTemplates = 4,\r\n  CanEditSchedules = 8,\r\n  CanEditEmployeeClockEvents = 16,\r\n  CanEditOwnClockEvents = 32,\r\n  CanEditUserAccounts = 64,\r\n}\r\n\r\nexport interface AuthorizedItems {\r\n  employeeId: number;\r\n  role: Role;\r\n  loading: boolean;\r\n  locations: AuthorizedLocation[];\r\n  tags: AuthorizedTag[];\r\n  payrollEvents: AuthorizedPayrollEvent[];\r\n  lastRefresh: Date | undefined;\r\n}\r\n\r\nexport interface AuthorizedLocation {\r\n  id: number;\r\n  name: string;\r\n  abbr: string;\r\n  adminAllDepts: boolean;\r\n  departments: AuthorizedDepartment[];\r\n  settings: LocationSettings;\r\n}\r\n\r\nexport interface AuthorizedDepartment {\r\n  id: number;\r\n  name: string;\r\n  abbr: string;\r\n  isDeptAdmin: boolean;\r\n  adminAuth: AdminAuthorization;\r\n  positions: AuthorizedPosition[];\r\n}\r\n\r\nexport interface AuthorizedTag {\r\n  id: number;\r\n  name: string;\r\n  locId: number;\r\n  positionIds: number[];\r\n}\r\n\r\nexport interface AuthorizedPosition {\r\n  id: number;\r\n  name: string;\r\n  hasPosition: boolean;\r\n  tagsIds: number[];\r\n  payrollEventIds: number[];\r\n}\r\n\r\nexport interface AuthorizedPayrollEvent {\r\n  id: number;\r\n  name: string;\r\n  positionIds: number[];\r\n}\r\n\r\nexport enum UnscheduledBreakOptions {\r\n  Both = 0,\r\n  Unpaid = 1,\r\n  Paid = 2,\r\n  None = 3,\r\n}\r\n\r\nexport enum BreakType {\r\n  UnscheduledUnpaid = 0,\r\n  UnscheduledPaid = 1,\r\n  Scheduled = 2,\r\n}\r\n\r\nexport enum EmployeeSort {\r\n  FirstName = 1,\r\n  LastName = 2,\r\n  EmploymentStart = 3,\r\n  EarliestEventStart = 4,\r\n}\r\n\r\nexport interface LocationSettings {\r\n  LocationId: number;\r\n  DayStartTime: any;\r\n  DayWeekStartsOn: string;\r\n  EmployeeRequestWindowStart: number;\r\n  EmployeeRequestWindowEnd: number;\r\n  EmployeeDaysToShowSchedule: number;\r\n  RequestPanelDisplayDays: number;\r\n  EmployeesShowShiftEventType: boolean;\r\n  ShowUnavailableEventType: boolean;\r\n  ShowVacationEventType: boolean;\r\n  ShowAbsentEventType: boolean;\r\n  ShowSpecialDates: boolean;\r\n  AllowEmployeesToDeleteUnavailableAndVacationApproved: boolean;\r\n  EmployeesOnlyViewOwnPositions: boolean;\r\n  EmployeesOnlyViewOwnDepartments: boolean;\r\n  EnableLegacyBreak: boolean;\r\n  EnableLegacyBreakStart: boolean;\r\n  DefaultBreakDuration: any;\r\n  DefaultBreakStartTime: any;\r\n  ShowTimeClockBreak: boolean;\r\n  EnableEnhancedBreakManagement: boolean;\r\n  TimeZoneOffset: number;\r\n  OtherEmployeesViewableTypeAndStatus: any;\r\n  NotesPanel: number;\r\n  ClockOutValueLabel: string;\r\n  ClockOutValueType: ClockOutValueType;\r\n  EnableEventConfirm: boolean;\r\n  TimeFormat: TimeFormat;\r\n  TimeFormatDigits: number;\r\n  TimeFormatDecimals: number;\r\n  LockDate: any;\r\n  HideScheduleEventsInPast: boolean;\r\n  NewEventDefaultStartTime: any;\r\n  NewEventDefaultEndTime: any;\r\n  EnableAutoAdjustingDateTimes: any;\r\n  GenericEmployeeIdName: string;\r\n  GenericEmployeeId2Name: string;\r\n  GenericEmployeeId3Name: string;\r\n  GenericEmployeePerPositionIdName: string;\r\n  GenericEmployeePerPositionId2Name: string;\r\n  GenericEmployeePerPositionId3Name: string;\r\n  GenericPositionIdName: string;\r\n  GenericPositionId2Name: string;\r\n  GenericPositionId3Name: string;\r\n  GenericDepartmentIdName: string;\r\n  GenericDepartmentId2Name: string;\r\n  GenericDepartmentId3Name: string;\r\n  GenericLocationIdName: string;\r\n  GenericLocationId2Name: string;\r\n  GenericLocationId3Name: string;\r\n  CalculatedSchedulePublishedTo: any;\r\n  RequireGeoLocation: boolean;\r\n  RequireIPAddress: boolean;\r\n  EnablePTO: boolean;\r\n  ClockInWithDifferentTag: boolean;\r\n  UnscheduledBreakOptions: UnscheduledBreakOptions;\r\n  ClockInRequirement: ClockInRequirement;\r\n  EmployeeSort: EmployeeSort;\r\n  EnableDirectCoverRequest: boolean;\r\n  EnablePositionChangeForEmployeePosition: boolean;\r\n}\r\n","/* eslint camelcase: 0 */\r\nimport {\r\n  HomePageDataGet,\r\n  AuthorizedItems,\r\n} from \"../orbital-interfaces/authorized-items\";\r\nimport { ApplicationUser } from \"../context/ApplicationUserContext\";\r\nimport env from \"./environment\";\r\nimport apiHelper from \"./OrbitalApiHelper\";\r\n\r\ninterface AccessTokenResponse {\r\n  access_token: string;\r\n  token_type: string;\r\n  expires_in: number;\r\n  error?: string;\r\n  error_description?: string;\r\n  [\".issued\"]: string;\r\n  [\".expires\"]: string;\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst authenticateUser = async (\r\n  username: string,\r\n  password: string,\r\n  environment: string\r\n) => {\r\n  console.log(\r\n    `Authenticating against ${env.settings.env.item(environment).name} (${\r\n      env.settings.env.item(environment).url\r\n    })`\r\n  );\r\n  const url = env.settings.env.item(environment).url + \"token\";\r\n  const body = `grant_type=password&username=${username}&password=${password}`;\r\n  try {\r\n    const response = await fetch(url, {\r\n      method: \"POST\",\r\n      body: body,\r\n    });\r\n\r\n    const json = (await response.json()) as AccessTokenResponse;\r\n    if (json.error || json.error_description) {\r\n      return {\r\n        loggedIn: false,\r\n        error: json.error_description,\r\n        access_token: \"\",\r\n      };\r\n    }\r\n\r\n    return { loggedIn: true, access_token: json.access_token };\r\n  } catch (err) {\r\n    console.error(\"Error returned from authentication request: \" + err);\r\n    return {\r\n      loggedIn: false,\r\n      err,\r\n      error: \"Error attempting to log in\",\r\n      access_token: \"\",\r\n    };\r\n  }\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst getHomePageData = async (user: ApplicationUser) => {\r\n  return (await apiHelper.get(user, \"api/v3/home/get/0\")) as HomePageDataGet;\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst getAuthorizedItems = async (user: ApplicationUser) => {\r\n  const result = (await apiHelper.get(\r\n    user,\r\n    \"api/v3/home/get-auth\"\r\n  )) as AuthorizedItems;\r\n  return result;\r\n};\r\n\r\nexport default {\r\n  authenticateUser,\r\n  getHomePageData,\r\n  getAuthorizedItems,\r\n};\r\n","enum EventType {\r\n  Shift = 1,\r\n  Unavailable = 2,\r\n  Vacation = 3,\r\n  Cover = 4,\r\n  Clock = 6,\r\n  Absent = 7,\r\n}\r\n\r\nexport default EventType;\r\n","enum EventStatus {\r\n  Approved = 1,\r\n  Request = 2,\r\n  RequestDenied = 4,\r\n}\r\n\r\nexport default EventStatus;\r\n","import {\r\n  AdminAuthorization,\r\n  AuthorizedDepartment,\r\n  AuthorizedItems,\r\n  AuthorizedLocation,\r\n  AuthorizedPosition,\r\n  Role,\r\n} from \"../orbital-interfaces/authorized-items\";\r\nimport EventType from \"../enums/EventType\";\r\nimport EventStatus from \"../enums/EventStatus\";\r\n\r\nexport interface PositionEx {\r\n  location: AuthorizedLocation;\r\n  department: AuthorizedDepartment | null;\r\n  position: AuthorizedPosition | null;\r\n}\r\n\r\nexport interface SelectedPosition {\r\n  location: AuthorizedLocation;\r\n  position: AuthorizedPosition;\r\n}\r\n\r\nexport interface SelectedDepartment {\r\n  location: AuthorizedLocation;\r\n  department: AuthorizedDepartment | null;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst getLocSettingsForLocationId = (\r\n  auth: AuthorizedItems,\r\n  locationId: number\r\n) => {\r\n  if (!auth || !auth.locations || auth.locations.length === 0) {\r\n    throw new Error(\r\n      \"getLocSettingsForLocationId: called with invalid auth parameter\"\r\n    );\r\n  }\r\n\r\n  if (locationId === 0) {\r\n    return auth.locations[0].settings;\r\n  }\r\n\r\n  return auth.locations.filter((loc) => loc.id === locationId)[0].settings;\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst getLocationFromLocationId = (\r\n  auth: AuthorizedItems,\r\n  locationId: number\r\n) => {\r\n  if (!auth || !auth.locations || auth.locations.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  if (locationId <= 0) {\r\n    return null;\r\n  }\r\n\r\n  return auth.locations.filter((l) => l.id === locationId)[0];\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\n// Returns true if the user can edit their own events (they have a position within one of\r\n// the admin's editable departments)\r\nconst canEditNonPositionEvents = (\r\n  auth: AuthorizedItems,\r\n  departmentId: number\r\n): boolean => {\r\n  const dept = auth.locations.flatMap((l) =>\r\n    l.departments.filter((d) => d.id === departmentId)\r\n  )[0];\r\n  if (\r\n    (dept.adminAuth & AdminAuthorization.CanEditSchedules) !==\r\n    AdminAuthorization.CanEditSchedules\r\n  ) {\r\n    return false;\r\n  }\r\n\r\n  return dept.positions.filter((p) => p.hasPosition).length > 0;\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst getPositionIdsForEmployee = (auth: AuthorizedItems): number[] => {\r\n  return auth.locations.flatMap((l) =>\r\n    l.departments.flatMap((d) =>\r\n      d.positions.filter((p) => p.hasPosition).map((p) => p.id)\r\n    )\r\n  );\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst getDepartmentFromPositionId = (\r\n  auth: AuthorizedItems,\r\n  positionId: number\r\n) => {\r\n  if (!auth || !auth.locations || auth.locations.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  if (positionId <= 0) {\r\n    return null;\r\n  }\r\n\r\n  let foundDepartment = null as AuthorizedDepartment | null;\r\n  auth.locations.flatMap((l) =>\r\n    l.departments.map((d) => {\r\n      const foundPosition = d.positions.filter((p) => p.id === positionId);\r\n      if (foundPosition.length === 1) {\r\n        foundDepartment = d;\r\n        return d;\r\n      }\r\n\r\n      return null;\r\n    })\r\n  );\r\n\r\n  return foundDepartment;\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\n// Returns true if the Admin can edit schedules for the passed-in department\r\nconst canEditSchedules = (\r\n  auth: AuthorizedItems,\r\n  locationId: number,\r\n  departmentId: number\r\n) => {\r\n  return (\r\n    (auth.locations\r\n      .filter((l) => l.id === locationId)[0]\r\n      .departments.filter((d) => d.id === departmentId)[0].adminAuth &\r\n      AdminAuthorization.CanEditSchedules) ===\r\n    AdminAuthorization.CanEditSchedules\r\n  );\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\n// Returns true if the event type is a type that is associated to a position (e.g.,\r\n// not an unavailable)\r\nconst isPositionSpecificEvent = (eventType: EventType) => {\r\n  return (\r\n    eventType === EventType.Shift ||\r\n    eventType === EventType.Cover ||\r\n    eventType === EventType.Clock ||\r\n    eventType === EventType.Absent\r\n  );\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\n// Returns true if 1) the user is an Admin and 2) they have a position in the passed-in department\r\nconst adminIsInDepartment = (auth: AuthorizedItems, departmentId: number) => {\r\n  if (auth.role !== Role.Admin) {\r\n    return false;\r\n  }\r\n\r\n  const dept = auth.locations.flatMap((l) =>\r\n    l.departments.filter((d) => d.id === departmentId)\r\n  )[0];\r\n  return dept.positions.filter((p) => p.hasPosition).length > 0;\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst getAdminAuthorizationForDepartment = (\r\n  auth: AuthorizedItems,\r\n  departmentId: number\r\n) => {\r\n  return auth.locations.flatMap((l) =>\r\n    l.departments.filter((d) => d.id === departmentId)\r\n  )[0].adminAuth;\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst hasPosition = (auth: AuthorizedItems, positionId: number) => {\r\n  return (\r\n    auth.locations.flatMap((l) =>\r\n      l.departments.flatMap((d) =>\r\n        d.positions.filter((p) => p.hasPosition && p.id === positionId)\r\n      )\r\n    ).length > 0\r\n  );\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst getSelectedDepartment = (\r\n  auth: AuthorizedItems,\r\n  locId: number,\r\n  depId: number\r\n): SelectedDepartment => {\r\n  const location = getLocationFromLocationId(auth, locId);\r\n  if (location === null) {\r\n    throw new Error(\r\n      `getSelectedDepartment: Could not find locationId \"${locId}\"`\r\n    );\r\n  }\r\n\r\n  if (depId === -1) {\r\n    return {\r\n      location,\r\n      department: null,\r\n    } as SelectedDepartment;\r\n  }\r\n\r\n  const department = location.departments.filter((d) => d.id === depId)[0];\r\n  return { location, department } as SelectedDepartment;\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst getSelectedPositionWithLocId = (\r\n  loc: AuthorizedLocation[],\r\n  locId: number,\r\n  posId: number\r\n) => {\r\n  const location = loc.filter((l) => l.id === locId)[0];\r\n  const position = location.departments.flatMap((d) =>\r\n    d.positions.filter((p) => p.id === posId)\r\n  )[0];\r\n  return { location, position };\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst getSelectedPosition = (loc: AuthorizedLocation[], posId: number) => {\r\n  for (let locPosId = 0; locPosId < loc.length; locPosId++) {\r\n    for (\r\n      let depPosId = 0;\r\n      depPosId < loc[locPosId].departments.length;\r\n      depPosId++\r\n    ) {\r\n      for (\r\n        let posPosId = 0;\r\n        posPosId < loc[locPosId].departments[depPosId].positions.length;\r\n        posPosId++\r\n      ) {\r\n        if (\r\n          loc[locPosId].departments[depPosId].positions[posPosId].id === posId\r\n        ) {\r\n          return {\r\n            location: loc[locPosId],\r\n            position: loc[locPosId].departments[depPosId].positions[posPosId],\r\n          };\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  return {\r\n    location: {} as AuthorizedLocation,\r\n    position: {} as AuthorizedPosition,\r\n  };\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst requiresGeolocation = (locations: AuthorizedLocation[]): boolean => {\r\n  for (let i = 0; i < locations.length; i++) {\r\n    if (locations[i].settings.RequireGeoLocation) {\r\n      return true;\r\n    }\r\n  }\r\n  return false;\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst isAdminForAllDepts = (auth: AuthorizedItems, locationId: number) => {\r\n  if (auth.role === Role.BusinessAdmin || auth.role === Role.LocationAdmin) {\r\n    return true;\r\n  }\r\n\r\n  if (auth.role === Role.Employee) {\r\n    return false;\r\n  }\r\n\r\n  const location = getLocationFromLocationId(auth, locationId);\r\n  return location?.adminAllDepts === true;\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst isDeptAdmin = (auth: AuthorizedItems, departmentId: number): boolean => {\r\n  if (!auth || !auth.locations || auth.locations.length === 0) {\r\n    return false;\r\n  }\r\n\r\n  if (auth.role === Role.Employee) {\r\n    return false;\r\n  }\r\n\r\n  if (auth.role === Role.BusinessAdmin || auth.role === Role.LocationAdmin) {\r\n    return true;\r\n  }\r\n\r\n  const dept = auth.locations.flatMap((l) =>\r\n    l.departments.filter((d) => d.id === departmentId)\r\n  )[0];\r\n\r\n  return dept.isDeptAdmin;\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst isAdminAuthorizedFor = (\r\n  auth: AuthorizedItems,\r\n  locationId: number,\r\n  departmentId: number,\r\n  adminAuth: AdminAuthorization\r\n): boolean => {\r\n  if (!auth || !auth.locations || auth.locations.length === 0) {\r\n    return false;\r\n  }\r\n\r\n  if (auth.role === Role.Employee) {\r\n    return false;\r\n  }\r\n\r\n  if (auth.role === Role.LocationAdmin || auth.role === Role.BusinessAdmin) {\r\n    return true;\r\n  }\r\n\r\n  if (departmentId === -1) {\r\n    const location = getLocationFromLocationId(auth, locationId);\r\n    return location?.adminAllDepts === true;\r\n  }\r\n\r\n  const dept = auth.locations.flatMap((l) =>\r\n    l.departments.filter((d) => d.id === departmentId)\r\n  )[0];\r\n\r\n  return (dept.adminAuth & adminAuth) === adminAuth;\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst getAdminDetpartments = (\r\n  auth: AuthorizedItems\r\n): AuthorizedDepartment[] => {\r\n  if (!auth || !auth.locations || auth.locations.length > 0) {\r\n    return [];\r\n  }\r\n\r\n  if (auth.role === Role.Employee) {\r\n    return [];\r\n  }\r\n\r\n  if (auth.role === Role.BusinessAdmin || auth.role === Role.LocationAdmin) {\r\n    return auth.locations.flatMap((l) => l.departments);\r\n  }\r\n\r\n  if (auth.role === Role.Admin) {\r\n    return auth.locations\r\n      .flatMap((l) => l.departments)\r\n      .filter((d) => d.isDeptAdmin);\r\n  }\r\n\r\n  return [];\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst isShiftTypeEvent = (eventType: EventType, eventStatus: EventStatus) => {\r\n  return (\r\n    (eventType === EventType.Shift && eventStatus === EventStatus.Approved) ||\r\n    (eventType === EventType.Cover && eventStatus === EventStatus.Request) ||\r\n    (eventType === EventType.Cover && eventStatus === EventStatus.RequestDenied)\r\n  );\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst isAuthItemsValid = (auth: AuthorizedItems | null | undefined): boolean => {\r\n  return auth !== null &&\r\n    auth !== undefined &&\r\n    auth!.locations !== undefined &&\r\n    auth!.locations !== null &&\r\n    auth!.locations.length > 0;\r\n};\r\n\r\nexport default {\r\n  getLocSettingsForLocationId,\r\n  getLocationFromLocationId,\r\n  getDepartmentFromPositionId,\r\n  getPositionIdsForEmployee,\r\n  isPositionSpecificEvent,\r\n  canEditSchedules,\r\n  getAdminAuthorizationForDepartment,\r\n  adminIsInDepartment,\r\n  canEditNonPositionEvents,\r\n  hasPosition,\r\n  isAuthItemsValid,\r\n  isShiftTypeEvent,\r\n  isDeptAdmin,\r\n  isAdminForAllDepts,\r\n  isAdminAuthorizedFor,\r\n  getSelectedDepartment,\r\n  getSelectedPositionWithLocId,\r\n  getSelectedPosition,\r\n  getAdminDetpartments,\r\n  requiresGeolocation,\r\n};\r\n","/* eslint-disable */\r\nimport React, { useState } from \"react\";\r\nimport { AuthorizedItems, Role } from \"../orbital-interfaces/authorized-items\";\r\nimport db from \"../data/dbStore\";\r\nimport UserAPI from \"../api/UserAPI\";\r\nimport {\r\n  ApplicationUser,\r\n  ApplicationUserContext,\r\n} from \"./ApplicationUserContext\";\r\nimport { log } from \"../util/logger\";\r\nimport { differenceInMinutes } from \"date-fns\";\r\nimport { getConstants } from \"../api/environment\";\r\nimport authHelper from \"../util/authitems-helper\";\r\n\r\nexport interface IAuthorizedItemsContext {\r\n  auth: AuthorizedItems;\r\n  refreshAuth: (\r\n    force: boolean,\r\n    newUser: ApplicationUser\r\n  ) => Promise<AuthorizedItems | null>;\r\n  clearAuth: () => Promise<void>;\r\n  authLoading: boolean;\r\n}\r\n\r\nconst INITIAL_AUTHORIZED_ITEMS: AuthorizedItems = {\r\n  employeeId: 0,\r\n  role: Role.Employee,\r\n  locations: [],\r\n  loading: false,\r\n  payrollEvents: [],\r\n  tags: [],\r\n  lastRefresh: undefined,\r\n};\r\n\r\nconst INITIAL_AUTHITEMS_CONTEXT = {\r\n  auth: INITIAL_AUTHORIZED_ITEMS,\r\n  refreshAuth: (force: boolean, newUser: ApplicationUser) => {\r\n    return new Promise<AuthorizedItems | null>(() => {});\r\n  },\r\n  clearAuth: async () => {},\r\n  authLoading: false,\r\n};\r\n\r\nexport const AuthorizedItemsContext = React.createContext<\r\n  IAuthorizedItemsContext\r\n>(INITIAL_AUTHITEMS_CONTEXT);\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function getAuthItems(user: ApplicationUser, force: boolean): Promise<AuthorizedItems | null> {\r\n  if (!user.isLoggedin) {\r\n    const empty = { ...INITIAL_AUTHORIZED_ITEMS };\r\n    await db.putAuthItems(empty).then(() => {\r\n      log(\"indexdb_authitems_cleared\");\r\n    });\r\n\r\n    return empty;\r\n  }\r\n\r\n  if (!force) {\r\n    const authFromStore = await db.getAuthItems();\r\n\r\n    // if the auth in the IndexDB store had valid locations/data and\r\n    // the data wasn't 'stale' (older than our max number of minutes it can be old),\r\n    // then just return what was in the IndexDB\r\n    if (\r\n      authHelper.isAuthItemsValid(authFromStore) &&\r\n      authFromStore!.lastRefresh !== undefined &&\r\n      differenceInMinutes(new Date(), authFromStore!.lastRefresh) <\r\n        getConstants(user).maxStaleAuthItemsInMinutes\r\n    ) {\r\n      return authFromStore!;\r\n    }\r\n  }\r\n\r\n  const authFromApi = await UserAPI.getAuthorizedItems(user);\r\n  if (\r\n    authFromApi &&\r\n    authFromApi.locations &&\r\n    authFromApi.locations.length > 0\r\n  ) {\r\n    await db.putAuthItems({ ...authFromApi, lastRefresh: new Date() });\r\n    log(\"indexdb_authitems_put\", { employeeId: authFromApi.employeeId });\r\n    return authFromApi;\r\n  } else {\r\n    return null;\r\n  }\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\n//\r\n// ----------------------------------------------------------------------------------------------\r\nexport const AuthorizedItemsContextProvider = (props: any) => {\r\n  const [auth, internalSetAuth] = useState({ ...INITIAL_AUTHORIZED_ITEMS });\r\n  const [authLoading, setLoading] = useState(false);\r\n\r\n  // ----------------------------------------------------------------------------------------------\r\n  const refreshAuth = async (force: boolean, newUser: ApplicationUser) => {\r\n    setLoading(true);\r\n\r\n    if (!newUser.isLoggedin) {\r\n      const empty = { ...INITIAL_AUTHORIZED_ITEMS };\r\n      internalSetAuth(empty);\r\n      db.putAuthItems(empty).then(() => {\r\n        log(\"indexdb_authitems_cleared\");\r\n      });\r\n\r\n      setLoading(false);\r\n    }\r\n\r\n    // If we're not being asked to force a refresh from the API, and we already have\r\n    // auth data, and the the last refresh was less than the max time we're allowed to\r\n    // have 'stale' auth items, just return what we have\r\n    if (\r\n      !force &&\r\n      auth.employeeId > 0 &&\r\n      auth.lastRefresh !== undefined &&\r\n      differenceInMinutes(new Date(), auth.lastRefresh) <\r\n        getConstants(newUser).maxStaleAuthItemsInMinutes\r\n    ) {\r\n      return auth;\r\n    }\r\n\r\n    const newAuth = await getAuthItems(newUser, force);\r\n    setLoading(false);\r\n    if (newAuth) {\r\n      internalSetAuth(newAuth);\r\n    }\r\n\r\n    return newAuth;\r\n  };\r\n\r\n  // ----------------------------------------------------------------------------------------------\r\n  const clearAuth = async (): Promise<void> => {\r\n    internalSetAuth(INITIAL_AUTHORIZED_ITEMS);\r\n    return await db.putAuthItems(INITIAL_AUTHORIZED_ITEMS);\r\n  };\r\n\r\n  return (\r\n    <AuthorizedItemsContext.Provider\r\n      value={{\r\n        auth,\r\n        refreshAuth,\r\n        clearAuth,\r\n        authLoading,\r\n      }}\r\n    >\r\n      {props.children}\r\n    </AuthorizedItemsContext.Provider>\r\n  );\r\n};\r\n// ---------------------------------------------------------------------------------------------\r\n","import React, { useState } from \"react\";\r\nimport {\r\n  IonContent,\r\n  IonPage,\r\n  IonRow,\r\n  IonCol,\r\n  IonButton,\r\n  IonList,\r\n  IonText,\r\n  IonLoading,\r\n  useIonViewWillEnter,\r\n} from \"@ionic/react\";\r\n// import \"./Login.scss\";\r\nimport \"../global-styles.scss\";\r\nimport UserAPI from \"../api/UserAPI\";\r\nimport { RouteComponentProps } from \"react-router\";\r\nimport useDialogBox from \"../hooks/useDialogBox\";\r\nimport { ApplicationUserContext } from \"../context/ApplicationUserContext\";\r\nimport env from \"../api/environment\";\r\nimport { log } from \"../util/logger\";\r\nimport { AuthorizedItemsContext } from \"../context/AuthorizedItemsContext\";\r\n\r\ninterface LoginProps extends RouteComponentProps {}\r\n\r\nfunction validate(username: string, password: string): boolean {\r\n  return username.length > 0 && password.length > 5;\r\n}\r\n\r\nconst Login: React.FC<LoginProps> = ({ history }: LoginProps) => {\r\n  const { alertBoxJsx, showAlert } = useDialogBox();\r\n  const { user, userLoggedIn } = React.useContext(ApplicationUserContext);\r\n  const { refreshAuth } = React.useContext(AuthorizedItemsContext);\r\n  const [showLoading, setShowLoading] = useState(false);\r\n  const [username, setUsername] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [usernameErrors] = useState(\"\");\r\n  const [passwordErrors] = useState(\"\");\r\n  const [loginEnabled, setLoginEnabled] = useState(false);\r\n\r\n  // ----------------------------------------------------------------------------------------------\r\n  const onUsernameChange = (newUsername: string) => {\r\n    setUsername(newUsername);\r\n    setLoginEnabled(validate(newUsername, password));\r\n  };\r\n\r\n  // ----------------------------------------------------------------------------------------------\r\n  const onPasswordChange = (newPassword: string) => {\r\n    setPassword(newPassword);\r\n    setLoginEnabled(validate(username, newPassword));\r\n  };\r\n\r\n  // ----------------------------------------------------------------------------------------------\r\n  const login = async () => {\r\n    if (username && password) {\r\n      const envUser = env.getUserAndEnvironmentFromInput(username);\r\n      setShowLoading(true);\r\n      const response = await UserAPI.authenticateUser(\r\n        envUser.username,\r\n        password,\r\n        envUser.env.key\r\n      );\r\n      if (response.loggedIn) {\r\n        const newUser = await userLoggedIn(\r\n          username,\r\n          response.access_token,\r\n          envUser.env.key\r\n        );\r\n        await refreshAuth(true, newUser);\r\n        log(\"login\", {\r\n          username: envUser.username,\r\n          appVersion: env.settings.appVersionString,\r\n          environment: envUser.env.name,\r\n        });\r\n        console.log(`logged in to ${envUser.env.name}: ${envUser.username}`);\r\n        history.push(\"/tabs/schedule\", { direction: \"none\" });\r\n        history.goForward();\r\n        setShowLoading(false);\r\n      } else {\r\n        setShowLoading(false);\r\n        log(\"login_failure\", {\r\n          username: envUser.username,\r\n          appVersion: env.settings.appVersionString,\r\n          environment: envUser.env.name,\r\n        });\r\n        const msg = response.error ? response.error : \"Could not log in\";\r\n        showAlert(\"Failed to log in\", msg, () => {\r\n          setPassword(\"\");\r\n          setLoginEnabled(false);\r\n        });\r\n      }\r\n    }\r\n  };\r\n\r\n  // ----------------------------------------------------------------------------------------------\r\n  useIonViewWillEnter(() => {\r\n    if (user.isLoggedin) {\r\n      history.push(\"/tabs/schedule\", { direction: \"forward\" });\r\n      history.goForward();\r\n    }\r\n  });\r\n\r\n  return (\r\n    <IonPage id=\"login-page\">\r\n      <IonContent className=\"login-content\">\r\n        <div className=\"login-logo\">\r\n          <img\r\n            className=\"logo\"\r\n            src=\"assets/img/OS Logo - 4pt Rounded _ 2 Tone Orange.svg\"\r\n            alt=\"Orbital Shift Logo\"\r\n          />\r\n        </div>\r\n\r\n        <IonLoading\r\n          isOpen={showLoading}\r\n          onDidDismiss={() => setShowLoading(false)}\r\n          spinner=\"dots\"\r\n          message={\"Logging in...\"}\r\n          duration={5000}\r\n        />\r\n\r\n        {alertBoxJsx}\r\n\r\n        <IonList className=\"form-list\">\r\n          <div className=\"item\">\r\n            <div className=\"label\">User</div>\r\n            <div className=\"field-container\">\r\n              <input\r\n                className=\"input\"\r\n                id=\"username\"\r\n                name=\"username\"\r\n                type=\"text\"\r\n                value={username}\r\n                onChange={(e) => {\r\n                  onUsernameChange(e.target.value);\r\n                }}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          {usernameErrors.length > 0 && (\r\n            <IonText color=\"light\">\r\n              <p className=\"ion-padding-start\">{usernameErrors}</p>\r\n            </IonText>\r\n          )}\r\n\r\n          <div className=\"item\">\r\n            <div className=\"label\">Password</div>\r\n            <div className=\"field-container\">\r\n              <input\r\n                className=\"input\"\r\n                id=\"password\"\r\n                name=\"password\"\r\n                type=\"password\"\r\n                value={password}\r\n                onChange={(e) => {\r\n                  onPasswordChange(e.target.value);\r\n                }}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          {passwordErrors.length > 0 && (\r\n            <IonText color=\"light\">\r\n              <p className=\"ion-padding-start\">{passwordErrors}</p>\r\n            </IonText>\r\n          )}\r\n        </IonList>\r\n\r\n        <IonRow>\r\n          <IonCol>\r\n            <IonButton\r\n              className=\"login-button\"\r\n              type=\"submit\"\r\n              onClick={login}\r\n              expand=\"block\"\r\n              disabled={!loginEnabled}\r\n            >\r\n              LOG IN\r\n            </IonButton>\r\n          </IonCol>\r\n        </IonRow>\r\n      </IonContent>\r\n    </IonPage>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n","import { EventBreak } from \"../orbital-interfaces/EventBreak\";\r\nimport { EventInformation } from \"../orbital-interfaces/TEC\";\r\nimport { ScheduleEvent } from \"../orbital-interfaces/ScheduleEvent\";\r\nimport {\r\n  addDays,\r\n  differenceInDays,\r\n  differenceInMinutes,\r\n  format,\r\n  isAfter,\r\n  isSameYear,\r\n  isToday,\r\n  parseISO,\r\n} from \"date-fns\";\r\nimport {\r\n  LocationSettings,\r\n  TimeFormat,\r\n} from \"../orbital-interfaces/authorized-items\";\r\nimport { OrbitalTime } from \"../orbital-interfaces/OrbitalTime\";\r\n\r\nconst noEndTime = new Date(9000, 1, 1);\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nexport function getDurationFromTimeSpan(timespan: string) {\r\n  if (!timespan) {\r\n    return 0;\r\n  }\r\n\r\n  const tok = timespan.split(\":\");\r\n  let hrs: number;\r\n  let min: number;\r\n  if (tok[0].indexOf(\".\") >= 0) {\r\n    const hrTok = tok[0].split(\".\");\r\n    hrs = 24 * parseInt(hrTok[0]) + parseInt(hrTok[1]);\r\n    min = parseInt(tok[1]);\r\n  } else {\r\n    hrs = parseInt(tok[0]);\r\n    min = parseInt(tok[1]);\r\n  }\r\n\r\n  return hrs * 60 + min;\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nexport function messageDateString(time: string) {\r\n  const date = parseISO(time);\r\n  const now = new Date();\r\n\r\n  if (isToday(date)) {\r\n    return format(date, \"h:mmaaa\").replace(\"M\", \"\");\r\n  } else if (differenceInDays(now, date) < 7) {\r\n    return format(date, \"EEE\");\r\n  } else if (isSameYear(date, now)) {\r\n    return format(date, \"MMM d\");\r\n  } else {\r\n    return format(date, \"M/d/yyyy\");\r\n  }\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nexport function getTimeStringFromMinutes(\r\n  locSettings: LocationSettings,\r\n  min: number | null\r\n) {\r\n  if (locSettings.TimeFormat === TimeFormat.HoursMinutes) {\r\n    if (min === null) {\r\n      return \"00:00\";\r\n    }\r\n\r\n    const hours = Math.floor(min / 60);\r\n    const minutes = min % 60;\r\n\r\n    return `${padZeroes(hours, 2)}:${padZeroes(minutes, 2)}`;\r\n  } else {\r\n    if (min === null) {\r\n      return \"0\";\r\n    }\r\n\r\n    return formatDecimal(\r\n      min / 60,\r\n      locSettings.TimeFormatDigits,\r\n      locSettings.TimeFormatDecimals\r\n    );\r\n  }\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nexport function getTimeStringFromOrbitalTime(\r\n  locSettings: LocationSettings,\r\n  time: OrbitalTime\r\n) {\r\n  if (time.ActualTime === \"00:00:00\") {\r\n    return locSettings.TimeFormat === TimeFormat.HoursMinutes\r\n      ? \"00:00\"\r\n      : formatDecimal(\r\n          0,\r\n          locSettings.TimeFormatDigits,\r\n          locSettings.TimeFormatDecimals\r\n        );\r\n  }\r\n\r\n  if (locSettings.TimeFormat === TimeFormat.HoursMinutes) {\r\n    const tok = time.ActualTime.split(\":\");\r\n    if (tok.length !== 3) {\r\n      return time.ActualTime;\r\n    }\r\n\r\n    if (tok[0].includes(\".\")) {\r\n      const dayHourTok = tok[0].split(\".\");\r\n      const hours = 24 * parseInt(dayHourTok[0]) + parseInt(dayHourTok[1]);\r\n      return `${hours}:${tok[1]}`;\r\n    } else {\r\n      const hours = parseInt(tok[0]);\r\n      return `${hours}:${tok[1]}`;\r\n    }\r\n  } else {\r\n    return formatDecimal(\r\n      time.ActualHours,\r\n      locSettings.TimeFormatDigits,\r\n      locSettings.TimeFormatDecimals\r\n    );\r\n  }\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nexport function getMinutesFromTimeString(\r\n  locSettings: LocationSettings,\r\n  str: string\r\n) {\r\n  if (!str || str.length === 0) {\r\n    return 0;\r\n  }\r\n\r\n  if (locSettings.TimeFormat === TimeFormat.HoursMinutes) {\r\n    const hourMinRegEx = /^\\d*(:\\d{2})?$/;\r\n    if (!hourMinRegEx.test(str)) {\r\n      return 0;\r\n    }\r\n\r\n    if (str[0] === \":\") {\r\n      return parseInt(str.substring(1));\r\n    }\r\n\r\n    const tok = str.split(\":\");\r\n    if (tok.length === 1) {\r\n      return parseInt(str) * 60;\r\n    }\r\n\r\n    return parseInt(tok[0]) * 60 + parseInt(tok[1]);\r\n  } else {\r\n    const decimalRegex = /^\\d+(.\\d*)?$/;\r\n    if (!decimalRegex.test(str)) {\r\n      return 0;\r\n    }\r\n\r\n    return Math.round(parseFloat(str) * 60.0);\r\n  }\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nexport function getDurationStringFromTimeSpan(timespan: string) {\r\n  if (!timespan) {\r\n    return \"(0m)\";\r\n  }\r\n  const tok = timespan.split(\":\");\r\n  let hrs: number;\r\n  let min: number;\r\n  if (tok[0].indexOf(\".\") >= 0) {\r\n    const hrTok = tok[0].split(\".\");\r\n    hrs = 24 * parseInt(hrTok[0]) + parseInt(hrTok[1]);\r\n    min = parseInt(tok[1]);\r\n  } else {\r\n    hrs = parseInt(tok[0]);\r\n    min = parseInt(tok[1]);\r\n  }\r\n\r\n  return hrs > 0 ? `(${hrs}h ${min}m)` : `(${min}m)`;\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nexport function getDurationString(minutes: number): string {\r\n  if (minutes < 60) {\r\n    return `(${minutes}m)`;\r\n  }\r\n\r\n  const str = `(${Math.floor(minutes / 60)}h`;\r\n  return minutes % 60 === 0 ? str + \")\" : str + ` ${minutes % 60}m)`;\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nexport function getDurationFromScheduleEvent(\r\n  ev: EventInformation | ScheduleEvent\r\n): number {\r\n  if ((ev as EventInformation).Data) {\r\n    return getDurationFromTimeSpan(\r\n      (ev as EventInformation).Data!.HourlyValue.Time.ActualTime\r\n    );\r\n  }\r\n\r\n  const getDiff = (start: string, end?: string) => {\r\n    const startDate = parseISO(start);\r\n    let endDate = end ? parseISO(end) : new Date();\r\n    if (endDate > noEndTime) {\r\n      endDate = new Date();\r\n    }\r\n    return differenceInMinutes(endDate, startDate);\r\n  };\r\n\r\n  let totalMinutes = getDiff(ev.EventStart, ev.EventEnd);\r\n  if (ev.EventBreaks) {\r\n    ev.EventBreaks.map(\r\n      (b) => (totalMinutes -= getDiff(b.BreakStart, b.BreakEnd))\r\n    );\r\n  }\r\n\r\n  return totalMinutes;\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nexport function getDuration(ev: EventInformation): number {\r\n  const getDiff = (start: string, end?: string) => {\r\n    const startDate = parseISO(start);\r\n    let endDate = end ? parseISO(end) : new Date();\r\n    if (endDate > noEndTime) {\r\n      endDate = new Date();\r\n    }\r\n    return differenceInMinutes(endDate, startDate);\r\n  };\r\n\r\n  let totalMinutes = getDiff(ev.EventStart, ev.EventEnd);\r\n  if (ev.EventBreaks) {\r\n    ev.EventBreaks.map(\r\n      (b) => (totalMinutes -= getDiff(b.BreakStart, b.BreakEnd))\r\n    );\r\n  }\r\n\r\n  return totalMinutes;\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nexport function getTotalDuration(events: EventInformation[]) {\r\n  let totalMinutes = 0;\r\n  events.map((ev) => (totalMinutes += getDuration(ev)));\r\n  return totalMinutes;\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nexport function getTotalDurationFromScheduleEvent(events: ScheduleEvent[]) {\r\n  let totalMinutes = 0;\r\n  events.map((ev) => (totalMinutes += getDurationFromScheduleEvent(ev)));\r\n  return totalMinutes;\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nexport function getDateString(date: Date): string {\r\n  return format(date, \"EEE MMM d, yyyy\").toUpperCase();\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nexport function getStartTime(ev: EventInformation | ScheduleEvent) {\r\n  return format(parseISO(ev.EventStart), \"h:mmaaa\").replace(\"M\", \"\");\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nexport function getMessageDeliveryTimeString(dateStr: string) {\r\n  return format(parseISO(dateStr), \"M/d EEE h:mmaa\").replace(\"M\", \"\");\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nexport function getBreakStartTime(brk: EventBreak) {\r\n  return format(parseISO(brk.BreakStart), \"h:mmaaa\").replace(\"M\", \"\");\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nexport function getEventStartEnd(ev: EventInformation | ScheduleEvent) {\r\n  const start = format(parseISO(ev.EventStart), \"h:mmaaa\").replace(\"M\", \"\");\r\n  const end = format(parseISO(ev.EventEnd), \"h:mmaaa\").replace(\"M\", \"\");\r\n\r\n  return `${start} - ${end}`;\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nexport function getBreakStartEnd(brk: EventBreak) {\r\n  const start = format(parseISO(brk.BreakStart), \"h:mmaaa\").replace(\"M\", \"\");\r\n\r\n  if (!brk.BreakEnd || brk.BreakEnd > noEndTime) {\r\n    return start;\r\n  }\r\n\r\n  const end = format(parseISO(brk.BreakEnd), \"h:mmaaa\").replace(\"M\", \"\");\r\n  return `${start} - ${end}`;\r\n}\r\n// ---------------------------------------------------------------------------------------------\r\nexport function getEventInformationStartEnd(\r\n  ev: EventInformation | ScheduleEvent\r\n) {\r\n  const start = format(parseISO(ev.EventStart), \"h:mmaaa\").replace(\"M\", \"\");\r\n  const end = format(parseISO(ev.EventEnd), \"h:mmaaa\").replace(\"M\", \"\");\r\n\r\n  return `${start} - ${end}`;\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nexport function getEventBreakStartEndString(brk: EventBreak): string {\r\n  const start = format(parseISO(brk.BreakStart), \"h:mmaa\").replace(\"M\", \"\");\r\n  const end = brk.BreakEnd\r\n    ? format(parseISO(brk.BreakEnd), \"h:mmaa\").replace(\"M\", \"\")\r\n    : format(new Date(), \"h:mmaa\").replace(\"M\", \"\");\r\n\r\n  return `${start} - ${end}`;\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nexport function getDateOnlyFromISOString(str: string) {\r\n  const date = parseISO(str);\r\n  const dateOnlyStr = format(date, \"yyyy-MM-dd\");\r\n  return parseISO(dateOnlyStr);\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nexport function getWeekStart(\r\n  date: Date,\r\n  weekStartsOn: string,\r\n  dayStart: string\r\n): Date {\r\n  const dayStartMinutes =\r\n    !dayStart || dayStart.indexOf(\"T\") < 0\r\n      ? 0\r\n      : getDurationFromTimeSpan(dayStart.split(\"T\")[1]);\r\n\r\n  let newDate = date;\r\n  newDate.setHours(0, dayStartMinutes, 0, 0);\r\n\r\n  let counter = 0;\r\n  while (format(newDate, \"EEEE\") !== weekStartsOn && counter < 20) {\r\n    newDate = addDays(newDate, -1);\r\n    counter++;\r\n  }\r\n\r\n  if (counter > 15) {\r\n    console.error(\r\n      `Could not calculate week start based on date ${date}` +\r\n        `and weekStartsOn \"${weekStartsOn}\"`\r\n    );\r\n  }\r\n\r\n  return newDate;\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nexport function getDayStartMinutes(dayStartLocSetting: string) {\r\n  const tok = dayStartLocSetting.split(\"T\");\r\n  return getDurationFromTimeSpan(tok[1]);\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nexport function getTimeDiff(dateStr: string) {\r\n  const now = new Date();\r\n  const dateTime = parseISO(dateStr);\r\n  let minutes = isAfter(now, dateTime)\r\n    ? differenceInMinutes(now, dateTime)\r\n    : differenceInMinutes(dateTime, now);\r\n\r\n  const hours = parseInt(\"\" + minutes / 60, 10);\r\n  minutes = minutes - hours * 60;\r\n  return `${formatDecimal(hours, 2, 0)}:${formatDecimal(minutes, 2, 0)}`;\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nexport function formatDateTimeAsMvcString(d: Date) {\r\n  return (\r\n    \"\" +\r\n    d.getFullYear() +\r\n    \"-\" +\r\n    padZeroes(d.getMonth() + 1, 2) +\r\n    \"-\" +\r\n    padZeroes(d.getDate(), 2) +\r\n    \"T\" +\r\n    padZeroes(d.getHours(), 2) +\r\n    \":\" +\r\n    padZeroes(d.getMinutes(), 2) +\r\n    \":00\"\r\n  );\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nexport function formatDecimal(num: number, digits: number, decimals: number) {\r\n  let val = Number(num).toFixed(decimals).toString();\r\n\r\n  let negative = \"\";\r\n  if (val.indexOf(\"-\") === 0) {\r\n    val = val.substring(1);\r\n    negative = \"-\";\r\n  }\r\n\r\n  const s = \"0000000000\" + val;\r\n  const decPos = val.indexOf(\".\");\r\n  if (decPos === -1) {\r\n    return negative + s.substr(s.length - Math.max(val.length, digits));\r\n  } else {\r\n    return (\r\n      negative +\r\n      s.substr(s.length - Math.max(val.length, digits + decimals + 1))\r\n    );\r\n  }\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nfunction padZeroes(val: any, digitCount: number) {\r\n  const s = \"0000000000\" + val;\r\n  return s.substr(s.length - digitCount);\r\n}\r\n","import EventType from \"../../enums/EventType\";\r\nimport EventStatus from \"../../enums/EventStatus\";\r\nimport {\r\n  AdminAuthorization,\r\n  AuthorizedItems,\r\n  Role,\r\n} from \"../../orbital-interfaces/authorized-items\";\r\nimport { isAfter, parseISO } from \"date-fns\";\r\nimport authHelper, { SelectedPosition } from \"../../util/authitems-helper\";\r\n\r\nexport enum EventEditEnum {\r\n  None,\r\n  UndoCoverRequest,\r\n  CreateShiftRequest,\r\n  DeleteShiftRequest,\r\n  CreateCoverRequest,\r\n  Delete,\r\n}\r\n\r\nexport interface Option {\r\n  value: number;\r\n  text: string;\r\n  color: string;\r\n}\r\n\r\nexport interface EventEditAuthorization {\r\n  buttonText: string;\r\n  enableConfirm: boolean;\r\n  isReadonly: boolean;\r\n  text: string;\r\n  usage: EventEditEnum;\r\n  eventTypeOptionList: Option[];\r\n  eventStatusOptionList: Option[];\r\n}\r\n\r\nexport const getEventNewAuthorization = (\r\n  auth: AuthorizedItems\r\n): EventEditAuthorization | null => {\r\n  let location = auth.locations[0];\r\n  let dept = auth.locations[0].departments[0];\r\n  let position = auth.locations[0].departments[0].positions[0];\r\n  let hasPositionFound = false;\r\n  for (let i = 0; i < auth.locations.length && !hasPositionFound; i++) {\r\n    for (\r\n      let j = 0;\r\n      j < auth.locations[i].departments.length && !hasPositionFound;\r\n      j++\r\n    ) {\r\n      for (\r\n        let k = 0;\r\n        k < auth.locations[i].departments[j].positions.length &&\r\n        !hasPositionFound;\r\n        k++\r\n      ) {\r\n        if (auth.locations[i].departments[j].positions[k].hasPosition) {\r\n          location = auth.locations[i];\r\n          dept = auth.locations[i].departments[j];\r\n          position = auth.locations[i].departments[j].positions[k];\r\n          hasPositionFound = true;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  const selectedPosition = { location, position };\r\n\r\n  let initialStatus = EventStatus.Request;\r\n  if (auth.role === Role.BusinessAdmin || auth.role === Role.LocationAdmin) {\r\n    initialStatus = EventStatus.Approved;\r\n  } else if (\r\n    auth.role === Role.Admin &&\r\n    (dept.adminAuth & AdminAuthorization.CanEditSchedules) ===\r\n      AdminAuthorization.CanEditSchedules\r\n  ) {\r\n    initialStatus = EventStatus.Approved;\r\n  }\r\n\r\n  const eventStatusOptions = getEventStatusOptionsList(\r\n    auth,\r\n    selectedPosition,\r\n    auth.employeeId,\r\n    initialStatus,\r\n    false\r\n  );\r\n  const eventTypeOptions = getEventTypeOptionsList(\r\n    auth,\r\n    selectedPosition,\r\n    auth.employeeId\r\n  );\r\n\r\n  return {\r\n    buttonText: \"\",\r\n    enableConfirm: true,\r\n    isReadonly: false,\r\n    text: \"\",\r\n    usage: EventEditEnum.None,\r\n    eventTypeOptionList: eventTypeOptions,\r\n    eventStatusOptionList: eventStatusOptions,\r\n  } as EventEditAuthorization;\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\nexport const getEventEditAuthorization = (\r\n  eventType: EventType,\r\n  eventStatus: EventStatus,\r\n  eventEmployeeId: number,\r\n  eventStart: string,\r\n  eventEnd: string,\r\n  eventLocationId: number,\r\n  eventDepartmentId: number,\r\n  eventPositionId: number,\r\n  eventConfirmed: boolean,\r\n  auth: AuthorizedItems\r\n): EventEditAuthorization | null => {\r\n  const selectedPosition = authHelper.getSelectedPositionWithLocId(\r\n    auth.locations,\r\n    eventLocationId,\r\n    eventPositionId\r\n  );\r\n  const eventStatusOptions = getEventStatusOptionsList(\r\n    auth,\r\n    selectedPosition,\r\n    eventEmployeeId,\r\n    eventStatus,\r\n    true\r\n  );\r\n  const eventTypeOptions = getEventTypeOptionsList(\r\n    auth,\r\n    selectedPosition,\r\n    eventEmployeeId\r\n  );\r\n\r\n  const retVal = {\r\n    buttonText: \"\",\r\n    enableConfirm: true,\r\n    isReadonly: false,\r\n    text: \"\",\r\n    usage: EventEditEnum.None,\r\n    eventTypeOptionList: eventTypeOptions,\r\n    eventStatusOptionList: eventStatusOptions,\r\n  } as EventEditAuthorization;\r\n\r\n  if (auth.role === Role.BusinessAdmin) {\r\n    return retVal;\r\n  }\r\n\r\n  if (auth.role === Role.LocationAdmin) {\r\n    if (authHelper.isPositionSpecificEvent(eventType)) {\r\n      if (auth.locations.filter((l) => l.id === eventLocationId).length === 0) {\r\n        return null;\r\n      }\r\n    }\r\n\r\n    return retVal;\r\n  }\r\n\r\n  const endOfEvent = parseISO(eventEnd);\r\n  const now = new Date();\r\n  const afterEnd = isAfter(now, endOfEvent);\r\n  let employeeEvent = false;\r\n  const adminAuth = authHelper.getAdminAuthorizationForDepartment(\r\n    auth,\r\n    eventDepartmentId\r\n  );\r\n\r\n  // If the user is in the Admin role\r\n  if (auth.role === Role.Admin) {\r\n    if (eventEmployeeId === auth.employeeId) {\r\n      if (eventType === EventType.Clock) {\r\n        if (\r\n          (adminAuth & AdminAuthorization.CanEditOwnClockEvents) ===\r\n          AdminAuthorization.CanEditOwnClockEvents\r\n        ) {\r\n          return retVal;\r\n        } else {\r\n          return null;\r\n        }\r\n      }\r\n\r\n      if (\r\n        (adminAuth & AdminAuthorization.CanEditSchedules) ===\r\n        AdminAuthorization.CanEditSchedules\r\n      ) {\r\n        return retVal;\r\n      }\r\n\r\n      employeeEvent = true;\r\n    } else {\r\n      // Not the user's event, someone else's\r\n\r\n      if (eventType === EventType.Clock) {\r\n        if (\r\n          (adminAuth & AdminAuthorization.CanEditEmployeeClockEvents) ===\r\n          AdminAuthorization.CanEditEmployeeClockEvents\r\n        ) {\r\n          return retVal;\r\n        } else {\r\n          return null;\r\n        }\r\n      }\r\n\r\n      if (\r\n        authHelper.canEditSchedules(auth, eventLocationId, eventDepartmentId)\r\n      ) {\r\n        return retVal;\r\n      } else {\r\n        // If the admin has a position in the selected department\r\n        if (authHelper.adminIsInDepartment(auth, eventDepartmentId)) {\r\n          // Treat the admin as an employee for event editing\r\n          employeeEvent = true;\r\n        } else {\r\n          // disable editing\r\n          return null;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  if (auth.role === Role.Employee || employeeEvent) {\r\n    if (eventEmployeeId === auth.employeeId) {\r\n      if (afterEnd) {\r\n        return null;\r\n      }\r\n\r\n      if (eventType === EventType.Clock) {\r\n        return null;\r\n      }\r\n\r\n      if (eventType === EventType.Shift) {\r\n        if (eventStatus === EventStatus.Approved) {\r\n          return {\r\n            ...retVal,\r\n            buttonText: \"Create Cover-Request\",\r\n            isReadonly: true,\r\n            usage: EventEditEnum.CreateCoverRequest,\r\n          };\r\n        }\r\n\r\n        if (eventStatus === EventStatus.Request) {\r\n          return {\r\n            ...retVal,\r\n            buttonText: \"Undo Shift-Request\",\r\n            enableConfirm: false,\r\n            isReadonly: true,\r\n            text: \"Click OK to remove your Shift-Request\",\r\n            usage: EventEditEnum.DeleteShiftRequest,\r\n          };\r\n        }\r\n\r\n        // else Shift Request-Denied\r\n        return null;\r\n      }\r\n\r\n      if (eventType === EventType.Cover) {\r\n        if (eventStatus === EventStatus.Request) {\r\n          return {\r\n            ...retVal,\r\n            buttonText: \"Undo Cover-Request\",\r\n            enableConfirm: true,\r\n            isReadonly: true,\r\n            usage: EventEditEnum.UndoCoverRequest,\r\n          };\r\n        }\r\n\r\n        return null; // Cover Request-Denied\r\n      }\r\n\r\n      if (\r\n        !authHelper.isPositionSpecificEvent(eventType) &&\r\n        authHelper.canEditNonPositionEvents(auth, eventDepartmentId)\r\n      ) {\r\n        return {\r\n          ...retVal,\r\n          buttonText: \"Delete Request\",\r\n          enableConfirm: false,\r\n          isReadonly: true,\r\n          text: \"Click OK to delete this event\",\r\n          usage: EventEditEnum.Delete,\r\n        };\r\n      }\r\n\r\n      return null;\r\n    }\r\n\r\n    // This is someone else's event being viewed by an Employee\r\n    if (eventType === EventType.Cover && eventStatus === EventStatus.Request) {\r\n      return {\r\n        ...retVal,\r\n        buttonText: \"Make Shift-Request\",\r\n        enableConfirm: false,\r\n        isReadonly: true,\r\n        text: \"\",\r\n        usage: EventEditEnum.CreateShiftRequest,\r\n      };\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  return null;\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst getEventTypeOptionsList = (\r\n  auth: AuthorizedItems,\r\n  selectedPosition: SelectedPosition,\r\n  eventEmployeeId: number\r\n): Option[] => {\r\n  if (\r\n    !auth ||\r\n    !auth.locations ||\r\n    auth.locations.length === 0 ||\r\n    !selectedPosition ||\r\n    !selectedPosition.location ||\r\n    !selectedPosition.location.settings\r\n  ) {\r\n    return [];\r\n  }\r\n\r\n  const eventTypeOptions: Option[] = [\r\n    {\r\n      value: EventType.Shift,\r\n      text: \"SHIFT\",\r\n      color: \"green\",\r\n    },\r\n  ];\r\n\r\n  const locSettings = selectedPosition.location.settings;\r\n  const dept = authHelper.getDepartmentFromPositionId(\r\n    auth,\r\n    selectedPosition.position.id\r\n  );\r\n  const adminAuth = authHelper.getAdminAuthorizationForDepartment(\r\n    auth,\r\n    dept!.id\r\n  );\r\n\r\n  if (auth.role === Role.BusinessAdmin || auth.role === Role.LocationAdmin) {\r\n    eventTypeOptions.push({\r\n      value: EventType.Clock,\r\n      text: \"CLOCK\",\r\n      color: \"green\",\r\n    });\r\n  } else if (auth.role === Role.Admin) {\r\n    if (\r\n      auth.employeeId === eventEmployeeId &&\r\n      (adminAuth & AdminAuthorization.CanEditOwnClockEvents) ===\r\n        AdminAuthorization.CanEditOwnClockEvents\r\n    ) {\r\n      eventTypeOptions.push({\r\n        value: EventType.Clock,\r\n        text: \"CLOCK\",\r\n        color: \"green\",\r\n      });\r\n    } else if (\r\n      auth.employeeId !== eventEmployeeId &&\r\n      (adminAuth & AdminAuthorization.CanEditEmployeeClockEvents) ===\r\n        AdminAuthorization.CanEditEmployeeClockEvents\r\n    ) {\r\n      eventTypeOptions.push({\r\n        value: EventType.Clock,\r\n        text: \"CLOCK\",\r\n        color: \"green\",\r\n      });\r\n    }\r\n  }\r\n\r\n  if (auth.role === Role.BusinessAdmin || auth.role === Role.LocationAdmin) {\r\n    eventTypeOptions.push({\r\n      value: EventType.Cover,\r\n      text: \"COVER\",\r\n      color: \"red\",\r\n    });\r\n  } else if (\r\n    auth.role === Role.Admin &&\r\n    (adminAuth & AdminAuthorization.CanEditSchedules) ===\r\n      AdminAuthorization.CanEditSchedules\r\n  ) {\r\n    eventTypeOptions.push({\r\n      value: EventType.Cover,\r\n      text: \"COVER\",\r\n      color: \"red\",\r\n    });\r\n  }\r\n\r\n  if (locSettings.ShowUnavailableEventType) {\r\n    eventTypeOptions.push({\r\n      value: EventType.Unavailable,\r\n      text: \"UNAVAILABLE\",\r\n      color: \"yellow\",\r\n    });\r\n  }\r\n\r\n  if (locSettings.ShowVacationEventType) {\r\n    eventTypeOptions.push({\r\n      value: EventType.Vacation,\r\n      text: \"VACATION\",\r\n      color: \"yellow\",\r\n    });\r\n  }\r\n\r\n  if (locSettings.ShowAbsentEventType) {\r\n    const peTypes = auth.payrollEvents\r\n      .filter(\r\n        (pe) =>\r\n          pe.positionIds.includes(selectedPosition.position.id) &&\r\n          !pe.name.startsWith(\"--\")\r\n      )\r\n      .map((pe) => {\r\n        return { value: pe.id, text: pe.name, color: \"yellow\" };\r\n      });\r\n    return eventTypeOptions.concat(peTypes);\r\n  }\r\n\r\n  return eventTypeOptions;\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst getEventStatusOptionsList = (\r\n  auth: AuthorizedItems,\r\n  selectedPosition: SelectedPosition,\r\n  eventEmployeeId: number,\r\n  eventStatusId: EventStatus,\r\n  isEditingExistingEvent: boolean\r\n): Option[] => {\r\n  const eventStatusOptions: Option[] = [];\r\n  const dept = authHelper.getDepartmentFromPositionId(\r\n    auth,\r\n    selectedPosition.position.id\r\n  );\r\n  const adminAuth = authHelper.getAdminAuthorizationForDepartment(\r\n    auth,\r\n    dept!.id\r\n  );\r\n\r\n  if (auth.role === Role.LocationAdmin || auth.role === Role.BusinessAdmin) {\r\n    eventStatusOptions.push({\r\n      value: EventStatus.Approved,\r\n      text: \"APPROVED\",\r\n      color: \"black\",\r\n    });\r\n  } else if (\r\n    auth.role === Role.Admin &&\r\n    (adminAuth & AdminAuthorization.CanEditSchedules) ===\r\n      AdminAuthorization.CanEditSchedules\r\n  ) {\r\n    eventStatusOptions.push({\r\n      value: EventStatus.Approved,\r\n      text: \"APPROVED\",\r\n      color: \"black\",\r\n    });\r\n  }\r\n\r\n  eventStatusOptions.push({\r\n    value: EventStatus.Request,\r\n    text: \"REQUEST\",\r\n    color: \"red\",\r\n  });\r\n\r\n  if (auth.role === Role.LocationAdmin || auth.role === Role.BusinessAdmin) {\r\n    eventStatusOptions.push({\r\n      value: EventStatus.RequestDenied,\r\n      text: \"REQUEST-DENIED\",\r\n      color: \"black\",\r\n    });\r\n  } else if (\r\n    auth.role === Role.Admin &&\r\n    (adminAuth & AdminAuthorization.CanEditSchedules) ===\r\n      AdminAuthorization.CanEditSchedules\r\n  ) {\r\n    eventStatusOptions.push({\r\n      value: EventStatus.RequestDenied,\r\n      text: \"REQUEST-DENIED\",\r\n      color: \"black\",\r\n    });\r\n  }\r\n\r\n  if (isEditingExistingEvent) {\r\n    if (\r\n      eventStatusOptions.filter((es) => es.value === eventStatusId).length === 0\r\n    ) {\r\n      switch (eventStatusId) {\r\n        case EventStatus.Approved:\r\n          eventStatusOptions.push({\r\n            value: EventStatus.Approved,\r\n            text: \"APPROVED\",\r\n            color: \"black\",\r\n          });\r\n          break;\r\n        case EventStatus.Request:\r\n          eventStatusOptions.push({\r\n            value: EventStatus.Request,\r\n            text: \"REQUEST\",\r\n            color: \"red\",\r\n          });\r\n          break;\r\n        case EventStatus.RequestDenied:\r\n          eventStatusOptions.push({\r\n            value: EventStatus.RequestDenied,\r\n            text: \"REQUEST-DENIED\",\r\n            color: \"black\",\r\n          });\r\n          break;\r\n      }\r\n    }\r\n  }\r\n\r\n  return eventStatusOptions;\r\n};\r\n","/* eslint camelcase: 0 */\r\nimport { ScheduleEvent } from \"../orbital-interfaces/ScheduleEvent\";\r\nimport { EditorValues } from \"../components/EditEvent/EditEventModalState\";\r\nimport { TECGetData } from \"../orbital-interfaces/TEC\";\r\nimport { EventFilter } from \"../orbital-interfaces/EventFilter\";\r\nimport { DailyNotes } from \"../orbital-interfaces/DailyNotes\";\r\nimport { DailyNotesFilter } from \"../orbital-interfaces/DailyNotesFilter\";\r\nimport { formatDateTimeAsMvcString } from \"../util/time-helper\";\r\nimport { ApplicationUser } from \"../context/ApplicationUserContext\";\r\nimport apiHelper from \"./OrbitalApiHelper\";\r\nimport { RecurrenceUpdateType } from \"../enums/RecurrenceUpdateType\";\r\n\r\ninterface ErrorResponse {\r\n  error: boolean;\r\n  message: string;\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst getScheduleEvent = async (\r\n  user: ApplicationUser,\r\n  scheduleEventId: number\r\n): Promise<ScheduleEvent | null> => {\r\n  const result = await apiHelper.get(\r\n    user,\r\n    \"api/v2/employee/schedule-events/get/\" + scheduleEventId\r\n  );\r\n\r\n  if (result.error) {\r\n    return null;\r\n  }\r\n\r\n  return result as ScheduleEvent;\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst getScheduleEventsByFilter = async (\r\n  user: ApplicationUser,\r\n  filter: EventFilter\r\n) => {\r\n  const filterToSend = {\r\n    start: formatDateTimeAsMvcString(filter.start),\r\n    end: formatDateTimeAsMvcString(filter.end),\r\n    ...filter,\r\n  };\r\n\r\n  return (await apiHelper.post(\r\n    user,\r\n    \"api/v2/employee/schedule-events/filter\",\r\n    filterToSend\r\n  )) as TECGetData;\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst getDailyNotesByFilter = async (\r\n  user: ApplicationUser,\r\n  filter: DailyNotesFilter\r\n) => {\r\n  const filterToSend = {\r\n    start: formatDateTimeAsMvcString(filter.start),\r\n    end: formatDateTimeAsMvcString(filter.end),\r\n    ...filter,\r\n  };\r\n\r\n  return (await apiHelper.post(\r\n    user,\r\n    \"api/v2/daily-notes/filter\",\r\n    filterToSend\r\n  )) as DailyNotes[];\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst updateScheduleEvent = async (\r\n  user: ApplicationUser,\r\n  eventValues: EditorValues,\r\n  recurrenceUpdateType: RecurrenceUpdateType | null\r\n) => {\r\n  const data = {\r\n    scheduleEventId: eventValues.scheduleEventId,\r\n    eventType: eventValues.eventType,\r\n    eventStatus: eventValues.eventStatus,\r\n    isConfirmed: eventValues.isConfirmed,\r\n    positionId: eventValues.position.position.id,\r\n    employeeId: eventValues.employee.id,\r\n    eventStart: eventValues.eventStart,\r\n    eventEnd: eventValues.eventEnd,\r\n    tagId: eventValues.tag?.id,\r\n    eventBreaks: eventValues.eventBreaks,\r\n    isClockedIn: eventValues.isClockedIn,\r\n    breakStart: null,\r\n    breakDuration: null,\r\n    clockOutValue: eventValues.clockoutValue,\r\n    absentTime: eventValues.absentTimeMinutes,\r\n    notes: eventValues.notes,\r\n    sendMessage: false,\r\n    recurrenceId: eventValues.recurrenceId,\r\n    recurrenceStart: eventValues.recurrenceStart,\r\n    recurrenceEnd: eventValues.recurrenceEnd,\r\n    recurrenceType: eventValues.recurrenceType,\r\n    repeatInterval: eventValues.repeatInterval,\r\n    repeatWeekdays: eventValues.repeatWeekdays,\r\n    recurrenceUpdateType,\r\n  };\r\n\r\n  return (await apiHelper.post(\r\n    user,\r\n    \"api/v2/employee/schedule-events/update\",\r\n    data\r\n  )) as ErrorResponse;\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst createScheduleEvent = async (\r\n  user: ApplicationUser,\r\n  eventValues: EditorValues,\r\n  recurrenceUpdateType: RecurrenceUpdateType | null\r\n) => {\r\n  const data = {\r\n    sceduleEventId: 0,\r\n    eventType: eventValues.eventType,\r\n    eventStatus: eventValues.eventStatus,\r\n    isConfirmed: eventValues.isConfirmed,\r\n    positionId: eventValues.position.position.id,\r\n    employeeId: eventValues.employee.id,\r\n    eventStart: eventValues.eventStart,\r\n    eventEnd: eventValues.eventEnd,\r\n    tagId: eventValues.tag?.id,\r\n    eventBreaks: eventValues.eventBreaks,\r\n    isClockedIn: eventValues.isClockedIn,\r\n    breakStart: null,\r\n    breakDuration: null,\r\n    clockOutValue: eventValues.clockoutValue,\r\n    absentTime: eventValues.absentTimeMinutes,\r\n    notes: eventValues.notes,\r\n    sendMessage: false,\r\n    recurrenceId: eventValues.recurrenceId,\r\n    recurrenceStart: eventValues.recurrenceStart,\r\n    recurrenceEnd: eventValues.recurrenceEnd,\r\n    recurrenceType: eventValues.recurrenceType,\r\n    repeatInterval: eventValues.repeatInterval,\r\n    repeatWeekdays: eventValues.repeatWeekdays,\r\n    recurrenceUpdateType,\r\n  };\r\n\r\n  return (await apiHelper.post(\r\n    user,\r\n    \"api/v2/employee/schedule-events/create\",\r\n    data\r\n  )) as ErrorResponse;\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst deleteScheduleEvent = async (\r\n  user: ApplicationUser,\r\n  scheduleEventId: number,\r\n  recurrenceUpdateType: RecurrenceUpdateType | null\r\n) => {\r\n  const data = {\r\n    scheduleEventId,\r\n    recurrenceUpdateType,\r\n    sendMessage: false,\r\n  };\r\n\r\n  return (await apiHelper.post(\r\n    user,\r\n    \"api/v2/employee/schedule-events/delete\",\r\n    data\r\n  )) as ErrorResponse;\r\n};\r\n\r\nexport default {\r\n  getScheduleEvent,\r\n  getScheduleEventsByFilter,\r\n  getDailyNotesByFilter,\r\n  updateScheduleEvent,\r\n  createScheduleEvent,\r\n  deleteScheduleEvent,\r\n};\r\n","export interface EventFilter {\r\n  settingsLocId: number;\r\n  dnLocIds: number[];\r\n  start: Date;\r\n  end: Date;\r\n  filterByEmployee: boolean;\r\n  filterByPosition: boolean;\r\n  positionIds: number[];\r\n  eventTypeId: number;\r\n  eventStatusId: number;\r\n  tagId?: number;\r\n}\r\n\r\nexport const initialEventFilter: EventFilter = {\r\n  settingsLocId: 0,\r\n  dnLocIds: [],\r\n  start: new Date(),\r\n  end: new Date(),\r\n  filterByEmployee: false,\r\n  filterByPosition: true,\r\n  positionIds: [],\r\n  eventTypeId: -1,\r\n  eventStatusId: -1,\r\n  tagId: undefined,\r\n};\r\n","import React, { useRef } from \"react\";\r\n// import \"./WeekChooser.scss\";\r\nimport \"../../global-styles.scss\";\r\nimport { IonIcon, IonDatetime } from \"@ionic/react\";\r\nimport { arrowBack, arrowForward, caretDown } from \"ionicons/icons\";\r\nimport { addDays, format, isSameDay, isToday, parseISO } from \"date-fns\";\r\n\r\ninterface WeekChooserProps {\r\n  startDate: Date;\r\n  setStartDate: (date: Date) => void;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\n//\r\n// --------------------------------------------------------------------------------------\r\nconst WeekChooser: React.FC<WeekChooserProps> = ({\r\n  startDate,\r\n  setStartDate,\r\n}: WeekChooserProps) => {\r\n  const dateRef = useRef(startDate);\r\n\r\n  const onDateChanged = (newDate: Date) => {\r\n    if (!isSameDay(newDate, dateRef.current)) {\r\n      dateRef.current = newDate;\r\n      setStartDate(newDate);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"chooser\">\r\n      <div className=\"top\">\r\n        <button\r\n          onClick={() => onDateChanged(addDays(startDate, -7))}\r\n          className=\"arrow\"\r\n          key={-1}\r\n        >\r\n          <IonIcon mode=\"ios\" icon={arrowBack} />\r\n        </button>\r\n\r\n        <div className=\"month-year-container\">\r\n          <div className=\"datetime-picker-container\">\r\n            <IonDatetime\r\n              className=\"datetime-picker\"\r\n              displayFormat=\"MMM YYYY\"\r\n              pickerFormat=\"MMM D YYYY\"\r\n              min=\"2005-01-01\"\r\n              max=\"2030-01-01\"\r\n              value={startDate.toISOString()}\r\n              onIonChange={(e) => {\r\n                onDateChanged(parseISO(e.detail.value!));\r\n              }}\r\n            />\r\n            <IonIcon mode=\"md\" icon={caretDown} />\r\n          </div>\r\n        </div>\r\n\r\n        <button\r\n          onClick={() => onDateChanged(addDays(startDate, 7))}\r\n          className=\"arrow\"\r\n          key={7}\r\n        >\r\n          <IonIcon mode=\"ios\" icon={arrowForward} />\r\n        </button>\r\n      </div>\r\n      <div className=\"weekday-list\">\r\n        {[0, 1, 2, 3, 4, 5, 6].map((num: number) => {\r\n          const thisDate = addDays(startDate, num);\r\n          const isTodayClass = isToday(thisDate) ? \"today\" : \"not-today\";\r\n          return (\r\n            <button\r\n              key={num}\r\n              className=\"weekday-button\"\r\n              style={{ outline: \"none\" }}\r\n            >\r\n              <div>\r\n                <div className=\"weekday-abbr\">{format(thisDate, \"EEE\")}</div>\r\n                <div className={isTodayClass} />\r\n                <div className=\"weekday-num\">{format(thisDate, \"d\")}</div>\r\n              </div>\r\n            </button>\r\n          );\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default WeekChooser;\r\n","import React, { CSSProperties, useContext } from \"react\";\r\nimport {\r\n  getDurationStringFromTimeSpan,\r\n  getEventInformationStartEnd,\r\n} from \"../../util/time-helper\";\r\n// import \"./EventCard.scss\";\r\nimport \"../../global-styles.scss\";\r\nimport { AuthorizedLocation } from \"../../orbital-interfaces/authorized-items\";\r\nimport { format, parseISO } from \"date-fns\";\r\nimport { EventInformation } from \"../../orbital-interfaces/TEC\";\r\nimport { time } from \"ionicons/icons\";\r\nimport { IonIcon } from \"@ionic/react\";\r\nimport {\r\n  getEventEditAuthorization,\r\n  EventEditAuthorization,\r\n} from \"../EditEvent/EditEventAuthorization\";\r\nimport { AuthorizedItemsContext } from \"../../context/AuthorizedItemsContext\";\r\nimport EventType from \"../../enums/EventType\";\r\n\r\ninterface EventCardProps {\r\n  event: EventInformation;\r\n  location: AuthorizedLocation;\r\n  multiLocation: boolean;\r\n  showEmployeeName: boolean;\r\n  onEdit: (ev: EventInformation, eventEditAuth: EventEditAuthorization) => void;\r\n}\r\n\r\nconst colorMap: any = {\r\n  1: \"#9CBA6A\",\r\n  2: \"#BFBFBF\",\r\n  3: \"#FFAD00\",\r\n  4: \"#C41A26\",\r\n  6: \"#677A46\",\r\n  7: \"#FFAD00\",\r\n};\r\n\r\nconst statusTimeColor: any = {\r\n  1: { color: \"black\" },\r\n  2: { color: \"#C41A26\" },\r\n  4: { color: \"#BCBCBC\" },\r\n};\r\n\r\nconst EventCard: React.FC<EventCardProps> = ({\r\n  location,\r\n  event,\r\n  multiLocation,\r\n  showEmployeeName,\r\n  onEdit,\r\n}: EventCardProps) => {\r\n  const { auth } = useContext(AuthorizedItemsContext);\r\n  const displayNameStyle: CSSProperties = showEmployeeName\r\n    ? { display: \"inline-block\" }\r\n    : { display: \"none\" };\r\n\r\n  const eventStartDate = parseISO(event.EventStart);\r\n  const multiDepartment = multiLocation\r\n    ? true\r\n    : location.departments.filter((d) =>\r\n        d.positions.filter((p) => p.hasPosition)\r\n      ).length > 1;\r\n\r\n  let posDisplay = \"\";\r\n  if (multiLocation && event.AbbreviatedLocationName) {\r\n    posDisplay = event.AbbreviatedLocationName + \"/\";\r\n  }\r\n\r\n  if (multiDepartment && event.AbbreviatedDepartmentName) {\r\n    posDisplay += event.AbbreviatedDepartmentName + \"/\";\r\n  }\r\n\r\n  posDisplay += event.PositionName;\r\n\r\n  const eventTypeBorder = {\r\n    borderLeft: `7px solid ${colorMap[event.EventTypeId]} `,\r\n  };\r\n\r\n  const timeColor: CSSProperties = statusTimeColor[event.EventStatusId];\r\n\r\n  const onUserClick = () => {\r\n    const eventEditAuth = getEventEditAuthorization(\r\n      event.EventTypeId,\r\n      event.EventStatusId,\r\n      event.EmployeeId,\r\n      event.EventStart,\r\n      event.EventEnd,\r\n      event.LocationId,\r\n      event.DepartmentId!,\r\n      event.PositionId,\r\n      event.IsConfirmed,\r\n      auth\r\n    );\r\n    if (eventEditAuth === null) {\r\n      return;\r\n    }\r\n\r\n    onEdit(event, eventEditAuth);\r\n  };\r\n\r\n  return (\r\n    <button\r\n      className=\"card\"\r\n      onClick={() => {\r\n        onUserClick();\r\n      }}\r\n    >\r\n      <div className=\"card-first-col\">\r\n        <div className=\"day-name\">{format(eventStartDate, \"EEE\")} </div>\r\n        <div className=\"day-number\">{format(eventStartDate, \"d\")}</div>\r\n      </div>\r\n      <div className=\"card-second-col\" style={eventTypeBorder}>\r\n        <div className=\"time-row\">\r\n          {event.IsClockedIn && <IonIcon icon={time} />}\r\n          <span style={timeColor}>\r\n            {getEventInformationStartEnd(event)}&nbsp;&nbsp;\r\n          </span>\r\n          {getDurationStringFromTimeSpan(\r\n            event.EventTypeId === EventType.Absent\r\n              ? event.Time\r\n              : event.EventDuration\r\n          )}{\" \"}\r\n          {event.FirstName}\r\n        </div>\r\n        <div className=\"name-row\" style={displayNameStyle}>\r\n          {event.FirstName} {event.LastName}\r\n        </div>\r\n        <div className=\"dept-position-row\">\r\n          {posDisplay}&nbsp;&nbsp;\r\n          {event.Tag && `~${event.Tag}`}\r\n        </div>\r\n      </div>\r\n    </button>\r\n  );\r\n};\r\n\r\nexport default EventCard;\r\n","import {\r\n  IonButton,\r\n  IonCol,\r\n  IonContent,\r\n  IonGrid,\r\n  IonHeader,\r\n  IonModal,\r\n  IonRow,\r\n  IonTitle,\r\n  IonToolbar,\r\n} from \"@ionic/react\";\r\nimport React, { useState } from \"react\";\r\n// import \"./useOrbitalDialogBox.scss\";\r\nimport \"../global-styles.scss\";\r\n\r\nexport interface DialogOptions {\r\n  value: number;\r\n  text: string;\r\n  color: string;\r\n}\r\n\r\nfunction useOrbitalDialogBox() {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [dialogData, setDialogData] = useState({\r\n    header: \"\",\r\n    message: \"\",\r\n    options: [] as DialogOptions[],\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    onDismiss: (selection: number | null) => {},\r\n  });\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const showDialog = (\r\n    header: string,\r\n    message: string,\r\n    dialogOptions: DialogOptions[],\r\n    onDismiss: (selection: number | null) => void\r\n  ) => {\r\n    setDialogData({\r\n      header,\r\n      message,\r\n      options: dialogOptions,\r\n      onDismiss,\r\n    });\r\n\r\n    setIsOpen(true);\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onButtonClick = (selection: number | null) => {\r\n    setIsOpen(false);\r\n    dialogData.onDismiss(selection);\r\n  };\r\n\r\n  const dialogBoxJsx = (\r\n    <IonModal\r\n      isOpen={isOpen}\r\n      cssClass=\"orbital-dialog-modal\"\r\n      onDidDismiss={() => onButtonClick(null)}\r\n    >\r\n      <IonContent className=\"modal-content\">\r\n        <IonHeader mode=\"ios\">\r\n          <IonToolbar>\r\n            <IonTitle>{dialogData.header}</IonTitle>\r\n          </IonToolbar>\r\n        </IonHeader>\r\n        <IonGrid>\r\n          {dialogData.options.map((opt) => (\r\n            <IonRow key={opt.value}>\r\n              <IonCol size=\"12\">\r\n                <IonButton\r\n                  expand=\"block\"\r\n                  color={opt.color}\r\n                  className=\"apply-button\"\r\n                  onClick={() => onButtonClick(opt.value)}\r\n                >\r\n                  {opt.text}\r\n                </IonButton>\r\n              </IonCol>\r\n            </IonRow>\r\n          ))}\r\n          <IonRow>\r\n            <IonCol size=\"12\">\r\n              <IonButton\r\n                expand=\"block\"\r\n                className=\"cancel-btn\"\r\n                onClick={() => onButtonClick(null)}\r\n              >\r\n                Cancel\r\n              </IonButton>\r\n            </IonCol>\r\n          </IonRow>\r\n        </IonGrid>\r\n      </IonContent>\r\n    </IonModal>\r\n  );\r\n\r\n  return {\r\n    showDialog,\r\n    dialogBoxJsx,\r\n  };\r\n}\r\n\r\nexport default useOrbitalDialogBox;\r\n","import React, { useContext, useState } from \"react\";\r\nimport { IonItem, IonLabel, IonSelect, IonSelectOption } from \"@ionic/react\";\r\nimport { AuthorizedItemsContext } from \"../../context/AuthorizedItemsContext\";\r\nimport authHelper, { SelectedDepartment } from \"../../util/authitems-helper\";\r\nimport { AdminAuthorization } from \"../../orbital-interfaces/authorized-items\";\r\n\r\ninterface DailyNoteDepartmentSelectorProps {\r\n  currentDepartment: SelectedDepartment;\r\n  onDepartmentUpdate: (dep: SelectedDepartment) => void;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\n//\r\n// --------------------------------------------------------------------------------------\r\nconst DailyNoteDepartmentSelector: React.FC<DailyNoteDepartmentSelectorProps> = ({\r\n  currentDepartment,\r\n  onDepartmentUpdate,\r\n}) => {\r\n  const { auth } = useContext(AuthorizedItemsContext);\r\n  const [selectedDepartment, setSelectedDepartment] = useState(\r\n    currentDepartment\r\n  );\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const updateLocation = (locId: number | undefined | null) => {\r\n    if (!locId) {\r\n      return;\r\n    }\r\n\r\n    const newSelection = {\r\n      location: auth.locations.filter((l) => l.id === locId)[0],\r\n      department: null,\r\n    };\r\n\r\n    setSelectedDepartment(newSelection);\r\n    onDepartmentUpdate(newSelection);\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const updateDepartment = (depId: number | undefined | null) => {\r\n    if (depId === undefined) {\r\n      return;\r\n    }\r\n\r\n    const newSelection = {\r\n      location: selectedDepartment.location,\r\n      department:\r\n        depId === null\r\n          ? null\r\n          : selectedDepartment.location.departments.filter(\r\n              (d) => d.id === depId\r\n            )[0],\r\n    };\r\n\r\n    setSelectedDepartment(newSelection);\r\n    onDepartmentUpdate(newSelection);\r\n  };\r\n\r\n  if (!auth || !auth.locations || auth.locations.length === 0) {\r\n    return (\r\n      <>\r\n        <div>Loading</div>\r\n      </>\r\n    );\r\n  } else {\r\n    const selectedDepartmentId =\r\n      selectedDepartment.department !== null\r\n        ? selectedDepartment.department.id\r\n        : null;\r\n\r\n    return (\r\n      <>\r\n        <IonItem>\r\n          <IonLabel>Location</IonLabel>\r\n          <IonSelect\r\n            interface=\"popover\"\r\n            style={{ maxWidth: \"100%\" }}\r\n            value={selectedDepartment.location.id}\r\n            onIonChange={(e) => updateLocation(e.detail.value)}\r\n          >\r\n            {auth.locations.map((loc) => (\r\n              <IonSelectOption key={loc.id} value={loc.id}>\r\n                {loc.name}\r\n              </IonSelectOption>\r\n            ))}\r\n          </IonSelect>\r\n        </IonItem>\r\n        <IonItem>\r\n          <IonLabel>Department</IonLabel>\r\n          <IonSelect\r\n            interface=\"popover\"\r\n            style={{ maxWidth: \"100%\" }}\r\n            value={selectedDepartmentId}\r\n            onIonChange={(e) => updateDepartment(e.detail.value)}\r\n          >\r\n            {authHelper.isAdminForAllDepts(\r\n              auth,\r\n              selectedDepartment.location.id\r\n            ) && (\r\n              <IonSelectOption key={-1} value={null}>\r\n                All Departments\r\n              </IonSelectOption>\r\n            )}\r\n            {selectedDepartment.location.departments\r\n              .filter((dep) =>\r\n                authHelper.isAdminAuthorizedFor(\r\n                  auth,\r\n                  selectedDepartment.location.id,\r\n                  dep.id,\r\n                  AdminAuthorization.CanEditSchedules\r\n                )\r\n              )\r\n              .map((dep) => (\r\n                <IonSelectOption key={dep.id} value={dep.id}>\r\n                  {dep.name}\r\n                </IonSelectOption>\r\n              ))}\r\n          </IonSelect>\r\n        </IonItem>\r\n      </>\r\n    );\r\n  }\r\n};\r\n\r\nexport default DailyNoteDepartmentSelector;\r\n","import { ApplicationUser } from \"../context/ApplicationUserContext\";\r\nimport apiHelper from \"./OrbitalApiHelper\";\r\nimport { formatDateTimeAsMvcString } from \"../util/time-helper\";\r\nimport { DailyNotes } from \"../orbital-interfaces/DailyNotes\";\r\n\r\nexport interface ApiResult {\r\n  error: boolean;\r\n  message: string;\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst updateDailyNote = async (\r\n  user: ApplicationUser,\r\n  dailyNoteId: number,\r\n  text: string,\r\n  role: number,\r\n  date: Date\r\n) => {\r\n  const result = (await apiHelper.post(user, \"api/v2/daily-notes/update\", {\r\n    dailyNoteId,\r\n    date: formatDateTimeAsMvcString(date),\r\n    text,\r\n    role,\r\n  })) as ApiResult;\r\n\r\n  return result;\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst insertDailyNote = async (\r\n  user: ApplicationUser,\r\n  locId: number,\r\n  depId: number,\r\n  role: number,\r\n  date: Date,\r\n  text: string\r\n) => {\r\n  const result = (await apiHelper.post(user, \"api/v2/daily-notes/insert\", {\r\n    locId,\r\n    depId,\r\n    role,\r\n    date,\r\n    text,\r\n  })) as ApiResult;\r\n\r\n  return result;\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst deleteDailyNote = async (user: ApplicationUser, dailyNoteId: number) => {\r\n  const result = (await apiHelper.post(\r\n    user,\r\n    \"api/v2/daily-notes/delete/\" + dailyNoteId\r\n  )) as ApiResult;\r\n\r\n  return result;\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst getDailyNote = async (\r\n  user: ApplicationUser,\r\n  locId: number,\r\n  depId: number,\r\n  role: number,\r\n  date: Date\r\n): Promise<ApiResult | DailyNotes> => {\r\n  const result = (await apiHelper.post(user, \"api/v2/daily-notes/get\", {\r\n    locId,\r\n    depId,\r\n    role,\r\n    date,\r\n  })) as ApiResult | DailyNotes;\r\n\r\n  return result;\r\n};\r\n\r\nexport default {\r\n  getDailyNote,\r\n  updateDailyNote,\r\n  insertDailyNote,\r\n  deleteDailyNote,\r\n};\r\n","import { IonToast } from \"@ionic/react\";\nimport React, { useState } from \"react\";\n\nfunction useSimpleToast() {\n  const [isOpen, setIsOpen] = useState(false);\n  const [toastData, setToastData] = useState({ message: \"\" });\n\n  const showToast = (message: string) => {\n    setToastData({\n      message,\n    });\n\n    setIsOpen(true);\n  };\n\n  const simpleToastJsx = (\n    <IonToast\n      isOpen={isOpen}\n      onDidDismiss={() => setIsOpen(false)}\n      position=\"top\"\n      message={toastData.message}\n      duration={1500}\n    />\n  );\n\n  return {\n    showToast,\n    simpleToastJsx,\n  };\n}\n\nexport default useSimpleToast;\n","import React, { useContext, useEffect, useRef, useState } from \"react\";\r\nimport {\r\n  IonButton,\r\n  IonButtons,\r\n  IonIcon,\r\n  IonContent,\r\n  IonHeader,\r\n  IonTitle,\r\n  IonToolbar,\r\n  IonList,\r\n  IonItem,\r\n  IonTextarea,\r\n  IonLabel,\r\n  IonSelect,\r\n  IonSelectOption,\r\n  IonDatetime,\r\n} from \"@ionic/react\";\r\nimport { arrowBackOutline } from \"ionicons/icons\";\r\nimport useDialogBox from \"../../hooks/useDialogBox\";\r\nimport useOrbitalDialogBox from \"../../hooks/useOrbitalDialogBox\";\r\nimport { AuthorizedItemsContext } from \"../../context/AuthorizedItemsContext\";\r\nimport { DailyNotes } from \"../../orbital-interfaces/DailyNotes\";\r\nimport { isSameDay, parseISO } from \"date-fns\";\r\nimport authHelper, { SelectedDepartment } from \"../../util/authitems-helper\";\r\nimport DailyNoteDepartmentSelector from \"./DailyNoteDepartmentSelector\";\r\n// import \"./EditDailyNoteMOdal.scss\";\r\nimport \"../../global-styles.scss\";\r\nimport notesApi, { ApiResult } from \"../../api/DailyNotesAPI\";\r\nimport { ApplicationUserContext } from \"../../context/ApplicationUserContext\";\r\nimport useSimpleToast from \"../../hooks/useSimpleToast\";\r\nimport {\r\n  AuthorizedItems,\r\n  Role,\r\n} from \"../../orbital-interfaces/authorized-items\";\r\n\r\ninterface EditDailyNoteModalProps {\r\n  onCloseModal: (toastMessage: string) => void;\r\n  isOpen: boolean;\r\n  note: DailyNotes | null;\r\n  initialDate: Date;\r\n  newNoteClicked: boolean;\r\n}\r\n\r\nfunction isDifferentNote(left: DailyNotes | null, right: DailyNotes | null) {\r\n  if (left === null && right !== null) {\r\n    return true;\r\n  }\r\n\r\n  if (left !== null && right === null) {\r\n    return true;\r\n  }\r\n\r\n  if (left === null && right === null) {\r\n    return false;\r\n  }\r\n\r\n  if (left?.Role !== right?.Role) {\r\n    return true;\r\n  }\r\n\r\n  if (left?.DailyNoteId !== right?.DailyNoteId) {\r\n    return true;\r\n  }\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction getFirstAvailableDepartment(\r\n  auth: AuthorizedItems\r\n): SelectedDepartment {\r\n  for (let i = 0; i < auth.locations.length; i++) {\r\n    const curLoc = auth.locations[i];\r\n\r\n    if (curLoc.adminAllDepts) {\r\n      return {\r\n        location: curLoc,\r\n        department: null,\r\n      };\r\n    }\r\n\r\n    for (let j = 0; j < curLoc.departments.length; j++) {\r\n      const curDep = curLoc.departments[j];\r\n\r\n      if (\r\n        auth.role === Role.LocationAdmin ||\r\n        auth.role === Role.BusinessAdmin\r\n      ) {\r\n        return {\r\n          location: curLoc,\r\n          department: curDep,\r\n        };\r\n      }\r\n\r\n      if (curDep.isDeptAdmin) {\r\n        return {\r\n          location: curLoc,\r\n          department: curDep,\r\n        };\r\n      }\r\n    }\r\n  }\r\n\r\n  throw new Error(\"Could not find a department for this user to add a note\");\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst EditDailyNoteModal: React.FC<EditDailyNoteModalProps> = ({\r\n  onCloseModal,\r\n  isOpen,\r\n  note,\r\n  initialDate,\r\n}) => {\r\n  const [originalNote, setOriginalNote] = useState(note);\r\n  const toast = useSimpleToast();\r\n  const dlg = useDialogBox();\r\n  const { user } = useContext(ApplicationUserContext);\r\n  const { auth } = useContext(AuthorizedItemsContext);\r\n  const dialog = useOrbitalDialogBox();\r\n  const [selectedRole, setSelectedRole] = useState(\r\n    note !== null ? note.Role : 1\r\n  );\r\n\r\n  const [selectedDepartment, setSelectedDepartment] = useState(\r\n    note !== null\r\n      ? authHelper.getSelectedDepartment(\r\n          auth,\r\n          note.LocationId,\r\n          note.DepartmentId\r\n        )\r\n      : getFirstAvailableDepartment(auth)\r\n  );\r\n\r\n  const [noteText, setNoteText] = useState(note !== null ? note.Notes : \"\");\r\n  const noteCharCountRef = useRef(note !== null ? note.Notes.length : 0);\r\n  const [selectedDate, setSelectedDate] = useState(\r\n    note !== null ? parseISO(note.EventStart) : initialDate\r\n  );\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    let isMounted = true;\r\n    if (isOpen) {\r\n      if (originalNote === null && isMounted) {\r\n        fetchDailyNote(selectedDepartment, selectedRole, selectedDate);\r\n      }\r\n    }\r\n\r\n    return () => {\r\n      isMounted = false;\r\n    };\r\n\r\n    // eslint-disable-next-line\r\n  }, [isOpen, originalNote]);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const fetchDailyNote = (\r\n    dep: SelectedDepartment,\r\n    role: number,\r\n    date: Date\r\n  ) => {\r\n    notesApi\r\n      .getDailyNote(\r\n        user,\r\n        dep.location.id,\r\n        dep.department === null ? -1 : dep.department.id,\r\n        role,\r\n        date\r\n      )\r\n      .then((res: DailyNotes | ApiResult) => {\r\n        if (\"message\" in res) {\r\n          if (res.error) {\r\n          } else {\r\n            setOriginalNote(null);\r\n          }\r\n        } else {\r\n          if (\r\n            originalNote !== null &&\r\n            originalNote.DailyNoteId === res.DailyNoteId\r\n          ) {\r\n            return;\r\n          }\r\n\r\n          if (isDifferentNote(res, originalNote)) {\r\n            setOriginalNote(res);\r\n          }\r\n\r\n          const newStart = parseISO(res.EventStart);\r\n          if (!isSameDay(newStart, selectedDate)) {\r\n            setSelectedDate(newStart);\r\n          }\r\n\r\n          if (\r\n            res.LocationId !== selectedDepartment.location.id ||\r\n            (res.DepartmentId === -1 &&\r\n              selectedDepartment.department !== null) ||\r\n            (res.DepartmentId !== -1 &&\r\n              selectedDepartment.department === null) ||\r\n            (selectedDepartment.department !== null &&\r\n              res.DepartmentId !== selectedDepartment.department.id)\r\n          ) {\r\n            setSelectedDepartment(\r\n              authHelper.getSelectedDepartment(\r\n                auth,\r\n                res.LocationId,\r\n                res.DepartmentId\r\n              )\r\n            );\r\n          }\r\n\r\n          if (res.Role !== selectedRole) {\r\n            setSelectedRole(res.Role);\r\n          }\r\n\r\n          if (res.Notes !== noteText) {\r\n            setNoteText(res.Notes);\r\n            noteCharCountRef.current = res.Notes.length;\r\n          }\r\n        }\r\n      });\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onCancel = () => {\r\n    if (\r\n      (originalNote === null && noteText != null) ||\r\n      (originalNote !== null && originalNote.Notes !== noteText)\r\n    ) {\r\n      updateBackend(\r\n        selectedDepartment,\r\n        selectedRole,\r\n        selectedDate,\r\n        noteText,\r\n        true\r\n      );\r\n    } else {\r\n      onCloseModal(\"\");\r\n    }\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const updateBackend = (\r\n    dep: SelectedDepartment,\r\n    role: number,\r\n    date: Date,\r\n    text: string,\r\n    isClosing: boolean\r\n  ) => {\r\n    if (\r\n      (originalNote === null && noteText.length === 0) ||\r\n      (originalNote !== null && originalNote.Notes === noteText)\r\n    ) {\r\n      if (isClosing) {\r\n        onCloseModal(\"\");\r\n      }\r\n      return;\r\n    }\r\n\r\n    if (originalNote !== null) {\r\n      if (text.length === 0) {\r\n        notesApi.deleteDailyNote(user, originalNote.DailyNoteId).then((res) => {\r\n          if (res.error) {\r\n            dlg.showAlert(\"Can't Delete Note\", res.message, () => {});\r\n          } else {\r\n            if (isClosing) {\r\n              onCloseModal(\"Note Deleted\");\r\n            } else {\r\n              toast.showToast(\"Note Deleted\");\r\n            }\r\n          }\r\n        });\r\n      }\r\n      notesApi\r\n        .updateDailyNote(user, originalNote.DailyNoteId, text, role, date)\r\n        .then((res) => {\r\n          if (res.error) {\r\n            dlg.showAlert(\"Can't Update Note\", res.message, () => {});\r\n          } else {\r\n            if (isClosing) {\r\n              onCloseModal(\"Note Updated\");\r\n            } else {\r\n              toast.showToast(\"Note Updated\");\r\n            }\r\n          }\r\n        });\r\n    } else {\r\n      notesApi\r\n        .insertDailyNote(\r\n          user,\r\n          dep.location.id,\r\n          dep.department === null ? -1 : dep.department.id,\r\n          role,\r\n          date,\r\n          text\r\n        )\r\n        .then((res) => {\r\n          if (res.error) {\r\n            dlg.showAlert(\"Can't Add Daily Note\", res.message, () => {});\r\n          } else {\r\n            if (isClosing) {\r\n              onCloseModal(\"Note Added\");\r\n            } else {\r\n              toast.showToast(\"Note Added\");\r\n            }\r\n          }\r\n        });\r\n    }\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onDepartmentUpdate = (dep: SelectedDepartment) => {\r\n    if (\r\n      dep.location.id !== selectedDepartment.location.id ||\r\n      dep.department !== selectedDepartment.department\r\n    ) {\r\n      setSelectedDepartment(dep);\r\n      updateBackend(\r\n        selectedDepartment,\r\n        selectedRole,\r\n        selectedDate,\r\n        noteText,\r\n        false\r\n      );\r\n      fetchDailyNote(dep, selectedRole, selectedDate);\r\n    }\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onRoleUpdate = (newRole: number) => {\r\n    if (newRole !== selectedRole) {\r\n      setSelectedRole(newRole);\r\n      updateBackend(\r\n        selectedDepartment,\r\n        selectedRole,\r\n        selectedDate,\r\n        noteText,\r\n        false\r\n      );\r\n      fetchDailyNote(selectedDepartment, newRole, selectedDate);\r\n    }\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onDateSelected = (dateStr: string | null | undefined) => {\r\n    if (dateStr === null || dateStr === undefined) {\r\n      return;\r\n    }\r\n\r\n    const date = parseISO(dateStr);\r\n    if (date !== selectedDate) {\r\n      setSelectedDate(date);\r\n      updateBackend(\r\n        selectedDepartment,\r\n        selectedRole,\r\n        selectedDate,\r\n        noteText,\r\n        false\r\n      );\r\n      fetchDailyNote(selectedDepartment, selectedRole, date);\r\n    }\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onTextChanged = (newText: string | null | undefined) => {\r\n    if (newText === null || newText === undefined) {\r\n      return;\r\n    }\r\n\r\n    if (newText.length !== noteCharCountRef.current) {\r\n      noteCharCountRef.current = newText.length;\r\n    }\r\n\r\n    if (newText !== noteText) {\r\n      setNoteText(newText);\r\n    }\r\n  };\r\n\r\n  if (!isOpen || !auth || !auth.locations || auth.locations.length === 0) {\r\n    return (\r\n      <>\r\n        <div>Loading</div>\r\n        {dlg.alertBoxJsx}\r\n      </>\r\n    );\r\n  } else {\r\n    return (\r\n      <>\r\n        <IonHeader className=\"ion-no-border\">\r\n          <IonToolbar>\r\n            <IonButtons slot=\"start\">\r\n              <IonButton onClick={onCancel}>\r\n                <IonIcon icon={arrowBackOutline} mode=\"md\" slot=\"icon-only\" />\r\n              </IonButton>\r\n            </IonButtons>\r\n            <IonTitle className=\"IonTitle--DailyNote\">Daily Notes</IonTitle>\r\n          </IonToolbar>\r\n        </IonHeader>\r\n\r\n        <IonContent class=\"edit-daily-modal-content\">\r\n          <IonList>\r\n            <DailyNoteDepartmentSelector\r\n              currentDepartment={selectedDepartment}\r\n              onDepartmentUpdate={onDepartmentUpdate}\r\n            />\r\n\r\n            <IonItem>\r\n              <IonLabel>Viewable By</IonLabel>\r\n              <IonSelect\r\n                interface=\"popover\"\r\n                value={selectedRole}\r\n                onIonChange={(e) => {\r\n                  onRoleUpdate(e.detail.value);\r\n                }}\r\n              >\r\n                <IonSelectOption value={1} key={1}>\r\n                  Employees\r\n                </IonSelectOption>\r\n                <IonSelectOption value={2} key={2}>\r\n                  Admins\r\n                </IonSelectOption>\r\n              </IonSelect>\r\n            </IonItem>\r\n            <IonItem>\r\n              <IonLabel>Date</IonLabel>\r\n              <IonDatetime\r\n                displayFormat=\"DDDD M / DD / YYYY\"\r\n                pickerFormat=\"MMM DD YYYY\"\r\n                min=\"2005-01-01\"\r\n                max=\"2030-01-01\"\r\n                value={selectedDate.toISOString()}\r\n                onIonChange={(e) => {\r\n                  onDateSelected(e.detail.value);\r\n                }}\r\n              />\r\n            </IonItem>\r\n            <IonItem>\r\n              <IonTextarea\r\n                value={noteText}\r\n                placeholder={\"Enter a Note\"}\r\n                rows={5}\r\n                spellcheck={true}\r\n                wrap=\"hard\"\r\n                debounce={50}\r\n                onIonChange={(e) => {\r\n                  onTextChanged(e.detail.value);\r\n                }}\r\n              />\r\n            </IonItem>\r\n            <div className=\"character-counter\">\r\n              {noteCharCountRef.current}/180\r\n            </div>\r\n          </IonList>\r\n        </IonContent>\r\n\r\n        {dlg.alertBoxJsx}\r\n        {dialog.dialogBoxJsx}\r\n        {toast.simpleToastJsx}\r\n      </>\r\n    );\r\n  }\r\n};\r\n\r\nexport default EditDailyNoteModal;\r\n","import React, { useContext, useState } from \"react\";\r\n// import \"./DailyNoteCard.scss\";\r\nimport \"../../global-styles.scss\";\r\nimport {\r\n  AdminAuthorization,\r\n  AuthorizedLocation,\r\n  Role,\r\n} from \"../../orbital-interfaces/authorized-items\";\r\nimport { format, parseISO } from \"date-fns\";\r\nimport { DailyNotes } from \"../../orbital-interfaces/DailyNotes\";\r\nimport { IonModal } from \"@ionic/react\";\r\nimport EditDailyNoteModal from \"./EditDailyNoteModal\";\r\nimport { AuthorizedItemsContext } from \"../../context/AuthorizedItemsContext\";\r\nimport authHelper from \"../../util/authitems-helper\";\r\n\r\ninterface EventCardProps {\r\n  note: DailyNotes;\r\n  location: AuthorizedLocation;\r\n  onForceRefresh: (toastMessage: string) => void;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\n//\r\n// --------------------------------------------------------------------------------------\r\nconst EventCard: React.FC<EventCardProps> = ({\r\n  note,\r\n  onForceRefresh,\r\n}: EventCardProps) => {\r\n  const noteDate = parseISO(note.EventStart);\r\n  const deptName = note.DepartmentId === -1 ? \"All Depts\" : note.DepartmentName;\r\n  const [showEditModal, setShowEditModal] = useState(false);\r\n  const { auth } = useContext(AuthorizedItemsContext);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  function onClose(toastMessage: string) {\r\n    onForceRefresh(toastMessage);\r\n    setShowEditModal(false);\r\n  }\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  function onClick() {\r\n    if (auth.role === Role.Employee) {\r\n      return;\r\n    }\r\n\r\n    if (\r\n      !authHelper.isAdminAuthorizedFor(\r\n        auth,\r\n        note.LocationId,\r\n        note.DepartmentId,\r\n        AdminAuthorization.CanEditSchedules\r\n      )\r\n    ) {\r\n      return false;\r\n    }\r\n\r\n    setShowEditModal(true);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <button className=\"card daily-note\" onClick={onClick}>\r\n        <div className=\"card-first-col\">\r\n          <div className=\"day-name\">{format(noteDate, \"EEE\")} </div>\r\n          <div className=\"day-number\">{format(noteDate, \"d\")}</div>\r\n        </div>\r\n        <div className=\"card-second-col\">\r\n          <div className=\"first-row\">\r\n            {deptName}: {note.Role === 1 ? \"Employees\" : \"Admins\"}\r\n            <br />\r\n            {note.Notes}\r\n          </div>\r\n        </div>\r\n      </button>\r\n\r\n      <IonModal\r\n        isOpen={showEditModal}\r\n        onDidDismiss={() => setShowEditModal(false)}\r\n      >\r\n        <EditDailyNoteModal\r\n          isOpen={showEditModal}\r\n          note={note}\r\n          onCloseModal={(toast) => onClose(toast)}\r\n          initialDate={new Date()}\r\n          newNoteClicked={true}\r\n        />\r\n      </IonModal>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default EventCard;\r\n","import React, { useContext, useState } from \"react\";\r\nimport { IonModal } from \"@ionic/react\";\r\nimport EditDailyNoteModal from \"./EditDailyNoteModal\";\r\nimport { AuthorizedItemsContext } from \"../../context/AuthorizedItemsContext\";\r\nimport {\r\n  AuthorizedItems,\r\n  Role,\r\n} from \"../../orbital-interfaces/authorized-items\";\r\n\r\ninterface AddDailyNoteButtonProps {\r\n  date: Date;\r\n  onForceRefresh: (toastMessage: string) => void;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction canAddNote(auth: AuthorizedItems) {\r\n  if (auth.role === Role.Employee) {\r\n    return false;\r\n  }\r\n\r\n  if (auth.role === Role.BusinessAdmin || auth.role === Role.LocationAdmin) {\r\n    return true;\r\n  }\r\n\r\n  for (let i = 0; i < auth.locations.length; i++) {\r\n    const curLoc = auth.locations[i];\r\n    if (curLoc.adminAllDepts) {\r\n      return true;\r\n    }\r\n\r\n    for (let j = 0; j < curLoc.departments.length; j++) {\r\n      if (curLoc.departments[j].isDeptAdmin) {\r\n        return true;\r\n      }\r\n    }\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\n//\r\n// --------------------------------------------------------------------------------------\r\nconst AddDailyNoteButton: React.FC<AddDailyNoteButtonProps> = ({\r\n  date,\r\n  onForceRefresh,\r\n}) => {\r\n  const [showEditModal, setShowEditModal] = useState(false);\r\n  const { auth } = useContext(AuthorizedItemsContext);\r\n\r\n  if (!canAddNote(auth)) {\r\n    return <span />;\r\n  }\r\n\r\n  const onClose = (toastMessage: string) => {\r\n    setShowEditModal(false);\r\n    onForceRefresh(toastMessage);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <button\r\n        className=\"add-daily-note-button\"\r\n        onClick={() => {\r\n          setShowEditModal(true);\r\n        }}\r\n      >\r\n        + Daily Note\r\n      </button>\r\n\r\n      <IonModal\r\n        isOpen={showEditModal}\r\n        onDidDismiss={() => setShowEditModal(false)}\r\n      >\r\n        <EditDailyNoteModal\r\n          isOpen={showEditModal}\r\n          note={null}\r\n          initialDate={date}\r\n          onCloseModal={(toast) => {\r\n            onClose(toast);\r\n          }}\r\n          newNoteClicked={true}\r\n        />\r\n      </IonModal>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default AddDailyNoteButton;\r\n","enum EventGroup {\r\n  All = -1,\r\n  Scheduled = -2,\r\n  DontWork = -3,\r\n  ClockAndSched = -6,\r\n  Custom = 0,\r\n}\r\n\r\nexport default EventGroup;\r\n","import React from \"react\";\r\n// import \"./EventList.scss\";\r\nimport EventCard from \"./EventCard\";\r\nimport DailyNoteCard from \"./DailyNoteCard\";\r\nimport { AuthorizedLocation } from \"../../orbital-interfaces/authorized-items\";\r\n// import \"./EventListSection.scss\";\r\nimport \"../../global-styles.scss\";\r\nimport { EventInformation } from \"../../orbital-interfaces/TEC\";\r\nimport { DailyNotes } from \"../../orbital-interfaces/DailyNotes\";\r\nimport { EventEditAuthorization } from \"../EditEvent/EditEventAuthorization\";\r\nimport AddDailyNoteButton from \"./AddDailyNoteButton\";\r\n\r\ninterface EventListSectionProps {\r\n  locations: AuthorizedLocation[];\r\n  events: EventInformation[];\r\n  notes: DailyNotes[];\r\n  header: string;\r\n  showEmployeeNames: boolean;\r\n  showTotalDuration: boolean;\r\n  onEdit: (ev: EventInformation, eventEditAuth: EventEditAuthorization) => void;\r\n  dailyNotesAddButtonDate: Date | null;\r\n  onForceRefresh: (toastMessage: string) => void;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\n//\r\n// --------------------------------------------------------------------------------------\r\nconst EventListSection: React.FC<EventListSectionProps> = ({\r\n  locations,\r\n  header,\r\n  events,\r\n  notes,\r\n  showEmployeeNames,\r\n  onEdit,\r\n  dailyNotesAddButtonDate,\r\n  onForceRefresh,\r\n}: EventListSectionProps) => {\r\n  const multiLocation =\r\n    locations.filter((l) =>\r\n      l.departments.filter((d) => d.positions.filter((p) => p.hasPosition))\r\n    ).length > 1;\r\n\r\n  if (events.length === 0) {\r\n    return <div />;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <div className=\"header\">\r\n        {header}\r\n        {dailyNotesAddButtonDate !== null && (\r\n          <AddDailyNoteButton\r\n            onForceRefresh={onForceRefresh}\r\n            date={dailyNotesAddButtonDate!}\r\n          />\r\n        )}\r\n      </div>\r\n      <div>\r\n        {notes.map((note) => (\r\n          <DailyNoteCard\r\n            onForceRefresh={onForceRefresh}\r\n            key={note.DailyNoteId}\r\n            note={note}\r\n            location={locations.filter((l) => l.id === note.LocationId)[0]}\r\n          />\r\n        ))}\r\n      </div>\r\n      <div>\r\n        {events.map((ev) => (\r\n          <EventCard\r\n            onEdit={onEdit}\r\n            key={ev.ScheduleEventId}\r\n            event={ev}\r\n            location={locations.filter((l) => l.id === ev.LocationId)[0]}\r\n            multiLocation={multiLocation}\r\n            showEmployeeName={showEmployeeNames}\r\n          />\r\n        ))}\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default EventListSection;\r\n","import React from \"react\";\r\n// import \"./EventList.scss\";\r\nimport \"../../global-styles.scss\";\r\nimport {\r\n  AuthorizedItems,\r\n  LocationSettings,\r\n} from \"../../orbital-interfaces/authorized-items\";\r\nimport { addDays, format, isBefore, parseISO } from \"date-fns\";\r\nimport { KeyedCollection } from \"../../util/KeyedCollection\";\r\nimport EventListSection from \"./EventListSection\";\r\nimport {\r\n  getDurationFromTimeSpan,\r\n  getDurationString,\r\n  getWeekStart,\r\n} from \"../../util/time-helper\";\r\nimport { EventInformation, HoursList } from \"../../orbital-interfaces/TEC\";\r\nimport { DailyNotes } from \"../../orbital-interfaces/DailyNotes\";\r\nimport { EventEditAuthorization } from \"../EditEvent/EditEventAuthorization\";\r\n\r\ninterface EventListProps {\r\n  events: EventInformation[];\r\n  notes: DailyNotes[];\r\n  hoursPerDay: HoursList[];\r\n  listType: \"my\" | \"requests\" | \"all\";\r\n  auth: AuthorizedItems;\r\n  onEdit: (ev: EventInformation, eventEditAuth: EventEditAuthorization) => void;\r\n  onForceRefresh: (toastMessage: string) => void;\r\n}\r\n\r\ninterface SegmentItemList {\r\n  events: EventInformation[];\r\n  notes: DailyNotes[];\r\n  date: Date | null;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst getSegmentsForMy = (\r\n  events: EventInformation[],\r\n  notes: DailyNotes[],\r\n  locationSettings: LocationSettings,\r\n  hoursPerDay: HoursList[]\r\n) => {\r\n  const segments = new KeyedCollection<SegmentItemList>();\r\n  if (events.length === 0 && notes.length === 0) {\r\n    return segments;\r\n  }\r\n\r\n  let weekStart = new Date(2199, 1, 1);\r\n  if (events.length > 0) {\r\n    weekStart = getWeekStart(\r\n      parseISO(events[0].EventStart),\r\n      locationSettings.DayWeekStartsOn,\r\n      locationSettings.DayStartTime\r\n    );\r\n  }\r\n\r\n  if (notes.length > 0) {\r\n    const notesStart = getWeekStart(\r\n      parseISO(notes[0].EventStart),\r\n      locationSettings.DayWeekStartsOn,\r\n      locationSettings.DayStartTime\r\n    );\r\n    if (isBefore(notesStart, weekStart)) {\r\n      weekStart = notesStart;\r\n    }\r\n  }\r\n\r\n  const weekEnd = addDays(weekStart, 6);\r\n  const header =\r\n    `${format(weekStart, \"MMM d\")} - ${format(\r\n      weekEnd,\r\n      \"MMM d\"\r\n    )}`.toUpperCase() +\r\n    \" \" +\r\n    getDurationString(\r\n      hoursPerDay\r\n        .map((h) => getDurationFromTimeSpan(h.time))\r\n        .reduce((prev, cur) => prev + cur, 0)\r\n    );\r\n\r\n  segments.add(header, { events, notes, date: weekStart });\r\n  return segments;\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst getSegmentsForRequests = (\r\n  events: EventInformation[],\r\n  notes: DailyNotes[],\r\n  employeeId: number\r\n) => {\r\n  const segments = new KeyedCollection<SegmentItemList>();\r\n  segments.add(\"MY REQUESTS\", {\r\n    events: events.filter((ev) => ev.EmployeeId === employeeId),\r\n    notes: [],\r\n    date: null,\r\n  });\r\n  segments.add(\"CO-WORKERS\", {\r\n    events: events.filter((ev) => ev.EmployeeId !== employeeId),\r\n    notes: [],\r\n    date: null,\r\n  });\r\n  return segments;\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst getSegmentsForAll = (events: EventInformation[], notes: DailyNotes[]) => {\r\n  const segments = new KeyedCollection<SegmentItemList>();\r\n  events.map((ev) => {\r\n    const thisDate = format(\r\n      parseISO(ev.EventStart).setHours(0, 0, 0, 0),\r\n      \"MMM d, yyyy\"\r\n    ).toUpperCase();\r\n    if (!segments.containsKey(thisDate)) {\r\n      const thisDatesNotes = notes.filter(\r\n        (n) =>\r\n          format(\r\n            parseISO(n.EventStart).setHours(0, 0, 0, 0),\r\n            \"MMM d, yyyy\"\r\n          ).toUpperCase() === thisDate\r\n      );\r\n      segments.add(thisDate, {\r\n        notes: thisDatesNotes,\r\n        events: [],\r\n        date: parseISO(ev.EventStart),\r\n      });\r\n    }\r\n\r\n    segments.item(thisDate).events.push(ev);\r\n    return thisDate;\r\n  });\r\n\r\n  return segments;\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst EventList: React.FC<EventListProps> = ({\r\n  events,\r\n  listType,\r\n  notes,\r\n  hoursPerDay,\r\n  auth,\r\n  onEdit,\r\n  onForceRefresh,\r\n}: EventListProps) => {\r\n  if (events.length === 0) {\r\n    return <div>No Events</div>;\r\n  }\r\n\r\n  let segments: KeyedCollection<SegmentItemList> = new KeyedCollection<\r\n    SegmentItemList\r\n  >();\r\n  switch (listType) {\r\n    case \"requests\":\r\n      segments = getSegmentsForRequests(events, notes, auth.employeeId);\r\n      break;\r\n    case \"my\":\r\n      segments = getSegmentsForMy(\r\n        events,\r\n        notes,\r\n        auth.locations[0].settings,\r\n        hoursPerDay\r\n      );\r\n      break;\r\n    default:\r\n      segments = getSegmentsForAll(events, notes);\r\n      break;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {segments.keys().map((seg) => (\r\n        <EventListSection\r\n          onEdit={onEdit}\r\n          key={seg}\r\n          header={seg}\r\n          locations={auth.locations}\r\n          events={segments.item(seg).events}\r\n          notes={segments.item(seg).notes}\r\n          showEmployeeNames={listType !== \"my\" && seg !== \"MY REQUESTS\"}\r\n          showTotalDuration={listType !== \"requests\"}\r\n          dailyNotesAddButtonDate={segments.item(seg).date}\r\n          onForceRefresh={onForceRefresh}\r\n        />\r\n      ))}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default EventList;\r\n","import EventGroup from \"../enums/EventGroup\";\r\nimport { EventFilter } from \"../orbital-interfaces/EventFilter\";\r\nimport { AuthorizedItems } from \"../orbital-interfaces/authorized-items\";\r\nimport EventType from \"../enums/EventType\";\r\n\r\nexport interface EventTypeOption {\r\n  value: number;\r\n  text: string;\r\n  color: string;\r\n}\r\n\r\nexport const getFilterByEventGroup = (\r\n  f: EventFilter,\r\n  group: EventGroup\r\n): EventFilter => {\r\n  return group === EventGroup.Custom\r\n    ? { ...f, eventTypeId: -1, eventStatusId: -1 }\r\n    : { ...f, eventTypeId: group, eventStatusId: group };\r\n};\r\n\r\nexport const getEventTypeOptions = (\r\n  auth: AuthorizedItems,\r\n  filter?: EventFilter\r\n): EventTypeOption[] => {\r\n  if (!auth || !auth.locations || auth.locations.length === 0) {\r\n    return [];\r\n  }\r\n\r\n  const locSettings = auth.locations[0].settings;\r\n\r\n  const eventTypeOptions: EventTypeOption[] = [\r\n    {\r\n      value: EventType.Shift,\r\n      text: \"SHIFT\",\r\n      color: \"green\",\r\n    },\r\n    {\r\n      value: EventType.Cover,\r\n      text: \"COVER\",\r\n      color: \"red\",\r\n    },\r\n  ];\r\n\r\n  if (filter) {\r\n    eventTypeOptions.unshift({ value: -1, text: \"ALL\", color: \"black\" });\r\n  }\r\n\r\n  eventTypeOptions.push({\r\n    value: EventType.Clock,\r\n    text: \"CLOCK\",\r\n    color: \"green\",\r\n  });\r\n\r\n  if (locSettings.ShowUnavailableEventType) {\r\n    eventTypeOptions.push({\r\n      value: EventType.Unavailable,\r\n      text: \"UNAVAILABLE\",\r\n      color: \"yellow\",\r\n    });\r\n  }\r\n\r\n  if (locSettings.ShowVacationEventType) {\r\n    eventTypeOptions.push({\r\n      value: EventType.Vacation,\r\n      text: \"VACATION\",\r\n      color: \"yellow\",\r\n    });\r\n  }\r\n\r\n  if (locSettings.ShowAbsentEventType) {\r\n    const peTypes: EventTypeOption[] = [];\r\n    const p2l: any = {};\r\n    auth.locations.flatMap((l) =>\r\n      l.departments.flatMap((d) => d.positions.map((p) => (p2l[p.id] = l)))\r\n    );\r\n\r\n    auth.payrollEvents.map((pe) => {\r\n      if (!pe.name.startsWith(\"--\")) {\r\n        if (filter) {\r\n          if (\r\n            pe.positionIds.some((id) => filter.positionIds.indexOf(id) >= 0)\r\n          ) {\r\n            peTypes.push({\r\n              value: pe.id,\r\n              text: `${pe.name} (${p2l[pe.positionIds[0]].name})`,\r\n              color: \"yellow\",\r\n            });\r\n          }\r\n        } else {\r\n          peTypes.push({\r\n            value: pe.id,\r\n            text: `${pe.name} (${p2l[pe.positionIds[0]].name})`,\r\n            color: \"yellow\",\r\n          });\r\n        }\r\n\r\n        return pe;\r\n      } else {\r\n        return null;\r\n      }\r\n    });\r\n    peTypes.sort((p1, p2) => {\r\n      return p1.text > p2.text ? 1 : -1;\r\n    });\r\n    return eventTypeOptions.concat(peTypes);\r\n  }\r\n\r\n  return eventTypeOptions;\r\n};\r\n","const arrayHelper = {\r\n  // ------------------------------------------------------------------------------------\r\n  areEqual: <T extends {}>(a1: T[], a2: T[]): boolean => {\r\n    if ((!a1 && a2) || (a1 && !a2)) {\r\n      return false;\r\n    }\r\n\r\n    if (!a1 && !a2) {\r\n      return true;\r\n    }\r\n\r\n    if (a1.length !== a2.length) {\r\n      return false;\r\n    }\r\n\r\n    for (let i = 0; i < a1.length; i++) {\r\n      if (!arrayHelper.contains(a2, a1[i])) {\r\n        return false;\r\n      }\r\n    }\r\n\r\n    return true;\r\n  },\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  contains: <T extends {}>(arr: T[], val: T): boolean => {\r\n    for (let i = 0; i < arr.length; i++) {\r\n      if (arr[i] === val) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  },\r\n\r\n  containsAny: <T extends {}>(arr1: T[], arr2: T[]): boolean => {\r\n    for (let i = 0; i < arr1.length; i++) {\r\n      if (arr2.includes(arr1[i])) {\r\n        return true;\r\n      }\r\n    }\r\n\r\n    return false;\r\n  },\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  unique: <T extends {}>(arr: T[]): T[] => {\r\n    const newArr: T[] = [];\r\n    // eslint-disable-next-line\r\n    arr.map((item) => {\r\n      if (!arrayHelper.contains(newArr, item)) {\r\n        newArr.push(item);\r\n      }\r\n    });\r\n\r\n    return newArr;\r\n  },\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  uniqueObject: <T extends {}>(\r\n    arr: T[],\r\n    filt: (o: T, n: T) => boolean\r\n  ): T[] => {\r\n    const newArr: T[] = [];\r\n    // eslint-disable-next-line\r\n    arr.map((item) => {\r\n      let found = false;\r\n      for (let i = 0; i < newArr.length; i++) {\r\n        if (filt(newArr[i], item)) {\r\n          found = true;\r\n          break;\r\n        }\r\n      }\r\n\r\n      if (!found) {\r\n        newArr.push(item);\r\n      }\r\n    });\r\n\r\n    return newArr;\r\n  },\r\n};\r\n\r\nexport default arrayHelper;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport {\r\n  IonButton,\r\n  IonButtons,\r\n  IonIcon,\r\n  IonContent,\r\n  IonFooter,\r\n  IonHeader,\r\n  IonItem,\r\n  IonLabel,\r\n  IonSelect,\r\n  IonSelectOption,\r\n  IonTitle,\r\n  IonToolbar,\r\n} from \"@ionic/react\";\r\nimport {\r\n  EventFilter,\r\n  initialEventFilter,\r\n} from \"../../orbital-interfaces/EventFilter\";\r\nimport { arrowBackOutline } from \"ionicons/icons\";\r\n// import \"./ScheduleFilterModal.scss\";\r\nimport \"../../global-styles.scss\";\r\nimport EventGroup from \"../../enums/EventGroup\";\r\nimport {\r\n  getFilterByEventGroup,\r\n  getEventTypeOptions,\r\n} from \"../../util/event-helper\";\r\nimport { AuthorizedItems } from \"../../orbital-interfaces/authorized-items\";\r\nimport arrayHelper from \"../../util/array-helper\";\r\n\r\ninterface ScheduleFilterModalProps {\r\n  filter: EventFilter;\r\n  auth: AuthorizedItems;\r\n  onDismissModal: (f: EventFilter, filterApplied: boolean) => void;\r\n  onCancelModal: () => void;\r\n  isOpen: boolean;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst ScheduleFilterModal: React.FC<ScheduleFilterModalProps> = ({\r\n  auth,\r\n  filter,\r\n  onDismissModal,\r\n  onCancelModal,\r\n  isOpen,\r\n}: ScheduleFilterModalProps) => {\r\n  const [myFilter, setMyFilter] = useState(filter);\r\n  const [showCustomEventTypes, setShowCustomEventTypes] = useState(false);\r\n  const [eventGroup, setEventGroup] = useState(EventGroup.ClockAndSched);\r\n  const [eventTypeList, setEventTypeList] = useState(\r\n    getEventTypeOptions(auth, filter)\r\n  );\r\n  const [locationIds, setLocationIds] = useState(\r\n    auth.locations.map((l) => \"\" + l.id)\r\n  );\r\n  const [departmentIds, setDepartmentIds] = useState(\r\n    auth.locations.flatMap((l) => l.departments).map((d) => \"\" + d.id)\r\n  );\r\n  const [positionIds, setPositionIds] = useState(\r\n    auth.locations\r\n      .flatMap((l) => l.departments)\r\n      .flatMap((d) => d.positions)\r\n      .map((p) => \"\" + p.id)\r\n  );\r\n  const [isDirty, setIsDirty] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setMyFilter(filter);\r\n  }, [filter]);\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      setIsDirty(false);\r\n    }\r\n  }, [isOpen]);\r\n\r\n  const getDefaultFilter = (auth: AuthorizedItems) => {\r\n    return {\r\n      ...initialEventFilter,\r\n      start: filter.start,\r\n      end: filter.end,\r\n      tagId: -1,\r\n      positionIds: auth.locations.flatMap((l) =>\r\n        l.departments.flatMap((d) => d.positions.map((p) => p.id))\r\n      ),\r\n      dnLocIds: auth.locations.map((l) => l.id),\r\n      settingsLocId: auth.locations[0].id,\r\n    };\r\n  };\r\n\r\n  const onReset = () => {\r\n    setShowCustomEventTypes(false);\r\n    setEventGroup(EventGroup.ClockAndSched);\r\n    setEventTypeList(getEventTypeOptions(auth, filter));\r\n    setLocationIds(auth.locations.map((l) => \"\" + l.id));\r\n    setDepartmentIds(\r\n      auth.locations.flatMap((l) => l.departments).map((d) => \"\" + d.id)\r\n    );\r\n    setPositionIds(\r\n      auth.locations\r\n        .flatMap((l) => l.departments)\r\n        .flatMap((d) => d.positions)\r\n        .map((p) => \"\" + p.id)\r\n    );\r\n    setMyFilter(getDefaultFilter(auth));\r\n\r\n    setIsDirty(true);\r\n  };\r\n\r\n  const onEventGroupSelect = (val: EventGroup) => {\r\n    setEventGroup(val);\r\n    setIsDirty(true);\r\n    setMyFilter(getFilterByEventGroup(myFilter, val));\r\n    setShowCustomEventTypes(val === EventGroup.Custom);\r\n  };\r\n\r\n  const onSetLocations = (locIds: string[]) => {\r\n    setLocationIds(locIds);\r\n    setIsDirty(true);\r\n    setDepartmentIds(\r\n      auth.locations\r\n        .filter((l) => locIds.indexOf(l.id.toString()) >= 0)\r\n        .flatMap((l) => l.departments)\r\n        .map((d) => \"\" + d.id)\r\n    );\r\n    setEventTypeList(getEventTypeOptions(auth, myFilter));\r\n  };\r\n\r\n  const onSetDepartmentIds = (deptIds: string[]) => {\r\n    setDepartmentIds(deptIds);\r\n    setIsDirty(true);\r\n    setPositionIds(\r\n      auth.locations\r\n        .filter((l) => locationIds.indexOf(l.id.toString()) >= 0)\r\n        .flatMap((l) => l.departments)\r\n        .flatMap((d) => d.positions)\r\n        .map((p) => \"\" + p.id)\r\n    );\r\n  };\r\n\r\n  const onSetPositionIds = (posIds: string[]) => {\r\n    setPositionIds(posIds);\r\n    setIsDirty(true);\r\n  };\r\n\r\n  const onCloseModal = () => {\r\n    const selectedPositionIds = positionIds.map((p) => parseInt(p));\r\n    const defaultFilter = getDefaultFilter(auth);\r\n    const returnedFilter = { ...myFilter, positionIds: selectedPositionIds };\r\n    const filterApplied = !(\r\n      defaultFilter.eventTypeId === returnedFilter.eventTypeId &&\r\n      defaultFilter.eventStatusId === returnedFilter.eventStatusId &&\r\n      defaultFilter.tagId === returnedFilter.tagId &&\r\n      arrayHelper.areEqual(\r\n        defaultFilter.positionIds,\r\n        returnedFilter.positionIds\r\n      )\r\n    );\r\n\r\n    onDismissModal(returnedFilter, filterApplied);\r\n  };\r\n\r\n  const onCancel = () => {\r\n    onCancelModal();\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <IonHeader className=\"ion-no-border\">\r\n        <IonToolbar>\r\n          <IonButtons slot=\"start\">\r\n            <IonButton onClick={onCancel}>\r\n              <IonIcon icon={arrowBackOutline} mode=\"md\" slot=\"icon-only\" />\r\n            </IonButton>\r\n          </IonButtons>\r\n          <IonTitle>Filter</IonTitle>\r\n          <IonButtons slot=\"end\">\r\n            <IonButton onClick={onReset}>RESET</IonButton>\r\n          </IonButtons>\r\n        </IonToolbar>\r\n      </IonHeader>\r\n\r\n      <IonContent class=\"outer-content\">\r\n        <IonItem>\r\n          <IonLabel>Events</IonLabel>\r\n          <IonSelect\r\n            value={eventGroup}\r\n            onIonChange={(e) => onEventGroupSelect(e.detail.value)}\r\n            interface=\"action-sheet\"\r\n          >\r\n            <IonSelectOption value={EventGroup.ClockAndSched}>\r\n              Clock + Sched\r\n            </IonSelectOption>\r\n            <IonSelectOption value={EventGroup.Scheduled}>\r\n              Scheduled\r\n            </IonSelectOption>\r\n            <IonSelectOption value={EventGroup.DontWork}>\r\n              Don&apos;t Work\r\n            </IonSelectOption>\r\n            <IonSelectOption value={EventGroup.Custom}>Custom</IonSelectOption>\r\n            <IonSelectOption value={EventGroup.All}>All</IonSelectOption>\r\n          </IonSelect>\r\n        </IonItem>\r\n\r\n        {showCustomEventTypes && (\r\n          <IonItem>\r\n            <IonLabel>Type</IonLabel>\r\n            <IonSelect\r\n              value={myFilter.eventTypeId}\r\n              onIonChange={(e) =>\r\n                setMyFilter({ ...myFilter, eventTypeId: e.detail.value })\r\n              }\r\n              interface=\"action-sheet\"\r\n            >\r\n              {eventTypeList.map((et) => (\r\n                <IonSelectOption key={et.value} value={et.value}>\r\n                  {et.text}\r\n                </IonSelectOption>\r\n              ))}\r\n            </IonSelect>\r\n          </IonItem>\r\n        )}\r\n\r\n        {showCustomEventTypes && (\r\n          <IonItem>\r\n            <IonLabel>Status</IonLabel>\r\n            <IonSelect\r\n              value={myFilter.eventStatusId}\r\n              onIonChange={(e) =>\r\n                setMyFilter({ ...myFilter, eventStatusId: e.detail.value })\r\n              }\r\n              interface=\"action-sheet\"\r\n            >\r\n              <IonSelectOption value={-1}>All</IonSelectOption>\r\n              <IonSelectOption value={1}>Approved</IonSelectOption>\r\n              <IonSelectOption value={2}>Request</IonSelectOption>\r\n              <IonSelectOption value={4}>Request Denied</IonSelectOption>\r\n            </IonSelect>\r\n          </IonItem>\r\n        )}\r\n\r\n        <IonItem>\r\n          <IonLabel>Tags</IonLabel>\r\n          <IonSelect\r\n            value={myFilter.tagId || -1}\r\n            onIonChange={(e) => {\r\n              setMyFilter({ ...myFilter, tagId: e.detail.value });\r\n              setIsDirty(true);\r\n            }}\r\n            interface=\"action-sheet\"\r\n          >\r\n            <IonSelectOption key={-1} value={-1}>\r\n              ALL\r\n            </IonSelectOption>\r\n            {auth.tags.map((tag) => (\r\n              <IonSelectOption key={tag.id} value={tag.id}>\r\n                ~{tag.name}\r\n              </IonSelectOption>\r\n            ))}\r\n          </IonSelect>\r\n        </IonItem>\r\n\r\n        {auth.locations.length > 1 && (\r\n          <IonItem>\r\n            <IonLabel>Locations</IonLabel>\r\n            <IonSelect\r\n              multiple={true}\r\n              onIonChange={(e) => onSetLocations(e.detail.value)}\r\n              value={locationIds}\r\n            >\r\n              {auth.locations.map((loc) => (\r\n                <IonSelectOption key={loc.id} value={loc.id.toString()}>\r\n                  {loc.name}\r\n                </IonSelectOption>\r\n              ))}\r\n            </IonSelect>\r\n          </IonItem>\r\n        )}\r\n\r\n        {auth.locations.flatMap((l) => l.departments).length > 1 && (\r\n          <IonItem>\r\n            <IonLabel>Departments</IonLabel>\r\n            <IonSelect\r\n              multiple={true}\r\n              onIonChange={(e) => onSetDepartmentIds(e.detail.value)}\r\n              value={departmentIds}\r\n            >\r\n              {auth.locations\r\n                .filter((l) => locationIds.indexOf(l.id.toString()) >= 0)\r\n                .map((loc) =>\r\n                  loc.departments.map((dept) => (\r\n                    <IonSelectOption key={dept.id} value={dept.id.toString()}>\r\n                      {loc.abbr}/{dept.name}\r\n                    </IonSelectOption>\r\n                  ))\r\n                )}\r\n            </IonSelect>\r\n          </IonItem>\r\n        )}\r\n\r\n        {auth.locations\r\n          .flatMap((l) => l.departments)\r\n          .flatMap((d) => d.positions).length > 1 && (\r\n          <IonItem>\r\n            <IonLabel>Positions</IonLabel>\r\n            <IonSelect\r\n              multiple={true}\r\n              onIonChange={(e) => onSetPositionIds(e.detail.value)}\r\n              value={positionIds}\r\n            >\r\n              {auth.locations\r\n                .filter((l) => locationIds.indexOf(l.id.toString()) >= 0)\r\n                .flatMap((l) => l.departments)\r\n                .filter((d) => departmentIds.indexOf(d.id.toString()) >= 0)\r\n                .map((dept) =>\r\n                  dept.positions.map((pos) => (\r\n                    <IonSelectOption key={pos.id} value={pos.id.toString()}>\r\n                      {pos.name}\r\n                    </IonSelectOption>\r\n                  ))\r\n                )}\r\n            </IonSelect>\r\n          </IonItem>\r\n        )}\r\n      </IonContent>\r\n\r\n      <IonFooter>\r\n        <IonButton\r\n          className=\"apply-button\"\r\n          expand=\"block\"\r\n          onClick={onCloseModal}\r\n          disabled={!isDirty}\r\n        >\r\n          APPLY FILTER\r\n        </IonButton>\r\n      </IonFooter>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ScheduleFilterModal;\r\n","import { IonRefresher, IonRefresherContent } from \"@ionic/react\";\r\nimport React, { useRef } from \"react\";\r\nimport { RefresherEventDetail } from \"@ionic/core\";\r\n\r\nfunction useIonicRefresher(\r\n  doRefresh: (event: CustomEvent<RefresherEventDetail>) => void\r\n) {\r\n  const ionRefresherRef = useRef<HTMLIonRefresherElement>(null);\r\n\r\n  // ----------------------------------------------------------------------------------------------\r\n  const ionicRefresherJsx = (\r\n    <IonRefresher slot=\"fixed\" ref={ionRefresherRef} onIonRefresh={doRefresh}>\r\n      <IonRefresherContent\r\n        pullingIcon=\"arrow-dropdown\"\r\n        pullingText=\"Pull down to refresh\"\r\n        refreshingSpinner=\"dots\"\r\n        refreshingText=\"Refreshing...\"\r\n      />\r\n    </IonRefresher>\r\n  );\r\n\r\n  const retVal = { ionicRefresherJsx };\r\n\r\n  return { ...retVal };\r\n}\r\n\r\nexport default useIonicRefresher;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport {\r\n  IonCol,\r\n  IonInput,\r\n  IonLabel,\r\n  IonRow,\r\n  IonSelect,\r\n  IonSelectOption,\r\n} from \"@ionic/react\";\r\n// import \"./EventTypeStatusEditor.scss\";\r\nimport \"../../../global-styles.scss\";\r\nimport {\r\n  AuthorizedItems,\r\n  LocationSettings,\r\n  Role,\r\n  TimeFormat,\r\n} from \"../../../orbital-interfaces/authorized-items\";\r\nimport EventType from \"../../../enums/EventType\";\r\nimport EventStatus from \"../../../enums/EventStatus\";\r\nimport { EditorReducerAction, EditorValues } from \"../EditEventModalState\";\r\nimport {\r\n  getMinutesFromTimeString,\r\n  getTimeStringFromMinutes,\r\n} from \"../../../util/time-helper\";\r\nimport authHelper from \"../../../util/authitems-helper\";\r\nimport { Option } from \"../EditEventAuthorization\";\r\n\r\ninterface EventTypeStatusEditorProps {\r\n  auth: AuthorizedItems;\r\n  editorValues: EditorValues;\r\n  update: React.Dispatch<EditorReducerAction>;\r\n  eventTypes: Option[];\r\n  eventStatuses: Option[];\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst EventTypeStatusEditor: React.FC<EventTypeStatusEditorProps> = ({\r\n  auth,\r\n  editorValues,\r\n  update,\r\n  eventTypes,\r\n  eventStatuses,\r\n}: EventTypeStatusEditorProps) => {\r\n  const [selectedEventTypeId, setSelectedEventTypeId] = useState(\r\n    EventType.Shift\r\n  );\r\n  const [selectedEventStatusId, setSelectedEventStatusId] = useState(\r\n    EventStatus.Approved\r\n  );\r\n  const [absentHoursPlaceholderText, setAbsentHoursPlaceholderText] = useState(\r\n    \"Ex: 00:00\"\r\n  );\r\n  const [locSettings, setLocSettings] = useState(\r\n    null as LocationSettings | null\r\n  );\r\n  const [absentTimeString, setAbsentTimeString] = useState(\r\n    null as string | null\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (editorValues.scheduleEventId === -1) {\r\n      return;\r\n    }\r\n    // If this is an employee and we're creating an event\r\n    if (\r\n      auth.role === Role.Employee &&\r\n      editorValues.scheduleEventId <= 0 &&\r\n      selectedEventStatusId !== EventStatus.Request\r\n    ) {\r\n      update({\r\n        type: \"TYPESTATUS-UPDATED\",\r\n        eventType: selectedEventTypeId,\r\n        eventStatus: EventStatus.Request,\r\n        absentId: editorValues.absentId,\r\n        absentTimeMinutes: editorValues.absentTimeMinutes,\r\n      });\r\n    }\r\n\r\n    if (editorValues.absentId) {\r\n      setSelectedEventTypeId(editorValues.absentId);\r\n    } else {\r\n      setSelectedEventTypeId(editorValues.eventType);\r\n    }\r\n\r\n    // setSelectedEventStatusId(eventStatuses[0].value);\r\n    setSelectedEventStatusId(editorValues.eventStatus);\r\n    // eslint-disable-next-line\r\n  }, [\r\n    auth,\r\n    editorValues.eventType,\r\n    editorValues.eventStatus,\r\n    editorValues.position,\r\n    editorValues.absentId,\r\n    editorValues.scheduleEventId,\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    if (editorValues.scheduleEventId === -1) {\r\n      return;\r\n    }\r\n\r\n    if (locSettings) {\r\n      setAbsentTimeString(\r\n        editorValues.absentTimeMinutes === null\r\n          ? null\r\n          : getTimeStringFromMinutes(\r\n              locSettings,\r\n              editorValues.absentTimeMinutes\r\n            )\r\n      );\r\n    }\r\n  }, [\r\n    locSettings,\r\n    editorValues.absentTimeMinutes,\r\n    editorValues.scheduleEventId,\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    if (editorValues.scheduleEventId === -1) {\r\n      return;\r\n    }\r\n\r\n    if (locSettings && editorValues.locationId === locSettings.LocationId) {\r\n      return;\r\n    }\r\n\r\n    if (!auth || !auth.locations || auth.locations.length === 0) {\r\n      return;\r\n    }\r\n\r\n    const newLocSettings = authHelper.getLocSettingsForLocationId(\r\n      auth,\r\n      editorValues.locationId\r\n    );\r\n    setLocSettings(newLocSettings);\r\n    setAbsentHoursPlaceholderText(\r\n      newLocSettings.TimeFormat === TimeFormat.HoursMinutes\r\n        ? \"Ex: 00:00\"\r\n        : \"Ex: 0.0\"\r\n    );\r\n    // eslint-disable-next-line\r\n  }, [editorValues.locationId, editorValues.scheduleEventId]);\r\n\r\n  useEffect(() => {\r\n    if (editorValues.scheduleEventId > 0) {\r\n      setSelectedEventStatusId(editorValues.eventStatus);\r\n    }\r\n  }, [editorValues.eventStatus, editorValues.scheduleEventId]);\r\n\r\n  const onEventTypeChange = (newEventType: EventType) => {\r\n    if (newEventType === editorValues.eventType) {\r\n      return;\r\n    }\r\n    setSelectedEventTypeId(newEventType);\r\n\r\n    const newAbsentMinutes =\r\n      newEventType !== EventType.Absent && newEventType < 100\r\n        ? null\r\n        : editorValues.absentTimeMinutes;\r\n\r\n    update({\r\n      type: \"TYPESTATUS-UPDATED\",\r\n      eventType: newEventType,\r\n      eventStatus: selectedEventStatusId,\r\n      absentId: newEventType >= 100 ? newEventType : undefined,\r\n      absentTimeMinutes: newAbsentMinutes,\r\n    });\r\n  };\r\n\r\n  const onEventStatusChange = (newEventStatus: EventStatus) => {\r\n    if (newEventStatus === editorValues.eventStatus) {\r\n      return;\r\n    }\r\n\r\n    setSelectedEventStatusId(newEventStatus);\r\n    update({\r\n      type: \"TYPESTATUS-UPDATED\",\r\n      eventType: selectedEventTypeId,\r\n      eventStatus: newEventStatus,\r\n      absentId: selectedEventTypeId >= 100 ? selectedEventTypeId : undefined,\r\n      absentTimeMinutes: editorValues.absentTimeMinutes,\r\n    });\r\n  };\r\n\r\n  const onAbsentTimeChange = (input?: string | null) => {\r\n    if (input === undefined) {\r\n      input = null;\r\n    }\r\n\r\n    if (input == null) {\r\n      update({\r\n        type: \"TYPESTATUS-UPDATED\",\r\n        eventType: selectedEventTypeId,\r\n        eventStatus: selectedEventStatusId,\r\n        absentId: selectedEventTypeId >= 100 ? selectedEventTypeId : undefined,\r\n        absentTimeMinutes: null,\r\n      });\r\n\r\n      return;\r\n    }\r\n\r\n    const min = getMinutesFromTimeString(locSettings!, input!);\r\n    if (min === editorValues.absentTimeMinutes) {\r\n      return;\r\n    }\r\n\r\n    update({\r\n      type: \"TYPESTATUS-UPDATED\",\r\n      eventType: selectedEventTypeId,\r\n      eventStatus: selectedEventStatusId,\r\n      absentId: selectedEventTypeId >= 100 ? selectedEventTypeId : undefined,\r\n      absentTimeMinutes: min,\r\n    });\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <IonRow className=\"edit-row\">\r\n        <IonCol size=\"3\">\r\n          <IonLabel className=\"label\">Type</IonLabel>\r\n        </IonCol>\r\n        <IonCol size=\"9\">\r\n          <IonSelect\r\n            className=\"select\"\r\n            interface=\"popover\"\r\n            disabled={editorValues.isReadonly}\r\n            value={selectedEventTypeId}\r\n            onIonChange={(e) => {\r\n              onEventTypeChange(e.detail.value);\r\n            }}\r\n          >\r\n            {eventTypes.map((et) => (\r\n              <IonSelectOption key={et.value} value={et.value}>\r\n                {et.text}\r\n              </IonSelectOption>\r\n            ))}\r\n          </IonSelect>\r\n        </IonCol>\r\n      </IonRow>\r\n\r\n      <IonRow className=\"edit-row\">\r\n        <IonCol size=\"3\">\r\n          <IonLabel className=\"label\">Status</IonLabel>\r\n        </IonCol>\r\n        <IonCol size=\"9\">\r\n          <IonSelect\r\n            className=\"select\"\r\n            interface=\"popover\"\r\n            disabled={\r\n              editorValues.isReadonly ||\r\n              (auth.role === Role.Employee && editorValues.scheduleEventId <= 0)\r\n            }\r\n            value={selectedEventStatusId}\r\n            onIonChange={(e) => {\r\n              onEventStatusChange(e.detail.value);\r\n            }}\r\n          >\r\n            {eventStatuses &&\r\n              eventStatuses.map((es) => (\r\n                <IonSelectOption key={es.value} value={es.value}>\r\n                  {es.text}\r\n                </IonSelectOption>\r\n              ))}\r\n          </IonSelect>\r\n        </IonCol>\r\n      </IonRow>\r\n\r\n      <IonRow\r\n        className={selectedEventTypeId > 100 ? \"visible edit-row\" : \"invisible\"}\r\n      >\r\n        <IonCol size=\"3\">\r\n          <IonLabel className=\"label\">Hours</IonLabel>\r\n        </IonCol>\r\n        <IonCol size=\"9\">\r\n          <IonInput\r\n            className=\"input-textbox\"\r\n            placeholder={absentHoursPlaceholderText}\r\n            disabled={editorValues.isReadonly}\r\n            value={absentTimeString}\r\n            onIonChange={(e) => {\r\n              if (e.detail.value) {\r\n                setAbsentTimeString(e.detail.value);\r\n              }\r\n            }}\r\n            onIonBlur={() => {\r\n              onAbsentTimeChange(absentTimeString);\r\n            }}\r\n          />\r\n        </IonCol>\r\n      </IonRow>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default EventTypeStatusEditor;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport {\r\n  IonLabel,\r\n  IonSelect,\r\n  IonRow,\r\n  IonCol,\r\n  IonSelectOption,\r\n} from \"@ionic/react\";\r\nimport \"../../../global-styles.scss\";\r\nimport \"./EventPositionEditor\";\r\nimport {\r\n  AuthorizedItems,\r\n  AuthorizedLocation,\r\n  AuthorizedPosition,\r\n} from \"../../../orbital-interfaces/authorized-items\";\r\nimport { EditorValues, EditorReducerAction } from \"../EditEventModalState\";\r\nimport authHelper from \"../../../util/authitems-helper\";\r\n\r\ninterface EventPositionEditorProps {\r\n  auth: AuthorizedItems;\r\n  editorValues: EditorValues;\r\n  update: React.Dispatch<EditorReducerAction>;\r\n}\r\n\r\ninterface Option {\r\n  id: number;\r\n  name: string;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst createPositionList = (loc: AuthorizedLocation[]): Option[] => {\r\n  const isMultiLoc = loc.length > 1;\r\n  return loc.flatMap((l) =>\r\n    l.departments.flatMap((d) =>\r\n      d.positions.map((p) => {\r\n        const isMultiDep = l.departments.length > 1;\r\n        let name = \"\";\r\n        if (isMultiLoc) {\r\n          name += (l.abbr ? l.abbr : l.name) + \"/\";\r\n        }\r\n\r\n        if (isMultiDep) {\r\n          name += (d.abbr ? d.abbr : d.name) + \"/\";\r\n        }\r\n\r\n        name += p.name;\r\n        return { id: p.id, name: name };\r\n      })\r\n    )\r\n  );\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst EventPositionEditor: React.FC<EventPositionEditorProps> = ({\r\n  auth,\r\n  editorValues,\r\n  update,\r\n}: EventPositionEditorProps) => {\r\n  const [selectedPosition, setSelectedPosition] = useState({\r\n    location: {} as AuthorizedLocation,\r\n    position: {} as AuthorizedPosition,\r\n  });\r\n  const [positionList, setPositionList] = useState([] as Option[]);\r\n\r\n  useEffect(() => {\r\n    if (editorValues.scheduleEventId === -1) {\r\n      return;\r\n    }\r\n\r\n    if (auth && auth.locations && auth.locations.length > 0) {\r\n      if (editorValues.position && editorValues.scheduleEventId > 0) {\r\n        const selPos = authHelper.getSelectedPositionWithLocId(\r\n          auth.locations,\r\n          editorValues.position.location.id,\r\n          editorValues.position.position.id\r\n        );\r\n        if (selPos.position.id !== selectedPosition.position.id) {\r\n          setSelectedPosition(selPos);\r\n        }\r\n      } else {\r\n        const selPos = authHelper.getSelectedPositionWithLocId(\r\n          auth.locations,\r\n          auth.locations[0].id,\r\n          auth.locations[0].departments[0].positions[0].id\r\n        );\r\n        setSelectedPosition(selPos);\r\n      }\r\n    }\r\n    // eslint-disable-next-line\r\n  }, [editorValues.position, auth, editorValues.scheduleEventId]);\r\n\r\n  useEffect(() => {\r\n    if (editorValues.scheduleEventId === -1) {\r\n      return;\r\n    }\r\n\r\n    if (auth && auth.locations && auth.locations.length > 0) {\r\n      setPositionList(createPositionList(auth.locations));\r\n    }\r\n  }, [auth, editorValues.scheduleEventId]);\r\n\r\n  const updatePosition = (posId: number) => {\r\n    const selected = authHelper.getSelectedPosition(auth.locations, posId);\r\n    if (selected.position.id === editorValues.position.position.id) {\r\n      return;\r\n    }\r\n\r\n    setSelectedPosition(selected);\r\n    update({ type: \"POSITION-UPDATED\", selectedPosition: selected });\r\n  };\r\n\r\n  return (\r\n    <IonRow className=\"edit-row\">\r\n      <IonCol size=\"3\">\r\n        <IonLabel className=\"label\">Position</IonLabel>\r\n      </IonCol>\r\n      <IonCol size=\"9\">\r\n        <IonSelect\r\n          className=\"select\"\r\n          interface=\"popover\"\r\n          disabled={editorValues.isReadonly}\r\n          value={selectedPosition.position.id}\r\n          onIonChange={(e) => updatePosition(e.detail.value)}\r\n        >\r\n          {positionList.map((p) => (\r\n            <IonSelectOption key={p.id} value={p.id}>\r\n              {p.name}\r\n            </IonSelectOption>\r\n          ))}\r\n        </IonSelect>\r\n      </IonCol>\r\n    </IonRow>\r\n  );\r\n};\r\n\r\nexport default EventPositionEditor;\r\n","import { EmployeeSort } from \"../orbital-interfaces/authorized-items\";\r\nimport { ApplicationUser } from \"../context/ApplicationUserContext\";\r\nimport { formatDateTimeAsMvcString } from \"../util/time-helper\";\r\nimport apiHelper from \"./OrbitalApiHelper\";\r\nimport { IdName } from \"../components/EditEvent/EditEventModalState\";\r\n\r\nexport interface EmployeeCommunication {\r\n  id: number;\r\n  name: string;\r\n  hasEmail: boolean;\r\n  hasText: boolean;\r\n  hasPush: boolean;\r\n  isChecked: boolean;\r\n}\r\n\r\n// -----------------------------------------------------------------------------\r\nconst getEmployeesByLocationIdPositionIdAndActiveDateRange = async (\r\n  user: ApplicationUser,\r\n  locId: number,\r\n  posId: number,\r\n  start: Date,\r\n  end: Date,\r\n  sort: EmployeeSort\r\n) => {\r\n  const data = {\r\n    locId,\r\n    posId,\r\n    start: formatDateTimeAsMvcString(start),\r\n    end: formatDateTimeAsMvcString(end),\r\n    sort,\r\n  };\r\n\r\n  return (await apiHelper.post(\r\n    user,\r\n    \"api/v2/employees/at-position\",\r\n    data\r\n  )) as IdName[];\r\n};\r\n\r\n// -----------------------------------------------------------------------------\r\nconst getEmployeeListForCommunication = async (\r\n  user: ApplicationUser,\r\n  locId: number,\r\n  depId: number,\r\n  posId: number,\r\n  channel: number,\r\n  role: string\r\n) => {\r\n  return (await apiHelper.post(\r\n    user,\r\n    \"api/v2/employees/get-communication-list\",\r\n    {\r\n      locId,\r\n      depId,\r\n      posId,\r\n      channel,\r\n      role,\r\n    }\r\n  )) as EmployeeCommunication[];\r\n};\r\n\r\nexport default {\r\n  getEmployeesByLocationIdPositionIdAndActiveDateRange,\r\n  getEmployeeListForCommunication,\r\n};\r\n","import { IonLoading } from \"@ionic/react\";\r\nimport React, { useState } from \"react\";\r\n\r\nexport function useShowLoading(message: string) {\r\n  const [showLoading, setShowLoading] = useState(false);\r\n  const showLoadingJsx = (\r\n    <IonLoading\r\n      isOpen={showLoading}\r\n      onDidDismiss={() => setShowLoading(false)}\r\n      spinner=\"dots\"\r\n      message={message}\r\n      duration={10000}\r\n    />\r\n  );\r\n\r\n  return {\r\n    showLoading,\r\n    setShowLoading,\r\n    showLoadingJsx,\r\n  };\r\n}\r\n","import React, { useState, useContext, useEffect } from \"react\";\r\nimport {\r\n  IonLabel,\r\n  IonSelect,\r\n  IonRow,\r\n  IonCol,\r\n  IonSelectOption,\r\n} from \"@ionic/react\";\r\nimport \"../../../global-styles.scss\";\r\nimport \"./EventEmployeeEditor\";\r\nimport { AuthorizedItems } from \"../../../orbital-interfaces/authorized-items\";\r\nimport employeeAPI from \"../../../api/EmployeesAPI\";\r\nimport { ApplicationUserContext } from \"../../../context/ApplicationUserContext\";\r\nimport { parseISO } from \"date-fns\";\r\nimport {\r\n  EditorValues,\r\n  EditorReducerAction,\r\n  IdName,\r\n} from \"../EditEventModalState\";\r\nimport { useShowLoading } from \"../../../hooks/useShowLoading\";\r\n\r\ninterface EventEmployeeEditorProps {\r\n  auth: AuthorizedItems;\r\n  editorValues: EditorValues;\r\n  update: React.Dispatch<EditorReducerAction>;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst EventEmployeeEditor: React.FC<EventEmployeeEditorProps> = ({\r\n  auth,\r\n  editorValues,\r\n  update,\r\n}: EventEmployeeEditorProps) => {\r\n  const [employeeList, setEmployeeList] = useState([] as IdName[]);\r\n  const loading = useShowLoading(\"Please wait...\");\r\n  const [selectedEmployeeId, setSelectedEmployeeId] = useState(-1);\r\n  const { user } = useContext(ApplicationUserContext);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    // eslint-disable-next-line\r\n    if (user && user.isLoggedin && editorValues.scheduleEventId !== -1) {\r\n      loading.setShowLoading(true);\r\n      getEmployees(editorValues);\r\n    }\r\n    // eslint-disable-next-line\r\n  }, [user, editorValues.position.position.id, editorValues.scheduleEventId]);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onChange = (employeeId: number) => {\r\n    if (employeeId === -5 || employeeId === editorValues.employee.id) {\r\n      return;\r\n    }\r\n\r\n    setSelectedEmployeeId(employeeId);\r\n    const emp = employeeList.filter((e) => e.id === employeeId)[0];\r\n    if (employeeId === -1) {\r\n      update({\r\n        type: \"EMPLOYEE-UPDATED\",\r\n        employee: { id: -1, name: \"SELECT EMPLOYEE\" },\r\n      });\r\n    } else {\r\n      update({\r\n        type: \"EMPLOYEE-UPDATED\",\r\n        employee: { id: employeeId, name: emp.name },\r\n      });\r\n    }\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const getEmployees = (ev: EditorValues) => {\r\n    employeeAPI\r\n      .getEmployeesByLocationIdPositionIdAndActiveDateRange(\r\n        user,\r\n        editorValues.position.location.id,\r\n        editorValues.position.position.id,\r\n        parseISO(editorValues.eventStart),\r\n        parseISO(editorValues.eventEnd),\r\n        editorValues.position.location.settings.EmployeeSort\r\n      )\r\n      .then((employees) => {\r\n        setEmployeeList(employees);\r\n        const empIds = employees.map((e) => e.id);\r\n\r\n        if (\r\n          editorValues.scheduleEventId === 0 &&\r\n          empIds.includes(auth.employeeId)\r\n        ) {\r\n          setSelectedEmployeeId(auth.employeeId);\r\n          const thisEmp = employees.filter((e) => e.id === auth.employeeId)[0];\r\n          update({\r\n            type: \"EMPLOYEE-UPDATED\",\r\n            employee: { id: thisEmp.id, name: thisEmp.name },\r\n          });\r\n        } else {\r\n          const newSelectedEmployeeId = empIds.includes(ev.employee.id)\r\n            ? ev.employee.id\r\n            : -1;\r\n\r\n          setSelectedEmployeeId(newSelectedEmployeeId);\r\n        }\r\n\r\n        loading.setShowLoading(false);\r\n      });\r\n  };\r\n\r\n  if (employeeList.length === 0) {\r\n    return (\r\n      <>\r\n        <IonRow className=\"edit-row\">\r\n          <IonCol size=\"3\">\r\n            <IonLabel className=\"label\">Employee</IonLabel>\r\n          </IonCol>\r\n          <IonCol size=\"9\">\r\n            <IonSelect className=\"select\" interface=\"popover\" value={-5}>\r\n              <IonSelectOption key=\"-5\" value=\"-5\">\r\n                {editorValues.employee.name}\r\n              </IonSelectOption>\r\n            </IonSelect>\r\n          </IonCol>\r\n        </IonRow>\r\n        {loading.showLoadingJsx}\r\n      </>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <IonRow className=\"edit-row\">\r\n        <IonCol size=\"3\">\r\n          <IonLabel className=\"label\">Employee</IonLabel>\r\n        </IonCol>\r\n        <IonCol size=\"9\">\r\n          <IonSelect\r\n            className=\"select\"\r\n            interface=\"popover\"\r\n            disabled={editorValues.isReadonly}\r\n            value={selectedEmployeeId}\r\n            onIonChange={(e) => {\r\n              onChange(e.detail.value);\r\n            }}\r\n          >\r\n            <IonSelectOption key={-1} value={-1}>\r\n              Select Employee\r\n            </IonSelectOption>\r\n            {employeeList.map((emp) => (\r\n              <IonSelectOption key={emp.id} value={emp.id}>\r\n                {emp.name}\r\n              </IonSelectOption>\r\n            ))}\r\n          </IonSelect>\r\n        </IonCol>\r\n      </IonRow>\r\n      {loading.showLoadingJsx}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default EventEmployeeEditor;\r\n","export enum RecurrenceType {\r\n  Daily = 0,\r\n  Weekly = 1,\r\n  MonthlyByDayOfMonth = 2,\r\n  MonthlyByDayOfWeek = 3,\r\n  Yearly = 4,\r\n}\r\n","import React from \"react\";\r\nimport { IonLabel, IonRow, IonCol, IonDatetime } from \"@ionic/react\";\r\nimport \"../../../global-styles.scss\";\r\nimport \"./EventStartEndEditor\";\r\nimport { AuthorizedItems } from \"../../../orbital-interfaces/authorized-items\";\r\nimport { parseISO } from \"date-fns\";\r\nimport { EditorValues, EditorReducerAction } from \"../EditEventModalState\";\r\n\r\ninterface EventStartEndEditorProps {\r\n  auth: AuthorizedItems;\r\n  editorValues: EditorValues;\r\n  update: React.Dispatch<EditorReducerAction>;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst EventStartEndEditor: React.FC<EventStartEndEditorProps> = ({\r\n  editorValues,\r\n  update,\r\n}: EventStartEndEditorProps) => {\r\n  const onStartChange = (newEventStart?: string | null) => {\r\n    if (!newEventStart) {\r\n      return;\r\n    }\r\n\r\n    if (parseISO(newEventStart) === parseISO(editorValues.eventStart)) {\r\n      return;\r\n    }\r\n\r\n    update({\r\n      type: \"START-UPDATED\",\r\n      eventStart: newEventStart,\r\n    });\r\n  };\r\n\r\n  const onEndChange = (newEventEnd?: string | null) => {\r\n    if (!newEventEnd) {\r\n      return;\r\n    }\r\n\r\n    if (parseISO(newEventEnd) === parseISO(editorValues.eventEnd)) {\r\n      return;\r\n    }\r\n\r\n    update({\r\n      type: \"END-UPDATED\",\r\n      eventEnd: newEventEnd,\r\n    });\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <IonRow className=\"edit-row\">\r\n        <IonCol size=\"3\">\r\n          <IonLabel className=\"label\">Start</IonLabel>\r\n        </IonCol>\r\n        <IonCol size=\"9\">\r\n          <IonDatetime\r\n            className=\"select\"\r\n            displayFormat=\"M/D/YY h:mma\"\r\n            disabled={editorValues.isReadonly}\r\n            pickerFormat=\"MMM DD YYYY h:mm A\"\r\n            min=\"2005-01-01\"\r\n            max=\"2030-01-01\"\r\n            minuteValues=\"0,5,10,15,20,25,30,35,40,45,50,55\"\r\n            value={editorValues.eventStart}\r\n            onIonChange={(e) => {\r\n              onStartChange(e.detail.value);\r\n            }}\r\n          />\r\n        </IonCol>\r\n      </IonRow>\r\n\r\n      <IonRow className=\"edit-row\">\r\n        <IonCol size=\"3\">\r\n          <IonLabel className=\"label\">End</IonLabel>\r\n        </IonCol>\r\n        <IonCol size=\"9\">\r\n          <IonDatetime\r\n            className=\"select\"\r\n            displayFormat=\"M/D/YY h:mma\"\r\n            disabled={editorValues.isReadonly || editorValues.isClockedIn}\r\n            pickerFormat=\"MMM DD YYYY h:mm A\"\r\n            min=\"2005-01-01\"\r\n            max=\"2030-01-01\"\r\n            minuteValues=\"0,5,10,15,20,25,30,35,40,45,50,55\"\r\n            value={editorValues.eventEnd}\r\n            onIonChange={(e) => {\r\n              onEndChange(e.detail.value);\r\n            }}\r\n          />\r\n        </IonCol>\r\n      </IonRow>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default EventStartEndEditor;\r\n","import React, { useState } from \"react\";\r\nimport {\r\n  IonCheckbox,\r\n  IonDatetime,\r\n  IonContent,\r\n  IonRow,\r\n  IonCol,\r\n  IonButton,\r\n  IonFooter,\r\n  IonGrid,\r\n  IonHeader,\r\n  IonTitle,\r\n  IonToolbar,\r\n} from \"@ionic/react\";\r\n// import \"./AddBreakModal.scss\";\r\nimport \"../../../global-styles.scss\";\r\nimport {\r\n  setHours,\r\n  setMinutes,\r\n  parseISO,\r\n  isAfter,\r\n  isBefore,\r\n  addMinutes,\r\n} from \"date-fns\";\r\nimport useDialogBox from \"../../../hooks/useDialogBox\";\r\nimport { EventBreak } from \"../../../orbital-interfaces/EventBreak\";\r\n\r\ninterface AddBreakModalProps {\r\n  onCancel: () => void;\r\n  onAdd: (\r\n    startDate: Date,\r\n    endDate: Date,\r\n    isRestricted: boolean,\r\n    isPaid: boolean\r\n  ) => void;\r\n  currentBreaks: EventBreak[];\r\n  eventStart: string;\r\n  eventEnd: string;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst hasOverlap = (start: Date, end: Date, breaks: EventBreak[]) => {\r\n  const startA = start;\r\n  const endA = end;\r\n  let found = false;\r\n  breaks.map((brk) => {\r\n    const startB = addMinutes(parseISO(brk.BreakStart), 3);\r\n    const endB = brk.BreakEnd\r\n      ? addMinutes(parseISO(brk.BreakEnd!), -3)\r\n      : new Date(2200, 1, 1);\r\n    if (startA < endB && endA > startB) {\r\n      found = true;\r\n    }\r\n\r\n    return found;\r\n  });\r\n  return found;\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst AddBreakModal: React.FC<AddBreakModalProps> = ({\r\n  onCancel,\r\n  onAdd,\r\n  currentBreaks,\r\n  eventStart,\r\n  eventEnd,\r\n}: AddBreakModalProps) => {\r\n  const [startDate, setStartDate] = useState(\r\n    setMinutes(setHours(new Date(), 12), 0)\r\n  );\r\n  const [endDate, setEndDate] = useState(\r\n    setMinutes(setHours(new Date(), 13), 0)\r\n  );\r\n  const [isRestricted, setIsRestricted] = useState(false);\r\n  const [isPaid, setIsPaid] = useState(false);\r\n  const [errorMessage, setErrorMessage] = useState(\"\");\r\n  const [isValid, setIsValid] = useState(true);\r\n  const alert = useDialogBox();\r\n\r\n  const onAddClick = () => {\r\n    if (startDate > endDate) {\r\n      alert.showAlert(\r\n        \"Invalid Start / End\",\r\n        \"Break Start cannot come after Break End.\",\r\n        () => { }\r\n      );\r\n    } else {\r\n      onAdd(startDate, endDate, isRestricted, isPaid);\r\n    }\r\n  };\r\n\r\n  const onStartUpdate = (newStart: string) => {\r\n    const newStartDate = parseISO(newStart);\r\n    setStartDate(newStartDate);\r\n    if (!isBefore(newStartDate, endDate)) {\r\n      setIsValid(false);\r\n      setErrorMessage(\"Start must be before End\");\r\n    } else if (parseISO(eventStart) > newStartDate) {\r\n      setIsValid(false);\r\n      setErrorMessage(\"Start before Event begins\");\r\n    } else if (hasOverlap(newStartDate, endDate, currentBreaks)) {\r\n      setIsValid(false);\r\n      setErrorMessage(\"Pre-existing break overlaps\");\r\n    } else {\r\n      setIsValid(true);\r\n      setErrorMessage(\"\");\r\n    }\r\n  };\r\n\r\n  const onEndUpdate = (newEnd: string) => {\r\n    const newEndDate = parseISO(newEnd);\r\n    setEndDate(newEndDate);\r\n\r\n    if (!isAfter(newEndDate, startDate)) {\r\n      setIsValid(false);\r\n      setErrorMessage(\"End must be after Start\");\r\n    } else if (newEndDate > parseISO(eventEnd)) {\r\n      setIsValid(false);\r\n      setErrorMessage(\"End after Event ends\");\r\n    } else if (hasOverlap(startDate, newEndDate, currentBreaks)) {\r\n      setIsValid(false);\r\n      setErrorMessage(\"Pre-existing break overlaps\");\r\n    } else {\r\n      setIsValid(true);\r\n      setErrorMessage(\"\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n\r\n      <IonHeader mode=\"ios\">\r\n        <IonToolbar>\r\n          <IonTitle>Add Break</IonTitle>\r\n        </IonToolbar>\r\n      </IonHeader>\r\n      <IonContent>\r\n        <IonGrid>\r\n          <IonRow>\r\n            <IonCol className=\"label\" size=\"3\">\r\n              Start\r\n            </IonCol>\r\n            <IonCol size=\"9\">\r\n              <IonDatetime\r\n                className=\"select\"\r\n                displayFormat=\"h:mm a\"\r\n                pickerFormat=\"h:mm A\"\r\n                min=\"2005-01-01\"\r\n                max=\"2030-01-01\"\r\n                minuteValues=\"0,5,10,15,20,25,30,35,40,45,50,55\"\r\n                value={startDate.toISOString()}\r\n                onIonChange={(e) => onStartUpdate(e.detail.value!)}\r\n              />\r\n            </IonCol>\r\n          </IonRow>\r\n          <IonRow>\r\n            <IonCol className=\"label\" size=\"3\">\r\n              End\r\n            </IonCol>\r\n            <IonCol size=\"9\">\r\n              <IonDatetime\r\n                className=\"select\"\r\n                displayFormat=\"h:mm a\"\r\n                pickerFormat=\"h:mm A\"\r\n                min=\"2005-01-01\"\r\n                max=\"2030-01-01\"\r\n                minuteValues=\"0,5,10,15,20,25,30,35,40,45,50,55\"\r\n                value={endDate.toISOString()}\r\n                onIonChange={(e) => onEndUpdate(e.detail.value!)}\r\n              />\r\n            </IonCol>\r\n          </IonRow>\r\n\r\n          <IonRow>\r\n            <IonCol size=\"3\">\r\n              <IonCheckbox\r\n                className=\"checkbox\"\r\n                checked={isRestricted}\r\n                onIonChange={(e) => {\r\n                  setIsRestricted(e.detail.checked);\r\n                }}\r\n              />\r\n            </IonCol>\r\n            <IonCol className=\"label\" size=\"9\">\r\n              Restricted Break\r\n            </IonCol>\r\n          </IonRow>\r\n\r\n          <IonRow>\r\n            <IonCol size=\"3\">\r\n              <IonCheckbox\r\n                className=\"checkbox\"\r\n                onIonChange={(e) => {\r\n                  setIsPaid(e.detail.checked);\r\n                }}\r\n              />\r\n            </IonCol>\r\n            <IonCol className=\"label\" size=\"9\">\r\n              Paid Break\r\n            </IonCol>\r\n          </IonRow>\r\n\r\n          <IonRow>\r\n            <IonCol size=\"12\" className=\"error-message\">\r\n              {errorMessage}\r\n            </IonCol>\r\n          </IonRow>\r\n\r\n        </IonGrid>\r\n      </IonContent>\r\n      <IonFooter>\r\n        <IonButton\r\n          expand=\"block\"\r\n          color=\"secondary\"\r\n          onClick={onAddClick}\r\n          disabled={!isValid}\r\n        >\r\n          ADD\r\n        </IonButton>\r\n\r\n        <IonButton expand=\"block\" onClick={onCancel}>\r\n          CANCEL\r\n        </IonButton>\r\n      </IonFooter>\r\n      {alert.alertBoxJsx}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default AddBreakModal;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport { IonModal, IonRow, IonCol, IonButton, IonIcon, IonLabel, } from \"@ionic/react\";\r\n// import \"./EventBreakEditor.scss\";\r\nimport \"../../../global-styles.scss\";\r\nimport { add, trash, lockClosed, logoUsd } from \"ionicons/icons\";\r\nimport { AuthorizedItems } from \"../../../orbital-interfaces/authorized-items\";\r\nimport { EventBreak } from \"../../../orbital-interfaces/EventBreak\";\r\nimport {\r\n  getBreakStartEnd,\r\n  formatDateTimeAsMvcString,\r\n} from \"../../../util/time-helper\";\r\nimport AddBreakModal from \"./AddBreakModal\";\r\nimport { EditorValues, EditorReducerAction } from \"../EditEventModalState\";\r\nimport EventType from \"../../../enums/EventType\";\r\nimport authHelper from \"../../../util/authitems-helper\";\r\n\r\ninterface EventBreakEditorProps {\r\n  auth: AuthorizedItems;\r\n  editorValues: EditorValues;\r\n  update: React.Dispatch<EditorReducerAction>;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst EventBreakEditor: React.FC<EventBreakEditorProps> = ({\r\n  editorValues,\r\n  update,\r\n}: EventBreakEditorProps) => {\r\n  const [breakList, setBreakList] = useState([] as EventBreak[]);\r\n  const [showBreakModal, setShowBreakModal] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (editorValues.scheduleEventId === -1) {\r\n      return;\r\n    }\r\n\r\n    setBreakList(editorValues.eventBreaks);\r\n  }, [editorValues.eventBreaks, editorValues.scheduleEventId]);\r\n\r\n  const showRestricted = (b: EventBreak) => {\r\n    return b.IsRestricted ? (\r\n      <IonIcon className=\"restricted-icon\" icon={lockClosed} />\r\n    ) : (\r\n        <span />\r\n      );\r\n  };\r\n\r\n  const showPaid = (b: EventBreak) => {\r\n    return b.IsPaidBreak ? (\r\n      <IonIcon className=\"paid-icon\" icon={logoUsd} />\r\n    ) : (\r\n        <span />\r\n      );\r\n  };\r\n\r\n  const onAddBreakModalCancel = () => {\r\n    setShowBreakModal(false);\r\n  };\r\n\r\n  const onAddBreakModalApply = (\r\n    startDate: Date,\r\n    endDate: Date,\r\n    isRestricted: boolean,\r\n    isPaid: boolean\r\n  ) => {\r\n    setShowBreakModal(false);\r\n    const brk: EventBreak = {\r\n      BreakStart: formatDateTimeAsMvcString(startDate),\r\n      BreakEnd: formatDateTimeAsMvcString(endDate),\r\n      IsRestricted: isRestricted,\r\n      IsPaidBreak: isPaid,\r\n      ScheduleEventId: editorValues.scheduleEventId,\r\n    };\r\n\r\n    const newBreakList = [...breakList, brk];\r\n    setBreakList(newBreakList);\r\n    update({ type: \"EVENTBREAKS-UPDATED\", breaks: newBreakList });\r\n  };\r\n\r\n  const onDeleteBreak = (breakStart: string) => {\r\n    const newBreakList = breakList.filter((b) => b.BreakStart !== breakStart);\r\n    setBreakList(newBreakList);\r\n    update({ type: \"EVENTBREAKS-UPDATED\", breaks: newBreakList });\r\n  };\r\n\r\n  if (\r\n    editorValues.eventType !== EventType.Clock &&\r\n    !authHelper.isShiftTypeEvent(\r\n      editorValues.eventType,\r\n      editorValues.eventStatus\r\n    )\r\n  ) {\r\n    return <div />;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <IonRow className=\"edit-row\">\r\n        <IonCol size=\"3\">\r\n          <IonLabel className=\"label\">(B)reaks</IonLabel>\r\n        </IonCol>\r\n\r\n        <IonCol size=\"2\">\r\n          <IonButton\r\n            size=\"small\"\r\n            color=\"light\"\r\n            disabled={editorValues.isReadonly}\r\n            onClick={() => {\r\n              setShowBreakModal(true);\r\n            }}\r\n          >\r\n            <IonIcon slot=\"icon-only\" icon={add} color=\"dark\" />\r\n          </IonButton>\r\n        </IonCol>\r\n      </IonRow>\r\n\r\n      <IonRow>\r\n        <IonCol size=\"3\">\r\n        </IonCol>\r\n        <IonCol size=\"9\">\r\n          {/* {(!breakList || breakList.length === 0) && (\r\n            <div className=\"break-div\">(B) NONE</div>\r\n          )} */}\r\n\r\n          {breakList &&\r\n            breakList.map((brk) => (\r\n              <div key={brk.BreakStart} className=\"break-div\">\r\n                (B) {getBreakStartEnd(brk)}\r\n                {showPaid(brk)}\r\n                {showRestricted(brk)}\r\n                <button\r\n                  disabled={editorValues.isReadonly}\r\n                  onClick={() => {\r\n                    onDeleteBreak(brk.BreakStart);\r\n                  }}\r\n                >\r\n                  <IonIcon\r\n                    slot=\"icon-only\"\r\n                    mode=\"ios\"\r\n                    icon={trash}\r\n                    color=\"gray\"\r\n                  />\r\n                </button>\r\n              </div>\r\n            ))}\r\n        </IonCol>\r\n      </IonRow>\r\n\r\n      <IonRow>\r\n        <IonCol size=\"12\">\r\n          <div style={{ borderBottom: \"1px solid #ddd\", width: \"100%\" }} />\r\n        </IonCol>\r\n      </IonRow>\r\n\r\n      <IonModal\r\n        isOpen={showBreakModal}\r\n        cssClass=\"add-break-modal\"\r\n        onDidDismiss={() => setShowBreakModal(false)}\r\n      >\r\n        <AddBreakModal\r\n          onCancel={onAddBreakModalCancel}\r\n          onAdd={onAddBreakModalApply}\r\n          currentBreaks={breakList}\r\n          eventStart={editorValues.eventStart}\r\n          eventEnd={editorValues.eventEnd}\r\n        />\r\n      </IonModal>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default EventBreakEditor;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport {\r\n  IonLabel,\r\n  IonSelect,\r\n  IonRow,\r\n  IonCol,\r\n  IonSelectOption,\r\n} from \"@ionic/react\";\r\nimport \"../../../global-styles.scss\";\r\nimport \"./EventTagEditor\";\r\nimport { AuthorizedItems } from \"../../../orbital-interfaces/authorized-items\";\r\nimport { EditorValues, EditorReducerAction } from \"../EditEventModalState\";\r\n\r\ninterface EventTagEditorProps {\r\n  auth: AuthorizedItems;\r\n  editorValues: EditorValues;\r\n  update: React.Dispatch<EditorReducerAction>;\r\n}\r\n\r\ninterface TagList {\r\n  id: number;\r\n  name: string;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst EventTagEditor: React.FC<EventTagEditorProps> = ({\r\n  auth,\r\n  editorValues,\r\n  update,\r\n}: EventTagEditorProps) => {\r\n  const [selectedTagId, setSelectedTagId] = useState(-1);\r\n  const [tagList, setTagList] = useState([] as TagList[]);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (editorValues.scheduleEventId === -1) {\r\n      return;\r\n    }\r\n\r\n    if (auth && auth.locations && auth.locations.length > 0) {\r\n      const tags = auth.tags\r\n        .filter((t) =>\r\n          t.positionIds.includes(editorValues.position.position.id)\r\n        )\r\n        .map((t) => {\r\n          return { id: t.id, name: t.name };\r\n        });\r\n      setTagList(tags);\r\n\r\n      const tagIds = tags.map((t) => t.id);\r\n      if (!tagIds.includes(selectedTagId)) {\r\n        if (\r\n          editorValues.tag &&\r\n          editorValues.tag.id &&\r\n          tagIds.includes(editorValues.tag.id)\r\n        ) {\r\n          setSelectedTagId(editorValues.tag.id);\r\n        } else {\r\n          setSelectedTagId(-1);\r\n        }\r\n      }\r\n    }\r\n\r\n    // eslint-disable-next-line\r\n  }, [auth, editorValues.position, editorValues.scheduleEventId]);\r\n\r\n  const onUpdateTag = (tagId: number) => {\r\n    setSelectedTagId(tagId);\r\n\r\n    if (tagId === editorValues.tag.id) {\r\n      return;\r\n    }\r\n\r\n    if (tagId === -1) {\r\n      update({ type: \"TAG-UPDATED\", tag: { id: -1, name: \"NONE\" } });\r\n    } else {\r\n      const tag = tagList.filter((t) => t.id === tagId)[0];\r\n      update({ type: \"TAG-UPDATED\", tag });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <IonRow className=\"edit-row\">\r\n      <IonCol size=\"3\">\r\n        <IonLabel className=\"label\">~Tag</IonLabel>\r\n      </IonCol>\r\n      <IonCol size=\"9\">\r\n        <IonSelect\r\n          className=\"select\"\r\n          interface=\"popover\"\r\n          disabled={editorValues.isReadonly}\r\n          value={selectedTagId}\r\n          onIonChange={(e) => {\r\n            onUpdateTag(e.detail.value);\r\n          }}\r\n        >\r\n          <IonSelectOption value={-1}>NONE</IonSelectOption>\r\n\r\n          {tagList.map((tag) => (\r\n            <IonSelectOption key={tag.id} value={tag.id}>\r\n              {tag.name}\r\n            </IonSelectOption>\r\n          ))}\r\n        </IonSelect>\r\n      </IonCol>\r\n    </IonRow>\r\n  );\r\n};\r\n\r\nexport default EventTagEditor;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { IonLabel, IonCheckbox, IonCol, IonIcon } from \"@ionic/react\";\r\nimport \"./EventStartEndEditor\";\r\nimport { AuthorizedItems } from \"../../../orbital-interfaces/authorized-items\";\r\nimport { EditorValues, EditorReducerAction } from \"../EditEventModalState\";\r\nimport EventType from \"../../../enums/EventType\";\r\nimport EventStatus from \"../../../enums/EventStatus\";\r\nimport { checkmark } from \"ionicons/icons\";\r\n\r\ninterface EventConfirmEditorProps {\r\n  auth: AuthorizedItems;\r\n  editorValues: EditorValues;\r\n  update: React.Dispatch<EditorReducerAction>;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst EventConfirmEditor: React.FC<EventConfirmEditorProps> = ({\r\n  auth,\r\n  editorValues,\r\n  update,\r\n}: EventConfirmEditorProps) => {\r\n  const [isConfirmed, setIsConfirmed] = useState(false);\r\n  const [showConfirmed, setShowConfirmed] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (editorValues.scheduleEventId === -1) {\r\n      return;\r\n    }\r\n\r\n    if (auth && auth.locations && auth.locations.length > 0) {\r\n      setIsConfirmed(editorValues.isConfirmed);\r\n    }\r\n\r\n    // eslint-disable-next-line\r\n  }, [\r\n    auth,\r\n    editorValues.eventStart,\r\n    editorValues.eventEnd,\r\n    editorValues.isClockedIn,\r\n    editorValues.scheduleEventId,\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    if (editorValues.scheduleEventId === -1) {\r\n      return;\r\n    }\r\n\r\n    const isConfirmable =\r\n      (editorValues.eventType === EventType.Shift &&\r\n        editorValues.eventStatus === EventStatus.Approved) ||\r\n      (editorValues.eventType === EventType.Cover &&\r\n        (editorValues.eventStatus === EventStatus.Request ||\r\n          editorValues.eventStatus === EventStatus.RequestDenied));\r\n    setShowConfirmed(isConfirmable);\r\n  }, [\r\n    editorValues.eventType,\r\n    editorValues.eventStatus,\r\n    editorValues.scheduleEventId,\r\n  ]);\r\n\r\n  const onCheckChange = (checked: boolean) => {\r\n    if (checked === isConfirmed || !showConfirmed) {\r\n      return;\r\n    }\r\n\r\n    setIsConfirmed(checked);\r\n    update({\r\n      type: \"CONFIRM-UPDATED\",\r\n      isConfirmed: checked,\r\n    });\r\n  };\r\n\r\n  if (!showConfirmed) {\r\n    return (\r\n      <>\r\n        {/* <IonCol size=\"0\">\r\n          <span />\r\n        </IonCol>\r\n        <IonCol size=\"0\">\r\n          <span />\r\n        </IonCol> */}\r\n      </>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <IonCol size=\"3\">\r\n        <IonLabel className=\"label\">\r\n          <IonIcon icon={checkmark} />\r\n          Confirm</IonLabel>\r\n      </IonCol>\r\n\r\n      <IonCol size=\"2\">\r\n        <IonCheckbox\r\n          checked={isConfirmed}\r\n          onIonChange={(e) => {\r\n            onCheckChange(e.detail.checked);\r\n          }}\r\n        />\r\n      </IonCol>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default EventConfirmEditor;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { IonLabel, IonCheckbox, IonCol, IonIcon } from \"@ionic/react\";\r\nimport \"./EventStartEndEditor\";\r\nimport { AuthorizedItems } from \"../../../orbital-interfaces/authorized-items\";\r\nimport { EditorValues, EditorReducerAction } from \"../EditEventModalState\";\r\nimport EventType from \"../../../enums/EventType\";\r\nimport { time } from \"ionicons/icons\";\r\n\r\ninterface EventIsClockedInEditorProps {\r\n  auth: AuthorizedItems;\r\n  editorValues: EditorValues;\r\n  update: React.Dispatch<EditorReducerAction>;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst EventIsClockedInEditor: React.FC<EventIsClockedInEditorProps> = ({\r\n  auth,\r\n  editorValues,\r\n  update,\r\n}: EventIsClockedInEditorProps) => {\r\n  const [isClockedIn, setIsClockedIn] = useState(false);\r\n  const [showIsClockedIn, setShowIsClockedIn] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (editorValues.scheduleEventId === -1) {\r\n      return;\r\n    }\r\n\r\n    if (auth && auth.locations && auth.locations.length > 0) {\r\n      setIsClockedIn(editorValues.isClockedIn);\r\n    }\r\n\r\n    // eslint-disable-next-line\r\n  }, [\r\n    auth,\r\n    editorValues.eventStart,\r\n    editorValues.eventEnd,\r\n    editorValues.isClockedIn,\r\n    editorValues.scheduleEventId,\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    if (editorValues.scheduleEventId === -1) {\r\n      return;\r\n    }\r\n\r\n    setShowIsClockedIn(editorValues.eventType === EventType.Clock);\r\n  }, [\r\n    editorValues.eventType,\r\n    editorValues.eventStatus,\r\n    editorValues.scheduleEventId,\r\n  ]);\r\n\r\n  const onCheckChange = (checked: boolean) => {\r\n    if (checked === isClockedIn || !showIsClockedIn) {\r\n      return;\r\n    }\r\n\r\n    setIsClockedIn(checked);\r\n    update({\r\n      type: \"ISCLOCKEDIN-UPDATED\",\r\n      isClockedIn: checked,\r\n    });\r\n  };\r\n\r\n  if (!showIsClockedIn) {\r\n    return (\r\n      <>\r\n        {/* <IonCol size=\"0\">\r\n          <span />\r\n        </IonCol>\r\n        <IonCol size=\"0\">\r\n          <span />\r\n        </IonCol> */}\r\n      </>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <>\r\n\r\n      <IonCol size=\"3\">\r\n        <IonLabel className=\"label\">\r\n          <IonIcon icon={time} />\r\n          Clocked In\r\n        </IonLabel>\r\n      </IonCol>\r\n\r\n      <IonCol size=\"2\">\r\n        <IonCheckbox\r\n          checked={isClockedIn}\r\n          onIonChange={(e) => {\r\n            onCheckChange(e.detail.checked);\r\n          }}\r\n        />\r\n      </IonCol>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default EventIsClockedInEditor;\r\n","import { ScheduleEvent } from \"../../orbital-interfaces/ScheduleEvent\";\r\nimport { SelectedPosition } from \"../../util/authitems-helper\";\r\nimport { EventBreak } from \"../../orbital-interfaces/EventBreak\";\r\nimport {\r\n  isAfter,\r\n  isBefore,\r\n  isEqual,\r\n  parseISO,\r\n  setHours,\r\n  setMinutes,\r\n} from \"date-fns\";\r\nimport { formatDateTimeAsMvcString } from \"../../util/time-helper\";\r\nimport EventType from \"../../enums/EventType\";\r\nimport EventStatus from \"../../enums/EventStatus\";\r\nimport {\r\n  AuthorizedItems,\r\n  AuthorizedLocation,\r\n  AuthorizedPosition,\r\n  LocationSettings,\r\n} from \"../../orbital-interfaces/authorized-items\";\r\nimport { EventEditAuthorization } from \"./EditEventAuthorization\";\r\nimport { RecurrenceType } from \"../../enums/RecurrenceType\";\r\nimport { EventInformation } from \"../../orbital-interfaces/TEC\";\r\nimport authHelper from \"../../util/authitems-helper\";\r\n\r\nconst getLocationById = (auth: AuthorizedItems, locId: number) => {\r\n  return auth.locations.filter((l) => l.id === locId)[0];\r\n};\r\n\r\nconst getPositionById = (auth: AuthorizedItems, posId: number) => {\r\n  return auth.locations.flatMap((l) =>\r\n    l.departments.flatMap((d) => d.positions.filter((p) => p.id === posId))\r\n  )[0];\r\n};\r\n\r\nconst getValidStartEnd = (startStr: string, endStr: string) => {\r\n  const start = parseISO(startStr);\r\n  const end = parseISO(endStr);\r\n\r\n  if (isEqual(start, end)) {\r\n    return true;\r\n  }\r\n\r\n  return isAfter(end, start);\r\n};\r\n\r\nexport interface IdName {\r\n  id: number;\r\n  name: string;\r\n}\r\n\r\nexport interface EditorValues {\r\n  scheduleEventId: number;\r\n  locationId: number;\r\n  isUpdating: boolean;\r\n  eventType: EventType;\r\n  eventStatus: EventStatus;\r\n  isConfirmed: boolean;\r\n  position: SelectedPosition;\r\n  employee: IdName;\r\n  eventStart: string;\r\n  eventEnd: string;\r\n  tag: IdName;\r\n  eventBreaks: EventBreak[];\r\n  isClockedIn: boolean;\r\n  isDirty: boolean;\r\n  valid: boolean;\r\n  validEventStartEnd: boolean;\r\n  validEmployee: boolean;\r\n  validTag: boolean;\r\n  validEventTypeStatus: boolean;\r\n  validClockoutValue: boolean;\r\n  validRecurrenceStartEnd: boolean;\r\n  validRepeatInterval: boolean;\r\n  validRepeatWeekdays: boolean;\r\n  absentId?: number;\r\n  absentName?: string;\r\n  absentTimeMinutes: number | null;\r\n  notes: string;\r\n  clockoutValue?: string;\r\n  isReadonly: boolean;\r\n  recurrenceId?: number;\r\n  recurrenceStart?: string;\r\n  recurrenceEnd?: string;\r\n  recurrenceType?: RecurrenceType;\r\n  repeatInterval?: number;\r\n  repeatWeekdays?: string;\r\n}\r\n\r\nexport function getEditorValuesFromEventInformation(\r\n  auth: AuthorizedItems,\r\n  ev: EventInformation\r\n): EditorValues {\r\n  return {\r\n    ...INITIAL_EDITOR_VAUES,\r\n    eventStatus: ev.EventStatusId,\r\n    eventType: ev.EventTypeId,\r\n    eventStart: ev.EventStart,\r\n    eventEnd: ev.EventEnd,\r\n    notes: ev.Notes,\r\n    isClockedIn: ev.IsClockedIn,\r\n    isConfirmed: ev.IsConfirmed,\r\n    scheduleEventId: ev.ScheduleEventId,\r\n    position: authHelper.getSelectedPositionWithLocId(\r\n      auth.locations,\r\n      ev.LocationId,\r\n      ev.PositionId\r\n    ),\r\n    employee: { id: ev.EmployeeId, name: ev.FirstName + \" \" + ev.LastName },\r\n    eventBreaks: ev.EventBreaks,\r\n  };\r\n}\r\n\r\nconst isClockoutValueValid = (\r\n  state: EditorValues,\r\n  locSettings: LocationSettings,\r\n  val?: string\r\n) => {\r\n  if (!val) {\r\n    return true;\r\n  }\r\n\r\n  // clockout values are not enabled\r\n  if (\r\n    !locSettings.ClockOutValueLabel ||\r\n    locSettings.ClockOutValueLabel.length === 0\r\n  ) {\r\n    return false;\r\n  }\r\n\r\n  const regEx = /^\\d*(\\.\\d{0,2})?$/;\r\n  return regEx.test(val);\r\n};\r\n\r\nconst isAllValid = (v: EditorValues): boolean => {\r\n  return (\r\n    v.validEventStartEnd &&\r\n    v.validEmployee &&\r\n    v.validTag &&\r\n    v.validEventTypeStatus &&\r\n    v.validClockoutValue &&\r\n    v.validRecurrenceStartEnd &&\r\n    v.validRepeatInterval &&\r\n    v.validRepeatWeekdays\r\n  );\r\n};\r\n\r\nexport const INITIAL_EDITOR_VAUES: EditorValues = {\r\n  scheduleEventId: -1,\r\n  locationId: 0,\r\n  isUpdating: false,\r\n  eventType: EventType.Shift,\r\n  eventStatus: EventStatus.Approved,\r\n  isConfirmed: false,\r\n  position: {\r\n    location: {} as AuthorizedLocation,\r\n    position: {} as AuthorizedPosition,\r\n  },\r\n  employee: { id: -1, name: \"SELECT EMPLOYEE\" },\r\n  eventStart: formatDateTimeAsMvcString(setHours(setMinutes(new Date(), 0), 8)),\r\n  eventEnd: formatDateTimeAsMvcString(setHours(setMinutes(new Date(), 0), 17)),\r\n  tag: { id: -1, name: \"SELECT TAG\" },\r\n  eventBreaks: [] as EventBreak[],\r\n  isClockedIn: false,\r\n  isDirty: false,\r\n  valid: true,\r\n  validEventStartEnd: true,\r\n  validEmployee: true,\r\n  validTag: true,\r\n  validEventTypeStatus: true,\r\n  validClockoutValue: true,\r\n  validRecurrenceStartEnd: true,\r\n  validRepeatInterval: true,\r\n  validRepeatWeekdays: true,\r\n  absentId: undefined,\r\n  absentName: undefined,\r\n  absentTimeMinutes: null,\r\n  notes: \"\",\r\n  clockoutValue: undefined,\r\n  isReadonly: false,\r\n};\r\n\r\nexport type EditorReducerAction =\r\n  | { type: \"LOADING\"; data: \"we're loading \" }\r\n  | {\r\n      type: \"BEGIN-UPDATE\";\r\n      auth: AuthorizedItems;\r\n      ev: ScheduleEvent;\r\n      eventEditAuth: EventEditAuthorization;\r\n    }\r\n  | { type: \"CANCEL\" }\r\n  | { type: \"CREATE-EVENT\"; auth: AuthorizedItems }\r\n  | {\r\n      type: \"TYPESTATUS-UPDATED\";\r\n      eventType: EventType;\r\n      eventStatus: EventStatus;\r\n      absentId?: number;\r\n      absentTimeMinutes: number | null;\r\n    }\r\n  | { type: \"POSITION-UPDATED\"; selectedPosition: SelectedPosition }\r\n  | { type: \"EMPLOYEE-UPDATED\"; employee: IdName }\r\n  | { type: \"START-UPDATED\"; eventStart: string }\r\n  | { type: \"END-UPDATED\"; eventEnd: string }\r\n  | { type: \"EVENTBREAKS-UPDATED\"; breaks: EventBreak[] }\r\n  | { type: \"TAG-UPDATED\"; tag: IdName }\r\n  | { type: \"CONFIRM-UPDATED\"; isConfirmed: boolean }\r\n  | { type: \"ISCLOCKEDIN-UPDATED\"; isClockedIn: boolean }\r\n  | { type: \"NOTES-UPDATED\"; notes: string }\r\n  | {\r\n      type: \"CLOCKOUTVALUE-UPDATED\";\r\n      clockoutValue?: string;\r\n      locSettings: LocationSettings;\r\n    }\r\n  | { type: \"SET-READONLY\"; isReadonly: boolean }\r\n  | {\r\n      type: \"REPEATING-UPDATED\";\r\n      recurrenceStart?: string;\r\n      recurrenceEnd?: string;\r\n      recurrenceType?: RecurrenceType;\r\n      repeatInterval?: number;\r\n      repeatWeekDays?: string;\r\n    };\r\n\r\nconst getIsClockedIn = (ev: ScheduleEvent) => {\r\n  const end = parseISO(ev.EventEnd);\r\n  return end > new Date(2199, 1, 1);\r\n};\r\n\r\n// ------------------------------------------------------------------------------------------------\r\nexport const editorValueReducer = (\r\n  currentState: EditorValues,\r\n  action: EditorReducerAction\r\n): EditorValues => {\r\n  console.log(\r\n    \"REDUCER: ACTION =\",\r\n    action.type,\r\n    \"   Current State Emp =\",\r\n    currentState.employee.id\r\n  );\r\n  switch (action.type) {\r\n    // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n    case \"BEGIN-UPDATE\":\r\n      const { ev, auth } = action;\r\n      const isClockedIn = getIsClockedIn(ev);\r\n      return {\r\n        scheduleEventId: ev.ScheduleEventId,\r\n        locationId: ev.LocationId,\r\n        isUpdating: false,\r\n        eventType: ev.EventTypeId,\r\n        eventStatus: ev.EventStatusId,\r\n        isConfirmed: ev.ConfirmedBy !== undefined && ev.ConfirmedBy !== null,\r\n        position: {\r\n          location: getLocationById(auth, ev.LocationId),\r\n          position: getPositionById(auth, ev.PositionId),\r\n        },\r\n        employee: { id: ev.EmployeeId, name: ev.FirstName + \" \" + ev.LastName },\r\n        eventStart: ev.EventStart,\r\n        eventEnd: isClockedIn\r\n          ? formatDateTimeAsMvcString(new Date())\r\n          : ev.EventEnd,\r\n        tag: { id: ev.TagId ? ev!.TagId : -1, name: \"\" },\r\n        eventBreaks: ev.EventBreaks,\r\n        isClockedIn: isClockedIn,\r\n        isDirty: false,\r\n        valid: true,\r\n        validEventStartEnd: true,\r\n        validEmployee: true,\r\n        validTag: true,\r\n        validEventTypeStatus: true,\r\n        validClockoutValue: true,\r\n        absentName: ev.AbsentName,\r\n        absentId: ev.AbsentId,\r\n        absentTimeMinutes: ev.AbsentTimeMinutes ? ev.AbsentTimeMinutes : null,\r\n        notes: ev.Notes,\r\n        clockoutValue: ev.ClockOutValue,\r\n        isReadonly: action.eventEditAuth.isReadonly,\r\n        recurrenceId: ev.EventRecurrenceId,\r\n        recurrenceStart: ev.EventRecurrenceStart,\r\n        recurrenceEnd: ev.EventRecurrenceEnd,\r\n        recurrenceType: ev.RepeatType,\r\n        repeatInterval: ev.RepeatInterval,\r\n        repeatWeekdays: ev.RepeatWeekdays,\r\n        validRecurrenceStartEnd: true,\r\n        validRepeatInterval: true,\r\n        validRepeatWeekdays: true,\r\n      };\r\n\r\n    // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n    case \"CANCEL\":\r\n      return INITIAL_EDITOR_VAUES;\r\n\r\n    // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n    case \"POSITION-UPDATED\":\r\n      const { selectedPosition } = action;\r\n      return {\r\n        ...currentState,\r\n        position: selectedPosition,\r\n        isDirty: true,\r\n      };\r\n\r\n    // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n    case \"CREATE-EVENT\":\r\n      const loc = action.auth.locations[0];\r\n      return {\r\n        ...INITIAL_EDITOR_VAUES,\r\n        position: {\r\n          location: loc,\r\n          position: loc.departments[0].positions[0],\r\n        },\r\n        scheduleEventId: 0,\r\n        isDirty: true,\r\n      };\r\n\r\n    // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n    case \"SET-READONLY\":\r\n      return {\r\n        ...currentState,\r\n        isReadonly: action.isReadonly,\r\n      };\r\n\r\n    // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n    case \"TYPESTATUS-UPDATED\":\r\n      const newTypeStatusState = {\r\n        ...currentState,\r\n        eventType: action.eventType,\r\n        eventStatus: action.eventStatus,\r\n        absentId: action.absentId,\r\n        absentTimeMinutes: action.absentTimeMinutes,\r\n        isDirty: true,\r\n        validEventTypeStatus: !(\r\n          action.absentId && action.absentTimeMinutes === null\r\n        ),\r\n      };\r\n\r\n      newTypeStatusState.valid = isAllValid(newTypeStatusState);\r\n      return newTypeStatusState;\r\n\r\n    // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n    case \"CLOCKOUTVALUE-UPDATED\":\r\n      const newClockoutValueState = {\r\n        ...currentState,\r\n        clockoutValue: action.clockoutValue,\r\n        validClockoutValue: isClockoutValueValid(\r\n          currentState,\r\n          action.locSettings,\r\n          action.clockoutValue\r\n        ),\r\n        isDirty: true,\r\n      };\r\n\r\n      newClockoutValueState.valid = isAllValid(newClockoutValueState);\r\n      return newClockoutValueState;\r\n\r\n    // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n    case \"EMPLOYEE-UPDATED\":\r\n      const newState = {\r\n        ...currentState,\r\n        employee: action.employee,\r\n        isDirty: true,\r\n        validEmployee: action.employee.id > 0,\r\n      };\r\n\r\n      newState.valid = isAllValid(newState);\r\n      return newState;\r\n\r\n    // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n    case \"START-UPDATED\":\r\n      const newStartState = {\r\n        ...currentState,\r\n        eventStart: action.eventStart,\r\n        isDirty: true,\r\n        validEventStartEnd: getValidStartEnd(\r\n          action.eventStart,\r\n          currentState.eventEnd\r\n        ),\r\n      };\r\n\r\n      newStartState.valid = isAllValid(newStartState);\r\n      return newStartState;\r\n\r\n    // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n    case \"END-UPDATED\":\r\n      const newEndState = {\r\n        ...currentState,\r\n        eventEnd: action.eventEnd,\r\n        isDirty: true,\r\n        validEventStartEnd: getValidStartEnd(\r\n          currentState.eventStart,\r\n          action.eventEnd\r\n        ),\r\n      };\r\n\r\n      newEndState.valid = isAllValid(newEndState);\r\n      return newEndState;\r\n\r\n    // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n    case \"EVENTBREAKS-UPDATED\":\r\n      return {\r\n        ...currentState,\r\n        eventBreaks: action.breaks,\r\n        isDirty: true,\r\n      };\r\n\r\n    // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n    case \"TAG-UPDATED\":\r\n      const newTagState = {\r\n        ...currentState,\r\n        tag: action.tag,\r\n        isDirty: true,\r\n        validTag: true,\r\n      };\r\n\r\n      newTagState.valid = isAllValid(newTagState);\r\n      return newTagState;\r\n\r\n    case \"CONFIRM-UPDATED\":\r\n      const newConfirmState = {\r\n        ...currentState,\r\n        isConfirmed: action.isConfirmed,\r\n        isDirty: true,\r\n      };\r\n\r\n      newConfirmState.valid = isAllValid(newConfirmState);\r\n      return newConfirmState;\r\n\r\n    case \"NOTES-UPDATED\":\r\n      return {\r\n        ...currentState,\r\n        notes: action.notes,\r\n        isDirty: true,\r\n      };\r\n\r\n    case \"ISCLOCKEDIN-UPDATED\":\r\n      const newClockedInState = {\r\n        ...currentState,\r\n        isClockedIn: action.isClockedIn,\r\n        isDirty: true,\r\n      };\r\n\r\n      if (action.isClockedIn) {\r\n        const now = formatDateTimeAsMvcString(new Date());\r\n        newClockedInState.eventStart = now;\r\n        newClockedInState.eventEnd = now;\r\n      }\r\n\r\n      newClockedInState.valid = isAllValid(newClockedInState);\r\n      return newClockedInState;\r\n\r\n    case \"REPEATING-UPDATED\":\r\n      const newRepeatState = {\r\n        ...currentState,\r\n        recurrenceStart: action.recurrenceStart,\r\n        recurrenceEnd: action.recurrenceEnd,\r\n        recurrenceType: action.recurrenceType,\r\n        repeatInterval: action.repeatInterval,\r\n        repeatWeekdays: action.repeatWeekDays,\r\n        isDirty: true,\r\n      };\r\n\r\n      if (newRepeatState.recurrenceStart) {\r\n        if (newRepeatState.repeatInterval === RecurrenceType.Weekly) {\r\n          newRepeatState.validRepeatWeekdays =\r\n            newRepeatState.repeatWeekdays !== null &&\r\n            newRepeatState.repeatWeekdays !== undefined &&\r\n            newRepeatState.repeatWeekdays.length > 0;\r\n        } else {\r\n          newRepeatState.repeatWeekdays = undefined;\r\n          newRepeatState.validRepeatWeekdays = true;\r\n        }\r\n\r\n        if (!newRepeatState.recurrenceEnd) {\r\n          newRepeatState.validRecurrenceStartEnd = false;\r\n        } else {\r\n          newRepeatState.validRecurrenceStartEnd = isBefore(\r\n            parseISO(newRepeatState.recurrenceStart),\r\n            parseISO(newRepeatState.recurrenceEnd)\r\n          );\r\n        }\r\n\r\n        newRepeatState.validRepeatInterval =\r\n          newRepeatState.repeatInterval !== null &&\r\n          newRepeatState.repeatInterval !== undefined &&\r\n          newRepeatState.repeatInterval > 0;\r\n      }\r\n\r\n      newRepeatState.valid = isAllValid(newRepeatState);\r\n      return newRepeatState;\r\n\r\n    // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n    default:\r\n      console.error(\r\n        \"ERROR in editorValueReducer, could not find action for \" + action.type\r\n      );\r\n      return currentState;\r\n  }\r\n};\r\n","export enum RecurrenceUpdateType {\r\n  UpdateSingleEvent,\r\n  UpdateEntireSeries,\r\n  UpdateSeriesForward,\r\n}\r\n","import React from \"react\";\r\nimport { IonLabel, IonTextarea, IonCol, IonRow } from \"@ionic/react\";\r\nimport \"./EventStartEndEditor\";\r\nimport { AuthorizedItems } from \"../../../orbital-interfaces/authorized-items\";\r\nimport { EditorValues, EditorReducerAction } from \"../EditEventModalState\";\r\n\r\ninterface EventNotesEditorProps {\r\n  auth: AuthorizedItems;\r\n  editorValues: EditorValues;\r\n  update: React.Dispatch<EditorReducerAction>;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst EventNotesEditor: React.FC<EventNotesEditorProps> = ({\r\n  editorValues,\r\n  update,\r\n}: EventNotesEditorProps) => {\r\n  const onNotesUpdate = (newNote?: string | null) => {\r\n    if (!newNote) {\r\n      newNote = \"\";\r\n    }\r\n\r\n    if (newNote !== editorValues.notes) {\r\n      update({ type: \"NOTES-UPDATED\", notes: newNote });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <IonRow className=\"edit-row\">\r\n      <IonCol size=\"3\">\r\n        <IonLabel className=\"label\">Notes</IonLabel>\r\n      </IonCol>\r\n      <IonCol size=\"9\">\r\n        <IonTextarea\r\n          className=\"textarea\"\r\n          maxlength={200}\r\n          rows={4}\r\n          value={editorValues.notes}\r\n          disabled={editorValues.isReadonly}\r\n          onIonChange={(e) => onNotesUpdate(e.detail.value)}\r\n        />\r\n      </IonCol>\r\n    </IonRow>\r\n  );\r\n};\r\n\r\nexport default EventNotesEditor;\r\n","import React, { useEffect, useState } from \"react\";\nimport { IonLabel, IonCol, IonRow, IonInput } from \"@ionic/react\";\nimport \"./EventStartEndEditor\";\nimport {\n  AuthorizedItems,\n  LocationSettings,\n} from \"../../../orbital-interfaces/authorized-items\";\nimport { EditorValues, EditorReducerAction } from \"../EditEventModalState\";\nimport authHelper from \"../../../util/authitems-helper\";\nimport { EventType } from \"../../../orbital-interfaces\";\n\ninterface EventClockoutValueEditorProps {\n  auth: AuthorizedItems;\n  editorValues: EditorValues;\n  update: React.Dispatch<EditorReducerAction>;\n}\n\n// --------------------------------------------------------------------------------------\nconst EventClockoutValueEditor: React.FC<EventClockoutValueEditorProps> = ({\n  auth,\n  editorValues,\n  update,\n}: EventClockoutValueEditorProps) => {\n  const [isVisible, setIsVisible] = useState(false);\n  const [locSettings, setLocSettings] = useState(\n    null as LocationSettings | null\n  );\n\n  useEffect(() => {\n    if (\n      editorValues.locationId === 0 ||\n      (locSettings && editorValues.locationId === locSettings.LocationId)\n    ) {\n      return;\n    }\n\n    if (!auth || !auth.locations || auth.locations.length === 0) {\n      return;\n    }\n\n    if (!editorValues.locationId) {\n      return;\n    }\n\n    const newLocSettings = authHelper.getLocSettingsForLocationId(\n      auth,\n      editorValues.locationId\n    );\n    setLocSettings(newLocSettings);\n    // eslint-disable-next-line\n  }, [editorValues.locationId, auth]);\n\n  useEffect(() => {\n    if (!locSettings) {\n      return;\n    }\n\n    setIsVisible(\n      locSettings!.ClockOutValueLabel !== undefined &&\n        locSettings!.ClockOutValueLabel !== null &&\n        locSettings!.ClockOutValueLabel.length > 0 &&\n        editorValues.eventType === EventType.Clock &&\n        !editorValues.isClockedIn\n    );\n  }, [editorValues.eventType, editorValues.isClockedIn, locSettings]);\n\n  const onClockoutValueUpdated = (newValue?: string | null) => {\n    if (newValue === null) {\n      newValue = undefined;\n    }\n\n    if (newValue === editorValues.clockoutValue) {\n      return;\n    }\n\n    update({\n      type: \"CLOCKOUTVALUE-UPDATED\",\n      locSettings: locSettings!,\n      clockoutValue: newValue,\n    });\n  };\n\n  if (!isVisible || locSettings === null) {\n    return <div />;\n  }\n\n  return (\n    <IonRow className=\"edit-row\">\n      <IonCol size=\"3\">\n        <IonLabel className=\"label\">{locSettings.ClockOutValueLabel}</IonLabel>\n      </IonCol>\n      <IonCol size=\"9\">\n        <IonInput\n          className=\"input-textbox\"\n          value={editorValues.clockoutValue}\n          onIonChange={(e) => onClockoutValueUpdated(e.detail.value)}\n        />\n      </IonCol>\n    </IonRow>\n  );\n};\n\nexport default EventClockoutValueEditor;\n","import { ApplicationUser } from \"../context/ApplicationUserContext\";\r\nimport apiHelper from \"./OrbitalApiHelper\";\r\nimport EventType from \"../enums/EventType\";\r\nimport EventStatus from \"../enums/EventStatus\";\r\nimport { RecurrenceUpdateType } from \"../enums/RecurrenceUpdateType\";\r\n\r\ninterface CoverRequestModel {\r\n  ScheduleEventId: number;\r\n  LocationId: number;\r\n  BusinessId: number;\r\n  BroadcastCoverRequestMessage: boolean;\r\n  CoverMessage: string;\r\n}\r\n\r\ninterface DeleteEventModel {\r\n  LocationId: number;\r\n  ScheduleEventId: number;\r\n  EventTypeId: EventType;\r\n  EventStatusId: EventStatus;\r\n  RecUpdateType?: RecurrenceUpdateType;\r\n}\r\n\r\nexport interface ErrorResponse {\r\n  error: boolean;\r\n  message: string;\r\n}\r\n\r\nexport interface CoverListItem {\r\n  value: number;\r\n  text: string;\r\n  disabled: boolean;\r\n  style: string | null;\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst undoCoverRequest = async (\r\n  user: ApplicationUser,\r\n  scheduleEventId: number\r\n) => {\r\n  // eslint-disable-next-line max-len\r\n  const url = `api/v1/employee/schedule-events/cover-request/undo?scheduleEventId=${scheduleEventId}`;\r\n  return await apiHelper.put(user, url);\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst createCoverRequest = async (\r\n  user: ApplicationUser,\r\n  scheduleEventId: number,\r\n  locationId: number,\r\n  businessId: number,\r\n  broadCastMessage: boolean,\r\n  coverMessage: string,\r\n  toEmployeeId: number | null\r\n) => {\r\n  const url = \"api/v1/employee/schedule-events/cover-request/submit\";\r\n\r\n  const data = {\r\n    ScheduleEventId: scheduleEventId,\r\n    LocationId: locationId,\r\n    BusinessId: businessId,\r\n    BroadcastCoverRequestMessage: broadCastMessage,\r\n    CoverMessage: coverMessage,\r\n    DirectToEmployeeId: toEmployeeId,\r\n  } as CoverRequestModel;\r\n\r\n  return await apiHelper.put(user, url, data);\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst makeShiftRequest = async (\r\n  user: ApplicationUser,\r\n  scheduleEventId: number,\r\n  locationId: number,\r\n  businessId: number,\r\n  broadCastMessage: boolean,\r\n  coverMessage: string\r\n) => {\r\n  const url = \"api/v2/requests/shift-request/submit\";\r\n\r\n  const data = {\r\n    ScheduleEventId: scheduleEventId,\r\n    LocationId: locationId,\r\n    BusinessId: businessId,\r\n    BroadcastCoverRequestMessage: broadCastMessage,\r\n    CoverMessage: coverMessage,\r\n  } as CoverRequestModel;\r\n\r\n  return (await apiHelper.put(user, url, data)) as ErrorResponse;\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst removeShiftRequest = async (\r\n  user: ApplicationUser,\r\n  locationId: number,\r\n  scheduleEventId: number,\r\n  eventType: EventType,\r\n  eventStatus: EventStatus,\r\n  recUpdateType?: RecurrenceUpdateType\r\n) => {\r\n  const url = \"api/v1/employee/schedule-events/delete\";\r\n\r\n  const data = {\r\n    LocationId: locationId,\r\n    ScheduleEventId: scheduleEventId,\r\n    EventTypeId: eventType,\r\n    EventStatusId: eventStatus,\r\n    RecUpdateType: recUpdateType,\r\n  } as DeleteEventModel;\r\n\r\n  return await apiHelper.post(user, url, data);\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst deleteEvent = async (\r\n  user: ApplicationUser,\r\n  locationId: number,\r\n  scheduleEventId: number,\r\n  eventType: EventType,\r\n  eventStatus: EventStatus,\r\n  recUpdateType?: RecurrenceUpdateType\r\n) => {\r\n  const url = \"api/v1/employee/schedule-events/delete\";\r\n\r\n  const data = {\r\n    LocationId: locationId,\r\n    ScheduleEventId: scheduleEventId,\r\n    EventTypeId: eventType,\r\n    EventStatusId: eventStatus,\r\n    RecUpdateType: recUpdateType,\r\n  } as DeleteEventModel;\r\n\r\n  return await apiHelper.post(user, url, data);\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst getCoverRequestListItems = async (\r\n  user: ApplicationUser,\r\n  scheduleEventId: number,\r\n  isDirectCoverList: boolean\r\n) => {\r\n  const url = \"api/v2/requests/transfers/to-list\";\r\n\r\n  const data = {\r\n    scheduleEventId,\r\n    directCoverList: isDirectCoverList,\r\n  };\r\n\r\n  return (await apiHelper.post(user, url, data)) as CoverListItem[];\r\n};\r\n\r\nexport default {\r\n  undoCoverRequest,\r\n  createCoverRequest,\r\n  makeShiftRequest,\r\n  removeShiftRequest,\r\n  deleteEvent,\r\n  getCoverRequestListItems,\r\n};\r\n","import React, { useContext, useEffect, useState } from \"react\";\r\nimport {\r\n  IonButton,\r\n  IonCol,\r\n  IonContent,\r\n  IonFooter,\r\n  IonGrid,\r\n  IonHeader,\r\n  IonRow,\r\n  IonSelect,\r\n  IonSelectOption,\r\n  IonTextarea,\r\n  IonTitle,\r\n  IonToolbar,\r\n} from \"@ionic/react\";\r\n// import \"./EventRequestModal.scss\";\r\nimport \"../../../global-styles.scss\";\r\nimport {\r\n  AuthorizedItems,\r\n  LocationSettings,\r\n} from \"../../../orbital-interfaces/authorized-items\";\r\nimport {\r\n  EventEditAuthorization,\r\n  EventEditEnum,\r\n} from \"../EditEventAuthorization\";\r\nimport requestAPI, { CoverListItem } from \"../../../api/RequestsAPI\";\r\nimport { ApplicationUserContext } from \"../../../context/ApplicationUserContext\";\r\n\r\ninterface EventRequestModalProps {\r\n  onCancel: () => void;\r\n  onOk: (\r\n    employeeId: number | null,\r\n    notes: string,\r\n    sendMessage: boolean\r\n  ) => void;\r\n  auth: AuthorizedItems;\r\n  eventEditAuth: EventEditAuthorization;\r\n  locSettings: LocationSettings;\r\n  scheduleEventId: number;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst EventRequestModal: React.FC<EventRequestModalProps> = ({\r\n  onCancel,\r\n  onOk,\r\n  eventEditAuth,\r\n  locSettings,\r\n  scheduleEventId,\r\n}: EventRequestModalProps) => {\r\n  const { user } = useContext(ApplicationUserContext);\r\n  const [notes, setNotes] = useState(\"\" as string | null | undefined);\r\n  const [selectedEmployeeId, setSelectedEmployeeId] = useState(\r\n    null as number | null\r\n  );\r\n  const [coverList, setCoverList] = useState(null as CoverListItem[] | null);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (\r\n      eventEditAuth.usage === EventEditEnum.CreateCoverRequest &&\r\n      scheduleEventId > 0\r\n    ) {\r\n      requestAPI\r\n        .getCoverRequestListItems(user, scheduleEventId, true)\r\n        .then((results) => {\r\n          setCoverList(results);\r\n          if (results && results.length > 0) {\r\n            setSelectedEmployeeId(results[0].value);\r\n          }\r\n        });\r\n    }\r\n\r\n    // eslint-disable-next-line\r\n  }, [scheduleEventId, eventEditAuth.usage]);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onOkClick = () => {\r\n    const newNotes = notes ?? \"\";\r\n    onOk(selectedEmployeeId, newNotes, false);\r\n  };\r\n\r\n  if (eventEditAuth.usage === EventEditEnum.None) {\r\n    return <div />;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <IonContent>\r\n        <IonHeader mode=\"ios\">\r\n          <IonToolbar>\r\n            <IonTitle>{eventEditAuth.buttonText}</IonTitle>\r\n          </IonToolbar>\r\n        </IonHeader>\r\n        <IonGrid>\r\n          <IonRow\r\n            hidden={\r\n              !locSettings.EnableDirectCoverRequest ||\r\n              eventEditAuth.usage !== EventEditEnum.CreateCoverRequest\r\n            }\r\n          >\r\n            <IonCol className=\"label\" size=\"3\">\r\n              To\r\n            </IonCol>\r\n            <IonCol size=\"9\">\r\n              <IonSelect\r\n                className=\"select\"\r\n                value={selectedEmployeeId}\r\n                onIonChange={(e) => {\r\n                  setSelectedEmployeeId(parseInt(e.detail.value));\r\n                }}\r\n              >\r\n                {coverList &&\r\n                  coverList.map((cover) => (\r\n                    <IonSelectOption\r\n                      key={cover.value}\r\n                      value={cover.value}\r\n                      disabled={cover.disabled}\r\n                    >\r\n                      {cover.text}\r\n                    </IonSelectOption>\r\n                  ))}\r\n              </IonSelect>\r\n            </IonCol>\r\n          </IonRow>\r\n\r\n          <IonRow\r\n            hidden={eventEditAuth.usage === EventEditEnum.CreateCoverRequest}\r\n          >\r\n            <IonCol size=\"12\">\r\n              <div className=\"usage-message\">{eventEditAuth.text}</div>\r\n            </IonCol>\r\n          </IonRow>\r\n\r\n          <IonRow\r\n            hidden={eventEditAuth.usage !== EventEditEnum.CreateCoverRequest}\r\n          >\r\n            <IonCol className=\"label\" size=\"3\">\r\n              Notes\r\n            </IonCol>\r\n            <IonCol size=\"9\">\r\n              <IonTextarea\r\n                className=\"select\"\r\n                maxlength={200}\r\n                rows={4}\r\n                value={notes}\r\n                onIonChange={(e) => {\r\n                  setNotes(e.detail.value);\r\n                }}\r\n              />\r\n            </IonCol>\r\n          </IonRow>\r\n\r\n          <IonRow>\r\n            <IonCol className=\"label\" size=\"3\" />\r\n            <IonCol size=\"9\" className=\"error-message\">\r\n              <div />\r\n            </IonCol>\r\n          </IonRow>\r\n        </IonGrid>\r\n      </IonContent>\r\n      <IonFooter>\r\n        <IonButton expand=\"block\" color=\"secondary\" onClick={onOkClick}>\r\n          OK\r\n        </IonButton>\r\n\r\n        <IonButton expand=\"block\" onClick={onCancel}>\r\n          CANCEL\r\n        </IonButton>\r\n      </IonFooter>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default EventRequestModal;\r\n","import React, { useContext, useState } from \"react\";\r\nimport { IonButton, IonModal } from \"@ionic/react\";\r\n// import \"./EventRequestEditor.scss\";\r\nimport \"../../../global-styles.scss\";\r\nimport { AuthorizedItems } from \"../../../orbital-interfaces/authorized-items\";\r\nimport { EditorReducerAction } from \"../EditEventModalState\";\r\nimport EventRequestModal from \"./EventRequestModal\";\r\nimport authHelper from \"../../../util/authitems-helper\";\r\nimport reqApi from \"../../../api/RequestsAPI\";\r\nimport { ApplicationUserContext } from \"../../../context/ApplicationUserContext\";\r\nimport EventType from \"../../../enums/EventType\";\r\nimport EventStatus from \"../../../enums/EventStatus\";\r\nimport useDialogBox from \"../../../hooks/useDialogBox\";\r\nimport {\r\n  EventEditAuthorization,\r\n  EventEditEnum,\r\n} from \"../EditEventAuthorization\";\r\n\r\ninterface EventRequestEditorProps {\r\n  auth: AuthorizedItems;\r\n  update: React.Dispatch<EditorReducerAction>;\r\n  cancelEditModal: (message: string) => void;\r\n  setUsageText: (usageText: string) => void;\r\n  eventEnd: string;\r\n  eventType: EventType;\r\n  eventStatus: EventStatus;\r\n  eventEmployeeId: number;\r\n  eventPositionId: number;\r\n  scheduleEventId: number;\r\n  locationId: number;\r\n  eventEditAuth: EventEditAuthorization | null;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst EventRequestEditor: React.FC<EventRequestEditorProps> = ({\r\n  auth,\r\n  cancelEditModal,\r\n  eventType,\r\n  eventStatus,\r\n  scheduleEventId,\r\n  locationId,\r\n  eventEditAuth,\r\n}: EventRequestEditorProps) => {\r\n  const { user } = useContext(ApplicationUserContext);\r\n  const [showRequestModal, setShowRequestModal] = useState(false);\r\n  const dlg = useDialogBox();\r\n\r\n  const onComplete = (message: string) => {\r\n    setShowRequestModal(false);\r\n    cancelEditModal(message);\r\n  };\r\n\r\n  const onApply = (\r\n    employeeId: number | null,\r\n    notes: string,\r\n    sendMessage: boolean\r\n  ) => {\r\n    switch (eventEditAuth!.usage) {\r\n      case EventEditEnum.CreateCoverRequest:\r\n        reqApi\r\n          .createCoverRequest(\r\n            user,\r\n            scheduleEventId,\r\n            locationId,\r\n            0,\r\n            sendMessage,\r\n            notes,\r\n            employeeId\r\n          )\r\n          .then(() => {\r\n            onComplete(\"Cover-Request Created\");\r\n          });\r\n        break;\r\n\r\n      case EventEditEnum.CreateShiftRequest:\r\n        reqApi\r\n          .makeShiftRequest(\r\n            user,\r\n            scheduleEventId,\r\n            locationId,\r\n            0,\r\n            sendMessage,\r\n            notes\r\n          )\r\n          .then((results) => {\r\n            if (results.error) {\r\n              dlg.showAlert(\"Shift-Request Failed\", results.message, () => {});\r\n            } else {\r\n              onComplete(results.message); // \"Shift-Request Created\"\r\n            }\r\n          });\r\n        break;\r\n\r\n      case EventEditEnum.DeleteShiftRequest:\r\n        reqApi\r\n          .removeShiftRequest(\r\n            user,\r\n            locationId,\r\n            scheduleEventId,\r\n            eventType,\r\n            eventStatus,\r\n            undefined\r\n          )\r\n          .then(() => {\r\n            onComplete(\"Shift-Request Removed\");\r\n          });\r\n        break;\r\n\r\n      case EventEditEnum.UndoCoverRequest:\r\n        reqApi.undoCoverRequest(user, scheduleEventId).then(() => {\r\n          onComplete(\"Removed Cover-Request\");\r\n        });\r\n        break;\r\n\r\n      case EventEditEnum.Delete:\r\n        reqApi\r\n          .deleteEvent(\r\n            user,\r\n            locationId,\r\n            scheduleEventId,\r\n            eventType,\r\n            eventStatus,\r\n            undefined\r\n          )\r\n          .then(() => {\r\n            onComplete(\"Deleted\");\r\n          });\r\n        break;\r\n    }\r\n  };\r\n\r\n  if (\r\n    !eventEditAuth ||\r\n    !auth ||\r\n    !auth.locations ||\r\n    auth.locations.length === 0 ||\r\n    eventEditAuth.usage === EventEditEnum.None ||\r\n    scheduleEventId <= 0\r\n  ) {\r\n    return <div />;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <IonButton\r\n        className=\"apply-button\"\r\n        expand=\"block\"\r\n        onClick={() => {\r\n          setShowRequestModal(true);\r\n        }}\r\n      >\r\n        {eventEditAuth.buttonText}\r\n      </IonButton>\r\n\r\n      <IonModal\r\n        isOpen={showRequestModal}\r\n        cssClass=\"event-request-modal\"\r\n        onDidDismiss={() => setShowRequestModal(false)}\r\n      >\r\n        <EventRequestModal\r\n          onCancel={() => {\r\n            setShowRequestModal(false);\r\n          }}\r\n          onOk={onApply}\r\n          auth={auth}\r\n          eventEditAuth={eventEditAuth}\r\n          scheduleEventId={scheduleEventId}\r\n          locSettings={authHelper.getLocSettingsForLocationId(auth, locationId)}\r\n        />\r\n        {dlg.alertBoxJsx}\r\n      </IonModal>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default EventRequestEditor;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { IonCheckbox } from \"@ionic/react\";\r\n// import \"./WeekdayList.scss\";\r\nimport \"../../../global-styles.scss\";\r\nimport { LocationSettings } from \"../../../orbital-interfaces/authorized-items\";\r\nimport { getWeekStart } from \"../../../util/time-helper\";\r\nimport { addDays, format, getDay } from \"date-fns\";\r\nimport { EditorReducerAction, EditorValues } from \"../EditEventModalState\";\r\n\r\ninterface WeekdayListProps {\r\n  locSettings: LocationSettings | null;\r\n  editorValues: EditorValues;\r\n  update: React.Dispatch<EditorReducerAction>;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst WeekdayList: React.FC<WeekdayListProps> = ({\r\n  locSettings,\r\n  editorValues,\r\n  update,\r\n}: WeekdayListProps) => {\r\n  const [checkList, setCheckList] = useState([\r\n    false,\r\n    false,\r\n    false,\r\n    false,\r\n    false,\r\n    false,\r\n    false,\r\n  ]);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (!editorValues.repeatWeekdays) {\r\n      setCheckList([false, false, false, false, false, false, false]);\r\n    } else {\r\n      const newState = [false, false, false, false, false, false, false];\r\n      for (let i = 0; i < editorValues.repeatWeekdays.length; i++) {\r\n        newState[parseInt(editorValues.repeatWeekdays[i])] = true;\r\n      }\r\n\r\n      setCheckList(newState);\r\n    }\r\n  }, [editorValues.repeatWeekdays]);\r\n\r\n  if (locSettings === null) {\r\n    return <div />;\r\n  }\r\n\r\n  const weekStart = getWeekStart(\r\n    new Date(),\r\n    locSettings.DayWeekStartsOn,\r\n    locSettings.DayStartTime\r\n  );\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  function onCheckboxChecked(dayOfWeek: number) {\r\n    const newCheckState = checkList.slice();\r\n    newCheckState[dayOfWeek] = !checkList[dayOfWeek];\r\n    setCheckList(newCheckState);\r\n\r\n    let repeatWeekdays = \"\";\r\n    for (let i = 0; i < newCheckState.length; i++) {\r\n      if (newCheckState[i]) {\r\n        repeatWeekdays += i;\r\n      }\r\n    }\r\n\r\n    update({\r\n      type: \"REPEATING-UPDATED\",\r\n      repeatWeekDays: repeatWeekdays,\r\n      repeatInterval: editorValues.repeatInterval,\r\n      recurrenceType: editorValues.recurrenceType,\r\n      recurrenceEnd: editorValues.recurrenceEnd,\r\n      recurrenceStart: editorValues.recurrenceStart,\r\n    });\r\n  }\r\n\r\n  return (\r\n    <div className=\"weeklist-container\">\r\n      {[0, 1, 2, 3, 4, 5, 6].map((num: number) => {\r\n        const thisDate = addDays(weekStart, num);\r\n        const dayOfWeek = getDay(thisDate);\r\n\r\n        return (\r\n          <span key={num} className=\"day\">\r\n            <IonCheckbox\r\n              className=\"day-checkbox\"\r\n              disabled={editorValues.isReadonly}\r\n              onClick={() => onCheckboxChecked(dayOfWeek)}\r\n              checked={checkList[dayOfWeek]}\r\n            />\r\n            <span className=\"day-abbr\">\r\n              {format(thisDate, \"EE\").substr(0, 2)}\r\n            </span>\r\n          </span>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default WeekdayList;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport {\r\n  IonCheckbox,\r\n  IonCol,\r\n  IonDatetime,\r\n  IonIcon,\r\n  IonInput,\r\n  IonLabel,\r\n  IonRow,\r\n  IonSelect,\r\n  IonSelectOption,\r\n} from \"@ionic/react\";\r\n// import \"./RecurringEventSection.scss\";\r\nimport \"../../../global-styles.scss\";\r\nimport { calendar, refresh } from \"ionicons/icons\";\r\nimport {\r\n  AuthorizedItems,\r\n  LocationSettings,\r\n} from \"../../../orbital-interfaces/authorized-items\";\r\nimport EventType from \"../../../enums/EventType\";\r\nimport authHelper from \"../../../util/authitems-helper\";\r\nimport WeekdayList from \"./WeekdayList\";\r\nimport { EditorReducerAction, EditorValues } from \"../EditEventModalState\";\r\nimport { RecurrenceType } from \"../../../enums/RecurrenceType\";\r\nimport { formatDateTimeAsMvcString } from \"../../../util/time-helper\";\r\n\r\ninterface RecurringEventSectionProps {\r\n  auth: AuthorizedItems;\r\n  editorValues: EditorValues;\r\n  update: React.Dispatch<EditorReducerAction>;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst RecurringEventSection: React.FC<RecurringEventSectionProps> = ({\r\n  auth,\r\n  editorValues,\r\n  update,\r\n}: RecurringEventSectionProps) => {\r\n  const [locSettings, setLocSettings] = useState(\r\n    null as LocationSettings | null\r\n  );\r\n  const [isVisible, setIsVisible] = useState(false);\r\n  const [isChecked, setIsChecked] = useState(false);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (editorValues.scheduleEventId === -1) {\r\n      return;\r\n    }\r\n\r\n    if (editorValues.locationId > 0) {\r\n      setLocSettings(\r\n        authHelper.getLocSettingsForLocationId(auth, editorValues.locationId)\r\n      );\r\n    } else if (editorValues.locationId === 0) {\r\n      setLocSettings(auth.locations[0].settings);\r\n    }\r\n    // eslint-disable-next-line\r\n  }, [editorValues.locationId, editorValues.scheduleEventId]);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (editorValues.scheduleEventId === -1) {\r\n      return;\r\n    }\r\n\r\n    setIsVisible(\r\n      editorValues.eventType === EventType.Shift ||\r\n      editorValues.eventType === EventType.Unavailable\r\n    );\r\n  }, [editorValues.eventType, editorValues.scheduleEventId]);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (!isVisible || editorValues.scheduleEventId === -1) {\r\n      return;\r\n    }\r\n\r\n    if (editorValues.recurrenceStart) {\r\n      setIsChecked(true);\r\n    } else {\r\n      if (isChecked) {\r\n      } else {\r\n      }\r\n    }\r\n  }, [\r\n    isChecked,\r\n    isVisible,\r\n    editorValues.recurrenceStart,\r\n    editorValues.scheduleEventId,\r\n  ]);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  function onRepeatingChecked() {\r\n    if (!isChecked) {\r\n      update({\r\n        type: \"REPEATING-UPDATED\",\r\n        repeatWeekDays: undefined,\r\n        repeatInterval: 1,\r\n        recurrenceType: RecurrenceType.Weekly,\r\n        recurrenceEnd: undefined,\r\n        recurrenceStart: formatDateTimeAsMvcString(new Date()),\r\n      });\r\n    } else {\r\n      update({\r\n        type: \"REPEATING-UPDATED\",\r\n        repeatWeekDays: undefined,\r\n        repeatInterval: undefined,\r\n        recurrenceType: undefined,\r\n        recurrenceEnd: undefined,\r\n        recurrenceStart: undefined,\r\n      });\r\n    }\r\n\r\n    setIsChecked(!isChecked);\r\n  }\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  function onRecurrenceStartChanged(newValue: string | null | undefined) {\r\n    if (!newValue) {\r\n      update({\r\n        type: \"REPEATING-UPDATED\",\r\n        repeatWeekDays: editorValues.repeatWeekdays,\r\n        repeatInterval: editorValues.repeatInterval,\r\n        recurrenceType: editorValues.recurrenceType,\r\n        recurrenceEnd: editorValues.recurrenceEnd,\r\n        recurrenceStart: undefined,\r\n      });\r\n    } else {\r\n      update({\r\n        type: \"REPEATING-UPDATED\",\r\n        repeatWeekDays: editorValues.repeatWeekdays,\r\n        repeatInterval: editorValues.repeatInterval,\r\n        recurrenceType: editorValues.recurrenceType,\r\n        recurrenceEnd: editorValues.recurrenceEnd,\r\n        recurrenceStart: newValue,\r\n      });\r\n    }\r\n  }\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  function onRecurrenceEndChanged(newValue: string | null | undefined) {\r\n    if (!newValue) {\r\n      update({\r\n        type: \"REPEATING-UPDATED\",\r\n        repeatWeekDays: editorValues.repeatWeekdays,\r\n        repeatInterval: editorValues.repeatInterval,\r\n        recurrenceType: editorValues.recurrenceType,\r\n        recurrenceEnd: undefined,\r\n        recurrenceStart: editorValues.recurrenceStart,\r\n      });\r\n    } else {\r\n      update({\r\n        type: \"REPEATING-UPDATED\",\r\n        repeatWeekDays: editorValues.repeatWeekdays,\r\n        repeatInterval: editorValues.repeatInterval,\r\n        recurrenceType: editorValues.recurrenceType,\r\n        recurrenceEnd: newValue,\r\n        recurrenceStart: editorValues.recurrenceStart,\r\n      });\r\n    }\r\n  }\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  function onRecurrenceTypeChanged(newValue: string | null | undefined) {\r\n    if (!newValue) {\r\n      update({\r\n        type: \"REPEATING-UPDATED\",\r\n        repeatWeekDays: editorValues.repeatWeekdays,\r\n        repeatInterval: editorValues.repeatInterval,\r\n        recurrenceType: undefined,\r\n        recurrenceEnd: editorValues.recurrenceEnd,\r\n        recurrenceStart: editorValues.recurrenceStart,\r\n      });\r\n    } else {\r\n      update({\r\n        type: \"REPEATING-UPDATED\",\r\n        repeatWeekDays: editorValues.repeatWeekdays,\r\n        repeatInterval: editorValues.repeatInterval,\r\n        recurrenceType: parseInt(newValue),\r\n        recurrenceEnd: editorValues.recurrenceEnd,\r\n        recurrenceStart: editorValues.recurrenceStart,\r\n      });\r\n    }\r\n  }\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  function onRepeatIntervalChanged(newValue: string | null | undefined) {\r\n    if (!newValue) {\r\n      update({\r\n        type: \"REPEATING-UPDATED\",\r\n        repeatWeekDays: editorValues.repeatWeekdays,\r\n        repeatInterval: undefined,\r\n        recurrenceType: editorValues.recurrenceType,\r\n        recurrenceEnd: editorValues.recurrenceEnd,\r\n        recurrenceStart: editorValues.recurrenceStart,\r\n      });\r\n    } else {\r\n      update({\r\n        type: \"REPEATING-UPDATED\",\r\n        repeatWeekDays: editorValues.repeatWeekdays,\r\n        repeatInterval: parseInt(newValue),\r\n        recurrenceType: editorValues.recurrenceType,\r\n        recurrenceEnd: editorValues.recurrenceEnd,\r\n        recurrenceStart: editorValues.recurrenceStart,\r\n      });\r\n    }\r\n  }\r\n\r\n  if (!isVisible) {\r\n    return <span />;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <IonRow>\r\n        <IonCol size=\"3\">\r\n          <IonLabel className=\"label\">(R)epeats</IonLabel>\r\n        </IonCol>\r\n\r\n        <IonCol size=\"2\">\r\n          <IonCheckbox\r\n            checked={isChecked}\r\n            onClick={onRepeatingChecked}\r\n            disabled={editorValues.isReadonly}\r\n          />\r\n        </IonCol>\r\n      </IonRow>\r\n\r\n      {isChecked && (\r\n        <>\r\n          <IonRow className=\"edit-row\">\r\n            <IonCol size=\"1\">\r\n              <IonIcon icon={calendar} mode=\"md\" />\r\n            </IonCol>\r\n            <IonCol size=\"5\">\r\n              <IonDatetime\r\n                value={editorValues.recurrenceStart}\r\n                className=\"select\"\r\n                displayFormat=\"M/D/YY\"\r\n                pickerFormat=\"MMM DD YYYY\"\r\n                disabled={editorValues.isReadonly}\r\n                min=\"2005-01-01\"\r\n                max=\"2030-01-01\"\r\n                onIonChange={(e) => {\r\n                  onRecurrenceStartChanged(e.detail.value);\r\n                }}\r\n              />\r\n            </IonCol>\r\n            <IonCol size=\"1\">\r\n              <IonIcon\r\n                icon={calendar}\r\n                mode=\"md\"\r\n                style={{ textAlign: \"right\" }}\r\n              />\r\n            </IonCol>\r\n            <IonCol size=\"5\">\r\n              <IonDatetime\r\n                value={editorValues.recurrenceEnd}\r\n                className=\"select\"\r\n                displayFormat=\"M/D/YY\"\r\n                pickerFormat=\"MMM DD YYYY\"\r\n                disabled={editorValues.isReadonly}\r\n                min=\"2005-01-01\"\r\n                max=\"2030-01-01\"\r\n                onIonChange={(e) => {\r\n                  onRecurrenceEndChanged(e.detail.value);\r\n                }}\r\n              />\r\n            </IonCol>\r\n          </IonRow>\r\n          <IonRow className=\"edit-row\">\r\n            <IonCol size=\"1\">\r\n              <IonIcon icon={refresh} mode=\"md\" />\r\n            </IonCol>\r\n            <IonCol size=\"5\">\r\n              <IonSelect\r\n                className=\"select\"\r\n                value={editorValues.recurrenceType}\r\n                disabled={editorValues.isReadonly}\r\n                onIonChange={(e) => {\r\n                  onRecurrenceTypeChanged(e.detail.value);\r\n                }}\r\n              >\r\n                <IonSelectOption value={RecurrenceType.Weekly}>\r\n                  Weekly\r\n                </IonSelectOption>\r\n                <IonSelectOption value={RecurrenceType.MonthlyByDayOfMonth}>\r\n                  Monthly (Day of Month)\r\n                </IonSelectOption>\r\n                <IonSelectOption value={RecurrenceType.MonthlyByDayOfWeek}>\r\n                  Monthly (Day of Week)\r\n                </IonSelectOption>\r\n              </IonSelect>\r\n            </IonCol>\r\n            <IonCol size=\"1\">#</IonCol>\r\n            <IonCol size=\"5\">\r\n              <IonInput\r\n                className=\"input-textbox\"\r\n                disabled={editorValues.isReadonly}\r\n                value={\r\n                  editorValues.repeatInterval\r\n                    ? editorValues.repeatInterval.toString()\r\n                    : undefined\r\n                }\r\n                onIonChange={(e) => onRepeatIntervalChanged(e.detail.value)}\r\n              />\r\n            </IonCol>\r\n          </IonRow>\r\n          <IonRow>\r\n            <IonCol size=\"12\">\r\n              <WeekdayList\r\n                locSettings={locSettings}\r\n                editorValues={editorValues}\r\n                update={update}\r\n              />\r\n            </IonCol>\r\n          </IonRow>\r\n        </>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default RecurringEventSection;\r\n","import React from \"react\";\r\nimport {\r\n  IonButton,\r\n  IonCol,\r\n  IonContent,\r\n  IonGrid,\r\n  IonHeader,\r\n  IonRow,\r\n  IonTitle,\r\n  IonToolbar,\r\n} from \"@ionic/react\";\r\nimport { RecurrenceUpdateType } from \"../../enums/RecurrenceUpdateType\";\r\n// import \"./RecurrenceUpdateTypeSelector.scss\";\r\nimport \"../../global-styles.scss\";\r\n\r\ninterface RecurrenceUpdateTypeSelectorProps {\r\n  onSelect: (selection: RecurrenceUpdateType | null) => void;\r\n  updateType: \"NO\" | \"UPDATE\" | \"DELETE\";\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst RecurrenceUpdateTypeSelector: React.FC<RecurrenceUpdateTypeSelectorProps> = ({\r\n  onSelect,\r\n  updateType,\r\n}: RecurrenceUpdateTypeSelectorProps) => {\r\n  if (updateType === \"NO\") {\r\n    return <div />;\r\n  }\r\n\r\n  const onButtonClick = (choice: RecurrenceUpdateType | null) => {\r\n    onSelect(choice);\r\n  };\r\n\r\n  const titleText =\r\n    updateType === \"UPDATE\"\r\n      ? \"Update Recurring Events\"\r\n      : \"Delete Recurring Events\";\r\n\r\n  return (\r\n    <>\r\n      <IonContent>\r\n        <IonHeader mode=\"ios\">\r\n          <IonToolbar>\r\n            <IonTitle>{titleText}</IonTitle>\r\n          </IonToolbar>\r\n        </IonHeader>\r\n        <IonGrid>\r\n          <IonRow>\r\n            <IonCol size=\"12\">\r\n              <IonButton\r\n                expand=\"block\"\r\n                color=\"danger\"\r\n                className=\"apply-button\"\r\n                onClick={() =>\r\n                  onButtonClick(RecurrenceUpdateType.UpdateSingleEvent)\r\n                }\r\n              >\r\n                This event\r\n              </IonButton>\r\n            </IonCol>\r\n          </IonRow>\r\n          <IonRow>\r\n            <IonCol size=\"12\">\r\n              <IonButton\r\n                expand=\"block\"\r\n                color=\"danger\"\r\n                className=\"apply-button\"\r\n                onClick={() =>\r\n                  onButtonClick(RecurrenceUpdateType.UpdateEntireSeries)\r\n                }\r\n              >\r\n                Entire series\r\n              </IonButton>\r\n            </IonCol>\r\n          </IonRow>\r\n          <IonRow>\r\n            <IonCol size=\"12\">\r\n              <IonButton\r\n                expand=\"block\"\r\n                color=\"danger\"\r\n                className=\"apply-button\"\r\n                onClick={() =>\r\n                  onButtonClick(RecurrenceUpdateType.UpdateSeriesForward)\r\n                }\r\n              >\r\n                This event forward\r\n              </IonButton>\r\n            </IonCol>\r\n          </IonRow>\r\n          <IonRow>\r\n            <IonCol size=\"12\">\r\n              <IonButton\r\n                expand=\"block\"\r\n                className=\"cancel-btn\"\r\n                onClick={() => onButtonClick(null)}\r\n              >\r\n                Cancel\r\n              </IonButton>\r\n            </IonCol>\r\n          </IonRow>\r\n        </IonGrid>\r\n      </IonContent>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default RecurrenceUpdateTypeSelector;\r\n","import React, { useEffect, useReducer, useState } from \"react\";\r\nimport {\r\n  IonButton,\r\n  IonButtons,\r\n  IonIcon,\r\n  IonContent,\r\n  IonFooter,\r\n  IonHeader,\r\n  IonGrid,\r\n  IonRow,\r\n  IonCol,\r\n  IonTitle,\r\n  IonToolbar,\r\n  IonModal,\r\n} from \"@ionic/react\";\r\nimport { arrowBackOutline } from \"ionicons/icons\";\r\n// import \"./EditEventModal.scss\";\r\nimport \"../../global-styles.scss\";\r\nimport { AuthorizedItems } from \"../../orbital-interfaces/authorized-items\";\r\nimport EventTypeStatusEditor from \"./editor/EventTypeStatusEditor\";\r\nimport EventPositionEditor from \"./editor/EventPositionEditor\";\r\nimport EventEmployeeEditor from \"./editor/EventEmployeeEditor\";\r\nimport EventStartEndEditor from \"./editor/EventStartEndEditor\";\r\nimport EventBreakEditor from \"./editor/EventBreakEditor\";\r\nimport EventTagEditor from \"./editor/EventTagEditor\";\r\nimport EventConfirmEditor from \"./editor/EventConfirmEditor\";\r\nimport EventIsClockedInEditor from \"./editor/EventIsClockedInEditor\";\r\nimport { editorValueReducer, EditorValues } from \"./EditEventModalState\";\r\nimport scheduleEventApi from \"../../api/ScheduleEventsAPI\";\r\nimport { ApplicationUserContext } from \"../../context/ApplicationUserContext\";\r\nimport useDialogBox from \"../../hooks/useDialogBox\";\r\nimport { ScheduleEvent } from \"../../orbital-interfaces/ScheduleEvent\";\r\nimport EventNotesEditor from \"./editor/EventNotesEditor\";\r\nimport EventClockoutValueEditor from \"./editor/EventClockoutValueEditor\";\r\nimport EventReqeustEditor from \"./editor/EventRequestEditor\";\r\nimport { createBrowserHistory } from \"history\";\r\nimport { EventEditAuthorization } from \"./EditEventAuthorization\";\r\nimport RecurringEventSection from \"./editor/RecurringEventSection\";\r\nimport { RecurrenceUpdateType } from \"../../enums/RecurrenceUpdateType\";\r\nimport RecurrenceUpdateTypeSelector from \"./RecurrenceUpdateTypeSelector\";\r\nimport useOrbitalDialogBox from \"../../hooks/useOrbitalDialogBox\";\r\nimport { useShowLoading } from \"../../hooks/useShowLoading\";\r\n\r\ninterface ScheduleFilterModalProps {\r\n  scheduleEventId: number | null;\r\n  auth: AuthorizedItems;\r\n  onDismissModal: (toastMessage?: string) => void;\r\n  onCancelModal: () => void;\r\n  isOpen: boolean;\r\n  eventEditAuth: EventEditAuthorization;\r\n  initialEvent: EditorValues;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst EditEventModal: React.FC<ScheduleFilterModalProps> = ({\r\n  auth,\r\n  scheduleEventId,\r\n  onDismissModal,\r\n  onCancelModal,\r\n  isOpen,\r\n  eventEditAuth,\r\n  initialEvent,\r\n}) => {\r\n  const loading = useShowLoading(\"Please wait...\");\r\n  const dlg = useDialogBox();\r\n  const { user } = React.useContext(ApplicationUserContext);\r\n  const [editorValues, updateEditorValues] = useReducer(\r\n    editorValueReducer,\r\n    initialEvent\r\n  );\r\n\r\n  const [scheduleEvent, setScheduleEvent] = useState(\r\n    null as ScheduleEvent | null\r\n  );\r\n\r\n  const [recurrenceUpdateType, setRecurrenceUpdateType] = useState(\r\n    null as RecurrenceUpdateType | null\r\n  );\r\n\r\n  const [\r\n    showRecurrenceUpdateTypeSelector,\r\n    setShowRecurrenceUpdateTypeSelector,\r\n  ] = useState(\"NO\" as \"NO\" | \"UPDATE\" | \"DELETE\");\r\n\r\n  const [buttonClicked, setButtonClicked] = useState(\r\n    \"NONE\" as \"NONE\" | \"CREATEUPDATE\" | \"DELETE\"\r\n  );\r\n\r\n  const isEditing = scheduleEventId !== null;\r\n  const dialog = useOrbitalDialogBox();\r\n  let title = \"New Event\";\r\n  let buttonText = \"CREATE\";\r\n\r\n  if (isEditing) {\r\n    title = \"Edit Event\";\r\n    buttonText = \"UPDATE\";\r\n  }\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (!isOpen) {\r\n      return;\r\n    }\r\n\r\n    if (!auth || !auth.locations || auth.locations.length === 0) {\r\n      return;\r\n    }\r\n\r\n    if (scheduleEventId) {\r\n      loading.setShowLoading(true);\r\n      scheduleEventApi\r\n        .getScheduleEvent(user, scheduleEventId)\r\n        .then((scheduleEvent) => {\r\n          loading.setShowLoading(false);\r\n          if (!scheduleEvent) {\r\n            dlg.showAlert(\r\n              \"No Event\",\r\n              \"The event may have been removed or you no longer have access\",\r\n              onCancel\r\n            );\r\n            return;\r\n          }\r\n\r\n          setScheduleEvent(scheduleEvent);\r\n          updateEditorValues({\r\n            type: \"BEGIN-UPDATE\",\r\n            ev: scheduleEvent,\r\n            auth,\r\n            eventEditAuth,\r\n          });\r\n        });\r\n    } else {\r\n      if (scheduleEvent !== null) {\r\n        setScheduleEvent(null);\r\n      }\r\n\r\n      updateEditorValues({ type: \"CREATE-EVENT\", auth });\r\n    }\r\n\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [scheduleEventId, user, isOpen, auth]);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (recurrenceUpdateType !== null && buttonClicked !== \"NONE\") {\r\n      if (buttonClicked === \"CREATEUPDATE\") {\r\n        createOrUpdate();\r\n      } else {\r\n        deleteEvent(\r\n          editorValues.recurrenceId !== null &&\r\n          editorValues.recurrenceId !== undefined\r\n        );\r\n      }\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [recurrenceUpdateType, buttonClicked]);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const createOrUpdate = () => {\r\n    const apiCall =\r\n      editorValues.scheduleEventId === 0\r\n        ? scheduleEventApi.createScheduleEvent\r\n        : scheduleEventApi.updateScheduleEvent;\r\n    apiCall(user, editorValues, recurrenceUpdateType).then((result) => {\r\n      if (result.error) {\r\n        dlg.showAlert(\"Cannot update\", result.message, () => {\r\n          onDismissModal(\"Could not update event\");\r\n        });\r\n      } else {\r\n        onDismissModal(\"Event Updated\");\r\n      }\r\n    });\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const deleteEvent = (skipPrompt: boolean) => {\r\n    const goDelete = () => {\r\n      scheduleEventApi\r\n        .deleteScheduleEvent(\r\n          user,\r\n          editorValues.scheduleEventId,\r\n          recurrenceUpdateType\r\n        )\r\n        .then((result) => {\r\n          if (result.error) {\r\n            dlg.showAlert(\"Cannot delete\", result.message, () => {\r\n              onDismissModal(\"Could not delete event\");\r\n            });\r\n          } else {\r\n            onDismissModal(\"Deleted Event\");\r\n          }\r\n        });\r\n    };\r\n\r\n    if (skipPrompt) {\r\n      goDelete();\r\n    } else {\r\n      dialog.showDialog(\r\n        \"Delete event?\",\r\n        \"\",\r\n        [{ text: \"Delete\", color: \"danger\", value: 1 }],\r\n        (selection) => {\r\n          if (selection === 1) {\r\n            goDelete();\r\n          }\r\n        }\r\n      );\r\n    }\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onCreateOrUpdateClick = () => {\r\n    setButtonClicked(\"CREATEUPDATE\");\r\n    if (editorValues.recurrenceId) {\r\n      if (recurrenceUpdateType !== null) {\r\n        createOrUpdate();\r\n      } else {\r\n        setShowRecurrenceUpdateTypeSelector(\"UPDATE\");\r\n      }\r\n    } else {\r\n      createOrUpdate();\r\n    }\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onRecurrenceUpdateTypeSelect = (\r\n    selection: RecurrenceUpdateType | null\r\n  ) => {\r\n    setShowRecurrenceUpdateTypeSelector(\"NO\");\r\n    setRecurrenceUpdateType(selection);\r\n    if (selection === null) {\r\n      setButtonClicked(\"NONE\");\r\n    }\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onDeleteClick = () => {\r\n    setButtonClicked(\"DELETE\");\r\n    if (editorValues.recurrenceId) {\r\n      if (recurrenceUpdateType !== null) {\r\n        deleteEvent(true);\r\n      } else {\r\n        setShowRecurrenceUpdateTypeSelector(\"DELETE\");\r\n      }\r\n    } else {\r\n      deleteEvent(\r\n        editorValues.recurrenceId !== null &&\r\n        editorValues.recurrenceId !== undefined\r\n      );\r\n    }\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onCancel = () => {\r\n    updateEditorValues({ type: \"CANCEL\" });\r\n    const history = createBrowserHistory();\r\n    history.push(\"/tabs/schedule\");\r\n    onCancelModal();\r\n  };\r\n\r\n  if (!isOpen || !auth || !auth.locations || auth.locations.length === 0) {\r\n    return (\r\n      <>\r\n        <div>Loading</div>\r\n        {dlg.alertBoxJsx}\r\n      </>\r\n    );\r\n  } else {\r\n    return (\r\n      <>\r\n        <IonHeader className=\"ion-no-border\">\r\n          <IonToolbar>\r\n            <IonButtons slot=\"start\">\r\n              <IonButton onClick={onCancel}>\r\n                <IonIcon icon={arrowBackOutline} mode=\"md\" slot=\"icon-only\" />\r\n              </IonButton>\r\n            </IonButtons>\r\n            <IonTitle>{title}</IonTitle>\r\n          </IonToolbar>\r\n        </IonHeader>\r\n\r\n        <IonContent class=\"outer-content\">\r\n          <IonGrid>\r\n            <EventTypeStatusEditor\r\n              editorValues={editorValues}\r\n              update={updateEditorValues}\r\n              auth={auth}\r\n              eventTypes={eventEditAuth.eventTypeOptionList}\r\n              eventStatuses={eventEditAuth.eventStatusOptionList}\r\n            />\r\n\r\n            <IonRow className=\"edit-row\">\r\n              <EventConfirmEditor\r\n                auth={auth}\r\n                editorValues={editorValues}\r\n                update={updateEditorValues}\r\n              />\r\n              <EventIsClockedInEditor\r\n                auth={auth}\r\n                editorValues={editorValues}\r\n                update={updateEditorValues}\r\n              />\r\n            </IonRow>\r\n\r\n            <IonRow className=\"edit-row\">\r\n              <IonCol size=\"12\">\r\n                <div style={{ width: \"100%\", borderBottom: \"1px solid #ddd\" }} />\r\n              </IonCol>\r\n            </IonRow>\r\n\r\n            <EventPositionEditor\r\n              auth={auth}\r\n              editorValues={editorValues}\r\n              update={updateEditorValues}\r\n            />\r\n\r\n            <EventEmployeeEditor\r\n              auth={auth}\r\n              editorValues={editorValues}\r\n              update={updateEditorValues}\r\n            />\r\n\r\n            <EventStartEndEditor\r\n              auth={auth}\r\n              editorValues={editorValues}\r\n              update={updateEditorValues}\r\n            />\r\n\r\n            <RecurringEventSection\r\n              auth={auth}\r\n              editorValues={editorValues}\r\n              update={updateEditorValues}\r\n            />\r\n\r\n            <IonRow className=\"edit-row\">\r\n              <IonCol size=\"12\">\r\n                <div style={{ width: \"100%\", borderBottom: \"1px solid #ddd\" }} />\r\n              </IonCol>\r\n            </IonRow>\r\n\r\n            <EventBreakEditor\r\n              auth={auth}\r\n              editorValues={editorValues}\r\n              update={updateEditorValues}\r\n            />\r\n\r\n            <EventTagEditor\r\n              auth={auth}\r\n              editorValues={editorValues}\r\n              update={updateEditorValues}\r\n            />\r\n\r\n            <EventClockoutValueEditor\r\n              auth={auth}\r\n              editorValues={editorValues}\r\n              update={updateEditorValues}\r\n            />\r\n\r\n            <EventNotesEditor\r\n              auth={auth}\r\n              editorValues={editorValues}\r\n              update={updateEditorValues}\r\n            />\r\n          </IonGrid>\r\n\r\n          {dlg.alertBoxJsx}\r\n          {dialog.dialogBoxJsx}\r\n          {loading.showLoadingJsx}\r\n\r\n          <IonModal\r\n            isOpen={showRecurrenceUpdateTypeSelector !== \"NO\"}\r\n            onDidDismiss={() => {\r\n              onRecurrenceUpdateTypeSelect(null);\r\n            }}\r\n            cssClass=\"recurrence-update-modal\"\r\n          >\r\n            <RecurrenceUpdateTypeSelector\r\n              onSelect={onRecurrenceUpdateTypeSelect}\r\n              updateType={showRecurrenceUpdateTypeSelector}\r\n            />\r\n          </IonModal>\r\n        </IonContent>\r\n\r\n        <IonFooter className=\"outer-content footer\">\r\n          <EventReqeustEditor\r\n            auth={auth}\r\n            eventType={editorValues.eventType}\r\n            eventEnd={editorValues.eventEnd}\r\n            eventStatus={editorValues.eventStatus}\r\n            eventEmployeeId={editorValues.employee.id}\r\n            eventPositionId={editorValues.position.position.id}\r\n            scheduleEventId={editorValues.scheduleEventId}\r\n            locationId={editorValues.locationId}\r\n            eventEditAuth={eventEditAuth}\r\n            update={updateEditorValues}\r\n            cancelEditModal={(message) => onDismissModal(message)}\r\n            setUsageText={() => { }}\r\n          />\r\n          <IonButton\r\n            className=\"apply-button\"\r\n            expand=\"block\"\r\n            onClick={onCreateOrUpdateClick}\r\n            disabled={!editorValues.isDirty || !editorValues.valid}\r\n            hidden={editorValues.isReadonly}\r\n          >\r\n            {buttonText}\r\n          </IonButton>\r\n          <IonButton\r\n            className=\"delete-button\"\r\n            expand=\"block\"\r\n            onClick={onDeleteClick}\r\n            hidden={\r\n              editorValues.isReadonly || editorValues.scheduleEventId <= 0\r\n            }\r\n          >\r\n            DELETE\r\n          </IonButton>\r\n        </IonFooter>\r\n      </>\r\n    );\r\n  }\r\n};\r\n\r\nexport default EditEventModal;\r\n","import React from \"react\";\r\n// import \"./EventCard.scss\";\r\nimport \"../../global-styles.scss\";\r\nimport Skeleton from \"react-loading-skeleton\";\r\n\r\ninterface EventCardSkeletonProps {\r\n  threeRows?: boolean;\r\n}\r\n\r\nconst EventCardSkeleton: React.FC<EventCardSkeletonProps> = ({\r\n  threeRows,\r\n}: EventCardSkeletonProps) => {\r\n  return (\r\n    <button className=\"card\">\r\n      <div className=\"card-first-col\">\r\n        <div className=\"day-name\">\r\n          <Skeleton />{\" \"}\r\n        </div>\r\n        <div className=\"day-number\">\r\n          <Skeleton />\r\n        </div>\r\n      </div>\r\n      <div style={{ padding: \"3px\" }}>\r\n        <Skeleton width={5} height={45} />\r\n      </div>\r\n      <div className=\"card-second-col\">\r\n        <div className=\"time-row\">\r\n          <span>\r\n            <Skeleton width={150} height={9} />\r\n            &nbsp;&nbsp;\r\n          </span>\r\n          <Skeleton />\r\n        </div>\r\n        {threeRows && (\r\n          <div>\r\n            <Skeleton width={80} height={10} />\r\n          </div>\r\n        )}\r\n        <div className=\"dept-position-row\">\r\n          <Skeleton width={150} height={10} />\r\n          &nbsp;&nbsp;\r\n        </div>\r\n      </div>\r\n    </button>\r\n  );\r\n};\r\n\r\nexport default EventCardSkeleton;\r\n","import React from \"react\";\r\n// import \"./NoEventsToShow.scss\";\r\nimport \"../../global-styles.scss\";\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst NoEventsToShow: React.FC = () => {\r\n  return (\r\n    <div className=\"no-events-wrapper\">\r\n      <span className=\"no-events-span\">No Events</span>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NoEventsToShow;\r\n","import { useEffect, useRef } from \"react\";\r\n\r\nexport function useInterval(\r\n  callback: () => void,\r\n  isRunning: boolean,\r\n  delay: number\r\n) {\r\n  const savedProps = useRef<() => void>();\r\n\r\n  // Remember the latest callback.\r\n  useEffect(() => {\r\n    savedProps.current = callback;\r\n  }, [callback]);\r\n\r\n  // Set up the interval.\r\n  useEffect(() => {\r\n    function tick() {\r\n      if (savedProps.current && isRunning) {\r\n        savedProps.current();\r\n      }\r\n    }\r\n\r\n    if (delay !== null) {\r\n      const id = setInterval(tick, delay);\r\n      return () => clearInterval(id);\r\n    }\r\n  }, [delay, isRunning]);\r\n}\r\n","import EventType from \"../enums/EventType\";\r\nimport EventStatus from \"../enums/EventStatus\";\r\nimport EventGroup from \"../enums/EventGroup\";\r\n\r\n/*\r\n * Code in this file was based on ScheduleEventHelper.cs in OrbitalShift.BLL.dll\r\n */\r\n\r\n// ---------------------------------------------------------------------------------\r\nfunction isShiftTypeEvent(\r\n  eventType: EventType,\r\n  eventStatus: EventStatus\r\n): boolean {\r\n  return (\r\n    (eventType === EventType.Shift && eventStatus === EventStatus.Approved) ||\r\n    (eventType === EventType.Cover && eventStatus === EventStatus.Request) ||\r\n    (eventType === EventType.Cover && eventStatus === EventStatus.RequestDenied)\r\n  );\r\n}\r\n\r\n// ---------------------------------------------------------------------------------\r\nfunction isAbsentExpenseEvent(\r\n  eventType: EventType,\r\n  eventStatus: EventStatus\r\n): boolean {\r\n  return eventType === EventType.Absent && eventStatus === EventStatus.Approved;\r\n}\r\n\r\n// ---------------------------------------------------------------------------------\r\nfunction isTimeClockEvent(\r\n  eventType: EventType,\r\n  eventStatus: EventStatus\r\n): boolean {\r\n  return (\r\n    isShiftTypeEvent(eventType, eventStatus) ||\r\n    (eventType === EventType.Clock && eventStatus === EventStatus.Approved)\r\n  );\r\n}\r\n\r\n// ---------------------------------------------------------------------------------\r\nexport function eventMatchesFilter(\r\n  eventTypeFilter: EventType | EventGroup,\r\n  eventStatusFilter: EventStatus | EventGroup,\r\n  eventType: EventType,\r\n  eventStatus: EventStatus\r\n): boolean {\r\n  if (eventTypeFilter > 0 && eventStatusFilter > 0) {\r\n    if (eventTypeFilter === eventType && eventStatusFilter === eventStatus) {\r\n      return true;\r\n    }\r\n  } else if (eventTypeFilter > 0 && eventStatusFilter === EventGroup.All) {\r\n    if (eventTypeFilter === eventType) {\r\n      return true;\r\n    }\r\n  } else if (\r\n    eventTypeFilter === EventGroup.All &&\r\n    eventStatusFilter === eventStatus\r\n  ) {\r\n    if (eventStatusFilter === eventStatus) {\r\n      return true;\r\n    }\r\n  } else if (\r\n    eventTypeFilter === EventGroup.Scheduled &&\r\n    eventStatusFilter === EventGroup.Scheduled\r\n  ) {\r\n    return (\r\n      isShiftTypeEvent(eventType, eventStatus) ||\r\n      isAbsentExpenseEvent(eventType, eventStatus)\r\n    );\r\n  } else if (\r\n    eventTypeFilter === EventGroup.ClockAndSched &&\r\n    eventStatusFilter === EventGroup.ClockAndSched\r\n  ) {\r\n    return (\r\n      isTimeClockEvent(eventType, eventStatus) ||\r\n      isAbsentExpenseEvent(eventType, eventStatus)\r\n    );\r\n  } else {\r\n    return true;\r\n  }\r\n\r\n  return false;\r\n}\r\n","import React, { useState, useEffect, useCallback } from \"react\";\r\nimport {\r\n  IonTitle,\r\n  IonToolbar,\r\n  IonContent,\r\n  IonPage,\r\n  IonModal,\r\n  IonButtons,\r\n  IonMenuButton,\r\n  IonSegment,\r\n  IonSegmentButton,\r\n  IonButton,\r\n  IonIcon,\r\n  IonHeader,\r\n  useIonViewWillEnter,\r\n  useIonViewWillLeave,\r\n} from \"@ionic/react\";\r\nimport { funnel, add } from \"ionicons/icons\";\r\nimport \"../global-styles.scss\";\r\nimport { getWeekStart } from \"../util/time-helper\";\r\nimport { addDays, startOfDay } from \"date-fns\";\r\nimport { AuthorizedItems } from \"../orbital-interfaces/authorized-items\";\r\nimport ScheduleEventsAPI from \"../api/ScheduleEventsAPI\";\r\nimport { DailyNotes } from \"../orbital-interfaces/DailyNotes\";\r\nimport { RefresherEventDetail } from \"@ionic/core\";\r\nimport { EventInformation, HoursList } from \"../orbital-interfaces/TEC\";\r\nimport {\r\n  EventFilter,\r\n  initialEventFilter,\r\n} from \"../orbital-interfaces/EventFilter\";\r\nimport WeekChooser from \"../components/SchedulePageComponents/WeekChooser\";\r\nimport EventList from \"../components/SchedulePageComponents/EventList\";\r\n// eslint-disable-next-line max-len\r\nimport ScheduleFilterModal from \"../components/SchedulePageComponents/ScheduleFilterModal\";\r\nimport useIonicRefresher from \"../hooks/useIonicRefresher\";\r\nimport EditEventModal from \"../components/EditEvent/EditEventModal\";\r\nimport useSimpleToast from \"../hooks/useSimpleToast\";\r\nimport { AuthorizedItemsContext } from \"../context/AuthorizedItemsContext\";\r\nimport { ApplicationUserContext } from \"../context/ApplicationUserContext\";\r\nimport { RouteComponentProps } from \"react-router\";\r\nimport Skeleton from \"react-loading-skeleton\";\r\nimport EventCardSkeleton from \"../components/SchedulePageComponents/EventCardSkeleton\";\r\nimport {\r\n  EventEditAuthorization,\r\n  getEventNewAuthorization,\r\n} from \"../components/EditEvent/EditEventAuthorization\";\r\nimport NoEventsToShow from \"../components/SchedulePageComponents/NoEventsToShow\";\r\nimport { useInterval } from \"../hooks/useInterval\";\r\nimport {\r\n  getEditorValuesFromEventInformation,\r\n  INITIAL_EDITOR_VAUES,\r\n} from \"../components/EditEvent/EditEventModalState\";\r\nimport EventGroup from \"../enums/EventGroup\";\r\nimport EventStatus from \"../enums/EventStatus\";\r\nimport { eventMatchesFilter } from \"../util/scheduleevent-helper\";\r\nimport { getConstants } from \"../api/environment\";\r\n\r\nconst initialEvents: EventInformation[] = [];\r\nconst initialDailyNotes: DailyNotes[] = [];\r\n\r\ninterface SchedulePageProps\r\n  extends RouteComponentProps<{\r\n    scheduleEventId?: string;\r\n  }> {}\r\n\r\n// ------------------------------------------------------------------------------------\r\nfunction getAllScheduleEvents(events: EventInformation[], f: EventFilter) {\r\n  return events.filter((ev) =>\r\n    eventMatchesFilter(\r\n      f.eventTypeId,\r\n      f.eventStatusId,\r\n      ev.EventTypeId,\r\n      ev.EventStatusId\r\n    )\r\n  );\r\n}\r\n\r\n// ------------------------------------------------------------------------------------\r\nfunction getMyScheduleEvents(\r\n  events: EventInformation[],\r\n  auth: AuthorizedItems,\r\n  f: EventFilter\r\n) {\r\n  return events.filter(\r\n    (ev) =>\r\n      eventMatchesFilter(\r\n        f.eventTypeId,\r\n        f.eventStatusId,\r\n        ev.EventTypeId,\r\n        ev.EventStatusId\r\n      ) && ev.EmployeeId === auth.employeeId\r\n  );\r\n}\r\n\r\n// ------------------------------------------------------------------------------------\r\nfunction getRequestScheduleEvents(events: EventInformation[]) {\r\n  return events.filter((ev) => ev.EventStatusId === EventStatus.Request);\r\n}\r\n\r\n// ------------------------------------------------------------------------------------\r\n//\r\n// ------------------------------------------------------------------------------------\r\n// eslint-disable-next-line react/prop-types\r\nconst SchedulePage: React.FC<SchedulePageProps> = ({ match }) => {\r\n  const { user } = React.useContext(ApplicationUserContext);\r\n  const { auth, refreshAuth } = React.useContext(AuthorizedItemsContext);\r\n  const toast = useSimpleToast();\r\n  const refresher = useIonicRefresher(\r\n    (e: CustomEvent<RefresherEventDetail>) => {\r\n      getScheduleEvents(auth, filter, e);\r\n    }\r\n  );\r\n\r\n  const [filterAppliedClass, setFilterAppliedClass] = useState(\r\n    \"filter-not-applied\"\r\n  );\r\n\r\n  const startDate =\r\n    auth && auth.locations && auth.locations.length > 0\r\n      ? getWeekStart(\r\n          startOfDay(new Date()),\r\n          auth.locations[0].settings.DayWeekStartsOn,\r\n          auth.locations[0].settings.DayStartTime\r\n        )\r\n      : getWeekStart(startOfDay(new Date()), \"Monday\", \"\");\r\n\r\n  const [myScheduleEvents, setMyScheduleEvents] = useState(initialEvents);\r\n  const [myDailyNotes, setMyDailyNotes] = useState(initialDailyNotes);\r\n  const [myHoursPerDay, setMyHoursPerDay] = useState([] as HoursList[]);\r\n  const [requestScheduleEvents, setRequestScheduleEvents] = useState(\r\n    initialEvents\r\n  );\r\n  const [requestDailyNotes, setRequestDailyNotes] = useState(initialDailyNotes);\r\n  const [requestHoursPerDay, setRequestHoursPerDay] = useState(\r\n    [] as HoursList[]\r\n  );\r\n  const [allScheduleEvents, setAllScheduleEvents] = useState(initialEvents);\r\n  const [allDailyNotes, setAllDailyNotes] = useState(initialDailyNotes);\r\n  const [allHoursPerDay, setAllHoursPerDay] = useState([] as HoursList[]);\r\n\r\n  const [showLoading, setShowLoading] = useState(true);\r\n  const [isShowing, setIsShowing] = useState(false);\r\n  const [segment, setSegment] = useState<\"my\" | \"requests\" | \"all\">(\"my\");\r\n  const [showFilterModal, setShowFilterModal] = useState(false);\r\n  const [showEventModal, setShowEventModal] = useState(false);\r\n  const [editEventId, setEditEventId] = useState(null as number | null);\r\n  const [initialEditEvent, setInitialEditEvent] = useState(\r\n    INITIAL_EDITOR_VAUES\r\n  );\r\n  const [eventEditAuth, setEventEditAuth] = useState(\r\n    null as EventEditAuthorization | null\r\n  );\r\n  const [filter, setFilter] = useState({\r\n    ...initialEventFilter,\r\n    start: startDate,\r\n    end: addDays(startDate, 6),\r\n    positionIds: auth.locations.flatMap((l) =>\r\n      l.departments.flatMap((d) => d.positions.map((p) => p.id))\r\n    ),\r\n    filterByEmployee: true,\r\n  });\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useIonViewWillEnter(() => {\r\n    setIsShowing(true);\r\n  });\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useIonViewWillLeave(() => {\r\n    setIsShowing(false);\r\n  });\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useInterval(\r\n    () => {\r\n      refreshAuth(false, user).then((newAuth) => {\r\n        if (newAuth) {\r\n          getScheduleEvents(newAuth, filter);\r\n        }\r\n      });\r\n    },\r\n    isShowing,\r\n    getConstants(user).refreshScheduleTimer\r\n  );\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (auth && auth.locations && auth.locations.length > 0) {\r\n      const newFilter = {\r\n        ...filter,\r\n        positionIds: auth.locations.flatMap((l) =>\r\n          l.departments.flatMap((d) => d.positions.map((p) => p.id))\r\n        ),\r\n        dnLocIds: auth.locations.map((l) => l.id),\r\n        settingsLocId: auth.locations[0].id,\r\n      };\r\n\r\n      setFilter(newFilter);\r\n\r\n      if (\r\n        (segment === \"my\" && myScheduleEvents.length === 0) ||\r\n        (segment === \"requests\" && requestScheduleEvents.length === 0) ||\r\n        (segment === \"all\" && allScheduleEvents.length === 0)\r\n      ) {\r\n        setShowLoading(true);\r\n        getScheduleEvents(auth, newFilter);\r\n      }\r\n    } else {\r\n      refreshAuth(false, user);\r\n    }\r\n    // eslint-disable-next-line\r\n  }, [auth]);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    // eslint-disable-next-line react/prop-types\r\n    if (match.params.scheduleEventId) {\r\n      // eslint-disable-next-line react/prop-types\r\n      setEditEventId(parseInt(match.params.scheduleEventId));\r\n      setShowEventModal(true);\r\n    }\r\n\r\n    // eslint-disable-next-line react/prop-types\r\n  }, [match.params.scheduleEventId]);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const getScheduleEvents = (\r\n    auth: AuthorizedItems,\r\n    f: EventFilter,\r\n    e?: CustomEvent<RefresherEventDetail>\r\n  ) => {\r\n    const apiFilter: EventFilter = {\r\n      ...f,\r\n      filterByEmployee: false,\r\n      eventTypeId: EventGroup.All,\r\n      eventStatusId: EventGroup.All,\r\n    };\r\n\r\n    ScheduleEventsAPI.getScheduleEventsByFilter(user, apiFilter).then((res) => {\r\n      setShowLoading(false);\r\n\r\n      if (e) {\r\n        e.detail.complete();\r\n      }\r\n\r\n      setMyScheduleEvents(getMyScheduleEvents(res.events, auth, f));\r\n      setMyDailyNotes(res.dailyNotes);\r\n      setMyHoursPerDay(res.hoursPerDay);\r\n\r\n      setRequestScheduleEvents(getRequestScheduleEvents(res.events));\r\n      setRequestDailyNotes([]);\r\n      setRequestHoursPerDay(res.hoursPerDay);\r\n\r\n      setAllScheduleEvents(getAllScheduleEvents(res.events, f));\r\n      setAllDailyNotes(res.dailyNotes);\r\n      setAllHoursPerDay(res.hoursPerDay);\r\n    });\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onEventClick = useCallback(\r\n    (ev: EventInformation, newEventEditAuth: EventEditAuthorization) => {\r\n      setEditEventId(ev.ScheduleEventId);\r\n      setEventEditAuth(newEventEditAuth);\r\n      setInitialEditEvent(getEditorValuesFromEventInformation(auth, ev));\r\n      setShowEventModal(true);\r\n    },\r\n\r\n    // eslint-disable-next-line\r\n    [auth.locations]\r\n  );\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onEventUpdated = (toastMessage?: string) => {\r\n    if (toastMessage) {\r\n      toast.showToast(toastMessage!);\r\n    }\r\n\r\n    getScheduleEvents(auth, filter);\r\n    setShowEventModal(false);\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const setStartDate = (date: Date) => {\r\n    if (date === filter.start) {\r\n      return;\r\n    }\r\n\r\n    const newFilter = {\r\n      ...filter,\r\n      start: date,\r\n      end: addDays(date, 6),\r\n    };\r\n\r\n    setFilter(newFilter);\r\n    setShowLoading(true);\r\n    getScheduleEvents(auth, newFilter);\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onDismissFilterModal = (f: EventFilter, filterApplied: boolean) => {\r\n    setFilter(f);\r\n    setFilterAppliedClass(\r\n      filterApplied ? \"filter-applied\" : \"filter-not-applied\"\r\n    );\r\n    setShowFilterModal(false);\r\n    setShowLoading(true);\r\n    getScheduleEvents(auth, f);\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onSegmentChange = (segmentName: \"my\" | \"requests\" | \"all\") => {\r\n    setSegment(segmentName);\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const forceRefresh = (toastMessage: string) => {\r\n    if (toastMessage && toastMessage.length > 0) {\r\n      toast.showToast(toastMessage);\r\n    }\r\n\r\n    getScheduleEvents(auth, filter);\r\n  };\r\n\r\n  if (!auth || !auth.locations || auth.locations.length === 0) {\r\n    return <div>Schedule Page</div>;\r\n  }\r\n\r\n  return (\r\n    <IonPage id=\"schedule-page\">\r\n      <IonHeader className=\"ion-no-border\">\r\n        <IonToolbar mode=\"md\">\r\n          <IonButtons slot=\"start\">\r\n            <IonMenuButton />\r\n          </IonButtons>\r\n          <IonTitle slot=\"start\">Schedule</IonTitle>\r\n          <IonButtons slot=\"end\">\r\n            <IonButton\r\n              onClick={() => {\r\n                setEditEventId(null);\r\n                setEventEditAuth(getEventNewAuthorization(auth));\r\n                setShowEventModal(true);\r\n              }}\r\n            >\r\n              <IonIcon icon={add} mode=\"md\" slot=\"icon-only\" />\r\n            </IonButton>\r\n            <IonButton onClick={() => setShowFilterModal(true)}>\r\n              <div className={filterAppliedClass}>&#183;</div>\r\n              <IonIcon icon={funnel} mode=\"ios\" slot=\"icon-only\" />\r\n            </IonButton>\r\n          </IonButtons>\r\n        </IonToolbar>\r\n      </IonHeader>\r\n\r\n      <IonSegment mode=\"md\" value={segment}>\r\n        <IonSegmentButton\r\n          mode=\"md\"\r\n          value=\"my\"\r\n          onClick={() => onSegmentChange(\"my\")}\r\n        >\r\n          MY\r\n        </IonSegmentButton>\r\n        <IonSegmentButton\r\n          mode=\"md\"\r\n          value=\"requests\"\r\n          onClick={() => onSegmentChange(\"requests\")}\r\n        >\r\n          REQUESTS\r\n        </IonSegmentButton>\r\n        <IonSegmentButton\r\n          mode=\"md\"\r\n          value=\"all\"\r\n          onClick={() => onSegmentChange(\"all\")}\r\n        >\r\n          ALL\r\n        </IonSegmentButton>\r\n      </IonSegment>\r\n      <WeekChooser\r\n        startDate={getWeekStart(\r\n          filter.start,\r\n          auth.locations[0].settings.DayWeekStartsOn,\r\n          auth.locations[0].settings.DayStartTime\r\n        )}\r\n        setStartDate={setStartDate}\r\n      />\r\n      <IonContent>\r\n        {refresher.ionicRefresherJsx}\r\n        {!showLoading && segment === \"my\" && myScheduleEvents?.length === 0 && (\r\n          <NoEventsToShow />\r\n        )}\r\n\r\n        {!showLoading && segment === \"my\" && myScheduleEvents?.length > 0 && (\r\n          <EventList\r\n            events={myScheduleEvents}\r\n            listType={segment}\r\n            notes={myDailyNotes}\r\n            hoursPerDay={myHoursPerDay}\r\n            auth={auth}\r\n            onEdit={onEventClick}\r\n            onForceRefresh={forceRefresh}\r\n          />\r\n        )}\r\n\r\n        {!showLoading &&\r\n          segment === \"requests\" &&\r\n          requestScheduleEvents.length === 0 && <NoEventsToShow />}\r\n\r\n        {!showLoading &&\r\n          segment === \"requests\" &&\r\n          requestScheduleEvents.length > 0 && (\r\n            <EventList\r\n              events={requestScheduleEvents}\r\n              listType={segment}\r\n              notes={requestDailyNotes}\r\n              hoursPerDay={requestHoursPerDay}\r\n              auth={auth}\r\n              onEdit={onEventClick}\r\n              onForceRefresh={forceRefresh}\r\n            />\r\n          )}\r\n\r\n        {!showLoading &&\r\n          segment === \"all\" &&\r\n          allScheduleEvents?.length === 0 && <NoEventsToShow />}\r\n\r\n        {!showLoading && segment === \"all\" && allScheduleEvents?.length > 0 && (\r\n          <EventList\r\n            events={allScheduleEvents}\r\n            listType={segment}\r\n            notes={allDailyNotes}\r\n            hoursPerDay={allHoursPerDay}\r\n            auth={auth}\r\n            onEdit={onEventClick}\r\n            onForceRefresh={forceRefresh}\r\n          />\r\n        )}\r\n\r\n        {showLoading && (\r\n          <>\r\n            <div style={{ marginTop: \"10px\" }} />\r\n            <Skeleton height={24} width={220} />\r\n            <br />\r\n            <EventCardSkeleton threeRows={segment !== \"my\"} />\r\n            <EventCardSkeleton threeRows={segment !== \"my\"} />\r\n            <EventCardSkeleton threeRows={segment !== \"my\"} />\r\n          </>\r\n        )}\r\n      </IonContent>\r\n\r\n      {toast.simpleToastJsx}\r\n\r\n      <IonModal\r\n        isOpen={showFilterModal}\r\n        onDidDismiss={() => setShowFilterModal(false)}\r\n      >\r\n        <ScheduleFilterModal\r\n          filter={filter}\r\n          auth={auth}\r\n          onDismissModal={onDismissFilterModal}\r\n          isOpen={showFilterModal}\r\n          onCancelModal={() => setShowFilterModal(false)}\r\n        />\r\n      </IonModal>\r\n\r\n      <IonModal\r\n        isOpen={showEventModal}\r\n        onDidDismiss={() => setShowEventModal(false)}\r\n      >\r\n        <EditEventModal\r\n          isOpen={showEventModal}\r\n          auth={auth}\r\n          onCancelModal={() => setShowEventModal(false)}\r\n          onDismissModal={(toastMessage) => onEventUpdated(toastMessage)}\r\n          scheduleEventId={editEventId}\r\n          initialEvent={initialEditEvent}\r\n          eventEditAuth={eventEditAuth!}\r\n        />\r\n      </IonModal>\r\n    </IonPage>\r\n  );\r\n};\r\n\r\nexport default SchedulePage;\r\n","export enum ClockInRequirement {\r\n  MatchingShift = 1,\r\n  AnyShift = 2,\r\n  NoShift = 3,\r\n}\r\n","import React, { useEffect, useState } from \"react\";\r\nimport {\r\n  IonButton,\r\n  IonButtons,\r\n  IonIcon,\r\n  IonContent,\r\n  IonFooter,\r\n  IonHeader,\r\n  IonTitle,\r\n  IonToolbar,\r\n} from \"@ionic/react\";\r\nimport { arrowBackOutline } from \"ionicons/icons\";\r\n// import \"../SchedulePageComponents/ScheduleFilterModal.scss\";\r\nimport \"../../global-styles.scss\";\r\nimport {\r\n  AuthorizedItems,\r\n  UnscheduledBreakOptions,\r\n  BreakType,\r\n} from \"../../orbital-interfaces/authorized-items\";\r\nimport { TimeClockSettingsData } from \"../../orbital-interfaces/TimeClockSettingsData\";\r\nimport { getEventBreakStartEndString } from \"../../util/time-helper\";\r\n\r\ninterface ScheduleFilterModalProps {\r\n  auth: AuthorizedItems;\r\n  tcData: TimeClockSettingsData;\r\n  onDismissModal: (selection: BreakItem) => void;\r\n}\r\n\r\nexport interface BreakItem {\r\n  key: string;\r\n  name: string;\r\n  breakType: BreakType;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst BreakSelectionModal: React.FC<ScheduleFilterModalProps> = ({\r\n  auth,\r\n  onDismissModal,\r\n  tcData,\r\n}: ScheduleFilterModalProps) => {\r\n  const [breakList, setBreakList] = useState([] as BreakItem[]);\r\n  const cancelOption = {\r\n    key: \"Cancel\",\r\n    name: \"\",\r\n    breakType: BreakType.UnscheduledUnpaid,\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (auth.locations.length === 0 || !tcData.ClockedInScheduleEvent) {\r\n      return;\r\n    }\r\n\r\n    const locSettings = auth.locations.filter(\r\n      (l) => l.id === tcData.ClockedInScheduleEvent!.LocationId\r\n    )[0].settings;\r\n    const breaks: BreakItem[] = [];\r\n\r\n    if (tcData.ScheduleEventsForClockIn.length > 0) {\r\n      tcData.ScheduleEventsForClockIn[0].EventBreaks.map((b) => {\r\n        return breaks.push({\r\n          key: b.BreakStart,\r\n          name: getEventBreakStartEndString(b),\r\n          breakType: BreakType.Scheduled,\r\n        });\r\n      });\r\n    }\r\n\r\n    switch (locSettings.UnscheduledBreakOptions) {\r\n      case UnscheduledBreakOptions.Both:\r\n        breaks.push({\r\n          key: \"UnScheduledUnpaid\",\r\n          name: \"Unscheduled\",\r\n          breakType: BreakType.UnscheduledUnpaid,\r\n        });\r\n        breaks.push({\r\n          key: \"UnScheduledPaid\",\r\n          name: \"Unscheduled $\",\r\n          breakType: BreakType.UnscheduledPaid,\r\n        });\r\n        break;\r\n\r\n      case UnscheduledBreakOptions.Paid:\r\n        breaks.push({\r\n          key: \"UnScheduledPaid\",\r\n          name: \"Unscheduled $\",\r\n          breakType: BreakType.UnscheduledPaid,\r\n        });\r\n        break;\r\n\r\n      case UnscheduledBreakOptions.Unpaid:\r\n        breaks.push({\r\n          key: \"UnScheduledUnpaid\",\r\n          name: \"Unscheduled\",\r\n          breakType: BreakType.UnscheduledUnpaid,\r\n        });\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    }\r\n\r\n    setBreakList(breaks);\r\n  }, [tcData, auth]);\r\n\r\n  return (\r\n    <>\r\n      <IonHeader className=\"ion-no-border\">\r\n        <IonToolbar>\r\n          <IonButtons slot=\"start\">\r\n            <IonButton onClick={() => onDismissModal(cancelOption)}>\r\n              <IonIcon icon={arrowBackOutline} mode=\"md\" slot=\"icon-only\" />\r\n            </IonButton>\r\n          </IonButtons>\r\n          <IonTitle>Choose Break</IonTitle>\r\n        </IonToolbar>\r\n      </IonHeader>\r\n\r\n      <IonContent class=\"outer-content\">\r\n        {breakList.map((brk) => (\r\n          <IonButton\r\n            className=\"apply-button\"\r\n            expand=\"block\"\r\n            key={brk.key}\r\n            color=\"secondary\"\r\n            onClick={() => {\r\n              onDismissModal(brk);\r\n            }}\r\n          >\r\n            {brk.name}\r\n          </IonButton>\r\n        ))}\r\n      </IonContent>\r\n\r\n      <IonFooter>\r\n        <IonButton\r\n          className=\"cancel-button\"\r\n          expand=\"block\"\r\n          color=\"tertiary\"\r\n          onClick={() => onDismissModal(cancelOption)}\r\n        >\r\n          CANCEL\r\n        </IonButton>\r\n      </IonFooter>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default BreakSelectionModal;\r\n","export enum StartBreakResponseCode {\r\n  Success,\r\n  BreakAlreadyExists,\r\n  AlreadyOnBreak,\r\n  ErrorInsertingBreak,\r\n  UserNotAtSpecifiedLocation,\r\n  EventDoesNotMatchCurrentUser,\r\n  InvalidUnscheduledBreak,\r\n}\r\n","export enum EndBreakResponseCode {\r\n  Success,\r\n  CannotEndRestrictedBreakEarly,\r\n  ErrorUpdatingEventBreak,\r\n  UserNotAtSpecifiedLocation,\r\n  EventDoesNotMatchCurrentUser,\r\n  BreakNoLongerExists,\r\n}\r\n","import { EndBreakResponse } from \"../orbital-interfaces/EndBreakResponse\";\r\nimport { StartBreakResponse } from \"../orbital-interfaces/StartBreakResponse\";\r\nimport { BreakType } from \"../orbital-interfaces/authorized-items\";\r\nimport { ScheduleEvent } from \"../orbital-interfaces/ScheduleEvent\";\r\nimport { ClockOutResponse } from \"../orbital-interfaces/ClockOutResponse\";\r\nimport { ClockInResponse } from \"../orbital-interfaces/ClockInResponse\";\r\n// eslint-disable-next-line max-len\r\nimport { SwitchPositionOrTagResponse } from \"../orbital-interfaces/SwitchPositionOrTagResponse\";\r\nimport { TimeClockSettingsData } from \"../orbital-interfaces/TimeClockSettingsData\";\r\nimport { ApplicationUser } from \"../context/ApplicationUserContext\";\r\nimport apiHelper from \"./OrbitalApiHelper\";\r\nimport { ClockInGeoLocations } from \"../orbital-interfaces/ClockInGeoLocations\";\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst getTimeClockSettings = async (\r\n  user: ApplicationUser,\r\n  lat: number | undefined,\r\n  lng: number | undefined\r\n) => {\r\n  const latitude = lat ?? user.latitude;\r\n  const longitude = lng ?? user.longitude;\r\n  return (await apiHelper.get(\r\n    user,\r\n    `api/v1/employee/timeclock/?lat=${latitude}&lng=${longitude}`\r\n  )) as TimeClockSettingsData;\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst clockIn = async (\r\n  user: ApplicationUser,\r\n  positionId: number,\r\n  tagId: number | null\r\n) => {\r\n  // eslint-disable-next-line max-len\r\n  const baseUrl = `/api/v2/employee/timeclock/clockin/${positionId}/${tagId}?lat=${user.latitude}&lng=${user.longitude}`;\r\n  return (await apiHelper.post(user, baseUrl, {})) as ClockInResponse;\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst clockOut = async (user: ApplicationUser, clockOutValue?: number) => {\r\n  const clockoutDataModel = {\r\n    ClockOutValue: clockOutValue,\r\n    TimeClockBreak: null,\r\n    BreakStart: null,\r\n  };\r\n\r\n  return (await apiHelper.post(\r\n    user,\r\n    `/api/v2/employee/timeclock/clockout?lat=${user.latitude}&lng=${user.longitude}`,\r\n    clockoutDataModel\r\n  )) as ClockOutResponse;\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst switchPositionOrTag = async (\r\n  user: ApplicationUser,\r\n  positionId: number,\r\n  tagId: number | null,\r\n  clockOutValue?: number\r\n) => {\r\n  // eslint-disable-next-line max-len\r\n  const baseUrl = `/api/v2/employee/timeclock/switch/${positionId}/${tagId}?lat=${user.latitude}&lng=${user.longitude}`;\r\n  const clockoutDataModel = {\r\n    ClockOutValue: clockOutValue,\r\n    TimeClockBreak: null,\r\n    BreakStart: null,\r\n  };\r\n\r\n  return (await apiHelper.post(\r\n    user,\r\n    baseUrl,\r\n    clockoutDataModel\r\n  )) as SwitchPositionOrTagResponse;\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst startBreak = async (\r\n  user: ApplicationUser,\r\n  clockEvent: ScheduleEvent,\r\n  shiftEvent: ScheduleEvent | null,\r\n  breakType: BreakType,\r\n  breakStart?: string\r\n) => {\r\n  // eslint-disable-next-line max-len\r\n  const baseUrl = `/api/v2/employee/timeclock/startbreak?lat=${user.latitude}&lng=${user.longitude}`;\r\n  const breakStartOptions = {\r\n    clockEventId: clockEvent.ScheduleEventId,\r\n    shiftEventId: shiftEvent ? shiftEvent!.ScheduleEventId : null,\r\n    shiftBreakStart: breakStart,\r\n    breakType,\r\n  };\r\n\r\n  return (await apiHelper.post(\r\n    user,\r\n    baseUrl,\r\n    breakStartOptions\r\n  )) as StartBreakResponse;\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst endBreak = async (\r\n  user: ApplicationUser,\r\n  clockEvent: ScheduleEvent,\r\n  shiftEvent: ScheduleEvent | null\r\n) => {\r\n  const shiftEventId = shiftEvent ? shiftEvent.ScheduleEventId : \"\";\r\n  // eslint-disable-next-line max-len\r\n  const baseUrl =\r\n    shiftEvent !== null\r\n      ? `/api/v2/employee/timeclock/endbreak/${clockEvent.ScheduleEventId}/${shiftEventId}?lat=${user.latitude}&lng=${user.longitude}`\r\n      : `/api/v2/employee/timeclock/endbreak/${clockEvent.ScheduleEventId}/-1?lat=${user.latitude}&lng=${user.longitude}`;\r\n\r\n  return (await apiHelper.post(user, baseUrl, {})) as EndBreakResponse;\r\n};\r\n\r\nconst getGeoLocations = async (user: ApplicationUser) => {\r\n  const baseUrl = \"/api/v2/employee/timeclock/geolocations\";\r\n  return (await apiHelper.get(user, baseUrl)) as ClockInGeoLocations[];\r\n};\r\n\r\nexport default {\r\n  getTimeClockSettings,\r\n  clockIn,\r\n  clockOut,\r\n  switchPositionOrTag,\r\n  startBreak,\r\n  endBreak,\r\n  getGeoLocations,\r\n};\r\n","import React, { useState } from \"react\";\r\nimport {\r\n  IonButton,\r\n  IonCol,\r\n  IonContent,\r\n  IonFooter,\r\n  IonInput,\r\n  IonGrid,\r\n  IonHeader,\r\n  IonRow,\r\n  IonTitle,\r\n  IonToolbar,\r\n} from \"@ionic/react\";\r\n// import \"./ClockoutModal.scss\";\r\nimport \"../../global-styles.scss\";\r\nimport { LocationSettings } from \"../../orbital-interfaces/authorized-items\";\r\n\r\ninterface ClockoutModalProps {\r\n  onCancel: () => void;\r\n  onOk: (clockoutValue?: number) => void;\r\n  locSettings: LocationSettings;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst ClockoutModal: React.FC<ClockoutModalProps> = ({\r\n  onCancel,\r\n  onOk,\r\n  locSettings,\r\n}: ClockoutModalProps) => {\r\n  const [clockoutValue, setClockoutValue] = useState(\r\n    undefined as number | undefined\r\n  );\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onOkClick = () => {\r\n    onOk(clockoutValue);\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  function onClockoutValueUpdate(val: string | undefined | null) {\r\n    if (!val) {\r\n      if (clockoutValue !== undefined) {\r\n        setClockoutValue(undefined);\r\n      }\r\n\r\n      return;\r\n    }\r\n\r\n    setClockoutValue(parseFloat(val));\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <IonContent>\r\n        <IonHeader mode=\"ios\">\r\n          <IonToolbar>\r\n            <IonTitle>Clock Out</IonTitle>\r\n          </IonToolbar>\r\n        </IonHeader>\r\n        <IonGrid>\r\n          <IonRow>\r\n            <IonCol className=\"label\" size=\"12\">\r\n              {locSettings.ClockOutValueLabel}\r\n            </IonCol>\r\n          </IonRow>\r\n          <IonRow>\r\n            <IonCol size=\"2\" />\r\n            <IonCol size=\"8\">\r\n              <IonInput\r\n                placeholder=\"Enter value\"\r\n                type=\"number\"\r\n                className=\"input\"\r\n                autoCorrect=\"off\"\r\n                clearInput={true}\r\n                value={clockoutValue?.toString()}\r\n                onIonChange={(e) => {\r\n                  onClockoutValueUpdate(e.detail.value);\r\n                }}\r\n              />\r\n            </IonCol>\r\n            <IonCol size=\"2\" />\r\n          </IonRow>\r\n        </IonGrid>\r\n      </IonContent>\r\n      <IonFooter>\r\n        <IonButton\r\n          expand=\"block\"\r\n          onClick={onOkClick}\r\n          className=\"clockout-button\"\r\n        >\r\n          CLOCK OUT\r\n        </IonButton>\r\n\r\n        <IonButton expand=\"block\" className=\"cancel-button\" onClick={onCancel}>\r\n          CANCEL\r\n        </IonButton>\r\n      </IonFooter>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ClockoutModal;\r\n","import React, { useState, useEffect } from \"react\";\r\n// import \"./ClockPanel.scss\";\r\nimport \"../../global-styles.scss\";\r\nimport { IonButton } from \"@ionic/react\";\r\nimport { LocationSettings } from \"../../orbital-interfaces/authorized-items\";\r\nimport { TimeClockSettingsData } from \"../../orbital-interfaces/TimeClockSettingsData\";\r\n\r\ninterface SwitchPositionOrTagButtonProps {\r\n  tcData: TimeClockSettingsData;\r\n  locSettings: LocationSettings;\r\n  selectedPosId: number;\r\n  selectedTagId: number | null;\r\n  onSwitch: () => void;\r\n}\r\n\r\nconst SwitchPositionOrTagButton: React.FC<SwitchPositionOrTagButtonProps> = ({\r\n  tcData,\r\n  locSettings,\r\n  selectedPosId,\r\n  selectedTagId,\r\n  onSwitch,\r\n}: SwitchPositionOrTagButtonProps) => {\r\n  const [disabled, setDisabled] = useState(true);\r\n\r\n  const hiddenJsx = <span />;\r\n\r\n  useEffect(() => {\r\n    if (tcData.UserClockedIn) {\r\n      const curPosId = tcData.ClockedInScheduleEvent!.PositionId;\r\n      let curTagId = tcData.ClockedInScheduleEvent!.TagId;\r\n      if (!curTagId) {\r\n        curTagId = -1;\r\n      }\r\n\r\n      if (curPosId !== selectedPosId) {\r\n        setDisabled(false);\r\n      } else if (curTagId !== selectedTagId) {\r\n        setDisabled(false);\r\n      } else {\r\n        setDisabled(true);\r\n      }\r\n    }\r\n  }, [\r\n    tcData.UserClockedIn,\r\n    tcData.ClockedInScheduleEvent,\r\n    selectedPosId,\r\n    selectedTagId,\r\n  ]);\r\n\r\n  if (\r\n    !locSettings.ClockInWithDifferentTag &&\r\n    !locSettings.EnablePositionChangeForEmployeePosition\r\n  ) {\r\n    return hiddenJsx;\r\n  }\r\n\r\n  if (!tcData.UserClockedIn) {\r\n    return hiddenJsx;\r\n  }\r\n\r\n  return (\r\n    <div className=\"switch-button-container\">\r\n      <IonButton\r\n        className=\"switch-button\"\r\n        disabled={disabled}\r\n        color=\"secondary\"\r\n        expand=\"block\"\r\n        onClick={onSwitch}\r\n      >\r\n        SWITCH\r\n      </IonButton>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SwitchPositionOrTagButton;\r\n","import React, { useRef, useEffect, useState } from \"react\";\r\n// import \"./Map.scss\";\r\nimport \"../../global-styles.scss\";\r\nimport { ApplicationUserContext } from \"../../context/ApplicationUserContext\";\r\nimport timeclockApi from \"../../api/TimeClockAPI\";\r\nimport { ClockInGeoLocations } from \"../../orbital-interfaces/ClockInGeoLocations\";\r\nimport { IonButton, IonIcon } from \"@ionic/react\";\r\nimport { arrowUpCircle, arrowDownCircle } from \"ionicons/icons\";\r\n\r\n// -----------------------------------------------------------------------------------------------\r\nfunction calculateNearestLocationMessage(\r\n  lat: number | undefined,\r\n  lng: number | undefined,\r\n  locations: ClockInGeoLocations[]\r\n): string {\r\n  if (!lat || !lng || locations.length === 0) {\r\n    return \"\";\r\n  }\r\n\r\n  if (\r\n    !google ||\r\n    !google.maps ||\r\n    !google.maps.geometry ||\r\n    !google.maps.geometry.spherical ||\r\n    !google.maps.geometry.spherical.computeDistanceBetween\r\n  ) {\r\n    return \"\";\r\n  }\r\n\r\n  const userPos = new google.maps.LatLng(lat, lng);\r\n  const MAX_DISTANCE = 999999999;\r\n  let closestLocation = null as ClockInGeoLocations | null;\r\n  let minDistance = MAX_DISTANCE;\r\n  for (let i = 0; i < locations.length; i++) {\r\n    const curLoc = locations[i];\r\n    if (!curLoc.lat || !curLoc.lng) {\r\n      continue;\r\n    }\r\n    const locPos = new google.maps.LatLng(curLoc.lat, curLoc.lng);\r\n    const distance =\r\n      google.maps.geometry.spherical.computeDistanceBetween(userPos, locPos) *\r\n        3.28084 -\r\n      curLoc.proximity;\r\n    if (distance < minDistance) {\r\n      minDistance = distance;\r\n      closestLocation = curLoc;\r\n    }\r\n  }\r\n\r\n  if (minDistance === MAX_DISTANCE) {\r\n    return \"\";\r\n  }\r\n\r\n  if (minDistance < 0) {\r\n    return \"At \" + closestLocation!.locationName;\r\n  }\r\n\r\n  const miles = minDistance * 0.000189394;\r\n  if (miles > 0.1) {\r\n    return `${Math.round((miles + Number.EPSILON) * 10) / 10} mi to ${\r\n      closestLocation!.locationName\r\n    }`;\r\n  }\r\n\r\n  return `${Math.round(minDistance)} ft to ${closestLocation!.locationName}`;\r\n}\r\n\r\n// -----------------------------------------------------------------------------------------------\r\n//\r\n// -----------------------------------------------------------------------------------------------\r\nconst Map: React.FC = () => {\r\n  const mapEle = useRef<HTMLDivElement | null>(null);\r\n  const map = useRef<google.maps.Map>();\r\n  const userCircle = useRef<google.maps.Circle>();\r\n  const { user } = React.useContext(ApplicationUserContext);\r\n  const [message, setMessage] = useState(\"\");\r\n  const [geoLocations, setGeoLocations] = useState([] as ClockInGeoLocations[]);\r\n  const [showMap, setShowMap] = useState(false);\r\n\r\n  // -----------------------------------------------------------------------------------------------\r\n  function onShowMapButtonClick() {\r\n    const newShowMap = !showMap;\r\n    setShowMap(newShowMap);\r\n    setMessage(\r\n      calculateNearestLocationMessage(\r\n        user.latitude,\r\n        user.longitude,\r\n        geoLocations\r\n      )\r\n    );\r\n  }\r\n\r\n  // -----------------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    console.log(\"MAP: useEffect running\");\r\n    if (mapEle.current === null || !user.latitude || !user.longitude) {\r\n      return;\r\n    }\r\n\r\n    if (map.current !== undefined) {\r\n      if (map.current && user.latitude && user.longitude) {\r\n        const userPos = new google.maps.LatLng(user.latitude, user.longitude);\r\n        map.current.setCenter(userPos);\r\n        if (userCircle.current) {\r\n          userCircle.current.setMap(null);\r\n        }\r\n\r\n        userCircle.current = new google.maps.Circle({\r\n          strokeColor: \"#FF0000\",\r\n          strokeOpacity: 0.8,\r\n          strokeWeight: 2,\r\n          fillColor: \"#FF0000\",\r\n          fillOpacity: 0.25,\r\n          radius: 6.5,\r\n          center: userPos,\r\n          map: map.current,\r\n        });\r\n      }\r\n\r\n      setMessage(\r\n        calculateNearestLocationMessage(\r\n          user.latitude,\r\n          user.longitude,\r\n          geoLocations\r\n        )\r\n      );\r\n\r\n      return;\r\n    }\r\n\r\n    map.current = new google.maps.Map(mapEle.current, {\r\n      center: {\r\n        lat: user.latitude,\r\n        lng: user.longitude,\r\n      },\r\n      zoom: 16,\r\n      disableDefaultUI: true,\r\n      fullscreenControl: false,\r\n    });\r\n\r\n    addMarkers();\r\n\r\n    google.maps.event.addListenerOnce(map.current, \"idle\", () => {\r\n      if (mapEle.current) {\r\n        mapEle.current.classList.add(\"show-map\");\r\n      }\r\n    });\r\n\r\n    function addMarkers() {\r\n      if (user.latitude && user.longitude) {\r\n        userCircle.current = new google.maps.Circle({\r\n          strokeColor: \"#FF0000\",\r\n          strokeOpacity: 0.8,\r\n          strokeWeight: 2,\r\n          fillColor: \"#FF0000\",\r\n          fillOpacity: 0.25,\r\n          radius: 6.5,\r\n          center: { lat: user!.latitude, lng: user!.longitude },\r\n          map: map.current,\r\n        });\r\n      }\r\n\r\n      timeclockApi.getGeoLocations(user).then((clockLocations) => {\r\n        setGeoLocations(clockLocations);\r\n        clockLocations.forEach((markerData) => {\r\n          const infoWindow = new google.maps.InfoWindow({\r\n            content: `<h5>${markerData.addr}</h5>`,\r\n          });\r\n\r\n          if (markerData.lat && markerData.lng) {\r\n            const position = new google.maps.LatLng(\r\n              markerData!.lat,\r\n              markerData!.lng\r\n            );\r\n\r\n            const marker = new google.maps.Marker({\r\n              position,\r\n              map: map.current!,\r\n              title: markerData.addr,\r\n            });\r\n\r\n            new google.maps.Circle({\r\n              strokeColor: \"#FF0000\",\r\n              strokeOpacity: 0.5,\r\n              strokeWeight: 1,\r\n              fillColor: \"#DD0000\",\r\n              fillOpacity: 0.2,\r\n              radius: markerData.proximity * 0.3048, // feet to meters\r\n              center: position,\r\n              map: map.current,\r\n            });\r\n            marker.addListener(\"click\", () => {\r\n              infoWindow.open(map.current!, marker);\r\n            });\r\n          }\r\n        });\r\n\r\n        setMessage(\r\n          calculateNearestLocationMessage(\r\n            user.latitude,\r\n            user.longitude,\r\n            clockLocations\r\n          )\r\n        );\r\n      });\r\n    }\r\n\r\n    // eslint-disable-next-line\r\n  }, [user, user.latitude, user.longitude, google, google.maps]);\r\n\r\n  return (\r\n    <>\r\n      <IonButton className=\"map-button\" onClick={onShowMapButtonClick}>\r\n        {message}\r\n        <IonIcon\r\n          id=\"show-map-button\"\r\n          icon={showMap ? arrowDownCircle : arrowUpCircle}\r\n        />\r\n      </IonButton>\r\n      <div id=\"map-container\" hidden={!showMap}>\r\n        <div ref={mapEle} className=\"map-canvas\" />\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Map;\r\n","import { IonAlert } from \"@ionic/react\";\nimport React, { useState } from \"react\";\n\nfunction useYesOrCancelDialogBox() {\n  const [isOpen, setIsOpen] = useState(false);\n  const [alertData, setAlertData] = useState({\n    message: \"\",\n    onCancel: () => {},\n    onYes: () => {},\n  });\n\n  const showDialog = (\n    message: string,\n    onYes: () => void,\n    onCancel: () => void\n  ) => {\n    setAlertData({\n      message,\n      onYes,\n      onCancel,\n    });\n\n    setIsOpen(true);\n  };\n\n  const dialogJsx = (\n    <IonAlert\n      isOpen={isOpen}\n      onDidDismiss={() => {\n        setIsOpen(false);\n      }}\n      message={alertData.message}\n      buttons={[\n        {\n          text: \"Cancel\",\n          role: \"cancel\",\n          cssClass: \"secondary\",\n          handler: alertData.onCancel,\n        },\n\n        {\n          text: \"Yes\",\n          handler: alertData.onYes,\n        },\n      ]}\n    />\n  );\n\n  return {\n    showDialog,\n    dialogJsx,\n  };\n}\n\nexport default useYesOrCancelDialogBox;\n","import React, { useEffect, useState } from \"react\";\r\n// import \"./ClockPanel.scss\";\r\nimport \"../../global-styles.scss\";\r\nimport { ApplicationUserContext } from \"../../context/ApplicationUserContext\";\r\nimport { AuthorizedItemsContext } from \"../../context/AuthorizedItemsContext\";\r\nimport { log } from \"../../util/logger\";\r\nimport authHelper from \"../../util/authitems-helper\";\r\nimport Map from \"./Map\";\r\nimport useYesOrCancelDialogBox from \"../../hooks/useYesOrCancelDialogBox\";\r\nimport useSimpleToast from \"../../hooks/useSimpleToast\";\r\n\r\ninterface GeoLocationComponentProps {\r\n  updateCallback: (lat?: number | undefined, lng?: number | undefined) => void;\r\n  isShowing: boolean;\r\n}\r\n\r\nconst GeoLocationComponent: React.FC<GeoLocationComponentProps> = ({\r\n  updateCallback,\r\n  isShowing,\r\n}: GeoLocationComponentProps) => {\r\n  const {\r\n    user,\r\n    startWatchPosition,\r\n    clearWatchPosition,\r\n    requestGeoPermission,\r\n    setRefusedGeoPermission,\r\n  } = React.useContext(ApplicationUserContext);\r\n  const { auth } = React.useContext(AuthorizedItemsContext);\r\n  const yesCancelDlg = useYesOrCancelDialogBox();\r\n  const [watchPositionId, setWatchPositionId] = useState(\"\");\r\n  const toast = useSimpleToast();\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (isShowing) {\r\n      if (\r\n        auth &&\r\n        auth.locations &&\r\n        auth.locations.length > 0 &&\r\n        authHelper.requiresGeolocation(auth.locations)\r\n      ) {\r\n        if (!user.requestedGeoPermission && !user.refusedGeoPermission) {\r\n          console.log(\"GeoLocationComponent: Prompting user\");\r\n          yesCancelDlg.showDialog(\r\n            \"To clock in/out, you may be required to provide your location. \" +\r\n              \"Do you want Team Dashboard to send location data?\",\r\n            () => {\r\n              requestGeoPermission();\r\n            },\r\n            () => {\r\n              setRefusedGeoPermission(true);\r\n            }\r\n          );\r\n        } else if (user.requestedGeoPermission && !user.refusedGeoPermission) {\r\n          const watchId = startWatchPosition((lat, lng, err) => {\r\n            log(\"geolocation_updated\", { user: user.username });\r\n\r\n            if (lat === undefined || lng === undefined) {\r\n              return;\r\n            }\r\n\r\n            if (err && err.length > 0) {\r\n              log(\"geolocation error: \" + err);\r\n              console.log(\"geolocation error: \" + err);\r\n              toast.showToast(\"Cannot read geolocation data\");\r\n              clearWatchPosition(watchId);\r\n            } else {\r\n              setTimeout(() => {\r\n                updateCallback(lat, lng);\r\n              }, 150);\r\n            }\r\n          });\r\n\r\n          setWatchPositionId(watchId);\r\n        }\r\n      }\r\n    } else {\r\n      if (\r\n        auth &&\r\n        auth.locations &&\r\n        auth.locations.length > 0 &&\r\n        authHelper.requiresGeolocation(auth.locations) &&\r\n        watchPositionId !== \"\"\r\n      ) {\r\n        console.log(\"GeoLocationComponent: stopping watch position\");\r\n        clearWatchPosition(watchPositionId);\r\n        setWatchPositionId(\"\");\r\n      }\r\n    }\r\n    // eslint-disable-next-line\r\n  }, [\r\n    isShowing,\r\n    auth,\r\n    auth.locations,\r\n    user.requestedGeoPermission,\r\n    user.refusedGeoPermission,\r\n  ]);\r\n\r\n  return (\r\n    <>\r\n      {auth &&\r\n        auth.locations &&\r\n        auth.locations.length > 0 &&\r\n        authHelper.requiresGeolocation(auth.locations) && <Map />}\r\n      {yesCancelDlg.dialogJsx}\r\n      {toast.simpleToastJsx}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default GeoLocationComponent;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport {\r\n  IonAlert,\r\n  IonLoading,\r\n  IonSelect,\r\n  IonModal,\r\n  IonItem,\r\n  IonLabel,\r\n  IonSelectOption,\r\n  IonIcon,\r\n  IonButton,\r\n  useIonViewWillEnter,\r\n  useIonViewWillLeave,\r\n} from \"@ionic/react\";\r\n// import \"./ClockPanel.scss\";\r\nimport \"../../global-styles.scss\";\r\nimport {\r\n  UnscheduledBreakOptions,\r\n  LocationSettings,\r\n  BreakType,\r\n} from \"../../orbital-interfaces/authorized-items\";\r\nimport { TimeClockSettingsData } from \"../../orbital-interfaces/TimeClockSettingsData\";\r\nimport { time, cafe } from \"ionicons/icons\";\r\nimport { ClockInRequirement } from \"../../enums/ClockInRequirement\";\r\nimport BreakSelectorModal, { BreakItem } from \"./BreakSelectorModal\";\r\nimport arrayHelper from \"../../util/array-helper\";\r\nimport timeClockApi from \"../../api/TimeClockAPI\";\r\nimport { format, parseISO } from \"date-fns\";\r\nimport { StartBreakResponseCode } from \"../../enums/StartBreakResponseCode\";\r\nimport { EndBreakResponseCode } from \"../../enums/EndBreakResponseCode\";\r\nimport { ApplicationUserContext } from \"../../context/ApplicationUserContext\";\r\nimport { AuthorizedItemsContext } from \"../../context/AuthorizedItemsContext\";\r\nimport ClockoutModal from \"./ClockoutModal\";\r\nimport SwitchPositionOrTagButton from \"./SwitchPositionOrTagButton\";\r\nimport { useInterval } from \"../../hooks/useInterval\";\r\nimport GeoLocationComponent from \"./GeoLocationComponent\";\r\nimport useSimpleToast from \"../../hooks/useSimpleToast\";\r\nimport { getConstants } from \"../../api/environment\";\r\n\r\ninterface ClockPanelProps {\r\n  onUpdate: () => void;\r\n  refreshToggle: boolean;\r\n}\r\n\r\ninterface List {\r\n  id: number;\r\n  name: string;\r\n}\r\n\r\nconst ClockPanel: React.FC<ClockPanelProps> = ({\r\n  onUpdate,\r\n  refreshToggle,\r\n}: ClockPanelProps) => {\r\n  const { user } = React.useContext(ApplicationUserContext);\r\n  const { auth } = React.useContext(AuthorizedItemsContext);\r\n  const [posList, setPosList] = useState([] as List[]);\r\n  const [selectedPosId, setSelectedPosId] = useState(0);\r\n  const [tagSwitchingEnabled, setTagSwitchingEnabled] = useState(false);\r\n  const [tagList, setTagList] = useState([] as List[]);\r\n  const [selectedTagId, setSelectedTagId] = useState(null as number | null);\r\n  const [breakSetting, setBreakSetting] = useState<\r\n    \"START BREAK\" | \"END BREAK\" | \"NONE\"\r\n  >(\"START BREAK\");\r\n  const [locSettings, setLocSettings] = useState({} as LocationSettings);\r\n  const [showBreakSelectorModal, setShowBreakSelectorModal] = useState(false);\r\n  const [showLoading, setShowLoading] = useState(false);\r\n  const [loadingMessage, setLoadingMessage] = useState(\"Please wait...\");\r\n  const [showAlertData, setShowAlertData] = useState({\r\n    show: false,\r\n    header: \"Alert\",\r\n    message: \"\",\r\n  });\r\n  const [tcData, setTCData] = useState(null as TimeClockSettingsData | null);\r\n  const [showClockoutModal, setShowClockoutModal] = useState(false);\r\n  const [refresh, setRefresh] = useState(false);\r\n  const [isShowing, setIsShowing] = useState(false);\r\n  const toast = useSimpleToast();\r\n\r\n  useIonViewWillEnter(() => {\r\n    setIsShowing(true);\r\n  });\r\n\r\n  useIonViewWillLeave(() => {\r\n    setIsShowing(false);\r\n  });\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    console.log(\r\n      \"ClockPanel: useEffect, refreshtoggle\",\r\n      refreshToggle,\r\n      \"refresh\",\r\n      refresh,\r\n      \"lat\",\r\n      user.latitude,\r\n      \"lng\",\r\n      user.longitude\r\n    );\r\n    if (refresh !== refreshToggle) {\r\n      setRefresh(refreshToggle);\r\n    }\r\n\r\n    updateTimeClockData();\r\n\r\n    // eslint-disable-next-line\r\n  }, [auth, refreshToggle]);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (!tcData || !auth || !auth.locations || auth.locations.length === 0) {\r\n      return;\r\n    }\r\n\r\n    if (tcData.ShowTimeClock) {\r\n      const uniqueLocationIds = arrayHelper.unique(\r\n        tcData.PositionsToClockInto.map((p) => p.LocationId)\r\n      );\r\n      const uniqueDeptIds = arrayHelper.unique(\r\n        tcData.PositionsToClockInto.map((p) => p.DepartmentId)\r\n      );\r\n      let plist: List[];\r\n      if (uniqueLocationIds.length > 1) {\r\n        plist = tcData.PositionsToClockInto.map((p) => {\r\n          return {\r\n            id: p.PositionId,\r\n            name: p.PositionNameWithLocAndDeptAbbreviation,\r\n          };\r\n        });\r\n      } else if (uniqueDeptIds.length > 1) {\r\n        plist = tcData.PositionsToClockInto.map((p) => {\r\n          return { id: p.PositionId, name: p.PositionNameWithDeptAbbreviation };\r\n        });\r\n      } else {\r\n        plist = tcData.PositionsToClockInto.map((p) => {\r\n          return { id: p.PositionId, name: p.PositionName };\r\n        });\r\n      }\r\n\r\n      let curPosId = selectedPosId;\r\n      if (curPosId === 0) {\r\n        if (tcData.UserClockedIn) {\r\n          curPosId = tcData.ClockedInScheduleEvent!.PositionId;\r\n          setSelectedPosId(curPosId);\r\n        } else if (\r\n          tcData.ScheduleEventsForClockIn &&\r\n          tcData.ScheduleEventsForClockIn.length > 0\r\n        ) {\r\n          curPosId = tcData.ScheduleEventsForClockIn[0].PositionId;\r\n          setSelectedPosId(curPosId);\r\n        } else if (plist.length > 0) {\r\n          curPosId = plist[0].id;\r\n          setSelectedPosId(curPosId);\r\n        } else {\r\n          curPosId = 0;\r\n        }\r\n      }\r\n\r\n      const curLocId = tcData.UserClockedIn\r\n        ? tcData.ClockedInScheduleEvent!.LocationId\r\n        : curPosId !== 0\r\n        ? auth.locations.filter((l) =>\r\n            l.departments.flatMap((d) =>\r\n              d.positions.flatMap((p) => p.id === curPosId)\r\n            )\r\n          )[0].id\r\n        : auth.locations[0].id;\r\n\r\n      const locSettings = auth.locations.filter((l) => l.id === curLocId)[0]\r\n        .settings;\r\n      setLocSettings(locSettings);\r\n\r\n      if (\r\n        locSettings.EnableEnhancedBreakManagement &&\r\n        (locSettings.UnscheduledBreakOptions !== UnscheduledBreakOptions.None ||\r\n          (tcData.ClockedInScheduleEvent!.EventBreaks &&\r\n            tcData.ClockedInScheduleEvent!.EventBreaks.length > 0))\r\n      ) {\r\n        setBreakSetting(\r\n          tcData.UserClockedIn && tcData.CurrentEventBreak\r\n            ? \"END BREAK\"\r\n            : \"START BREAK\"\r\n        );\r\n      } else {\r\n        setBreakSetting(\"NONE\");\r\n      }\r\n\r\n      setPosList(plist);\r\n      setTags(curPosId);\r\n    }\r\n    // eslint-disable-next-line\r\n  }, [auth, tcData]);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useInterval(\r\n    () => {\r\n      updateTimeClockData();\r\n    },\r\n    isShowing,\r\n    getConstants(user).refreshTimeclockSettingsTimer\r\n  );\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const updateTimeClockData = (\r\n    lat?: number | undefined,\r\n    lng?: number | undefined\r\n  ) => {\r\n    timeClockApi.getTimeClockSettings(user, lat, lng).then((results) => {\r\n      setTCData(results);\r\n    });\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const setTags = (currentPositionId: number): number => {\r\n    if (!tcData) {\r\n      return -1;\r\n    }\r\n\r\n    const curLocId = tcData.UserClockedIn\r\n      ? tcData.ClockedInScheduleEvent!.LocationId\r\n      : auth.locations.filter((l) =>\r\n          l.departments.flatMap((d) =>\r\n            d.positions.flatMap((p) => p.id === currentPositionId)\r\n          )\r\n        )[0].id;\r\n    const locSettings = auth.locations.filter((l) => l.id === curLocId)[0]\r\n      .settings;\r\n\r\n    if (\r\n      locSettings.ClockInWithDifferentTag &&\r\n      tcData.TagsPerPosition[currentPositionId] &&\r\n      tcData.TagsPerPosition[currentPositionId].length > 1\r\n    ) {\r\n      setTagSwitchingEnabled(true);\r\n      const tagList = tcData.TagsPerPosition[currentPositionId].map((t) => {\r\n        return { id: t.TagId, name: t.TagName };\r\n      });\r\n      tagList.unshift({ id: -1, name: \"NONE\" });\r\n      setTagList(tagList);\r\n    } else {\r\n      setTagSwitchingEnabled(false);\r\n      return -1;\r\n    }\r\n\r\n    let tagId = -1;\r\n    if (tcData.UserClockedIn) {\r\n      if (tcData.ClockedInScheduleEvent!.TagId) {\r\n        tagId = tcData.ClockedInScheduleEvent!.TagId;\r\n      } else if (tcData.ClockedInScheduleEvent!.TagId === null) {\r\n        tagId = -1;\r\n      } else {\r\n        tagId = -1;\r\n      }\r\n    } else if (\r\n      tcData.TagsPerPosition[currentPositionId] &&\r\n      tcData.TagsPerPosition[currentPositionId].length > 0\r\n    ) {\r\n      if (\r\n        tcData.ScheduleEventsForClockIn &&\r\n        tcData.ScheduleEventsForClockIn[0] &&\r\n        tcData.ScheduleEventsForClockIn[0].TagId\r\n      ) {\r\n        tagId = tcData.ScheduleEventsForClockIn[0].TagId;\r\n      } else {\r\n        tagId = -1;\r\n      }\r\n    }\r\n\r\n    setSelectedTagId(tagId);\r\n    return tagId;\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onPositionChange = (newVal: number) => {\r\n    setSelectedPosId(newVal);\r\n    setTags(newVal);\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onTagChange = (newVal: number) => {\r\n    setSelectedTagId(newVal);\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const showAlert = (header: string, message: string) => {\r\n    setShowAlertData({ show: true, header, message });\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onBreakSelectorModalClose = (brk: BreakItem) => {\r\n    if (!tcData) {\r\n      return;\r\n    }\r\n\r\n    setShowBreakSelectorModal(false);\r\n    if (brk.key === \"Cancel\") {\r\n      return;\r\n    }\r\n\r\n    setLoadingMessage(\"Starting Break...\");\r\n    setShowLoading(true);\r\n\r\n    timeClockApi\r\n      .startBreak(\r\n        user,\r\n        tcData.ClockedInScheduleEvent!,\r\n        tcData.ScheduleEventsForClockIn[0],\r\n        brk.breakType,\r\n        brk.breakType === BreakType.Scheduled ? brk.key : undefined\r\n      )\r\n      .then((response) => {\r\n        setShowLoading(false);\r\n        if (\r\n          response.StartBreakResponseCode === StartBreakResponseCode.Success\r\n        ) {\r\n          toast.showToast(\r\n            \"Break started at \" +\r\n              format(parseISO(response.BreakStart), \"h:mmaaa\")\r\n          );\r\n          onUpdate();\r\n          updateTimeClockData();\r\n        } else {\r\n          showAlert(\r\n            \"Could not start break\",\r\n            `Unable to start break, ${response.Message}`\r\n          );\r\n        }\r\n      });\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const clockout = (clockOutValue?: number) => {\r\n    if (showClockoutModal) {\r\n      setShowClockoutModal(false);\r\n    }\r\n\r\n    setLoadingMessage(\"Clocking Out...\");\r\n    setShowLoading(true);\r\n\r\n    timeClockApi.clockOut(user, clockOutValue).then((response) => {\r\n      setShowLoading(false);\r\n      if (response.ClockOutResponseCode === 0) {\r\n        toast.showToast(\r\n          \"Clocked out at \" +\r\n            format(parseISO(response.ClockOutEvent.EventEnd), \"h:mmaaa\")\r\n        );\r\n        onUpdate();\r\n        updateTimeClockData();\r\n      } else {\r\n        showAlert(\r\n          \"Could not Clock Out\",\r\n          `Unable to Clock out, ${response.Message}`\r\n        );\r\n      }\r\n    });\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onClockOutClick = () => {\r\n    if (locSettings.ClockOutValueLabel) {\r\n      setShowClockoutModal(true);\r\n    } else {\r\n      clockout();\r\n    }\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onClockInClick = () => {\r\n    setLoadingMessage(\"Clocking in...\");\r\n    setShowLoading(true);\r\n\r\n    timeClockApi\r\n      .clockIn(user, selectedPosId, selectedTagId)\r\n      .then((response) => {\r\n        setShowLoading(false);\r\n        if (response.ClockInResponseCode === 0) {\r\n          toast.showToast(\r\n            \"Clocked in at \" +\r\n              format(parseISO(response.ClockInEvent.EventStart), \"h:mmaaa\")\r\n          );\r\n          onUpdate();\r\n          updateTimeClockData();\r\n        } else {\r\n          showAlert(\r\n            \"Could not Clock In\",\r\n            `Unable to Clock in, ${response.Message}`\r\n          );\r\n        }\r\n      });\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onBreakButtonClick = () => {\r\n    if (breakSetting === \"NONE\" || !tcData) {\r\n      return;\r\n    }\r\n\r\n    if (breakSetting === \"END BREAK\") {\r\n      setLoadingMessage(\"Ending Break...\");\r\n      setShowLoading(true);\r\n\r\n      timeClockApi\r\n        .endBreak(\r\n          user,\r\n          tcData.ClockedInScheduleEvent!,\r\n          tcData.ScheduleEventsForClockIn.length > 0\r\n            ? tcData.ScheduleEventsForClockIn[0]\r\n            : null\r\n        )\r\n        .then((response) => {\r\n          setShowLoading(false);\r\n          if (response.EndBreakResponseCode === EndBreakResponseCode.Success) {\r\n            toast.showToast(\r\n              `Ended break at ${format(parseISO(response.BreakEnd), \"h:mmaaa\")}`\r\n            );\r\n            onUpdate();\r\n            updateTimeClockData();\r\n          } else {\r\n            showAlert(\"Did not come off break\", response.Message);\r\n          }\r\n        });\r\n\r\n      return;\r\n    }\r\n\r\n    if (\r\n      locSettings.UnscheduledBreakOptions !== UnscheduledBreakOptions.None ||\r\n      (tcData.ClockedInScheduleEvent!.EventBreaks &&\r\n        tcData.ClockedInScheduleEvent!.EventBreaks.length > 0)\r\n    ) {\r\n      setShowBreakSelectorModal(true);\r\n    } else {\r\n      showAlert(\r\n        \"No implemented\",\r\n        \"Not implemented in ClockPanel.tsx for this scenario\"\r\n      );\r\n    }\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onSwitchClick = () => {\r\n    setLoadingMessage(\"Switching...\");\r\n    setShowLoading(true);\r\n\r\n    timeClockApi\r\n      .switchPositionOrTag(user, selectedPosId, selectedTagId)\r\n      .then((response) => {\r\n        setShowLoading(false);\r\n        if (response.AllowedToSwitchPositions || response.AllowedToSwitchTags) {\r\n          toast.showToast(\"Switched\");\r\n          onUpdate();\r\n          updateTimeClockData();\r\n        } else {\r\n          showAlert(\r\n            \"Could not switch\",\r\n            `${response.ClockInMessage} ${response.ClockOutMessage}`\r\n          );\r\n        }\r\n      });\r\n  };\r\n\r\n  if (!auth || !tcData) {\r\n    return <div>Loading...</div>;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {toast.simpleToastJsx}\r\n      <IonLoading\r\n        isOpen={showLoading}\r\n        onDidDismiss={() => setShowLoading(false)}\r\n        spinner=\"dots\"\r\n        message={loadingMessage}\r\n      />\r\n\r\n      <div className=\"clock-controls\">\r\n        <GeoLocationComponent\r\n          updateCallback={updateTimeClockData}\r\n          isShowing={isShowing}\r\n        />\r\n\r\n        {tcData.PositionsToClockInto && tcData.PositionsToClockInto.length > 1 && (\r\n          <IonItem className=\"item-no-border\">\r\n            <IonLabel>Position</IonLabel>\r\n            <IonSelect\r\n              interface=\"action-sheet\"\r\n              onIonChange={(e) => onPositionChange(e.detail.value)}\r\n              disabled={\r\n                !(\r\n                  ((tcData.UserClockedIn && tcData.UserMayClockOut) ||\r\n                    (!tcData.UserClockedIn && tcData.UserMayClockIn)) &&\r\n                  locSettings.ClockInRequirement !==\r\n                    ClockInRequirement.MatchingShift\r\n                )\r\n              }\r\n              value={selectedPosId}\r\n            >\r\n              {posList.map((pos) => (\r\n                <IonSelectOption key={pos.id} value={pos.id}>\r\n                  {pos.name}\r\n                </IonSelectOption>\r\n              ))}\r\n            </IonSelect>\r\n          </IonItem>\r\n        )}\r\n\r\n        {tagSwitchingEnabled && (\r\n          <IonItem className=\"item-no-border\">\r\n            <IonLabel>~Tag</IonLabel>\r\n            <IonSelect\r\n              interface=\"action-sheet\"\r\n              onIonChange={(e) => onTagChange(e.detail.value)}\r\n              disabled={\r\n                !(\r\n                  ((tcData.UserClockedIn && tcData.UserMayClockOut) ||\r\n                    (!tcData.UserClockedIn && tcData.UserMayClockIn)) &&\r\n                  locSettings.ClockInRequirement !==\r\n                    ClockInRequirement.MatchingShift\r\n                )\r\n              }\r\n              value={selectedTagId}\r\n            >\r\n              {tagList.map((t) => (\r\n                <IonSelectOption key={t.id} value={t.id}>\r\n                  {t.name}\r\n                </IonSelectOption>\r\n              ))}\r\n            </IonSelect>\r\n          </IonItem>\r\n        )}\r\n\r\n        <SwitchPositionOrTagButton\r\n          tcData={tcData}\r\n          locSettings={locSettings}\r\n          selectedPosId={selectedPosId}\r\n          selectedTagId={selectedTagId}\r\n          onSwitch={onSwitchClick}\r\n        />\r\n        {!tcData.UserClockedIn && (\r\n          <div className=\"clockin-button-container\">\r\n            <IonButton\r\n              className=\"clockin-button\"\r\n              onClick={onClockInClick}\r\n              disabled={!tcData.UserMayClockIn}\r\n            >\r\n              <IonIcon mode=\"md\" style={{ paddingRight: \"5px\" }} icon={time} />{\" \"}\r\n              CLOCK IN\r\n            </IonButton>\r\n          </div>\r\n        )}\r\n        {tcData.UserClockedIn && (\r\n          <div className=\"clockout-button-container\">\r\n            <IonButton\r\n              className=\"clockout-button\"\r\n              disabled={!tcData.UserMayClockOut}\r\n              expand=\"block\"\r\n              onClick={onClockOutClick}\r\n            >\r\n              CLOCK OUT{\" \"}\r\n              <IonIcon mode=\"md\" style={{ paddingLeft: \"5px\" }} icon={time} />\r\n            </IonButton>\r\n\r\n            {breakSetting !== \"NONE\" && (\r\n              <IonButton\r\n                onClick={onBreakButtonClick}\r\n                expand=\"block\"\r\n                className=\"break-button\"\r\n                disabled={!tcData.UserMayClockOut}\r\n              >\r\n                <IonIcon icon={cafe} />\r\n                {breakSetting}\r\n              </IonButton>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      <IonModal isOpen={showBreakSelectorModal} cssClass=\"break-selector-modal\">\r\n        <BreakSelectorModal\r\n          auth={auth}\r\n          tcData={tcData}\r\n          onDismissModal={(selection) => onBreakSelectorModalClose(selection)}\r\n        />\r\n      </IonModal>\r\n\r\n      <IonModal\r\n        cssClass=\"clockout-modal\"\r\n        isOpen={showClockoutModal}\r\n        onDidDismiss={() => {\r\n          setShowClockoutModal(false);\r\n        }}\r\n      >\r\n        <ClockoutModal\r\n          onCancel={() => {\r\n            setShowClockoutModal(false);\r\n          }}\r\n          onOk={clockout}\r\n          locSettings={locSettings}\r\n        />\r\n      </IonModal>\r\n\r\n      <IonAlert\r\n        isOpen={showAlertData.show}\r\n        onDidDismiss={() => setShowAlertData({ ...showAlertData, show: false })}\r\n        header={showAlertData.header}\r\n        message={showAlertData.message}\r\n        buttons={[\"OK\"]}\r\n      />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ClockPanel;\r\n","import React from \"react\";\n// import \"./PayrollPeriodChooser.scss\";\nimport \"../../global-styles.scss\";\nimport { IonIcon } from \"@ionic/react\";\nimport { arrowBack, arrowForward } from \"ionicons/icons\";\nimport { addDays, format } from \"date-fns\";\n\ninterface PayrollPeriodChooserProps {\n  startDate: Date | null;\n  endDate: Date | null;\n  onNextPayPeriod: () => void;\n  onPrevPayPeriod: () => void;\n}\n\nfunction getPayPeriodDateText(start: Date | null, end: Date | null) {\n  if (!start || !end) {\n    return \" \";\n  }\n\n  if (start.getMonth() !== end.getMonth()) {\n    return (\n      format(start, \"MMM d\").toUpperCase() +\n      \" - \" +\n      format(addDays(end, -1), \"MMM d\").toUpperCase()\n    );\n  }\n\n  return (\n    format(start, \"MMM d\").toUpperCase() + \" - \" + format(addDays(end, -1), \"d\")\n  );\n}\n\n// --------------------------------------------------------------------------------------\n//\n// --------------------------------------------------------------------------------------\nconst PayrollPeriodChooser: React.FC<PayrollPeriodChooserProps> = ({\n  startDate,\n  endDate,\n  onNextPayPeriod,\n  onPrevPayPeriod,\n}: PayrollPeriodChooserProps) => {\n  const isLoading = startDate === null || endDate === null;\n  const payPeriodDateText = isLoading\n    ? \"\"\n    : getPayPeriodDateText(startDate, endDate);\n\n  return (\n    <div className=\"chooser\">\n      <div className=\"top\">\n        <button onClick={onPrevPayPeriod} className=\"arrow\" key={-1}>\n          <IonIcon mode=\"ios\" icon={arrowBack} />\n        </button>\n\n        <div className=\"month-year-container\">\n          <div className=\"datetime-picker-container\">\n            <div className=\"datetime-picker\">{payPeriodDateText}</div>\n          </div>\n        </div>\n\n        <button onClick={onNextPayPeriod} className=\"arrow\" key={7}>\n          <IonIcon mode=\"ios\" icon={arrowForward} />\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default PayrollPeriodChooser;\n","import { ApplicationUser } from \"../context/ApplicationUserContext\";\r\nimport apiHelper from \"./OrbitalApiHelper\";\r\nimport { formatDateTimeAsMvcString } from \"../util/time-helper\";\r\nimport { OrbitalTime } from \"../orbital-interfaces/OrbitalTime\";\r\n\r\nexport interface PayrollPeriodHoursPerAbsent {\r\n  absentId: number;\r\n  time: OrbitalTime;\r\n}\r\n\r\nexport interface PayrollPeriodDateItem {\r\n  date: string;\r\n  regular: OrbitalTime;\r\n  dailyOvertime: OrbitalTime;\r\n  weeklyOvertime: OrbitalTime;\r\n  special: OrbitalTime;\r\n  absent: OrbitalTime;\r\n  timePerAbsent: PayrollPeriodHoursPerAbsent[];\r\n}\r\n\r\nexport interface PayrollPeriodData {\r\n  start: string;\r\n  end: string;\r\n  list: PayrollPeriodDateItem[];\r\n  error: boolean;\r\n  message: string;\r\n  totalRegular: OrbitalTime;\r\n  totalWeeklyOvertime: OrbitalTime;\r\n  totalDailyOvertime: OrbitalTime;\r\n  totalAbsent: OrbitalTime;\r\n  totalSpecial: OrbitalTime;\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst getPayPeriodDateForEmployee = async (\r\n  user: ApplicationUser,\r\n  locationId: number,\r\n  date: Date\r\n) => {\r\n  const dateStr = formatDateTimeAsMvcString(date);\r\n  return (await apiHelper.get(\r\n    user,\r\n    \"api/v2/payroll/get/\" + locationId + \"/\" + dateStr\r\n  )) as PayrollPeriodData;\r\n};\r\n\r\nexport default {\r\n  getPayPeriodDateForEmployee,\r\n};\r\n","import React from \"react\";\r\nimport { OrbitalTime } from \"../../orbital-interfaces/OrbitalTime\";\r\nimport { LocationSettings } from \"../../orbital-interfaces/authorized-items\";\r\nimport { getTimeStringFromOrbitalTime } from \"../../util/time-helper\";\r\ninterface PayrollDetailListProps {\r\n  time: OrbitalTime | null;\r\n  locSettings: LocationSettings;\r\n  fontColor: string;\r\n}\r\n\r\nfunction getHoursString(locsettings: LocationSettings, time: OrbitalTime) {\r\n  return getTimeStringFromOrbitalTime(locsettings, time);\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst PayrollOrbitalTimeItem: React.FC<PayrollDetailListProps> = ({\r\n  time,\r\n  locSettings,\r\n  fontColor,\r\n}: PayrollDetailListProps) => {\r\n  if (time === null) {\r\n    return <span> -- </span>;\r\n  }\r\n\r\n  const displayColor = time.ActualHours === 0.0 ? \"#ddd\" : fontColor;\r\n\r\n  return (\r\n    <span style={{ color: displayColor }}>\r\n      {getHoursString(locSettings, time)}\r\n    </span>\r\n  );\r\n};\r\n\r\nexport default PayrollOrbitalTimeItem;\r\n","import React, { useContext } from \"react\";\r\nimport {\r\n  IonContent,\r\n  IonRow,\r\n  IonCol,\r\n  IonButton,\r\n  IonFooter,\r\n  IonGrid,\r\n  IonHeader,\r\n  IonTitle,\r\n  IonToolbar,\r\n} from \"@ionic/react\";\r\n// import \"./PayrollDetailModal.scss\";\r\nimport \"../../global-styles.scss\";\r\nimport { parseISO } from \"date-fns\";\r\nimport { PayrollPeriodDateItem } from \"../../api/PayrollPeriodAPI\";\r\nimport { getDateString } from \"../../util/time-helper\";\r\nimport {\r\n  AuthorizedItems,\r\n  LocationSettings,\r\n} from \"../../orbital-interfaces/authorized-items\";\r\nimport PayrollOrbitalTimeItem from \"./PayrollOrbitalTimeItem\";\r\nimport { AuthorizedItemsContext } from \"../../context/AuthorizedItemsContext\";\r\n\r\ninterface AddBreakModalProps {\r\n  onClose: () => void;\r\n  data: PayrollPeriodDateItem;\r\n  locSettings: LocationSettings;\r\n}\r\n\r\nfunction getAbsentName(auth: AuthorizedItems, id: number) {\r\n  return auth.payrollEvents.filter((pe) => pe.id === id)[0].name;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst PayrollDetailModal: React.FC<AddBreakModalProps> = ({\r\n  onClose,\r\n  data,\r\n  locSettings,\r\n}: AddBreakModalProps) => {\r\n  const { auth } = useContext(AuthorizedItemsContext);\r\n\r\n  if (!data) {\r\n    return <div>loading</div>;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <IonContent>\r\n        <IonHeader mode=\"ios\">\r\n          <IonToolbar>\r\n            <IonTitle>{getDateString(parseISO(data.date))}</IonTitle>\r\n          </IonToolbar>\r\n        </IonHeader>\r\n        <IonGrid>\r\n          {data.regular.ActualHours > 0.0 && (\r\n            <IonRow>\r\n              <IonCol size=\"7\">Regular</IonCol>\r\n              <IonCol size=\"5\">\r\n                <PayrollOrbitalTimeItem\r\n                  time={data.regular}\r\n                  locSettings={locSettings}\r\n                  fontColor=\"black\"\r\n                />\r\n              </IonCol>\r\n            </IonRow>\r\n          )}\r\n\r\n          {data.dailyOvertime.ActualHours > 0.0 && (\r\n            <IonRow>\r\n              <IonCol size=\"7\">Daily Overtime</IonCol>\r\n              <IonCol size=\"5\">\r\n                <PayrollOrbitalTimeItem\r\n                  time={data.dailyOvertime}\r\n                  locSettings={locSettings}\r\n                  fontColor=\"red\"\r\n                />\r\n              </IonCol>\r\n            </IonRow>\r\n          )}\r\n\r\n          {data.weeklyOvertime.ActualHours > 0.0 && (\r\n            <IonRow>\r\n              <IonCol size=\"7\">Weekly Overtime</IonCol>\r\n              <IonCol size=\"5\">\r\n                <PayrollOrbitalTimeItem\r\n                  time={data.weeklyOvertime}\r\n                  locSettings={locSettings}\r\n                  fontColor=\"red\"\r\n                />\r\n              </IonCol>\r\n            </IonRow>\r\n          )}\r\n\r\n          {data.special.ActualHours > 0.0 && (\r\n            <IonRow>\r\n              <IonCol size=\"7\">Special Dates</IonCol>\r\n              <IonCol size=\"5\">\r\n                <PayrollOrbitalTimeItem\r\n                  time={data.special}\r\n                  locSettings={locSettings}\r\n                  fontColor=\"black\"\r\n                />\r\n              </IonCol>\r\n            </IonRow>\r\n          )}\r\n\r\n          {data.timePerAbsent &&\r\n            data.timePerAbsent.map((hpa) => {\r\n              return (\r\n                <IonRow key={hpa.absentId}>\r\n                  <IonCol size=\"7\">{getAbsentName(auth, hpa.absentId)}</IonCol>\r\n                  <IonCol size=\"5\">\r\n                    <PayrollOrbitalTimeItem\r\n                      time={hpa.time}\r\n                      locSettings={locSettings}\r\n                      fontColor=\"#AD850C\"\r\n                    />\r\n                  </IonCol>\r\n                </IonRow>\r\n              );\r\n            })}\r\n        </IonGrid>\r\n      </IonContent>\r\n      <IonFooter>\r\n        <IonButton expand=\"block\" onClick={onClose}>\r\n          CLOSE\r\n        </IonButton>\r\n      </IonFooter>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PayrollDetailModal;\r\n","import React, { useContext, useState } from \"react\";\r\nimport { IonRow, IonCol, IonModal } from \"@ionic/react\";\r\nimport { format, parseISO } from \"date-fns\";\r\nimport { PayrollPeriodDateItem } from \"../../api/PayrollPeriodAPI\";\r\nimport PayrollOrbitalTimeItem from \"./PayrollOrbitalTimeItem\";\r\nimport { AuthorizedItemsContext } from \"../../context/AuthorizedItemsContext\";\r\nimport authHelper from \"../../util/authitems-helper\";\r\nimport { ColumnEnum } from \"./PayrollDetailList\";\r\nimport PayrollDetailModal from \"./PayrollDetailModal\";\r\nimport Skeleton from \"react-loading-skeleton\";\r\n\r\ninterface PayrollDetailListProps {\r\n  payrollRow: PayrollPeriodDateItem | null;\r\n  colsToDisplay: ColumnEnum;\r\n  colSize: string;\r\n}\r\n\r\nfunction formatDateString(d: string) {\r\n  // return format(parseISO(d), \"EEE d\").toUpperCase();\r\n  return format(parseISO(d), \"EEE d\");\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst PayrollDetailRow: React.FC<PayrollDetailListProps> = ({\r\n  payrollRow,\r\n  colsToDisplay,\r\n  colSize,\r\n}: PayrollDetailListProps) => {\r\n  const { auth } = useContext(AuthorizedItemsContext);\r\n  const locSettings = authHelper.getLocSettingsForLocationId(\r\n    auth,\r\n    auth.locations[0].id\r\n  );\r\n  const [showDetailModal, setShowDetailModal] = useState(false);\r\n\r\n  if (payrollRow === null) {\r\n    return (\r\n      <IonRow>\r\n        <IonCol size=\"3\">\r\n          <Skeleton width={50} />\r\n        </IonCol>\r\n        <IonCol size=\"3\">\r\n          <Skeleton width={50} />\r\n        </IonCol>\r\n        <IonCol size=\"3\">\r\n          <Skeleton width={50} />\r\n        </IonCol>\r\n        <IonCol size=\"3\">\r\n          <Skeleton width={50} />\r\n        </IonCol>\r\n      </IonRow>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <IonRow>\r\n        <IonCol size={colSize}>\r\n          <button\r\n            className=\"payperiod-list-buttons\"\r\n            onClick={() => setShowDetailModal(true)}\r\n          >\r\n            {formatDateString(payrollRow!.date)}\r\n          </button>\r\n        </IonCol>\r\n\r\n        <IonCol\r\n          size={colSize}\r\n          color=\"secondary\"\r\n          hidden={(colsToDisplay & ColumnEnum.Regular) !== ColumnEnum.Regular}\r\n        >\r\n          <PayrollOrbitalTimeItem\r\n            time={payrollRow?.regular}\r\n            locSettings={locSettings}\r\n            fontColor=\"black\"\r\n          />\r\n        </IonCol>\r\n\r\n        <IonCol\r\n          size={colSize}\r\n          hidden={\r\n            (colsToDisplay & ColumnEnum.DailyOvertime) !==\r\n            ColumnEnum.DailyOvertime\r\n          }\r\n        >\r\n          <PayrollOrbitalTimeItem\r\n            time={payrollRow?.dailyOvertime}\r\n            locSettings={locSettings}\r\n            fontColor=\"red\"\r\n          />\r\n        </IonCol>\r\n\r\n        <IonCol\r\n          size={colSize}\r\n          hidden={\r\n            (colsToDisplay & ColumnEnum.WeeklyOvertime) !==\r\n            ColumnEnum.WeeklyOvertime\r\n          }\r\n        >\r\n          <PayrollOrbitalTimeItem\r\n            time={payrollRow?.weeklyOvertime}\r\n            locSettings={locSettings}\r\n            fontColor=\"red\"\r\n          />\r\n        </IonCol>\r\n\r\n        <IonCol\r\n          size={colSize}\r\n          hidden={(colsToDisplay & ColumnEnum.Special) !== ColumnEnum.Special}\r\n        >\r\n          <PayrollOrbitalTimeItem\r\n            time={payrollRow?.special}\r\n            locSettings={locSettings}\r\n            fontColor=\"black\"\r\n          />\r\n        </IonCol>\r\n\r\n        <IonCol\r\n          size={colSize}\r\n          hidden={(colsToDisplay & ColumnEnum.Absent) !== ColumnEnum.Absent}\r\n        >\r\n          <PayrollOrbitalTimeItem\r\n            time={payrollRow?.absent}\r\n            locSettings={locSettings}\r\n            fontColor=\"black\"\r\n          />\r\n        </IonCol>\r\n      </IonRow>\r\n\r\n      <IonModal\r\n        cssClass=\"detail-modal\"\r\n        isOpen={showDetailModal}\r\n        onDidDismiss={() => setShowDetailModal(false)}\r\n      >\r\n        <PayrollDetailModal\r\n          onClose={() => setShowDetailModal(false)}\r\n          locSettings={locSettings}\r\n          data={payrollRow!}\r\n        />\r\n      </IonModal>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PayrollDetailRow;\r\n","import React, { useContext, useEffect, useState } from \"react\";\r\nimport { IonGrid, IonRow, IonCol } from \"@ionic/react\";\r\nimport { PayrollPeriodData } from \"../../api/PayrollPeriodAPI\";\r\n// import \"./PayrollDetailList.scss\";\r\nimport \"../../global-styles.scss\";\r\nimport PayrollDetailRow from \"./PayrollDetailRow\";\r\nimport { AuthorizedItemsContext } from \"../../context/AuthorizedItemsContext\";\r\nimport authHelper from \"../../util/authitems-helper\";\r\nimport PayrollOrbitalTimeItem from \"./PayrollOrbitalTimeItem\";\r\nimport Skeleton from \"react-loading-skeleton\";\r\n\r\ninterface PayrollDetailListProps {\r\n  payrollData: PayrollPeriodData | null;\r\n}\r\n\r\nexport enum ColumnEnum {\r\n  None = 0,\r\n  Regular = 1 << 0,\r\n  DailyOvertime = 1 << 1,\r\n  WeeklyOvertime = 1 << 2,\r\n  Special = 1 << 3,\r\n  Absent = 1 << 4,\r\n  All = ~(~0 << 5),\r\n}\r\n\r\nfunction getColumnsToDisplay(\r\n  payrollData: PayrollPeriodData\r\n): { count: number; cols: ColumnEnum } {\r\n  let cols = ColumnEnum.Regular;\r\n  let count = 2;\r\n\r\n  if (payrollData.totalDailyOvertime.ActualHours > 0.0) {\r\n    cols |= ColumnEnum.DailyOvertime;\r\n    count++;\r\n  }\r\n\r\n  if (payrollData.totalWeeklyOvertime.ActualHours > 0.0) {\r\n    cols |= ColumnEnum.WeeklyOvertime;\r\n    count++;\r\n  }\r\n\r\n  if (payrollData.totalSpecial.ActualHours > 0.0) {\r\n    cols |= ColumnEnum.Special;\r\n    count++;\r\n  }\r\n\r\n  if (payrollData.totalAbsent.ActualHours > 0.0) {\r\n    cols |= ColumnEnum.Absent;\r\n    count++;\r\n  }\r\n\r\n  return { cols, count };\r\n}\r\n// --------------------------------------------------------------------------------------\r\nconst PayrollDetailList: React.FC<PayrollDetailListProps> = ({\r\n  payrollData,\r\n}: PayrollDetailListProps) => {\r\n  const { auth } = useContext(AuthorizedItemsContext);\r\n  const locSettings = authHelper.getLocSettingsForLocationId(\r\n    auth,\r\n    auth.locations[0].id\r\n  );\r\n  const [colsToDisplay, setColsToDisplay] = useState(ColumnEnum.None);\r\n  const [colSize, setColSize] = useState(\"3\");\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (!payrollData) {\r\n      return;\r\n    }\r\n\r\n    const { count, cols } = getColumnsToDisplay(payrollData);\r\n    setColsToDisplay(cols);\r\n    setColSize(count >= 5 ? \"2\" : \"3\");\r\n  }, [payrollData]);\r\n\r\n  if (payrollData === null) {\r\n    return (\r\n      <div className=\"grid-container\">\r\n        <IonGrid class=\"ion-text-end\">\r\n          <IonRow className=\"list-header\" class=\"ion-text-center\">\r\n            <IonCol size=\"3\">\r\n              <Skeleton width={60} />\r\n            </IonCol>\r\n            <IonCol size=\"3\">\r\n              <Skeleton width={60} />\r\n            </IonCol>\r\n            <IonCol size=\"3\">\r\n              <Skeleton width={60} />\r\n            </IonCol>\r\n            <IonCol size=\"3\">\r\n              <Skeleton width={60} />\r\n            </IonCol>\r\n          </IonRow>\r\n          {[1, 2, 3, 4, 5, 6, 7, 8, 9, 10].map((x) => {\r\n            return (\r\n              <PayrollDetailRow\r\n                payrollRow={null}\r\n                colSize=\"3\"\r\n                colsToDisplay={ColumnEnum.None}\r\n                key={x}\r\n              />\r\n            );\r\n          })}\r\n        </IonGrid>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"grid-container\">\r\n      <IonGrid class=\"ion-text-end\">\r\n        <IonRow className=\"list-header\" class=\"ion-text-center\">\r\n          <IonCol size={colSize}>DATE</IonCol>\r\n          <IonCol\r\n            size={colSize}\r\n            hidden={(colsToDisplay & ColumnEnum.Regular) !== ColumnEnum.Regular}\r\n          >\r\n            REG\r\n          </IonCol>\r\n          <IonCol\r\n            size={colSize}\r\n            hidden={\r\n              (colsToDisplay & ColumnEnum.DailyOvertime) !==\r\n              ColumnEnum.DailyOvertime\r\n            }\r\n          >\r\n            DAILY OT\r\n          </IonCol>\r\n          <IonCol\r\n            size={colSize}\r\n            hidden={\r\n              (colsToDisplay & ColumnEnum.WeeklyOvertime) !==\r\n              ColumnEnum.WeeklyOvertime\r\n            }\r\n          >\r\n            WKLY OT\r\n          </IonCol>\r\n          <IonCol\r\n            size={colSize}\r\n            hidden={(colsToDisplay & ColumnEnum.Special) !== ColumnEnum.Special}\r\n          >\r\n            SPECIAL\r\n          </IonCol>\r\n          <IonCol\r\n            size={colSize}\r\n            hidden={(colsToDisplay & ColumnEnum.Absent) !== ColumnEnum.Absent}\r\n          >\r\n            ABSENT\r\n          </IonCol>\r\n        </IonRow>\r\n        {payrollData?.list.map((row) => (\r\n          <PayrollDetailRow\r\n            key={row.date}\r\n            payrollRow={row}\r\n            colsToDisplay={colsToDisplay}\r\n            colSize={colSize}\r\n          />\r\n        ))}\r\n        <IonRow className=\"list-footer\">\r\n          <IonCol size={colSize}>TOTAL</IonCol>\r\n          <IonCol\r\n            size={colSize}\r\n            hidden={(colsToDisplay & ColumnEnum.Regular) !== ColumnEnum.Regular}\r\n          >\r\n            <PayrollOrbitalTimeItem\r\n              time={payrollData?.totalRegular}\r\n              locSettings={locSettings}\r\n              fontColor=\"black\"\r\n            />\r\n          </IonCol>\r\n          <IonCol\r\n            size={colSize}\r\n            hidden={\r\n              (colsToDisplay & ColumnEnum.DailyOvertime) !==\r\n              ColumnEnum.DailyOvertime\r\n            }\r\n          >\r\n            <PayrollOrbitalTimeItem\r\n              time={payrollData?.totalDailyOvertime}\r\n              locSettings={locSettings}\r\n              fontColor=\"red\"\r\n            />\r\n          </IonCol>\r\n          <IonCol\r\n            size={colSize}\r\n            hidden={\r\n              (colsToDisplay & ColumnEnum.WeeklyOvertime) !==\r\n              ColumnEnum.WeeklyOvertime\r\n            }\r\n          >\r\n            <PayrollOrbitalTimeItem\r\n              time={payrollData?.totalWeeklyOvertime}\r\n              locSettings={locSettings}\r\n              fontColor=\"red\"\r\n            />\r\n          </IonCol>\r\n          <IonCol\r\n            size={colSize}\r\n            hidden={(colsToDisplay & ColumnEnum.Special) !== ColumnEnum.Special}\r\n          >\r\n            <PayrollOrbitalTimeItem\r\n              time={payrollData?.totalSpecial}\r\n              locSettings={locSettings}\r\n              fontColor=\"black\"\r\n            />\r\n          </IonCol>\r\n          <IonCol\r\n            size={colSize}\r\n            hidden={(colsToDisplay & ColumnEnum.Absent) !== ColumnEnum.Absent}\r\n          >\r\n            <PayrollOrbitalTimeItem\r\n              time={payrollData?.totalAbsent}\r\n              locSettings={locSettings}\r\n              fontColor=\"black\"\r\n            />\r\n          </IonCol>\r\n        </IonRow>\r\n      </IonGrid>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PayrollDetailList;\r\n","import React, { useState, useEffect } from \"react\";\r\n// import \"./ClockPanel.scss\";\r\nimport \"../../global-styles.scss\";\r\nimport { addDays, parseISO } from \"date-fns\";\r\nimport { ApplicationUserContext } from \"../../context/ApplicationUserContext\";\r\nimport { AuthorizedItemsContext } from \"../../context/AuthorizedItemsContext\";\r\nimport PayrollPeriodChooser from \"./PayrollPeriodChooser\";\r\nimport PayrollPeriodAPI, {\r\n  PayrollPeriodData,\r\n} from \"../../api/PayrollPeriodAPI\";\r\nimport useDialogBox from \"../../hooks/useDialogBox\";\r\nimport PayrollDetailList from \"./PayrollDetailList\";\r\nimport { RefresherEventDetail } from \"@ionic/core\";\r\nimport useIonicRefresher from \"../../hooks/useIonicRefresher\";\r\nimport { IonContent } from \"@ionic/react\";\r\n\r\ninterface PayrollPeriodsTabProps {\r\n  date: Date | null;\r\n}\r\n\r\nconst PayrollPeriodsTab: React.FC<PayrollPeriodsTabProps> = ({\r\n  date,\r\n}: PayrollPeriodsTabProps) => {\r\n  const { user } = React.useContext(ApplicationUserContext);\r\n  const { auth } = React.useContext(AuthorizedItemsContext);\r\n  const [currentDate, setCurrentDate] = useState(null as Date | null);\r\n  const [startDate, setStartDate] = useState(null as Date | null);\r\n  const [endDate, setEndDate] = useState(null as Date | null);\r\n  const [payrollData, setPayrollData] = useState(\r\n    null as PayrollPeriodData | null\r\n  );\r\n  const dlg = useDialogBox();\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const doRefresh = (e: CustomEvent<RefresherEventDetail>) => {\r\n    getData(e);\r\n  };\r\n\r\n  const refresher = useIonicRefresher(doRefresh);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    let newStartDate = date;\r\n    if (date === null) {\r\n      newStartDate = new Date();\r\n    }\r\n\r\n    setCurrentDate(newStartDate);\r\n  }, [date]);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (currentDate == null) {\r\n      return;\r\n    }\r\n\r\n    getData();\r\n    // eslint-disable-next-line\r\n  }, [currentDate]);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  function getData(e?: CustomEvent<RefresherEventDetail>) {\r\n    PayrollPeriodAPI.getPayPeriodDateForEmployee(\r\n      user,\r\n      auth.locations[0].id,\r\n      currentDate!\r\n    ).then((data) => {\r\n      if (data.error) {\r\n        dlg.showAlert(\r\n          \"Error\",\r\n          \"Could not retrieve Payroll data: \" + data.message,\r\n          () => {}\r\n        );\r\n        return;\r\n      }\r\n\r\n      setStartDate(parseISO(data.start));\r\n      setEndDate(parseISO(data.end));\r\n      setPayrollData(data);\r\n      if (e) {\r\n        e.detail.complete();\r\n      }\r\n    });\r\n  }\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onNextPayPeriod = () => {\r\n    setCurrentDate(addDays(endDate!, 1));\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onPrevPayPeriod = () => {\r\n    setCurrentDate(addDays(startDate!, -1));\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <PayrollPeriodChooser\r\n        startDate={startDate}\r\n        endDate={endDate}\r\n        onNextPayPeriod={onNextPayPeriod}\r\n        onPrevPayPeriod={onPrevPayPeriod}\r\n      />\r\n      <IonContent>\r\n        {refresher.ionicRefresherJsx}\r\n        {auth && auth.locations && auth.locations.length > 0 && (\r\n          <PayrollDetailList payrollData={payrollData} />\r\n        )}\r\n        {dlg.alertBoxJsx}\r\n      </IonContent>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PayrollPeriodsTab;\r\n","import React from \"react\";\r\nimport { DailyNotes } from \"../orbital-interfaces/DailyNotes\";\r\n// import \"./TodayDailyNoteCard.scss\";\r\nimport \"../global-styles.scss\";\r\nimport { AuthorizedItems } from \"../orbital-interfaces/authorized-items\";\r\n\r\ninterface TodayNoteCardProps {\r\n  oneLine: boolean;\r\n  dailyNote?: DailyNotes;\r\n  authItems: AuthorizedItems;\r\n}\r\n\r\n// ---------------------------------------------------------------------------------\r\nconst getDeptName = (note: DailyNotes, authItems: AuthorizedItems) => {\r\n  let dept = \"\";\r\n  if (authItems.locations.length >= 1) {\r\n    dept =\r\n      authItems.locations.filter((l) => l.id === note.LocationId)[0].abbr + \"/\";\r\n  }\r\n\r\n  return note.DepartmentId === -1\r\n    ? dept + \"All Departments\"\r\n    : dept + note.DepartmentName;\r\n};\r\n\r\n// ==============================================================================\r\nconst TodayNoteCard: React.FC<TodayNoteCardProps> = ({\r\n  authItems,\r\n  oneLine,\r\n  dailyNote,\r\n}: TodayNoteCardProps) => {\r\n  if (!dailyNote) {\r\n    return <div />;\r\n  }\r\n\r\n  return (\r\n    <button className=\"card daily-note\">\r\n      <div className=\"event-color-col\" />\r\n      <div className=\"card-second-col\">\r\n        <div className=\"dept-position-row\">{getDeptName(dailyNote, authItems)}</div>\r\n        <div className={oneLine ? \"note-text-row-oneline\" : \"note-text-row\"}>\r\n          {dailyNote.Notes}\r\n        </div>\r\n      </div>\r\n    </button>\r\n  );\r\n};\r\n\r\nexport default TodayNoteCard;\r\n","import React, { CSSProperties, useContext } from \"react\";\r\nimport { IonIcon } from \"@ionic/react\";\r\n// import \"./TodayEventCard.scss\";\r\nimport \"../global-styles.scss\";\r\nimport {\r\n  getBreakStartEnd,\r\n  getDurationStringFromTimeSpan,\r\n  getEventStartEnd,\r\n  getStartTime,\r\n} from \"../util/time-helper\";\r\nimport { AuthorizedLocation } from \"../orbital-interfaces/authorized-items\";\r\nimport EventType from \"../enums/EventType\";\r\nimport EventStatus from \"../enums/EventStatus\";\r\nimport { cafe, time } from \"ionicons/icons\";\r\nimport { EventInformation } from \"../orbital-interfaces/TEC\";\r\nimport {\r\n  getEventEditAuthorization,\r\n  EventEditAuthorization,\r\n} from \"./EditEvent/EditEventAuthorization\";\r\nimport { AuthorizedItemsContext } from \"../context/AuthorizedItemsContext\";\r\n\r\ninterface TodayEventCardProps {\r\n  event?: EventInformation;\r\n  locations: AuthorizedLocation[];\r\n  onEdit: (ev: EventInformation, eventEditAuth: EventEditAuthorization) => void;\r\n}\r\n\r\nconst colorMap: any = {\r\n  1: \"#9CBA6A\",\r\n  2: \"#BFBFBF\",\r\n  3: \"#FFAD00\",\r\n  4: \"#C41A26\",\r\n  6: \"#677A46\",\r\n  7: \"#FFAD00\",\r\n};\r\n\r\nconst statusTimeColor: any = {\r\n  1: { color: \"black\" },\r\n  2: { color: \"#C41A26\" },\r\n  4: { color: \"#BCBCBC\" },\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction getPosition(locations: AuthorizedLocation[], ev: any) {\r\n  const thisLocation = locations.filter((loc) => loc.id === ev.LocationId)[0];\r\n  const multiLocation =\r\n    locations.filter((l) =>\r\n      l.departments.filter((d) => d.positions.filter((p) => p.hasPosition))\r\n    ).length > 1;\r\n  const multiDepartment = multiLocation\r\n    ? true\r\n    : thisLocation.departments.filter((d) =>\r\n        d.positions.filter((p) => p.hasPosition)\r\n      ).length > 1;\r\n\r\n  let posDisplay = \"\";\r\n  if (multiLocation) {\r\n    if (ev.AbbreviatedLocationName) {\r\n      posDisplay = ev.AbbreviatedLocationName + \"/\";\r\n    } else if (ev.LocationAbbreviation) {\r\n      posDisplay = ev.LocationAbbreviation + \"/\";\r\n    }\r\n  }\r\n\r\n  if (multiDepartment) {\r\n    if (ev.AbbreviatedDepartmentName) {\r\n      posDisplay += ev.AbbreviatedDepartmentName + \"/\";\r\n    } else if (ev.DepartmentAbbreviation) {\r\n      posDisplay += ev.DepartmentAbbreviation + \"/\";\r\n    }\r\n  }\r\n\r\n  posDisplay += ev.PositionName;\r\n\r\n  return posDisplay;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst TodayEventCard: React.FC<TodayEventCardProps> = ({\r\n  event,\r\n  locations,\r\n  onEdit,\r\n}: TodayEventCardProps) => {\r\n  const { auth } = useContext(AuthorizedItemsContext);\r\n\r\n  if (!event || !auth || !auth.locations || auth.locations.length === 0) {\r\n    return <div />;\r\n  }\r\n\r\n  const noEndTime = new Date(9000, 1, 1);\r\n  const onClock =\r\n    event.EventTypeId === EventType.Clock &&\r\n    event.EventStatusId === EventStatus.Approved &&\r\n    event.IsClockedIn;\r\n  const onBreak =\r\n    event.EventTypeId === EventType.Clock &&\r\n    event.EventStatusId === EventStatus.Approved &&\r\n    event.EventBreaks.filter((b) => !b.BreakEnd || b.BreakEnd > noEndTime)\r\n      .length > 0;\r\n  const timeColor: CSSProperties = statusTimeColor[event.EventStatusId];\r\n\r\n  const displayIcon = onClock && onBreak ? cafe : time;\r\n  const rangeDisplay = onClock ? (\r\n    <div className=\"time-row\">\r\n      <IonIcon icon={displayIcon} />\r\n      <span style={timeColor}>{getStartTime(event)}</span>{\" \"}\r\n      {getDurationStringFromTimeSpan(\r\n        event.EventTypeId === EventType.Absent\r\n          ? event.Time\r\n          : event.EventDuration\r\n      )}{\" \"}\r\n    </div>\r\n  ) : (\r\n    <div className=\"time-row\">\r\n      <span style={timeColor}>{getEventStartEnd(event)}</span>{\" \"}\r\n      {getDurationStringFromTimeSpan(event.EventDuration)}{\" \"}\r\n    </div>\r\n  );\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onButtonClick = () => {\r\n    const eventEditAuth = getEventEditAuthorization(\r\n      event.EventTypeId,\r\n      event.EventStatusId,\r\n      event.EmployeeId,\r\n      event.EventStart,\r\n      event.EventEnd,\r\n      event.LocationId,\r\n      event.DepartmentId!,\r\n      event.PositionId,\r\n      event.IsConfirmed,\r\n      auth\r\n    );\r\n    if (eventEditAuth === null) {\r\n      return;\r\n    }\r\n\r\n    onEdit(event, eventEditAuth);\r\n  };\r\n\r\n  const tag = event.Tag ? \" ~\" + event.Tag : \"\";\r\n\r\n  const eventTypeBorder = {\r\n    borderLeft: `7px solid ${colorMap[event.EventTypeId]} `,\r\n  };\r\n  return (\r\n    <button onClick={onButtonClick} className=\"card\">\r\n      <div className=\"card-second-col\" style={eventTypeBorder}>\r\n        {rangeDisplay}\r\n        <div className=\"dept-position-row\">\r\n          {getPosition(locations, event)} {tag}\r\n        </div>\r\n        {event.EventBreaks &&\r\n          event.EventBreaks.map((brk) => (\r\n            <div key={brk.BreakStart} className=\"break-div\">\r\n              (B) {getBreakStartEnd(brk)}\r\n            </div>\r\n          ))}\r\n      </div>\r\n    </button>\r\n  );\r\n};\r\n\r\nexport default TodayEventCard;\r\n","import React from \"react\";\r\n// import \"./TodayEventCard.scss\";\r\nimport \"../global-styles.scss\";\r\nimport Skeleton from \"react-loading-skeleton\";\r\n\r\ninterface TodayEventCardProps {}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst TodayEventCardSkeleton: React.FC<TodayEventCardProps> = () => {\r\n  return (\r\n    <button className=\"card\">\r\n      <div style={{ paddingLeft: \"20px\", paddingRight: \"2px\" }}>\r\n        <Skeleton width={5} height={40} />\r\n      </div>\r\n      <div className=\"card-second-col\">\r\n        <Skeleton width={150} />\r\n        <div className=\"dept-position-row\">\r\n          <Skeleton width={150} />\r\n        </div>\r\n      </div>\r\n    </button>\r\n  );\r\n};\r\n\r\nexport default TodayEventCardSkeleton;\r\n","import React, { useState, useEffect, useContext } from \"react\";\r\n// import \"./ClockPanel.scss\";\r\nimport \"../../global-styles.scss\";\r\nimport { ApplicationUserContext } from \"../../context/ApplicationUserContext\";\r\nimport useDialogBox from \"../../hooks/useDialogBox\";\r\nimport {\r\n  IonContent,\r\n  IonItem,\r\n  IonLabel,\r\n  IonList,\r\n  IonListHeader,\r\n  IonModal,\r\n  IonSpinner,\r\n  useIonViewWillEnter,\r\n  useIonViewWillLeave,\r\n} from \"@ionic/react\";\r\nimport { getDateString } from \"../../util/time-helper\";\r\nimport TodayDailyNoteCard from \"../TodayDailyNoteCard\";\r\nimport TodayEventCard from \"../TodayEventCard\";\r\nimport { EventInformation } from \"../../orbital-interfaces/TEC\";\r\nimport EditEventModal from \"../EditEvent/EditEventModal\";\r\nimport { RefresherEventDetail } from \"@ionic/core\";\r\nimport UserAPI from \"../../api/UserAPI\";\r\nimport useIonicRefresher from \"../../hooks/useIonicRefresher\";\r\nimport { initialHomePageData } from \"../../orbital-interfaces/authorized-items\";\r\nimport TodayEventCardSkeleton from \"../TodayEventCardSkeleton\";\r\nimport { EventEditAuthorization } from \"../EditEvent/EditEventAuthorization\";\r\nimport {\r\n  getEditorValuesFromEventInformation,\r\n  INITIAL_EDITOR_VAUES,\r\n} from \"../EditEvent/EditEventModalState\";\r\nimport { AuthorizedItemsContext } from \"../../context/AuthorizedItemsContext\";\r\nimport { useInterval } from \"../../hooks/useInterval\";\r\nimport { getConstants } from \"../../api/environment\";\r\n\r\ninterface ClockTodayTabProps {\r\n  refreshToggle: boolean;\r\n  onUpdate: () => void;\r\n}\r\n\r\nconst ClockTodayTab: React.FC<ClockTodayTabProps> = ({\r\n  refreshToggle,\r\n  onUpdate,\r\n}: ClockTodayTabProps) => {\r\n  const doRefresh = (e: CustomEvent<RefresherEventDetail>) => {\r\n    getData(e);\r\n  };\r\n\r\n  const [homePageData, setHomePageData] = useState(initialHomePageData);\r\n  const refresher = useIonicRefresher(doRefresh);\r\n  const { user } = React.useContext(ApplicationUserContext);\r\n  const dlg = useDialogBox();\r\n  const [showEventModal, setShowEventModal] = useState(false);\r\n  const [editEventId, setEditEventId] = useState(null as number | null);\r\n  const [eventEditAuth, setEventEditAuth] = useState(\r\n    null as EventEditAuthorization | null\r\n  );\r\n  const [initialEditEvent, setInitialEditEvent] = useState(\r\n    INITIAL_EDITOR_VAUES\r\n  );\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isShowing, setIsShowing] = useState(false);\r\n  const { auth } = useContext(AuthorizedItemsContext);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useIonViewWillEnter(() => {\r\n    setIsShowing(true);\r\n  });\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useIonViewWillLeave(() => {\r\n    setIsShowing(false);\r\n  });\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useInterval(\r\n    () => {\r\n      getData();\r\n    },\r\n    isShowing,\r\n    getConstants(user).refreshScheduleTimer\r\n  );\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onEventClick = (\r\n    ev: EventInformation,\r\n    newEventEditAuth: EventEditAuthorization | null\r\n  ) => {\r\n    setEditEventId(ev.ScheduleEventId);\r\n    setEventEditAuth(newEventEditAuth);\r\n    setInitialEditEvent(getEditorValuesFromEventInformation(auth, ev));\r\n    setShowEventModal(true);\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  function getData(e?: CustomEvent<RefresherEventDetail>) {\r\n    try {\r\n      UserAPI.getHomePageData(user).then((response) => {\r\n        console.log(\"ClockTodayTab.getData: got homepage data\");\r\n        setHomePageData(response);\r\n        setIsLoading(false);\r\n        if (e) {\r\n          e.detail.complete();\r\n          onUpdate();\r\n        }\r\n      });\r\n    } catch (e) {\r\n      console.log(\"Error in ClockTodayTab.getData: \" + e.message);\r\n    }\r\n  }\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    // eslint-disable-next-line\r\n    if (user && user.isLoggedin) {\r\n      setIsLoading(true);\r\n      getData(undefined);\r\n    }\r\n\r\n    // eslint-disable-next-line\r\n  }, [refreshToggle]);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onEventUpdated = () => {\r\n    getData(undefined);\r\n    setShowEventModal(false);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <IonContent className=\"outer-content\">\r\n        {refresher.ionicRefresherJsx}\r\n\r\n        <IonList className=\"todaylist\" lines=\"none\">\r\n          <IonListHeader className=\"list-header\" mode=\"ios\">\r\n            <IonLabel className=\"label-list-header\" mode=\"ios\">\r\n              {getDateString(new Date())}\r\n            </IonLabel>\r\n          </IonListHeader>\r\n          {isLoading &&\r\n            ((homePageData.dailyNotes && homePageData.dailyNotes.length > 0) ||\r\n              (homePageData.currentEvents &&\r\n                homePageData.currentEvents.length > 0)) && (\r\n              <IonSpinner className=\"center\" name=\"dots\" />\r\n            )}\r\n\r\n          {isLoading &&\r\n            (!homePageData.dailyNotes ||\r\n              homePageData.dailyNotes.length === 0 ||\r\n              !homePageData.currentEvents ||\r\n              homePageData.currentEvents.length === 0) && (\r\n              <>\r\n                <TodayEventCardSkeleton />\r\n                <TodayEventCardSkeleton />\r\n              </>\r\n            )}\r\n\r\n          {homePageData.dailyNotes &&\r\n            homePageData.dailyNotes.map((note) => (\r\n              <IonItem key={note.DailyNoteId}>\r\n                <TodayDailyNoteCard\r\n                  authItems={homePageData.auth}\r\n                  oneLine={false}\r\n                  dailyNote={note}\r\n                />\r\n              </IonItem>\r\n            ))}\r\n          {homePageData.currentEvents.map((ev) => (\r\n            <IonItem key={ev.ScheduleEventId}>\r\n              <TodayEventCard\r\n                onEdit={onEventClick}\r\n                locations={homePageData.auth.locations}\r\n                event={ev}\r\n              />\r\n            </IonItem>\r\n          ))}\r\n        </IonList>\r\n      </IonContent>\r\n\r\n      <IonModal\r\n        isOpen={showEventModal}\r\n        onDidDismiss={() => setShowEventModal(false)}\r\n      >\r\n        <EditEventModal\r\n          isOpen={showEventModal}\r\n          auth={homePageData.auth}\r\n          onCancelModal={() => setShowEventModal(false)}\r\n          onDismissModal={() => onEventUpdated()}\r\n          scheduleEventId={editEventId}\r\n          eventEditAuth={eventEditAuth!}\r\n          initialEvent={initialEditEvent}\r\n        />\r\n      </IonModal>\r\n\r\n      {dlg.alertBoxJsx}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ClockTodayTab;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport {\r\n  IonFooter,\r\n  IonSegment,\r\n  IonSegmentButton,\r\n  IonHeader,\r\n  IonToolbar,\r\n  IonTitle,\r\n  IonPage,\r\n  IonButtons,\r\n  IonMenuButton,\r\n} from \"@ionic/react\";\r\n// import \"./ClockPage.scss\";\r\nimport \"../global-styles.scss\";\r\nimport ClockPanel from \"../components/ClockPageComponents/ClockPanel\";\r\nimport PayrollPeriodsTab from \"../components/ClockPageComponents/PayrollPeriodsTab\";\r\nimport ClockTodayTab from \"../components/ClockPageComponents/ClockTodayTab\";\r\nimport { ApplicationUserContext } from \"../context/ApplicationUserContext\";\r\nimport { AuthorizedItemsContext } from \"../context/AuthorizedItemsContext\";\r\n\r\nconst ClockPage: React.FC = () => {\r\n  const [segment, setSegment] = useState<\"today\" | \"pay-periods\">(\"today\");\r\n  const [refreshToggle, setRefreshToggle] = useState(false);\r\n  const [refreshTimeClockToggle, setRefreshTimeClockToggle] = useState(false);\r\n  const { user } = React.useContext(ApplicationUserContext);\r\n  const { auth, refreshAuth } = React.useContext(AuthorizedItemsContext);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (!auth || !auth.locations || auth.locations.length === 0) {\r\n      refreshAuth(false, user);\r\n    }\r\n\r\n    // eslint-disable-next-line\r\n  }, [auth]);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onClockPanelUpdate = () => {\r\n    setRefreshToggle(!refreshToggle);\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onTodayPanelUpdate = () => {\r\n    console.log(\"onTodayPanelUpdate\");\r\n    setRefreshTimeClockToggle(!refreshTimeClockToggle);\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onSegmentChange = (segmentName: any) => {\r\n    setSegment(segmentName);\r\n  };\r\n\r\n  return (\r\n    <IonPage>\r\n      <IonHeader className=\"ion-no-border\">\r\n        <IonToolbar mode=\"md\">\r\n          <IonButtons slot=\"start\">\r\n            <IonMenuButton />\r\n          </IonButtons>\r\n          <IonTitle slot=\"start\">Clock</IonTitle>\r\n        </IonToolbar>\r\n      </IonHeader>\r\n\r\n      <IonSegment\r\n        mode=\"md\"\r\n        onIonChange={(e) => onSegmentChange(e.detail.value)}\r\n      >\r\n        <IonSegmentButton mode=\"md\" value=\"today\">\r\n          TODAY\r\n        </IonSegmentButton>\r\n\r\n        <IonSegmentButton mode=\"md\" value=\"pay-periods\">\r\n          PAY PERIOD\r\n        </IonSegmentButton>\r\n      </IonSegment>\r\n\r\n      {segment === \"today\" && (\r\n        <ClockTodayTab\r\n          refreshToggle={refreshToggle}\r\n          onUpdate={onTodayPanelUpdate}\r\n        />\r\n      )}\r\n\r\n      {segment === \"pay-periods\" && <PayrollPeriodsTab date={null} />}\r\n\r\n      <IonFooter className=\"footer\">\r\n        {segment === \"today\" && (\r\n          <ClockPanel\r\n            refreshToggle={refreshTimeClockToggle}\r\n            onUpdate={onClockPanelUpdate}\r\n          />\r\n        )}\r\n      </IonFooter>\r\n    </IonPage>\r\n  );\r\n};\r\n\r\nexport default ClockPage;\r\n","import React from \"react\";\r\nimport { Message } from \"../../orbital-interfaces/Message\";\r\nimport { messageDateString } from \"../../util/time-helper\";\r\n// import \"./MessageItem.scss\";\r\nimport \"../../global-styles.scss\";\r\nimport { bookmark } from \"ionicons/icons\";\r\nimport { IonIcon } from \"@ionic/react\";\r\n\r\ninterface MessageItemProps {\r\n  message: Message;\r\n  onMessageClick: () => void;\r\n}\r\n\r\n// ==============================================================================\r\nconst MessageItem: React.FC<MessageItemProps> = ({\r\n  message,\r\n  onMessageClick,\r\n}: MessageItemProps) => {\r\n  if (!message) {\r\n    return <div />;\r\n  }\r\n\r\n  const fontWeightForSubject = message.isViewed ? \"normal\" : \"bold\";\r\n\r\n  return (\r\n    <button className=\"message\" onClick={onMessageClick}>\r\n      <div className=\"top-line\">\r\n        <span className=\"subject\" style={{ fontWeight: fontWeightForSubject }}>\r\n          {message.isPinned && (\r\n            <IonIcon icon={bookmark} style={{ color: \"gray\" }} />\r\n          )}\r\n          {message.subject}\r\n        </span>\r\n        <span className=\"time\">\r\n          {messageDateString(message.deliveryDateTime)}{\" \"}\r\n        </span>\r\n      </div>\r\n      <div className=\"bottom-line\">{message.previewLine}</div>\r\n    </button>\r\n  );\r\n};\r\n\r\nexport default MessageItem;\r\n","import React, { useState } from \"react\";\r\nimport {\r\n  IonButton,\r\n  IonButtons,\r\n  IonIcon,\r\n  IonContent,\r\n  IonFooter,\r\n  IonHeader,\r\n  IonItem,\r\n  IonLabel,\r\n  IonSelect,\r\n  IonSelectOption,\r\n  IonTitle,\r\n  IonToolbar,\r\n} from \"@ionic/react\";\r\nimport { arrowBackOutline } from \"ionicons/icons\";\r\n// import \"../SchedulePageComponents/ScheduleFilterModal.scss\";\r\nimport \"../../global-styles.scss\";\r\nimport ToggleListEx from \"../ToggleListEx\";\r\nimport { NotificationTypeModel } from \"../../orbital-interfaces/NotificationTypeModel\";\r\n\r\nexport interface FilterData {\r\n  msgTypes: { messageTypeId: number; name: string }[];\r\n  employees: { employeeId: number; name: string }[];\r\n}\r\n\r\nexport interface FilterResult {\r\n  msgTypeIds: number[];\r\n  employeeId: number;\r\n}\r\n\r\ninterface MessagesFilterModalProps {\r\n  onDismissModal: (result: FilterResult) => void;\r\n  onCancelModal: () => void;\r\n  filterData: FilterData;\r\n}\r\n\r\nconst MessagesFilterModal: React.FC<MessagesFilterModalProps> = ({\r\n  onDismissModal,\r\n  onCancelModal,\r\n  filterData,\r\n}: MessagesFilterModalProps) => {\r\n  const [filterResult, setFilterResult] = useState({\r\n    msgTypeIds: filterData.msgTypes\r\n      ? filterData.msgTypes.map((mt) => mt.messageTypeId)\r\n      : ([] as number[]),\r\n    employeeId: -1,\r\n  } as FilterResult);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onCloseModal = () => {\r\n    onDismissModal(filterResult);\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onCancel = () => {\r\n    onCancelModal();\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onResetAll = () => {\r\n    setFilterResult({\r\n      msgTypeIds: filterData.msgTypes.map((mt) => mt.messageTypeId),\r\n      employeeId: -1,\r\n    });\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onMessageTypeChange = (newSelection: NotificationTypeModel[]) => {\r\n    setFilterResult({\r\n      ...filterResult,\r\n      msgTypeIds: newSelection.map((mt) => mt.id),\r\n    });\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <IonHeader className=\"ion-no-border\">\r\n        <IonToolbar>\r\n          <IonButtons slot=\"start\">\r\n            <IonButton onClick={onCancel}>\r\n              <IonIcon icon={arrowBackOutline} mode=\"md\" slot=\"icon-only\" />\r\n            </IonButton>\r\n          </IonButtons>\r\n          <IonTitle>Filter</IonTitle>\r\n          <IonButtons slot=\"end\">\r\n            <IonButton onClick={onResetAll}>RESET ALL</IonButton>\r\n          </IonButtons>\r\n        </IonToolbar>\r\n      </IonHeader>\r\n\r\n      <IonContent class=\"outer-content\">\r\n        <IonItem>\r\n          <IonLabel>From</IonLabel>\r\n          <IonSelect\r\n            value={filterResult.employeeId}\r\n            onIonChange={(e) =>\r\n              setFilterResult({ ...filterResult, employeeId: e.detail.value })\r\n            }\r\n            interface=\"action-sheet\"\r\n          >\r\n            <IonSelectOption key={-1} value={-1}>\r\n              EVERYONE\r\n            </IonSelectOption>\r\n            {filterData &&\r\n              filterData.employees &&\r\n              filterData.employees.map((emp) => (\r\n                <IonSelectOption key={emp.employeeId} value={emp.employeeId}>\r\n                  {emp.name}\r\n                </IonSelectOption>\r\n              ))}\r\n          </IonSelect>\r\n        </IonItem>\r\n        <IonItem>\r\n          <IonLabel>Message Types</IonLabel>\r\n        </IonItem>\r\n        {filterData.msgTypes && (\r\n          <ToggleListEx\r\n            list={filterData.msgTypes.map((mt) => {\r\n              return { id: mt.messageTypeId, name: mt.name, description: \"\" };\r\n            })}\r\n            selected={filterData.msgTypes\r\n              .filter((mt) =>\r\n                filterResult.msgTypeIds.includes(mt.messageTypeId)\r\n              )\r\n              .map((mt) => {\r\n                return { id: mt.messageTypeId, name: mt.name, description: \"\" };\r\n              })}\r\n            selectionChanged={onMessageTypeChange}\r\n          />\r\n        )}\r\n      </IonContent>\r\n\r\n      <IonFooter className=\"outer-content footer\">\r\n        <IonButton\r\n          className=\"apply-button\"\r\n          expand=\"block\"\r\n          onClick={onCloseModal}\r\n        >\r\n          APPLY FILTER\r\n        </IonButton>\r\n        <IonButton\r\n          className=\"apply-button\"\r\n          expand=\"block\"\r\n          onClick={onCancel}\r\n          color=\"tertiary\"\r\n        >\r\n          BACK\r\n        </IonButton>\r\n      </IonFooter>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default MessagesFilterModal;\r\n","import { KeyedCollection } from \"../util/KeyedCollection\";\r\n\r\nexport interface MessageType {\r\n  id: number;\r\n  typeName: string;\r\n  description: string;\r\n}\r\n\r\nconst types: MessageType[] = [\r\n  { id: 1, typeName: \"CoverRequestMessage\", description: \"Cover-Request\" },\r\n  { id: 2, typeName: \"CoverApprovedMessage\", description: \"Cover-Approved\" },\r\n  {\r\n    id: 3,\r\n    typeName: \"DirectCoverRequestMessage\",\r\n    description: \"Direct Cover-Request\",\r\n  },\r\n  { id: 5, typeName: \"ShiftRequestMessage\", description: \"Shift-Request\" },\r\n  { id: 6, typeName: \"ShiftRequestDeniedMessage\", description: \"Shift-Denied\" },\r\n  {\r\n    id: 10,\r\n    typeName: \"ShiftRequestReceivedMessage\",\r\n    description: \"Shift-Request Received\",\r\n  },\r\n  {\r\n    id: 20,\r\n    typeName: \"NoClockInAlertMessage\",\r\n    description: \"No Clock In Alert\",\r\n  },\r\n  {\r\n    id: 21,\r\n    typeName: \"NoClockOutAlertMessage\",\r\n    description: \"No Clock Out Alert\",\r\n  },\r\n  {\r\n    id: 22,\r\n    typeName: \"LateClockInMessage\",\r\n    description: \"Late Clock In Alert\",\r\n  },\r\n  {\r\n    id: 23,\r\n    typeName: \"EarlyClockOutAlertMessage\",\r\n    description: \"Early Clock Out Alert\",\r\n  },\r\n  {\r\n    id: 50,\r\n    typeName: \"ScheduleEventUpdatedMessage\",\r\n    description: \"Schedule Event Updated\",\r\n  },\r\n  {\r\n    id: 60,\r\n    typeName: \"PublishedScheduleUpdatedMessage\",\r\n    description: \"Published Schedule Updated\",\r\n  },\r\n  {\r\n    id: 80,\r\n    typeName: \"PasswordRecoveryMessage\",\r\n    description: \"Password Recovery\",\r\n  },\r\n  {\r\n    id: 81,\r\n    typeName: \"VerifyCellPhoneMessage\",\r\n    description: \"Verify Cell Phone\",\r\n  },\r\n  {\r\n    id: 82,\r\n    typeName: \"VerifyCellPhoneCompleteMessage\",\r\n    description: \"Verify Cell Phone Completed\",\r\n  },\r\n  { id: 83, typeName: \"VerifyEmailMessage\", description: \"Verify Email\" },\r\n  { id: 100, typeName: \"CustomMessage\", description: \"Custom Messages\" },\r\n  {\r\n    id: 101,\r\n    typeName: \"WeeklyScheduleForEmployeeMessage\",\r\n    description: \"Employee Weekly Schedule\",\r\n  },\r\n  { id: 555, typeName: \"WelcomeMessage\", description: \"Welcome\" },\r\n  {\r\n    id: 603,\r\n    typeName: \"UpdatePaymentInformationMessage\",\r\n    description: \"Update Payment Information\",\r\n  },\r\n  {\r\n    id: 700,\r\n    typeName: \"UpgradeSubscriptionMessage\",\r\n    description: \"Upgrade Subscription (to Orbital)\",\r\n  },\r\n  { id: 701, typeName: \"FailedSignupMessage\", description: \"Failed Signup\" },\r\n  { id: 702, typeName: \"GenericErrorMessage\", description: \"Error Message\" },\r\n  { id: 704, typeName: \"SignupMessage\", description: \"Signup Completed\" },\r\n  {\r\n    id: 705,\r\n    typeName: \"DatesOutOfSyncMessage\",\r\n    description: \"Dates Out of Sync\",\r\n  },\r\n  {\r\n    id: 708,\r\n    typeName: \"CancelSubscriptionMessage\",\r\n    description: \"Canceled Subscription  \",\r\n  },\r\n];\r\n\r\nexport const messageTypes = new KeyedCollection<MessageType>();\r\n\r\ntypes.map((t) => messageTypes.add(\"\" + t.id, t));\r\n","import { Message } from \"../orbital-interfaces/Message\";\r\nimport { ApplicationUser } from \"../context/ApplicationUserContext\";\r\nimport apiHelper from \"./OrbitalApiHelper\";\r\nimport { ErrorResponse } from \"./RequestsAPI\";\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst getUserMessage = async (user: ApplicationUser, msgId: number) => {\r\n  return (await apiHelper.get(\r\n    user,\r\n    \"api/v2/employee/messages/\" + msgId\r\n  )) as Message;\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst getUserMessages = async (user: ApplicationUser) => {\r\n  return (await apiHelper.get(user, \"api/v2/employee/messages\")) as Message[];\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst getReadCount = async (user: ApplicationUser, msgId: number) => {\r\n  return (await apiHelper.get(\r\n    user,\r\n    \"api/v1/employee/messages/\" + msgId + \"/readCount\"\r\n  )) as number;\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst setIsPinned = async (\r\n  user: ApplicationUser,\r\n  msgId: number,\r\n  isPinned: boolean\r\n) => {\r\n  return await apiHelper.post(\r\n    user,\r\n    \"api/v1/employee/messages/\" + msgId + \"/togglePin\",\r\n    { isPinned }\r\n  );\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst setIsViewed = async (\r\n  user: ApplicationUser,\r\n  msgId: number,\r\n  isViewed: boolean\r\n) => {\r\n  return await apiHelper.post(\r\n    user,\r\n    \"api/v1/employee/messages/\" + msgId + \"/toggleView\",\r\n    { isViewed }\r\n  );\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst deleteMessage = async (user: ApplicationUser, msgId: number) => {\r\n  return await apiHelper.del(user, \"api/v1/employee/messages/\" + msgId);\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst getUnreadCount = async (user: ApplicationUser) => {\r\n  if (!user.isLoggedin) {\r\n    return 0;\r\n  }\r\n\r\n  return (await apiHelper.get(\r\n    user,\r\n    \"api/v2/employee/messages/unreadCount\"\r\n  )) as number;\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst sendMessage = async (\r\n  user: ApplicationUser,\r\n  locId: number,\r\n  channel: number,\r\n  empIds: number[],\r\n  text: string\r\n) => {\r\n  return (await apiHelper.post(user, \"api/v2/employee/messages/send\", {\r\n    locId,\r\n    channel,\r\n    empIds,\r\n    text,\r\n  })) as ErrorResponse;\r\n};\r\n\r\nexport default {\r\n  getUserMessage,\r\n  getUserMessages,\r\n  getReadCount,\r\n  setIsPinned,\r\n  setIsViewed,\r\n  deleteMessage,\r\n  getUnreadCount,\r\n  sendMessage,\r\n};\r\n","import React, { useState, useEffect, useContext } from \"react\";\r\nimport { ApplicationUserContext } from \"./ApplicationUserContext\";\r\nimport messagesApi from \"../api/MessageAPI\";\r\nimport { useInterval } from \"../hooks/useInterval\";\r\nimport { getConstants } from \"../api/environment\";\r\n\r\nexport interface IMessagesState {\r\n  unreadMessagesCount: number;\r\n}\r\n\r\nexport interface IMessagesContext extends IMessagesState {\r\n  refreshCount: () => void;\r\n}\r\n\r\nconst INITIAL_MESSAGES_CONTEXT: IMessagesContext = {\r\n  unreadMessagesCount: 0,\r\n  refreshCount: () => {},\r\n};\r\n\r\nexport const MessagesContext = React.createContext<IMessagesContext>(\r\n  INITIAL_MESSAGES_CONTEXT\r\n);\r\n\r\n// --------------------------------------------------------------------------------------\r\n//\r\n// --------------------------------------------------------------------------------------\r\nexport const MessagesContextProvider = (props: any) => {\r\n  const { user } = useContext(ApplicationUserContext);\r\n  const [messagesState, internalSetMessagesState] = useState<IMessagesState>({\r\n    unreadMessagesCount: 0,\r\n  });\r\n\r\n  function refreshCount() {\r\n    getUnreadCount();\r\n  }\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  function getUnreadCount() {\r\n    if (user.isLoggedin) {\r\n      messagesApi.getUnreadCount(user).then((newUnreadCount) => {\r\n        if (newUnreadCount !== messagesState.unreadMessagesCount) {\r\n          const newState: IMessagesState = {\r\n            unreadMessagesCount: newUnreadCount,\r\n          };\r\n\r\n          internalSetMessagesState(newState);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (user.isLoggedin) {\r\n      getUnreadCount();\r\n    }\r\n    // eslint-disable-next-line\r\n  }, [user.isLoggedin]);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useInterval(\r\n    () => {\r\n      getUnreadCount();\r\n    },\r\n    true,\r\n    getConstants(user).checkUnreadMessageCountTimer\r\n  );\r\n\r\n  return (\r\n    <MessagesContext.Provider\r\n      value={{\r\n        refreshCount,\r\n        unreadMessagesCount: messagesState.unreadMessagesCount,\r\n      }}\r\n    >\r\n      {props.children}\r\n    </MessagesContext.Provider>\r\n  );\r\n};\r\n","import React, { useContext, useEffect, useState } from \"react\";\r\nimport {\r\n  IonButton,\r\n  IonButtons,\r\n  IonIcon,\r\n  IonContent,\r\n  IonFooter,\r\n  IonHeader,\r\n  IonGrid,\r\n  IonRow,\r\n  IonCol,\r\n  IonToolbar,\r\n} from \"@ionic/react\";\r\nimport { arrowBackOutline, bookmark, trash } from \"ionicons/icons\";\r\n// import \"../EditEvent/EditEventModal.scss\";\r\nimport \"../../global-styles.scss\";\r\nimport { ApplicationUserContext } from \"../../context/ApplicationUserContext\";\r\nimport useDialogBox from \"../../hooks/useDialogBox\";\r\nimport { Message } from \"../../orbital-interfaces/Message\";\r\nimport { AuthorizedItemsContext } from \"../../context/AuthorizedItemsContext\";\r\nimport { getMessageDeliveryTimeString } from \"../../util/time-helper\";\r\nimport scheduleEventAPI from \"../../api/ScheduleEventsAPI\";\r\nimport messageAPI from \"../../api/MessageAPI\";\r\nimport { ScheduleEvent } from \"../../orbital-interfaces/ScheduleEvent\";\r\nimport EventReqeustEditor from \"../EditEvent/editor/EventRequestEditor\";\r\n// import \"./ViewMessageModal.scss\";\r\nimport { MessagesReducerAction } from \"../../pages/MessagesPage\";\r\nimport useYesOrCancelDialogBox from \"../../hooks/useYesOrCancelDialogBox\";\r\nimport {\r\n  getEventEditAuthorization,\r\n  EventEditAuthorization,\r\n} from \"../EditEvent/EditEventAuthorization\";\r\nimport { MessagesContext } from \"../../context/MessagesContext\";\r\n\r\ninterface ViewMessageModalProps {\r\n  message: Message | null;\r\n  onCloseModal: (msg: string | null) => void;\r\n  updateMessages: React.Dispatch<MessagesReducerAction>;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst ViewMessagetModal: React.FC<ViewMessageModalProps> = ({\r\n  message,\r\n  onCloseModal,\r\n  updateMessages,\r\n}) => {\r\n  const dlg = useDialogBox();\r\n  const yesCancelDlg = useYesOrCancelDialogBox();\r\n  const { user } = React.useContext(ApplicationUserContext);\r\n  const { auth } = React.useContext(AuthorizedItemsContext);\r\n  const [scheduleEvent, setScheduleEvent] = useState(\r\n    null as ScheduleEvent | null\r\n  );\r\n  const [eventEditAuth, setEventEditAuth] = useState(\r\n    null as EventEditAuthorization | null\r\n  );\r\n  const [readCount, setReadCount] = useState(null as number | null);\r\n  const [usageText, setUsageText] = useState(null as string | null);\r\n  const [pinned, setPinned] = useState(false);\r\n  const { refreshCount } = useContext(MessagesContext);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (!message) {\r\n      return;\r\n    }\r\n\r\n    if (message.scheduleEventId) {\r\n      scheduleEventAPI\r\n        .getScheduleEvent(user, message.scheduleEventId)\r\n        .then((event) => {\r\n          if (event) {\r\n            setScheduleEvent(event);\r\n            const newEventEditAuth = getEventEditAuthorization(\r\n              event.EventTypeId,\r\n              event.EventStatusId,\r\n              event.EmployeeId,\r\n              event.EventStart,\r\n              event.EventEnd,\r\n              event.LocationId,\r\n              event.DepartmentId,\r\n              event.PositionId,\r\n              event.ConfirmedBy !== null &&\r\n              event.ConfirmedBy !== undefined &&\r\n              event.ConfirmedBy !== \"\",\r\n              auth\r\n            );\r\n            setEventEditAuth(newEventEditAuth);\r\n          }\r\n        });\r\n    } else {\r\n      if (scheduleEvent) {\r\n        setScheduleEvent(null);\r\n        setUsageText(null);\r\n      }\r\n    }\r\n\r\n    messageAPI.getReadCount(user, message.messageId).then((newReadCount) => {\r\n      setReadCount(newReadCount);\r\n    });\r\n\r\n    if (!message.isViewed) {\r\n      messageAPI.setIsViewed(user, message.messageId, true).then(() => {\r\n        updateMessages({\r\n          type: \"UPDATE-VIEWED\",\r\n          msgId: message.messageId,\r\n          isViewed: true,\r\n        });\r\n      });\r\n    }\r\n\r\n    setPinned(message.isPinned);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [message?.messageId]);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onPinnedClick = () => {\r\n    const newPinValue = !pinned;\r\n    messageAPI.setIsPinned(user, message!.messageId, newPinValue).then(() => {\r\n      setPinned(newPinValue);\r\n      updateMessages({\r\n        type: \"UPDATE-PINNED\",\r\n        msgId: message!.messageId,\r\n        isPinned: newPinValue,\r\n      });\r\n    });\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onDeleteClick = () => {\r\n    yesCancelDlg.showDialog(\r\n      \"Delete this message?\",\r\n      () => {\r\n        messageAPI.deleteMessage(user, message!.messageId).then(() => {\r\n          updateMessages({ type: \"DELETE\", msgId: message!.messageId });\r\n          onCancel(\"Message Deleted\");\r\n        });\r\n      },\r\n      () => { }\r\n    );\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onCancel = (msg: string | null) => {\r\n    if (!message?.isViewed) {\r\n      refreshCount();\r\n    }\r\n\r\n    onCloseModal(msg);\r\n  };\r\n\r\n  if (!message || !auth || !auth.locations || auth.locations.length === 0) {\r\n    return (\r\n      <>\r\n        <div>Loading</div>\r\n        {dlg.alertBoxJsx}\r\n      </>\r\n    );\r\n  } else {\r\n    return (\r\n      <>\r\n        <IonHeader className=\"ion-no-border\">\r\n          <IonToolbar>\r\n            <IonButtons slot=\"start\">\r\n              <IonButton\r\n                onClick={() => {\r\n                  onCancel(null);\r\n                }}\r\n              >\r\n                <IonIcon icon={arrowBackOutline} mode=\"md\" slot=\"icon-only\" />\r\n              </IonButton>\r\n            </IonButtons>\r\n            <IonButtons slot=\"end\">\r\n              <IonButton\r\n                onClick={() => {\r\n                  onPinnedClick();\r\n                }}\r\n              >\r\n                <IonIcon\r\n                  icon={bookmark}\r\n                  style={pinned ? { color: \"black\" } : { color: \"lightgray\" }}\r\n                />\r\n              </IonButton>\r\n              <IonButton\r\n                onClick={() => {\r\n                  onDeleteClick();\r\n                }}\r\n              >\r\n                <IonIcon icon={trash} />\r\n              </IonButton>\r\n            </IonButtons>\r\n          </IonToolbar>\r\n        </IonHeader>\r\n\r\n        <IonContent class=\"outer-contentMessage\">\r\n          <IonGrid>\r\n            <IonRow class=\"messageIonRow-header\">\r\n              <IonCol class=\"messageHeaderSubject\" size=\"12\" >\r\n                {message!.subject}\r\n              </IonCol>\r\n\r\n              <IonCol class=\"messageHeaderDetails\" size=\"12\">\r\n                From: {message!.fromEmployeeFirstName}{\" \"}\r\n                {message!.fromEmployeeLastName}\r\n              </IonCol>\r\n\r\n              <IonCol class=\"messageHeaderDetails\" size=\"9\" >\r\n                {getMessageDeliveryTimeString(message!.deliveryDateTime)}\r\n              </IonCol>\r\n\r\n              <IonCol class=\"readCounter\" size=\"3\" >\r\n                {readCount !== null && <span>{readCount} Read</span>}\r\n              </IonCol>\r\n            </IonRow>\r\n            <div></div>\r\n            \r\n            <IonRow class=\"messageIonRow-content\">\r\n              <IonCol class=\"messageBlock\" size=\"12\">\r\n                <div\r\n                  dangerouslySetInnerHTML={{ __html: message?.messageText }}\r\n                />\r\n              </IonCol>\r\n            </IonRow>\r\n\r\n            {usageText !== null && (\r\n              <IonRow>\r\n                <IonCol size=\"12\">{usageText}</IonCol>\r\n              </IonRow>\r\n            )}\r\n          </IonGrid>\r\n\r\n          {dlg.alertBoxJsx}\r\n          {yesCancelDlg.dialogJsx}\r\n        </IonContent>\r\n\r\n        <IonFooter className=\"outer-content footer\">\r\n          {scheduleEvent !== null && (\r\n            <EventReqeustEditor\r\n              auth={auth}\r\n              eventEnd={scheduleEvent.EventEnd}\r\n              eventType={scheduleEvent.EventTypeId}\r\n              eventStatus={scheduleEvent.EventStatusId}\r\n              eventEmployeeId={scheduleEvent.EmployeeId}\r\n              eventPositionId={scheduleEvent.PositionId}\r\n              scheduleEventId={scheduleEvent.ScheduleEventId}\r\n              locationId={scheduleEvent.LocationId}\r\n              update={() => { }}\r\n              cancelEditModal={onCancel}\r\n              eventEditAuth={eventEditAuth}\r\n              setUsageText={setUsageText}\r\n            />\r\n          )}\r\n          <IonButton\r\n            className=\"apply-button\"\r\n            expand=\"block\"\r\n            onClick={() => {\r\n              onCancel(null);\r\n            }}\r\n            color=\"tertiary\"\r\n          >\r\n            BACK\r\n          </IonButton>\r\n        </IonFooter>\r\n      </>\r\n    );\r\n  }\r\n};\r\n\r\nexport default ViewMessagetModal;\r\n","import React, { useContext, useState } from \"react\";\r\nimport { IonItem, IonLabel, IonSelect, IonSelectOption } from \"@ionic/react\";\r\nimport { AuthorizedItemsContext } from \"../../../context/AuthorizedItemsContext\";\r\nimport authHelper, { PositionEx } from \"../../../util/authitems-helper\";\r\nimport {\r\n  AuthorizedItems,\r\n  AuthorizedLocation,\r\n  AuthorizedPosition,\r\n  Role,\r\n} from \"../../../orbital-interfaces/authorized-items\";\r\n\r\ninterface PositionSelectorProps {\r\n  currentPosition: PositionEx;\r\n  onPositionUpdate: (pos: PositionEx) => void;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction isAdminAtLocation(\r\n  auth: AuthorizedItems,\r\n  location: AuthorizedLocation\r\n) {\r\n  if (auth.role === Role.LocationAdmin || auth.role === Role.BusinessAdmin) {\r\n    return true;\r\n  }\r\n\r\n  if (auth.role === Role.Employee) {\r\n    return false;\r\n  }\r\n\r\n  return location.departments.find((d) => d.isDeptAdmin) !== undefined;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction setPositionForLocation(\r\n  auth: AuthorizedItems,\r\n  locationId: number\r\n): PositionEx {\r\n  const location = authHelper.getLocationFromLocationId(auth, locationId);\r\n  if (location === null) {\r\n    throw new Error(\"Can't find location\");\r\n  }\r\n\r\n  return {\r\n    location,\r\n    department: null,\r\n    position: null,\r\n  };\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction setPositionForDepartment(\r\n  auth: AuthorizedItems,\r\n  pos: PositionEx,\r\n  departmentId: number | null\r\n): PositionEx {\r\n  if (departmentId === null) {\r\n    return setPositionForLocation(auth, pos.location.id);\r\n  }\r\n\r\n  const department = pos.location.departments.filter(\r\n    (d) => d.id === departmentId\r\n  )[0];\r\n  return {\r\n    location: pos.location,\r\n    department,\r\n    position: null,\r\n  };\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction setPositionForPosition(\r\n  auth: AuthorizedItems,\r\n  pos: PositionEx,\r\n  positionId: number | null\r\n): PositionEx {\r\n  if (positionId === null) {\r\n    return {\r\n      location: pos.location,\r\n      department: pos.department,\r\n      position: null,\r\n    };\r\n  }\r\n\r\n  const position = pos.department!.positions.filter(\r\n    (p) => p.id === positionId\r\n  )[0];\r\n  return {\r\n    location: pos.location,\r\n    department: pos.department,\r\n    position,\r\n  };\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction getPositionListForSelection(sel: PositionEx): AuthorizedPosition[] {\r\n  if (sel.department !== null) {\r\n    return sel.department.positions;\r\n  }\r\n\r\n  return sel.location.departments.flatMap((d) => d.positions);\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\n//\r\n// --------------------------------------------------------------------------------------\r\nconst PositionSelector: React.FC<PositionSelectorProps> = ({\r\n  currentPosition,\r\n  onPositionUpdate,\r\n}) => {\r\n  const { auth } = useContext(AuthorizedItemsContext);\r\n  const [selectedPosition, setSelectedPosition] = useState(currentPosition);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const updateLocation = (locId: number | undefined | null) => {\r\n    if (!locId) {\r\n      return;\r\n    }\r\n\r\n    const newPos = setPositionForLocation(auth, locId);\r\n    setSelectedPosition(newPos);\r\n    onPositionUpdate(newPos);\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const updateDepartment = (depId: number | undefined | null) => {\r\n    if (depId === undefined) {\r\n      return;\r\n    }\r\n\r\n    const newPos = setPositionForDepartment(auth, selectedPosition, depId);\r\n    setSelectedPosition(newPos);\r\n    onPositionUpdate(newPos);\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const updatePosition = (posId: number | undefined | null) => {\r\n    if (posId === undefined) {\r\n      return;\r\n    }\r\n\r\n    const newPos = setPositionForPosition(auth, selectedPosition, posId);\r\n    setSelectedPosition(newPos);\r\n    onPositionUpdate(newPos);\r\n  };\r\n\r\n  if (!auth || !auth.locations || auth.locations.length === 0) {\r\n    return (\r\n      <>\r\n        <div>Loading</div>\r\n      </>\r\n    );\r\n  } else {\r\n    return (\r\n      <>\r\n        <IonItem>\r\n          <IonLabel>Location</IonLabel>\r\n          <IonSelect\r\n            interface=\"popover\"\r\n            style={{ maxWidth: \"100%\" }}\r\n            value={selectedPosition.location.id}\r\n            onIonChange={(e) => updateLocation(e.detail.value)}\r\n          >\r\n            {auth.locations\r\n              .filter((l) => isAdminAtLocation(auth, l))\r\n              .map((loc) => (\r\n                <IonSelectOption key={loc.id} value={loc.id}>\r\n                  {loc.name}\r\n                </IonSelectOption>\r\n              ))}\r\n          </IonSelect>\r\n        </IonItem>\r\n        <IonItem>\r\n          <IonLabel>Department</IonLabel>\r\n          <IonSelect\r\n            interface=\"popover\"\r\n            style={{ maxWidth: \"100%\" }}\r\n            value={\r\n              selectedPosition.department === null\r\n                ? null\r\n                : selectedPosition.department.id\r\n            }\r\n            onIonChange={(e) => updateDepartment(e.detail.value)}\r\n          >\r\n            <IonSelectOption key={-1} value={null}>\r\n              All Departments\r\n            </IonSelectOption>\r\n            {selectedPosition.location.departments &&\r\n              selectedPosition.location.departments\r\n                .filter((dep) => authHelper.isDeptAdmin(auth, dep.id))\r\n                .map((dep) => (\r\n                  <IonSelectOption key={dep.id} value={dep.id}>\r\n                    {dep.name}\r\n                  </IonSelectOption>\r\n                ))}\r\n          </IonSelect>\r\n        </IonItem>\r\n        <IonItem>\r\n          <IonLabel>Position</IonLabel>\r\n          <IonSelect\r\n            interface=\"popover\"\r\n            style={{ maxWidth: \"100%\" }}\r\n            value={\r\n              selectedPosition.position === null\r\n                ? null\r\n                : selectedPosition.position.id\r\n            }\r\n            onIonChange={(e) => updatePosition(e.detail.value)}\r\n          >\r\n            <IonSelectOption key={-1} value={null}>\r\n              All Positions\r\n            </IonSelectOption>\r\n            {getPositionListForSelection(selectedPosition).map((pos) => (\r\n              <IonSelectOption key={pos.id} value={pos.id}>\r\n                {selectedPosition.department === null\r\n                  ? authHelper.getDepartmentFromPositionId(auth, pos.id)!.abbr +\r\n                    \"/\" +\r\n                    pos.name\r\n                  : pos.name}\r\n              </IonSelectOption>\r\n            ))}\r\n          </IonSelect>\r\n        </IonItem>\r\n      </>\r\n    );\r\n  }\r\n};\r\n\r\nexport default PositionSelector;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport {\r\n  IonCheckbox,\r\n  IonContent,\r\n  IonRow,\r\n  IonCol,\r\n  IonButton,\r\n  IonFooter,\r\n  IonGrid,\r\n  IonHeader,\r\n  IonTitle,\r\n  IonToolbar,\r\n  IonIcon,\r\n} from \"@ionic/react\";\r\nimport { EmployeeCommunication } from \"../../../api/EmployeesAPI\";\r\nimport { mail, notifications, phonePortrait } from \"ionicons/icons\";\r\n\r\ninterface EmployeeSelectorModalProps {\r\n  onOk: (employees: EmployeeCommunication[]) => void;\r\n  employeeList: EmployeeCommunication[];\r\n  selectedEmployeeList: EmployeeCommunication[];\r\n  channel: number;\r\n}\r\n\r\nconst emailIcon = <IonIcon icon={mail} />;\r\nconst textIcon = <IonIcon icon={phonePortrait} />;\r\nconst pushIcon = <IonIcon icon={notifications} />;\r\n\r\n// --------------------------------------------------------------------------------------\r\nexport function isEmployeeEnabled(\r\n  emp: EmployeeCommunication,\r\n  channel: number\r\n): boolean {\r\n  switch (channel) {\r\n    case -1:\r\n      return emp.hasEmail || emp.hasText || emp.hasPush;\r\n    case 1:\r\n      return emp.hasEmail;\r\n    case 2:\r\n      return emp.hasText;\r\n    case 3:\r\n      return emp.hasPush;\r\n    default:\r\n      return false;\r\n  }\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\n//\r\n// --------------------------------------------------------------------------------------\r\nconst EmployeeSelectorModal: React.FC<EmployeeSelectorModalProps> = ({\r\n  onOk,\r\n  employeeList,\r\n  selectedEmployeeList,\r\n  channel,\r\n}: EmployeeSelectorModalProps) => {\r\n  const [list, setList] = useState([] as EmployeeCommunication[]);\r\n  const [isAllChecked, setIsAllChecked] = useState(false);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    const newList = employeeList.map((e) => {\r\n      return {\r\n        id: e.id,\r\n        name: e.name,\r\n        hasEmail: e.hasEmail,\r\n        hasText: e.hasText,\r\n        hasPush: e.hasPush,\r\n        isChecked: selectedEmployeeList.some((s) => s.id === e.id),\r\n      };\r\n    });\r\n\r\n    setList(newList);\r\n  }, [employeeList, selectedEmployeeList]);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  function onOkClick() {\r\n    onOk(list.filter((e) => e.isChecked));\r\n  }\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  function onEmployeeChecked(empId: number) {\r\n    let checkCount = 0;\r\n    const newList = list.map((e) => {\r\n      if (!isEmployeeEnabled(e, channel)) {\r\n        return { ...e, isChecked: false };\r\n      }\r\n\r\n      if (e.isChecked) {\r\n        if (e.id === empId) {\r\n          return { ...e, isChecked: false };\r\n        } else {\r\n          checkCount++;\r\n          return { ...e, isChecked: isEmployeeEnabled(e, channel) };\r\n        }\r\n      } else {\r\n        if (e.id === empId) {\r\n          checkCount++;\r\n          return { ...e, isChecked: isEmployeeEnabled(e, channel) };\r\n        } else {\r\n          return { ...e, isChecked: false };\r\n        }\r\n      }\r\n    });\r\n\r\n    const allCheckCount = employeeList.filter((e) =>\r\n      isEmployeeEnabled(e, channel)\r\n    ).length;\r\n\r\n    setIsAllChecked(checkCount === allCheckCount);\r\n    setList(newList);\r\n  }\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  function onAllClick() {\r\n    const newValue = !isAllChecked;\r\n\r\n    const newList = list.map((e) => {\r\n      if (!isEmployeeEnabled(e, channel)) {\r\n        return { ...e, isChecked: false };\r\n      }\r\n\r\n      return { ...e, isChecked: newValue };\r\n    });\r\n\r\n    setList(newList);\r\n    setIsAllChecked(newValue);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <IonHeader mode=\"ios\">\r\n        <IonToolbar>\r\n          <IonTitle>Employees</IonTitle>\r\n        </IonToolbar>\r\n      </IonHeader>\r\n      <IonContent>\r\n        <IonGrid>\r\n          <IonRow key={-1}>\r\n            <IonCol size=\"3\">\r\n              <IonCheckbox\r\n                className=\"checkbox\"\r\n                checked={isAllChecked}\r\n                onClick={onAllClick}\r\n              />\r\n            </IonCol>\r\n            <IonCol className=\"label\" size=\"6\">\r\n              Select All\r\n            </IonCol>\r\n            <IonCol size=\"1\">{emailIcon}</IonCol>\r\n            <IonCol size=\"1\">{textIcon}</IonCol>\r\n            <IonCol size=\"1\">{pushIcon}</IonCol>\r\n          </IonRow>\r\n          {list.map((emp) => (\r\n            <IonRow key={emp.id}>\r\n              <IonCol size=\"3\">\r\n                <IonCheckbox\r\n                  className=\"checkbox\"\r\n                  checked={emp.isChecked}\r\n                  disabled={!isEmployeeEnabled(emp, channel)}\r\n                  onClick={() => {\r\n                    onEmployeeChecked(emp.id);\r\n                  }}\r\n                />\r\n              </IonCol>\r\n              <IonCol className=\"label\" size=\"6\">\r\n                {emp.name}\r\n              </IonCol>\r\n              <IonCol size=\"1\">{emp.hasEmail && emailIcon}</IonCol>\r\n              <IonCol size=\"1\">{emp.hasText && textIcon}</IonCol>\r\n              <IonCol size=\"1\">{emp.hasText && pushIcon}</IonCol>\r\n            </IonRow>\r\n          ))}\r\n        </IonGrid>\r\n      </IonContent>\r\n      <IonFooter>\r\n        <IonButton expand=\"block\" color=\"secondary\" onClick={onOkClick}>\r\n          OK\r\n        </IonButton>\r\n      </IonFooter>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default EmployeeSelectorModal;\r\n","import React, { useContext, useEffect, useState } from \"react\";\r\nimport {\r\n  IonButton,\r\n  IonItem,\r\n  IonLabel,\r\n  IonSelect,\r\n  IonSelectOption,\r\n  IonModal,\r\n} from \"@ionic/react\";\r\nimport { AuthorizedItemsContext } from \"../../../context/AuthorizedItemsContext\";\r\nimport {\r\n  AuthorizedItems,\r\n  Role,\r\n} from \"../../../orbital-interfaces/authorized-items\";\r\nimport { PositionEx } from \"../../../util/authitems-helper\";\r\nimport PositionSelector from \"./PositionSelector\";\r\nimport employeeApi, { EmployeeCommunication } from \"../../../api/EmployeesAPI\";\r\nimport { ApplicationUserContext } from \"../../../context/ApplicationUserContext\";\r\nimport EmployeeSelectorModal, {\r\n  isEmployeeEnabled,\r\n} from \"./EmployeeSelectorModal\";\r\nimport { useShowLoading } from \"../../../hooks/useShowLoading\";\r\n\r\ninterface MessageChannel {\r\n  id: number;\r\n  text: string;\r\n}\r\n\r\nconst messageChannels: MessageChannel[] = [\r\n  { id: -1, text: \"All Channels\" },\r\n  { id: 1, text: \"Email\" },\r\n  { id: 2, text: \"Text\" },\r\n  { id: 3, text: \"Push Notification\" },\r\n];\r\n\r\ninterface EmployeesSelectorProps {\r\n  onUpdate: (\r\n    empList: EmployeeCommunication[],\r\n    locId: number,\r\n    channel: number\r\n  ) => void;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction getFirstAvailablePosition(auth: AuthorizedItems): PositionEx {\r\n  for (let i = 0; i < auth.locations.length; i++) {\r\n    const curLoc = auth.locations[i];\r\n\r\n    if (curLoc.adminAllDepts) {\r\n      return {\r\n        location: curLoc,\r\n        department: null,\r\n        position: null,\r\n      };\r\n    }\r\n\r\n    for (let j = 0; j < curLoc.departments.length; j++) {\r\n      const curDep = curLoc.departments[j];\r\n      if (curDep.isDeptAdmin) {\r\n        return {\r\n          location: curLoc,\r\n          department: curDep,\r\n          position: null,\r\n        };\r\n      }\r\n    }\r\n  }\r\n\r\n  throw new Error(\r\n    \"Could not find a department where this user could send messages\"\r\n  );\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction getEmployeeButtonName(selList: EmployeeCommunication[]) {\r\n  if (selList.length === 0) {\r\n    return \"None Selected\";\r\n  }\r\n\r\n  if (selList.length === 1) {\r\n    return selList[0].name;\r\n  }\r\n\r\n  return `${selList.length} Selected`;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\n//\r\n// --------------------------------------------------------------------------------------\r\nconst EmployeesSelector: React.FC<EmployeesSelectorProps> = ({ onUpdate }) => {\r\n  const { user } = useContext(ApplicationUserContext);\r\n  const { auth } = useContext(AuthorizedItemsContext);\r\n  const [selectedRole, setSelectedRole] = useState(\"All\" as \"All\" | Role);\r\n  const [selectedPosition, setSelectedPosition] = useState(\r\n    getFirstAvailablePosition(auth)\r\n  );\r\n  const [selectedChannel, setSelectedChannel] = useState(-1);\r\n  const [selectedEmployees, setSelectedEmployees] = useState(\r\n    [] as EmployeeCommunication[]\r\n  );\r\n  const [employeeList, setEmployeeList] = useState(\r\n    [] as EmployeeCommunication[]\r\n  );\r\n\r\n  const [showEmployeeModal, setShowEmployeeModal] = useState(false);\r\n\r\n  const loading = useShowLoading(\"Retreiving employee list\");\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  function fetchEmployees(\r\n    locId: number,\r\n    depId: number,\r\n    posId: number,\r\n    channel: number,\r\n    role: string\r\n  ) {\r\n    loading.setShowLoading(true);\r\n    employeeApi\r\n      .getEmployeeListForCommunication(user, locId, depId, posId, channel, role)\r\n      .then((emp) => {\r\n        setEmployeeList(emp);\r\n      })\r\n      .finally(() => {\r\n        loading.setShowLoading(false);\r\n      });\r\n  }\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onRoleUpdate = (newRole: \"All\" | Role) => {\r\n    if (newRole !== selectedRole) {\r\n      setSelectedRole(newRole);\r\n      setSelectedEmployees([]);\r\n      fetchEmployees(\r\n        selectedPosition.location.id,\r\n        selectedPosition.department === null\r\n          ? -1\r\n          : selectedPosition.department.id,\r\n        selectedPosition.position === null ? -1 : selectedPosition.position.id,\r\n        selectedChannel,\r\n        newRole\r\n      );\r\n    }\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onPositionUpdate = (posEx: PositionEx) => {\r\n    setSelectedPosition(posEx);\r\n    setSelectedEmployees([]);\r\n    fetchEmployees(\r\n      posEx.location.id,\r\n      posEx.department === null ? -1 : posEx.department.id,\r\n      posEx.position === null ? -1 : posEx.position.id,\r\n      selectedChannel,\r\n      selectedRole\r\n    );\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onChannelUpdate = (newChannelId: number | null | undefined) => {\r\n    if (newChannelId === null || newChannelId === undefined) {\r\n      return;\r\n    }\r\n\r\n    if (newChannelId !== selectedChannel) {\r\n      setSelectedEmployees([]);\r\n      setSelectedChannel(newChannelId);\r\n    }\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onEmployeeUpdate = (newEmployeeList: EmployeeCommunication[]) => {\r\n    setSelectedEmployees(newEmployeeList);\r\n    setShowEmployeeModal(false);\r\n    onUpdate(newEmployeeList, selectedPosition.location.id, selectedChannel);\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (auth.locations && auth.locations.length > 0) {\r\n      fetchEmployees(auth.locations[0].id, -1, -1, 0, \"All\");\r\n    }\r\n\r\n    // eslint-disable-next-line\r\n  }, [auth.locations]);\r\n\r\n  if (!auth || !auth.locations || auth.locations.length === 0) {\r\n    return (\r\n      <>\r\n        <div>Loading</div>\r\n      </>\r\n    );\r\n  } else {\r\n    return (\r\n      <>\r\n        <IonItem>\r\n          <IonLabel>Role</IonLabel>\r\n          <IonSelect\r\n            interface=\"popover\"\r\n            value={selectedRole}\r\n            onIonChange={(e) => {\r\n              onRoleUpdate(e.detail.value);\r\n            }}\r\n          >\r\n            <IonSelectOption value={\"All\"} key={-1}>\r\n              All\r\n            </IonSelectOption>\r\n            <IonSelectOption value={Role.BusinessAdmin} key={2}>\r\n              Business Admin\r\n            </IonSelectOption>\r\n            <IonSelectOption value={Role.LocationAdmin} key={3}>\r\n              Location Admin\r\n            </IonSelectOption>\r\n            <IonSelectOption value={Role.Admin} key={4}>\r\n              Admin\r\n            </IonSelectOption>\r\n            <IonSelectOption value={Role.Employee} key={5}>\r\n              Employee\r\n            </IonSelectOption>\r\n          </IonSelect>\r\n        </IonItem>\r\n        <PositionSelector\r\n          currentPosition={selectedPosition}\r\n          onPositionUpdate={onPositionUpdate}\r\n        />\r\n        <IonItem>\r\n          <IonLabel>Send To</IonLabel>\r\n          <IonSelect\r\n            interface=\"popover\"\r\n            value={selectedChannel}\r\n            onIonChange={(e) => onChannelUpdate(e.detail.value)}\r\n          >\r\n            {messageChannels.map((channel) => (\r\n              <IonSelectOption key={channel.id} value={channel.id}>\r\n                {channel.text}\r\n              </IonSelectOption>\r\n            ))}\r\n          </IonSelect>\r\n        </IonItem>\r\n        <IonItem>\r\n          <IonLabel>\r\n            Employees (\r\n            {\r\n              employeeList.filter((e) => isEmployeeEnabled(e, selectedChannel))\r\n                .length\r\n            }{\" \"}\r\n            / {employeeList.length})\r\n          </IonLabel>\r\n          <IonButton onClick={() => setShowEmployeeModal(true)}>\r\n            {getEmployeeButtonName(selectedEmployees)}\r\n          </IonButton>\r\n        </IonItem>\r\n        {loading.showLoadingJsx}\r\n        <IonModal\r\n          cssClass=\"add-break-modal\"\r\n          onDidDismiss={() => setShowEmployeeModal(false)}\r\n          isOpen={showEmployeeModal}\r\n        >\r\n          <EmployeeSelectorModal\r\n            channel={selectedChannel}\r\n            onOk={onEmployeeUpdate}\r\n            employeeList={employeeList}\r\n            selectedEmployeeList={selectedEmployees}\r\n          />\r\n        </IonModal>\r\n      </>\r\n    );\r\n  }\r\n};\r\n\r\nexport default EmployeesSelector;\r\n","import React, { useContext, useState } from \"react\";\r\nimport {\r\n  IonButton,\r\n  IonButtons,\r\n  IonIcon,\r\n  IonContent,\r\n  IonHeader,\r\n  IonTitle,\r\n  IonToolbar,\r\n  IonList,\r\n  IonItem,\r\n  IonTextarea,\r\n  IonFooter,\r\n} from \"@ionic/react\";\r\nimport { arrowBackOutline } from \"ionicons/icons\";\r\nimport { AuthorizedItemsContext } from \"../../../context/AuthorizedItemsContext\";\r\nimport \"../../../global-styles.scss\";\r\nimport EmployeesSelector from \"./EmployeesSelector\";\r\nimport { EmployeeCommunication } from \"../../../api/EmployeesAPI\";\r\nimport messageApi from \"../../../api/MessageAPI\";\r\nimport { useShowLoading } from \"../../../hooks/useShowLoading\";\r\nimport { ApplicationUserContext } from \"../../../context/ApplicationUserContext\";\r\nimport useDialogBox from \"../../../hooks/useDialogBox\";\r\n\r\ninterface CreateMessageModalProps {\r\n  onCloseModal: (toastMessage: string) => void;\r\n  isOpen: boolean;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\n//\r\n// --------------------------------------------------------------------------------------\r\nconst CreateMessageModal: React.FC<CreateMessageModalProps> = ({\r\n  onCloseModal,\r\n  isOpen,\r\n}) => {\r\n  const { user } = useContext(ApplicationUserContext);\r\n  const { auth } = useContext(AuthorizedItemsContext);\r\n  const [messageText, setMessageText] = useState(\"\");\r\n  const [employeeIds, setEmployeeIds] = useState([] as number[]);\r\n  const [locationId, setLocationId] = useState(0);\r\n  const [channel, setChannel] = useState(0);\r\n  const sendingMessage = useShowLoading(\"Sending\");\r\n  const dialog = useDialogBox();\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onSendClick = () => {\r\n    sendingMessage.setShowLoading(true);\r\n    messageApi\r\n      .sendMessage(user, locationId, channel, employeeIds, messageText)\r\n      .then((res) => {\r\n        sendingMessage.setShowLoading(false);\r\n        if (res.error) {\r\n          dialog.showAlert(\r\n            \"Could not send\",\r\n            \"Could not send message. \" + res.message,\r\n            () => {}\r\n          );\r\n        } else {\r\n          if (employeeIds.length === 1) {\r\n            onCloseModal(\"Message sent\");\r\n          } else {\r\n            onCloseModal(\"Messages sent\");\r\n          }\r\n        }\r\n      });\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onMessageTextUpdate = (newText: string | undefined | null) => {\r\n    if (newText !== null && newText !== undefined && newText !== messageText) {\r\n      setMessageText(newText);\r\n    }\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onEmployeeListUpdate = (\r\n    newEmpList: EmployeeCommunication[],\r\n    newLocId: number,\r\n    newChannel: number\r\n  ) => {\r\n    setEmployeeIds(\r\n      newEmpList.map((e) => {\r\n        return e.id;\r\n      })\r\n    );\r\n\r\n    if (newLocId !== locationId) {\r\n      setLocationId(newLocId);\r\n    }\r\n\r\n    if (newChannel !== channel) {\r\n      setChannel(newChannel);\r\n    }\r\n  };\r\n\r\n  if (!isOpen || !auth || !auth.locations || auth.locations.length === 0) {\r\n    return <div>Loading</div>;\r\n  } else {\r\n    return (\r\n      <>\r\n        <IonHeader className=\"ion-no-border\">\r\n          <IonToolbar>\r\n            <IonButtons slot=\"start\">\r\n              <IonButton onClick={() => onCloseModal(\"\")}>\r\n                <IonIcon icon={arrowBackOutline} mode=\"md\" slot=\"icon-only\" />\r\n              </IonButton>\r\n            </IonButtons>\r\n            <IonTitle className=\"IonTitle--DailyNote\">New Message</IonTitle>\r\n          </IonToolbar>\r\n        </IonHeader>\r\n\r\n        <IonContent class=\"edit-daily-modal-content\">\r\n          <IonList>\r\n            <EmployeesSelector onUpdate={onEmployeeListUpdate} />\r\n            <IonItem>\r\n              <IonTextarea\r\n                value={messageText}\r\n                placeholder={\"Enter Message\"}\r\n                rows={5}\r\n                spellcheck={true}\r\n                wrap=\"hard\"\r\n                debounce={250}\r\n                onIonChange={(e) => {\r\n                  onMessageTextUpdate(e.detail.value);\r\n                }}\r\n              />\r\n            </IonItem>\r\n          </IonList>\r\n          {sendingMessage.showLoadingJsx}\r\n        </IonContent>\r\n\r\n        <IonFooter>\r\n          <IonButton\r\n            className=\"apply-button\"\r\n            expand=\"block\"\r\n            onClick={onSendClick}\r\n            disabled={\r\n              employeeIds.length === 0 ||\r\n              messageText.length === 0 ||\r\n              sendingMessage.showLoading\r\n            }\r\n          >\r\n            Send\r\n          </IonButton>\r\n        </IonFooter>\r\n      </>\r\n    );\r\n  }\r\n};\r\n\r\nexport default CreateMessageModal;\r\n","import React, { useState, useEffect, useReducer } from \"react\";\r\nimport {\r\n  IonModal,\r\n  IonHeader,\r\n  IonButton,\r\n  IonIcon,\r\n  IonToolbar,\r\n  IonTitle,\r\n  IonContent,\r\n  IonPage,\r\n  IonButtons,\r\n  IonMenuButton,\r\n} from \"@ionic/react\";\r\nimport \"../global-styles.scss\";\r\nimport { funnel, add } from \"ionicons/icons\";\r\nimport useIonicRefresher from \"../hooks/useIonicRefresher\";\r\nimport { Message } from \"../orbital-interfaces/Message\";\r\nimport MessageItem from \"../components/MessagesPageComponents/MessageItem\";\r\nimport MessagesFilterModal, {\r\n  FilterData,\r\n  FilterResult,\r\n} from \"../components/MessagesPageComponents/MessagesFilterModal\";\r\nimport { messageTypes } from \"../orbital-interfaces/MessageTypes\";\r\nimport arrayHelper from \"../util/array-helper\";\r\nimport messageApi from \"../api/MessageAPI\";\r\nimport { ApplicationUserContext } from \"../context/ApplicationUserContext\";\r\nimport { RefresherEventDetail } from \"@ionic/core\";\r\nimport ViewMessagetModal from \"../components/MessagesPageComponents/ViewMessageModal\";\r\nimport useSimpleToast from \"../hooks/useSimpleToast\";\r\nimport { RouteComponentProps } from \"react-router\";\r\nimport Skeleton from \"react-loading-skeleton\";\r\nimport CreateMessageModal from \"../components/MessagesPageComponents/create/CreateMessageModal\";\r\nimport { AuthorizedItemsContext } from \"../context/AuthorizedItemsContext\";\r\nimport authHelper from \"../util/authitems-helper\";\r\nimport { MessagesContext } from \"../context/MessagesContext\";\r\n\r\nconst initialMessages: Message[] = [];\r\n\r\nexport type MessagesReducerAction =\r\n  | { type: \"LOADED-FROM-API\"; data: Message[] }\r\n  | { type: \"CLEAR\" }\r\n  | { type: \"UPDATE-PINNED\"; msgId: number; isPinned: boolean }\r\n  | { type: \"UPDATE-VIEWED\"; msgId: number; isViewed: boolean }\r\n  | { type: \"DELETE\"; msgId: number };\r\n\r\n// ------------------------------------------------------------------------------------------------\r\nexport const messagesReducer = (\r\n  currentState: Message[],\r\n  action: MessagesReducerAction\r\n): Message[] => {\r\n  console.log(\"REDUCER: ACTION =\", action.type);\r\n\r\n  switch (action.type) {\r\n    case \"LOADED-FROM-API\":\r\n      return action.data;\r\n    case \"CLEAR\":\r\n      return [] as Message[];\r\n    case \"UPDATE-PINNED\":\r\n      return currentState.map((m) =>\r\n        m.messageId === action.msgId ? { ...m, isPinned: action.isPinned } : m\r\n      );\r\n    case \"UPDATE-VIEWED\":\r\n      return currentState.map((m) => {\r\n        return m.messageId === action.msgId\r\n          ? { ...m, isViewed: action.isViewed }\r\n          : m;\r\n      });\r\n    case \"DELETE\":\r\n      return currentState.filter((m) => m.messageId !== action.msgId);\r\n  }\r\n};\r\n\r\ninterface MessagesPageProps\r\n  extends RouteComponentProps<{\r\n    messageId?: string;\r\n  }> {}\r\n\r\n// eslint-disable-next-line react/prop-types\r\nconst MessagesPage: React.FC<MessagesPageProps> = ({ match, history }) => {\r\n  const { user } = React.useContext(ApplicationUserContext);\r\n  const { auth, refreshAuth } = React.useContext(AuthorizedItemsContext);\r\n  const { unreadMessagesCount } = React.useContext(MessagesContext);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (!auth || !auth.locations || auth.locations.length === 0) {\r\n      refreshAuth(false, user);\r\n    }\r\n\r\n    // eslint-disable-next-line\r\n  }, [auth]);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const doRefresh = (e: CustomEvent<RefresherEventDetail>) => {\r\n    refreshMessages(e);\r\n  };\r\n\r\n  const refresher = useIonicRefresher(doRefresh);\r\n  const [showFilterModal, setShowFilterModal] = useState(false);\r\n  const [isLoadingMessages, setIsLoadingMessages] = useState(true);\r\n  const [messages, updateMessages] = useReducer(messagesReducer, []);\r\n  const [filteredMessages, setFilteredMessages] = useState(initialMessages);\r\n  const [filterData, setFilterData] = useState({} as FilterData);\r\n  const [filterResult, setFilterResult] = useState({} as FilterResult);\r\n  const [viewMessage, setViewMessage] = useState(null as Message | null);\r\n  const toast = useSimpleToast();\r\n  const [showCreateMessage, setShowCreateMessage] = useState(false);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (\r\n      user &&\r\n      user.isLoggedin &&\r\n      auth &&\r\n      auth.locations &&\r\n      auth.locations.length > 0\r\n    ) {\r\n      return refreshMessages(undefined);\r\n    }\r\n\r\n    // eslint-disable-next-line\r\n  }, [user.isLoggedin, unreadMessagesCount, auth]);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    filterMessages(filterResult, messages);\r\n\r\n    // eslint-disable-next-line\r\n  }, [messages]);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    // eslint-disable-next-line react/prop-types\r\n    if (match.params.messageId && viewMessage === null) {\r\n      messageApi\r\n        // eslint-disable-next-line react/prop-types\r\n        .getUserMessage(user, parseInt(match.params.messageId))\r\n        .then((msg) => {\r\n          if (!msg) {\r\n            toast.showToast(\"The requested message has been removed\");\r\n            // eslint-disable-next-line react/prop-types\r\n            history.push(\"/tabs/messages/\");\r\n          }\r\n\r\n          setViewMessage(msg);\r\n        });\r\n    }\r\n\r\n    // eslint-disable-next-line\r\n  }, [match.params.messageId]);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const refreshMessages = (e?: CustomEvent<RefresherEventDetail>) => {\r\n    let isSubscribed = true;\r\n\r\n    if (messages.length === 0 && isLoadingMessages === false) {\r\n      setIsLoadingMessages(true);\r\n    }\r\n\r\n    messageApi.getUserMessages(user).then((msgs) => {\r\n      if (!isSubscribed) {\r\n        return;\r\n      }\r\n\r\n      updateMessages({ type: \"LOADED-FROM-API\", data: msgs });\r\n      filterMessages(filterResult, msgs);\r\n      setIsLoadingMessages(false);\r\n\r\n      if (e) {\r\n        e.detail.complete();\r\n      }\r\n    });\r\n\r\n    return () => {\r\n      isSubscribed = false;\r\n    };\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const filterClose = (updatedFilter: FilterResult) => {\r\n    setFilterResult(updatedFilter);\r\n    filterMessages(updatedFilter, messages);\r\n    setShowFilterModal(false);\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const filterMessages = (f: FilterResult, msgs: Message[]) => {\r\n    if (!f || !f.msgTypeIds) {\r\n      setFilteredMessages(msgs);\r\n      return;\r\n    }\r\n\r\n    if (f.employeeId !== -1) {\r\n      if (f.msgTypeIds.length > 0) {\r\n        setFilteredMessages(\r\n          msgs.filter(\r\n            (m) =>\r\n              m.fromEmployeeId === f.employeeId &&\r\n              arrayHelper.contains(f.msgTypeIds, m.messageTypeId)\r\n          )\r\n        );\r\n      } else {\r\n        setFilteredMessages(\r\n          msgs.filter((m) => m.fromEmployeeId === f.employeeId)\r\n        );\r\n      }\r\n    } else if (f.msgTypeIds.length > 0) {\r\n      console.log(f.msgTypeIds);\r\n      setFilteredMessages(\r\n        msgs.filter((m) => arrayHelper.contains(f.msgTypeIds, m.messageTypeId))\r\n      );\r\n    } else {\r\n      setFilteredMessages(msgs);\r\n    }\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onCloseMessageModal = (msg: string | null) => {\r\n    setViewMessage(null);\r\n    if (msg) {\r\n      toast.showToast(msg);\r\n    }\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onCloseCreateMessageModal = (toastMessage: string | null) => {\r\n    setShowCreateMessage(false);\r\n    if (toastMessage !== null && toastMessage.length > 0) {\r\n      toast.showToast(toastMessage);\r\n    }\r\n\r\n    setTimeout(() => {\r\n      refreshMessages();\r\n    }, 4000);\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const showFilter = () => {\r\n    const employees = arrayHelper.uniqueObject(\r\n      messages.map((msg) => {\r\n        return {\r\n          employeeId: msg.fromEmployeeId,\r\n          name: msg.fromEmployeeFirstName + \" \" + msg.fromEmployeeLastName,\r\n        };\r\n      }),\r\n      (x, y) => {\r\n        return x.employeeId === y.employeeId;\r\n      }\r\n    );\r\n    const msgTypes = arrayHelper.uniqueObject(\r\n      messages.map((msg) => {\r\n        return {\r\n          messageTypeId: msg.messageTypeId,\r\n          name: messageTypes.item(String(msg.messageTypeId)).description,\r\n        };\r\n      }),\r\n      (x, y) => {\r\n        return x.messageTypeId === y.messageTypeId;\r\n      }\r\n    );\r\n\r\n    setFilterData({ msgTypes, employees });\r\n\r\n    setShowFilterModal(true);\r\n  };\r\n\r\n  return (\r\n    <IonPage>\r\n      <IonHeader className=\"ion-no-border\">\r\n        <IonToolbar mode=\"md\">\r\n          <IonButtons slot=\"start\">\r\n            <IonMenuButton />\r\n          </IonButtons>\r\n          <IonTitle slot=\"start\">Messages</IonTitle>\r\n          <IonButtons slot=\"end\">\r\n            <IonButton\r\n              hidden={\r\n                auth.locations.find((l) =>\r\n                  l.departments.find((d) => authHelper.isDeptAdmin(auth, d.id))\r\n                ) === undefined\r\n              }\r\n              onClick={() => {\r\n                setShowCreateMessage(true);\r\n              }}\r\n            >\r\n              <IonIcon icon={add} mode=\"md\" slot=\"icon-only\" />\r\n            </IonButton>\r\n            <IonButton onClick={showFilter}>\r\n              <IonIcon icon={funnel} mode=\"ios\" slot=\"icon-only\" />\r\n            </IonButton>\r\n          </IonButtons>\r\n        </IonToolbar>\r\n      </IonHeader>\r\n\r\n      <IonContent className=\"outer-content\">\r\n        {refresher.ionicRefresherJsx}\r\n        {isLoadingMessages && (\r\n          <>\r\n            {[\r\n              1,\r\n              2,\r\n              3,\r\n              4,\r\n              5,\r\n              6,\r\n              7,\r\n              8,\r\n              9,\r\n              10,\r\n              11,\r\n              12,\r\n              13,\r\n              14,\r\n              15,\r\n              16,\r\n              17,\r\n              18,\r\n              19,\r\n              20,\r\n              21,\r\n            ].map((x) => {\r\n              return (\r\n                <div key={x} style={{ margin: \"10px 8px\" }}>\r\n                  <Skeleton width={360} height={45} />\r\n                </div>\r\n              );\r\n            })}\r\n          </>\r\n        )}\r\n        {!isLoadingMessages && filteredMessages.length === 0 && (\r\n          <div className=\"no-messages-text\">No messages to display.</div>\r\n        )}\r\n        <div className=\"message-list\">\r\n          {!isLoadingMessages &&\r\n            filteredMessages.length > 0 &&\r\n            filteredMessages\r\n              .filter((m) => m.isPinned)\r\n              .map((msg) => (\r\n                <MessageItem\r\n                  key={msg.messageId}\r\n                  message={msg}\r\n                  onMessageClick={() => setViewMessage(msg)}\r\n                />\r\n              ))}\r\n        </div>\r\n\r\n        <div className=\"message-list\">\r\n          {!isLoadingMessages &&\r\n            filteredMessages.length > 0 &&\r\n            filteredMessages\r\n              .filter((m) => !m.isPinned)\r\n              .map((msg) => (\r\n                <MessageItem\r\n                  key={msg.messageId}\r\n                  message={msg}\r\n                  onMessageClick={() => setViewMessage(msg)}\r\n                />\r\n              ))}\r\n        </div>\r\n      </IonContent>\r\n\r\n      <IonModal isOpen={showFilterModal}>\r\n        <MessagesFilterModal\r\n          filterData={filterData}\r\n          onDismissModal={filterClose}\r\n          onCancelModal={() => setShowFilterModal(false)}\r\n        />\r\n      </IonModal>\r\n\r\n      <IonModal isOpen={viewMessage !== null}>\r\n        <ViewMessagetModal\r\n          message={viewMessage}\r\n          updateMessages={updateMessages}\r\n          onCloseModal={onCloseMessageModal}\r\n        />\r\n      </IonModal>\r\n\r\n      <IonModal isOpen={showCreateMessage}>\r\n        <CreateMessageModal\r\n          onCloseModal={onCloseCreateMessageModal}\r\n          isOpen={showCreateMessage}\r\n        />\r\n      </IonModal>\r\n\r\n      {toast.simpleToastJsx}\r\n    </IonPage>\r\n  );\r\n};\r\n\r\nexport default MessagesPage;\r\n","import React, { useContext } from \"react\";\r\nimport { IonIcon, IonLabel } from \"@ionic/react\";\r\nimport { chatbubblesOutline } from \"ionicons/icons\";\r\n// import \"./MainTabs.scss\";\r\nimport \"../global-styles.scss\";\r\nimport { MessagesContext } from \"../context/MessagesContext\";\r\n\r\n// ------------------------------------------------------------------------------------\r\n//\r\n// ------------------------------------------------------------------------------------\r\nconst MessagesTabButton: React.FC = () => {\r\n  const { unreadMessagesCount } = useContext(MessagesContext);\r\n\r\n  return (\r\n    <>\r\n      <div className={unreadMessagesCount ? \"hasMessages\" : \"noMessages\"}>\r\n        {unreadMessagesCount}\r\n      </div>\r\n      <IonIcon icon={chatbubblesOutline} />\r\n      <IonLabel>Messages</IonLabel>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default MessagesTabButton;\r\n","import React from \"react\";\r\nimport {\r\n  IonTabs,\r\n  IonRouterOutlet,\r\n  IonTabBar,\r\n  IonTabButton,\r\n  IonIcon,\r\n  IonLabel,\r\n} from \"@ionic/react\";\r\nimport { Route, Redirect } from \"react-router\";\r\nimport { calendarOutline, timeOutline } from \"ionicons/icons\";\r\nimport SchedulePage from \"./SchedulePage\";\r\nimport ClockPage from \"./ClockPage\";\r\nimport MessagesPage from \"./MessagesPage\";\r\nimport MessagesTabButton from \"./MessagesTabButton\";\r\n// import \"./MainTabs.scss\";\r\nimport \"../global-styles.scss\";\r\n\r\ninterface MainTabsProps {}\r\n\r\nconst MainTabs: React.FC<MainTabsProps> = () => {\r\n  return (\r\n    <IonTabs>\r\n      <IonRouterOutlet>\r\n        <Redirect exact={true} path=\"/tabs\" to=\"/tabs/schedule\" />\r\n\r\n        {/* KENKEN: TODO: Bring the dashboard back in.\r\n        <Route path=\"/tabs/dashboard\" render={() => <Dashboard />} exact={true} />\r\n        */}\r\n\r\n        <Route\r\n          path=\"/tabs/schedule/:scheduleEventId\"\r\n          render={(routeProps) => <SchedulePage {...routeProps} />}\r\n        />\r\n\r\n        <Route\r\n          path=\"/tabs/schedule\"\r\n          render={(routeProps) => <SchedulePage {...routeProps} />}\r\n          exact={true}\r\n        />\r\n\r\n        <Route\r\n          path=\"/tabs/messages/:messageId\"\r\n          render={(routeProps) => <MessagesPage {...routeProps} />}\r\n        />\r\n\r\n        <Route\r\n          path=\"/tabs/messages\"\r\n          render={(routeProps) => <MessagesPage {...routeProps} />}\r\n          exact={true}\r\n        />\r\n\r\n        <Route path=\"/tabs/clock\" render={() => <ClockPage />} exact={true} />\r\n      </IonRouterOutlet>\r\n      <IonTabBar slot=\"bottom\">\r\n        {/*\r\n        <IonTabButton tab=\"dashboard\" href=\"/tabs/dashboard\">\r\n          <IonIcon src=\"assets/img/OS Symbol - 8pt Rounded Black.svg\" />\r\n          <IonLabel>Dashboard</IonLabel>\r\n        </IonTabButton>\r\n        */}\r\n        <IonTabButton key=\"1\" tab=\"schedule\" href=\"/tabs/schedule\">\r\n          <IonIcon icon={calendarOutline} />\r\n          <IonLabel>Schedule</IonLabel>\r\n        </IonTabButton>\r\n        <IonTabButton key=\"2\" tab=\"clock\" href=\"/tabs/clock\">\r\n          <IonIcon icon={timeOutline} />\r\n          <IonLabel>Clock</IonLabel>\r\n        </IonTabButton>\r\n        <IonTabButton key=\"3\" tab=\"map\" href=\"/tabs/messages\">\r\n          <MessagesTabButton />\r\n        </IonTabButton>\r\n      </IonTabBar>\r\n    </IonTabs>\r\n  );\r\n};\r\n\r\nexport default MainTabs;\r\n","import React from \"react\";\r\nimport { Redirect } from \"react-router\";\r\nimport MainTabs from \"./../pages/MainTabs\";\r\nimport { ApplicationUserContext } from \"../context/ApplicationUserContext\";\r\n\r\ninterface StateProps {}\r\n\r\nconst AuthGate: React.FC<StateProps> = () => {\r\n  const { user } = React.useContext(ApplicationUserContext);\r\n\r\n  if (user.loading) {\r\n    return <div></div>;\r\n  }\r\n\r\n  if (user.isLoggedin) {\r\n    return <MainTabs />;\r\n  }\r\n\r\n  return <Redirect to=\"/login\" />;\r\n};\r\n\r\nexport default AuthGate;\r\n","import React from \"react\";\r\nimport { IonContent, IonPage, useIonViewDidEnter } from \"@ionic/react\";\r\nimport { RouteComponentProps } from \"react-router\";\r\nimport { ApplicationUserContext } from \"../context/ApplicationUserContext\";\r\n// import \"./Logout.scss\";\r\nimport \"../global-styles.scss\";\r\nimport { log } from \"../util/logger\";\r\nimport { AuthorizedItemsContext } from \"../context/AuthorizedItemsContext\";\r\n\r\ninterface LogoutProps extends RouteComponentProps {}\r\n\r\nconst Logout: React.FC<LogoutProps> = ({ history }: RouteComponentProps) => {\r\n  const { user, logout } = React.useContext(ApplicationUserContext);\r\n  const { clearAuth } = React.useContext(AuthorizedItemsContext);\r\n\r\n  useIonViewDidEnter(() => {\r\n    Promise.all([clearAuth(), logout()]).then(() => {\r\n      log(\"logout\", { user: user.username });\r\n      console.log(`logged out (${user.username})`);\r\n      setTimeout(() => {\r\n        history.push(\"/login\", { direction: \"none\" });\r\n        history.goForward();\r\n      }, 500);\r\n    });\r\n  });\r\n\r\n  return (\r\n    <IonPage id=\"logout-page\">\r\n      <IonContent className=\"logout-content\">\r\n        <div className=\"login-logo\">\r\n          <img\r\n            className=\"logo\"\r\n            src=\"assets/img/OS Logo - 4pt Rounded _ 2 Tone Orange.svg\"\r\n            alt=\"Orbital Shift Logo\"\r\n          />\r\n        </div>\r\n\r\n        <div className=\"label\">You were logged out</div>\r\n      </IonContent>\r\n    </IonPage>\r\n  );\r\n};\r\n\r\nexport default Logout;\r\n","import React, { useEffect } from \"react\";\r\nimport { Route, BrowserRouter, Redirect } from \"react-router-dom\";\r\nimport { IonApp, IonRouterOutlet, IonSplitPane } from \"@ionic/react\";\r\nimport { IonReactRouter } from \"@ionic/react-router\";\r\nimport Menu from \"./components/Menu\";\r\nimport { initialize, log } from \"./util/logger\";\r\n\r\n/* Core CSS required for Ionic components to work properly */\r\nimport \"@ionic/react/css/core.css\";\r\n\r\n/* Basic CSS for apps built with Ionic */\r\nimport \"@ionic/react/css/normalize.css\";\r\nimport \"@ionic/react/css/structure.css\";\r\nimport \"@ionic/react/css/typography.css\";\r\n\r\n/* Optional CSS utils that can be commented out */\r\nimport \"@ionic/react/css/padding.css\";\r\nimport \"@ionic/react/css/float-elements.css\";\r\nimport \"@ionic/react/css/text-alignment.css\";\r\nimport \"@ionic/react/css/text-transformation.css\";\r\nimport \"@ionic/react/css/flex-utils.css\";\r\nimport \"@ionic/react/css/display.css\";\r\n\r\n/* Theme variables */\r\nimport \"./theme/variables.css\";\r\nimport Login from \"./pages/Login\";\r\nimport AuthGate from \"./components/AuthGate\";\r\n\r\nimport { ApplicationUserContextProvider } from \"./context/ApplicationUserContext\";\r\nimport Logout from \"./pages/Logout\";\r\nimport { AuthorizedItemsContextProvider } from \"./context/AuthorizedItemsContext\";\r\nimport env from \"./api/environment\";\r\nimport { ScreenOrientation } from \"@ionic-native/screen-orientation\";\r\nimport { MessagesContextProvider } from \"./context/MessagesContext\";\r\n\r\nconst MyApp: React.FC = () => {\r\n  useEffect(() => {\r\n    if (env.settings.hasCapacitor) {\r\n      ScreenOrientation.lock(ScreenOrientation.ORIENTATIONS.PORTRAIT).then(\r\n        () => {\r\n          console.log(\"screen locked to portrait\");\r\n        }\r\n      );\r\n    }\r\n\r\n    initialize();\r\n    log(\"app_render\", {\r\n      vers: env.settings.appVersionString,\r\n      platform: env.settings.platform,\r\n    });\r\n  }, []);\r\n\r\n  return (\r\n    <IonApp>\r\n      <IonReactRouter>\r\n        <IonReactRouter>\r\n          <IonSplitPane contentId=\"main\">\r\n            <Menu />\r\n            <IonRouterOutlet id=\"main\">\r\n              <Route\r\n                path=\"/login\"\r\n                render={(routeProps) => <Login {...routeProps} />}\r\n              />\r\n\r\n              <Route\r\n                path=\"/logout\"\r\n                render={(routeProps) => <Logout {...routeProps} />}\r\n              />\r\n\r\n              <Route\r\n                path=\"/tabs\"\r\n                render={(routeProps) => <AuthGate {...routeProps} />}\r\n              />\r\n\r\n              <Route path=\"/\" exact={true}>\r\n                <Redirect to=\"/tabs/schedule\" />\r\n              </Route>\r\n            </IonRouterOutlet>\r\n          </IonSplitPane>\r\n        </IonReactRouter>\r\n      </IonReactRouter>\r\n    </IonApp>\r\n  );\r\n};\r\n\r\nconst App: React.FC = () => {\r\n  return (\r\n    <BrowserRouter>\r\n      <ApplicationUserContextProvider>\r\n        <AuthorizedItemsContextProvider>\r\n          <MessagesContextProvider>\r\n            <MyApp />\r\n          </MessagesContextProvider>\r\n        </AuthorizedItemsContextProvider>\r\n      </ApplicationUserContextProvider>\r\n    </BrowserRouter>\r\n  );\r\n};\r\n\r\nexport default App;\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport App from \"./App\";\r\n\r\nReactDOM.render(<App />, document.getElementById(\"root\"));\r\n"],"sourceRoot":""}