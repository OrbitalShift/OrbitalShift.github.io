(this["webpackJsonpcom.orbitalshift.app"]=this["webpackJsonpcom.orbitalshift.app"]||[]).push([[6],{104:function(e,t,n){e.exports=n(132)},110:function(e,t,n){var a={"./ion-action-sheet-ios.entry.js":[135,67],"./ion-action-sheet-md.entry.js":[136,68],"./ion-alert-ios.entry.js":[137,59],"./ion-alert-md.entry.js":[138,60],"./ion-app_8-ios.entry.js":[139,53],"./ion-app_8-md.entry.js":[140,54],"./ion-avatar_3-ios.entry.js":[141,8],"./ion-avatar_3-md.entry.js":[142,9],"./ion-back-button-ios.entry.js":[143,10],"./ion-back-button-md.entry.js":[144,11],"./ion-backdrop-ios.entry.js":[145,12],"./ion-backdrop-md.entry.js":[146,13],"./ion-button_2-ios.entry.js":[147,69],"./ion-button_2-md.entry.js":[148,70],"./ion-card_5-ios.entry.js":[149,14],"./ion-card_5-md.entry.js":[150,15],"./ion-checkbox-ios.entry.js":[151,16],"./ion-checkbox-md.entry.js":[152,17],"./ion-chip-ios.entry.js":[153,18],"./ion-chip-md.entry.js":[154,19],"./ion-col_3.entry.js":[155,20],"./ion-datetime_3-ios.entry.js":[156,57],"./ion-datetime_3-md.entry.js":[157,58],"./ion-fab_3-ios.entry.js":[158,21],"./ion-fab_3-md.entry.js":[159,22],"./ion-img.entry.js":[160,23],"./ion-infinite-scroll_2-ios.entry.js":[161,24],"./ion-infinite-scroll_2-md.entry.js":[162,25],"./ion-input-ios.entry.js":[163,26],"./ion-input-md.entry.js":[164,27],"./ion-item-option_3-ios.entry.js":[165,71],"./ion-item-option_3-md.entry.js":[166,72],"./ion-item_8-ios.entry.js":[167,73],"./ion-item_8-md.entry.js":[168,74],"./ion-loading-ios.entry.js":[169,28],"./ion-loading-md.entry.js":[170,29],"./ion-menu_3-ios.entry.js":[171,75],"./ion-menu_3-md.entry.js":[172,76],"./ion-modal-ios.entry.js":[173,55],"./ion-modal-md.entry.js":[174,56],"./ion-nav_2.entry.js":[175,66],"./ion-popover-ios.entry.js":[176,30],"./ion-popover-md.entry.js":[177,31],"./ion-progress-bar-ios.entry.js":[178,32],"./ion-progress-bar-md.entry.js":[179,33],"./ion-radio_2-ios.entry.js":[180,34],"./ion-radio_2-md.entry.js":[181,35],"./ion-range-ios.entry.js":[182,77],"./ion-range-md.entry.js":[183,78],"./ion-refresher_2-ios.entry.js":[184,61],"./ion-refresher_2-md.entry.js":[185,62],"./ion-reorder_2-ios.entry.js":[186,36],"./ion-reorder_2-md.entry.js":[187,37],"./ion-ripple-effect.entry.js":[188,38],"./ion-route_4.entry.js":[189,79],"./ion-searchbar-ios.entry.js":[190,80],"./ion-searchbar-md.entry.js":[191,81],"./ion-segment_2-ios.entry.js":[192,82],"./ion-segment_2-md.entry.js":[193,83],"./ion-select_3-ios.entry.js":[194,84],"./ion-select_3-md.entry.js":[195,85],"./ion-slide_2-ios.entry.js":[196,86],"./ion-slide_2-md.entry.js":[197,87],"./ion-spinner.entry.js":[198,39],"./ion-split-pane-ios.entry.js":[199,40],"./ion-split-pane-md.entry.js":[200,41],"./ion-tab-bar_2-ios.entry.js":[201,42],"./ion-tab-bar_2-md.entry.js":[202,43],"./ion-tab_2.entry.js":[203,44],"./ion-text.entry.js":[204,45],"./ion-textarea-ios.entry.js":[205,46],"./ion-textarea-md.entry.js":[206,47],"./ion-toast-ios.entry.js":[207,63],"./ion-toast-md.entry.js":[208,64],"./ion-toggle-ios.entry.js":[209,48],"./ion-toggle-md.entry.js":[210,49],"./ion-virtual-scroll.entry.js":[211,50]};function r(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],r=t[0];return n.e(t[1]).then((function(){return n(r)}))}r.keys=function(){return Object.keys(a)},r.id=110,e.exports=r},112:function(e,t,n){var a={"./ion-icon.entry.js":[215,90]};function r(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],r=t[0];return n.e(t[1]).then((function(){return n(r)}))}r.keys=function(){return Object.keys(a)},r.id=112,e.exports=r},130:function(e,t,n){},132:function(e,t,n){"use strict";n.r(t);var a,r,o,i,c,s,l,u,d,m,p,f=n(0),v=n.n(f),E=n(54),h=n.n(E),g=n(15),b=n(58),y=n(1),O=n(71),S=n(2),k=n(6),I=(n(9),n(7)),C=n(3),j=n.n(C),T=n(5),A=n(102),D=function(){return Object(A.a)("osKeyStore",1,{upgrade:function(e){e.createObjectStore("userStore"),e.createObjectStore("authItems")}})},N=function(){var e=Object(T.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D();case 2:return n=e.sent,e.next=5,n.put("userStore",t,"user");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=Object(T.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D();case 2:return t=e.sent,e.next=5,t.get("userStore","user");case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=Object(T.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D();case 2:return t=e.sent,e.next=5,t.get("userStore","user").then((function(e){return e?e.access_token:void 0}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=Object(T.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D();case 2:return n=e.sent,e.next=5,n.put("authItems",t,"authItems");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=Object(T.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D();case 2:return t=e.sent,e.next=5,t.get("authItems","authItems");case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),L={getKeyStore:D,putUserState:N,getUserState:w,getAccessToken:x,putAuthItems:M,getAuthItems:F},R=n(38),P=n(61);n(133);!function(e){e[e.None=0]="None",e[e.CanViewWages=1]="CanViewWages",e[e.CanEditPublishedTo=2]="CanEditPublishedTo",e[e.CanEditTemplates=4]="CanEditTemplates",e[e.CanEditSchedules=8]="CanEditSchedules",e[e.CanEditEmployeeClockEvents=16]="CanEditEmployeeClockEvents",e[e.CanEditOwnClockEvents=32]="CanEditOwnClockEvents",e[e.CanEditUserAccounts=64]="CanEditUserAccounts"}(a||(a={})),function(e){e[e.UnscheduledUnpaid=0]="UnscheduledUnpaid",e[e.UnscheduledPaid=1]="UnscheduledPaid",e[e.Scheduled=2]="Scheduled"}(r||(r={})),function(e){e[e.MatchingShift=1]="MatchingShift",e[e.AnyShift=2]="AnyShift",e[e.NoShift=3]="NoShift"}(o||(o={})),function(e){e[e.ClockInOk=0]="ClockInOk",e[e.UserNotAtSpecifiedLocation=1]="UserNotAtSpecifiedLocation",e[e.UserRoleMayNotClockIn=2]="UserRoleMayNotClockIn",e[e.UserIsAlreadyClockedIn=3]="UserIsAlreadyClockedIn",e[e.NoScheduleEventsAndClockInRequiresMatchingShift=4]="NoScheduleEventsAndClockInRequiresMatchingShift",e[e.NoPositionsAndClockInRequiresAnyShift=5]="NoPositionsAndClockInRequiresAnyShift",e[e.NoScheduleEventsAtPositionsAndClockInRequiresAnyShift=6]="NoScheduleEventsAtPositionsAndClockInRequiresAnyShift",e[e.NoPositionsAndClockInRequiresNoShift=7]="NoPositionsAndClockInRequiresNoShift",e[e.NoScheduleEventForGivenPositionAndClockInRequiresMatchingShift=8]="NoScheduleEventForGivenPositionAndClockInRequiresMatchingShift",e[e.NoPositionsToClockInAndRequiresAnyShift=9]="NoPositionsToClockInAndRequiresAnyShift",e[e.UserAlreadyClockedIntoADifferentEvent=10]="UserAlreadyClockedIntoADifferentEvent",e[e.NoValidCookieFoundForClockByDevice=11]="NoValidCookieFoundForClockByDevice",e[e.CannotClockInFromGivenIpAddress=12]="CannotClockInFromGivenIpAddress",e[e.BusinessNotEnabledForTimeClock=13]="BusinessNotEnabledForTimeClock",e[e.NoGeoCoordinatesPassedButRequiredForMobile=14]="NoGeoCoordinatesPassedButRequiredForMobile",e[e.CouldNotDetermineGeoLocationRequiredToClockIn=15]="CouldNotDetermineGeoLocationRequiredToClockIn",e[e.UserNotAtRequiredGeoLocations=16]="UserNotAtRequiredGeoLocations",e[e.NoValidCookieOrIpAddressFound=17]="NoValidCookieOrIpAddressFound",e[e.CouldNotFindRequiredClockLocationForClockIn=18]="CouldNotFindRequiredClockLocationForClockIn",e[e.CouldNotFindClockStationInfo=19]="CouldNotFindClockStationInfo",e[e.CouldNotFindBusinessClockStationId=20]="CouldNotFindBusinessClockStationId",e[e.CouldNotFindPositionForEmployee=21]="CouldNotFindPositionForEmployee",e[e.NoPunchClockLocationsAvailableForUser=22]="NoPunchClockLocationsAvailableForUser",e[e.LocationSettingsForbidClockingInToShiftWithDifferentTag=23]="LocationSettingsForbidClockingInToShiftWithDifferentTag",e[e.LocationSettingsForbidClockingInWithTagAndNoEvent=24]="LocationSettingsForbidClockingInWithTagAndNoEvent",e[e.LocationSettingsForbidSettingTagToNull=25]="LocationSettingsForbidSettingTagToNull"}(i||(i={})),function(e){e[e.ClockOutOk=0]="ClockOutOk",e[e.UserNotAtSpecifiedLocation=1]="UserNotAtSpecifiedLocation",e[e.UserRoleMayNotClockIn=2]="UserRoleMayNotClockIn",e[e.UserNotClockedIn=3]="UserNotClockedIn",e[e.NoOpenTimeClockEventForUserAtLocation=4]="NoOpenTimeClockEventForUserAtLocation",e[e.BreakStartComesBeforeStartOfClockedInTime=5]="BreakStartComesBeforeStartOfClockedInTime",e[e.BreakStartComesAfterClockedOutTime=6]="BreakStartComesAfterClockedOutTime",e[e.BreakTimeIsGreaterThanShiftTimeAfterBreakStart=7]="BreakTimeIsGreaterThanShiftTimeAfterBreakStart",e[e.BreakTimeIsGreaterThanEntireShiftTime=8]="BreakTimeIsGreaterThanEntireShiftTime",e[e.BusinessNotEnabledForTimeClock=9]="BusinessNotEnabledForTimeClock",e[e.NoValidCookieFoundForClockByDevice=10]="NoValidCookieFoundForClockByDevice",e[e.CannotClockOutFromGivenIpAddress=11]="CannotClockOutFromGivenIpAddress",e[e.NoGeoCoordinatesPassedButRequiredForMobile=12]="NoGeoCoordinatesPassedButRequiredForMobile",e[e.CouldNotDetermineGeoLocationRequiredToClockOut=13]="CouldNotDetermineGeoLocationRequiredToClockOut",e[e.UserNotAtRequiredGeoLocations=14]="UserNotAtRequiredGeoLocations",e[e.NoValidCookieOrIpAddressFound=15]="NoValidCookieOrIpAddressFound",e[e.CouldNotFindRequiredClockLocationForClockOut=16]="CouldNotFindRequiredClockLocationForClockOut",e[e.CouldNotFindClockStationInfo=17]="CouldNotFindClockStationInfo",e[e.CouldNotFindBusinessClockStationId=18]="CouldNotFindBusinessClockStationId",e[e.CouldNotFindPositionForEmployee=19]="CouldNotFindPositionForEmployee",e[e.NoPunchClockLocationsAvailableForUser=20]="NoPunchClockLocationsAvailableForUser",e[e.ErrorUpdateEventBreaks=21]="ErrorUpdateEventBreaks"}(c||(c={})),function(e){e[e.Unit=1]="Unit",e[e.Money=2]="Money"}(s||(s={})),function(e){e[e.iOS=1]="iOS",e[e.Android=2]="Android"}(l||(l={})),function(e){e[e.FirstName=1]="FirstName",e[e.LastName=2]="LastName",e[e.EmploymentStart=3]="EmploymentStart",e[e.EarliestEventStart=4]="EarliestEventStart"}(u||(u={})),function(e){e[e.Success=0]="Success",e[e.CannotEndRestrictedBreakEarly=1]="CannotEndRestrictedBreakEarly",e[e.ErrorUpdatingEventBreak=2]="ErrorUpdatingEventBreak",e[e.UserNotAtSpecifiedLocation=3]="UserNotAtSpecifiedLocation",e[e.EventDoesNotMatchCurrentUser=4]="EventDoesNotMatchCurrentUser",e[e.BreakNoLongerExists=5]="BreakNoLongerExists"}(d||(d={})),function(e){e[e.All=-1]="All",e[e.Scheduled=-2]="Scheduled",e[e.DontWork=-3]="DontWork",e[e.ClockAndSched=-6]="ClockAndSched",e[e.Custom=0]="Custom"}(m||(m={})),function(e){e[e.Approved=1]="Approved",e[e.Request=2]="Request",e[e.RequestDenied=4]="RequestDenied"}(p||(p={}));var U,B=[{id:1,name:"Approved"},{id:2,name:"Request"},{id:4,name:"Request Denied"}];function V(e){var t=B.find((function(t){return t.id===e}));if(void 0===t)throw new Error("getEventStatusIdName: Unknown event status: "+e);return t}!function(e){e[e.Shift=1]="Shift",e[e.Unavailable=2]="Unavailable",e[e.Vacation=3]="Vacation",e[e.Cover=4]="Cover",e[e.Clock=6]="Clock",e[e.Absent=7]="Absent"}(U||(U={}));var q,z,W,_,G,Y,J,H=[{id:1,name:"Shift"},{id:2,name:"Unavailable"},{id:3,name:"Vacation"},{id:4,name:"Cover"},{id:6,name:"Clock"},{id:7,name:"Absent"}];function K(e){var t=H.find((function(t){return t.id===e}));if(void 0===t)throw new Error("getEventTypeIdList: Unknown event type: "+e);return t}function Q(e){switch(e){case G.None:return"None";case G.Standard:return"Standard";case G.Premium:return"Premium";case G.Enterprise:return"Enterprise";default:return"Unknown"}}!function(e){e[e.Daily=0]="Daily",e[e.Weekly=1]="Weekly",e[e.MonthlyByDayOfMonth=2]="MonthlyByDayOfMonth",e[e.MonthlyByDayOfWeek=3]="MonthlyByDayOfWeek",e[e.Yearly=4]="Yearly"}(q||(q={})),function(e){e[e.UpdateSingleEvent=0]="UpdateSingleEvent",e[e.UpdateEntireSeries=1]="UpdateEntireSeries",e[e.UpdateSeriesForward=2]="UpdateSeriesForward"}(z||(z={})),function(e){e.Employee="Employee",e.Admin="Admin",e.LocationAdmin="Location Admin",e.BusinessAdmin="Business Admin",e.Orbital="Orbital"}(W||(W={})),function(e){e[e.Success=0]="Success",e[e.BreakAlreadyExists=1]="BreakAlreadyExists",e[e.AlreadyOnBreak=2]="AlreadyOnBreak",e[e.ErrorInsertingBreak=3]="ErrorInsertingBreak",e[e.UserNotAtSpecifiedLocation=4]="UserNotAtSpecifiedLocation",e[e.EventDoesNotMatchCurrentUser=5]="EventDoesNotMatchCurrentUser",e[e.InvalidUnscheduledBreak=6]="InvalidUnscheduledBreak"}(_||(_={})),function(e){e[e.None=-1]="None",e[e.Standard=0]="Standard",e[e.Premium=1]="Premium",e[e.Enterprise=2]="Enterprise"}(G||(G={})),function(e){e[e.HoursMinutes=0]="HoursMinutes",e[e.HoursAndDecimals=1]="HoursAndDecimals"}(Y||(Y={})),function(e){e[e.Both=0]="Both",e[e.Unpaid=1]="Unpaid",e[e.Paid=2]="Paid",e[e.None=3]="None"}(J||(J={}));var Z=n(12),X=n(13),$=function(){function e(){Object(Z.a)(this,e),this.items={},this._count=0}return Object(X.a)(e,[{key:"containsKey",value:function(e){return this.items.hasOwnProperty(e)}},{key:"count",value:function(){return this._count}},{key:"add",value:function(e,t){this.items.hasOwnProperty(e)||this._count++,this.items[e]=t}},{key:"remove",value:function(e){var t=this.items[e];return delete this.items[e],this._count--,t}},{key:"item",value:function(e){return this.items[e]}},{key:"keys",value:function(){var e=[];for(var t in this.items)this.items.hasOwnProperty(t)&&e.push(t);return e}},{key:"values",value:function(){var e=[];for(var t in this.items)this.items.hasOwnProperty(t)&&e.push(this.items[t]);return e}}]),e}(),ee={constants:{checkUnreadMessageCountTimer:3e4,refreshScheduleTimer:6e4,refreshTimeclockSettingsTimer:15e3,maxStaleAuthItemsInMinutes:15,minimumFeetForGeolocationUpdate:15},key:"prod",name:"",url:""},te=[Object(I.a)({},ee,{key:"prod",name:"Production",url:"https://api.orbitalshift.com/"}),Object(I.a)({},ee,{key:"sbx",name:"Sandbox",url:"https://sandboxapi.orbitalshift.com/"}),Object(I.a)({},ee,{key:"loc",name:"Local",url:"http://localhost:54825/"}),Object(I.a)({},ee,{key:"emu",name:"Local (Emu)",url:"http://10.0.2.2:54825/"}),Object(I.a)({},ee,{key:"tst",name:"TestServer",url:"http://TestServer:8000/"})],ne=new $;te.map((function(e){return ne.add(e.key,e)}));var ae={env:ne,versionName:"2.0.0",versionCode:"6155",revisionHash:"a27de2e",buildDate:"Thu 05/21/2020 6:12P",appVersionString:"2.0.0.6155 (a27de2e)",hasCapacitor:Object(y.T)("capacitor"),platform:Object(y.T)("ios")?"ios":Object(y.T)("android")?"android":"other"},re=function(e){return e.isLoggedin?ae.env.item(e.environment).constants:ee.constants},oe={settings:ae,getApiUrl:function(e,t){return ae.env.item(e.environment).url+t},getUserAndEnvironmentFromInput:function(e){if(e.length<4)return{username:e,env:ae.env.item("prod")};var t=e.toLowerCase().substring(0,4),n=e.substring(4);switch(t){case"sbx ":return{username:n,env:ae.env.item("sbx")};case"loc ":return{username:n,env:ae.env.item("loc")};case"emu ":return{username:n,env:ae.env.item("emu")};case"tst ":return{username:n,env:ae.env.item("tst")};default:return{username:e,env:ae.env.item("prod")}}}},ie={apiKey:"AIzaSyAS526InuG-53VGKi5SA780Mh0YwHkhMDE",authDomain:"orbital-shift-team-dashboard.firebaseapp.com",databaseURL:"https://orbital-shift-team-dashboard.firebaseio.com",projectId:"orbital-shift-team-dashboard",storageBucket:"orbital-shift-team-dashboard.appspot.com",messagingSenderId:"475985033328",appId:"1:475985033328:web:77740655a89e28de035cb5",measurementId:"G-TGE8788D28"};function ce(e,t){P.analytics().logEvent(e,t)}function se(e,t){if(e.isLoggedin){var n=oe.settings.env.item(e.environment);void 0!==e.username&&P.analytics().setUserId(e.username),P.analytics().setUserProperties({userRole:t.role,subscriptionType:Q(t.subscriptionType),businessName:t.businessName,userName:e.username,version:oe.settings.appVersionString,environment:n.name})}}var le=n(26),ue=function(){var e=Object(T.a)(j.a.mark((function e(t,n,a){var r,o,i,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=oe.getApiUrl(t,n),console.log("API: "+n),e.prev=2,e.next=5,fetch(r,{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.access_token),AppVersion:oe.settings.appVersionString}});case 5:if(o=e.sent,!(i=o.headers.get("content-type"))||-1===i.indexOf("application/json")){e.next=13;break}return e.next=10,o.json();case 10:return c=e.sent,ce("api_succeeded",{method:"POST",baseUrl:n,username:t.username}),e.abrupt("return",c);case 13:ce("api_succeeded",{method:"POST",baseUrl:n,username:t.username}),e.next=21;break;case 16:throw e.prev=16,e.t0=e.catch(2),ce("api_err",Object(I.a)({method:"POST",baseUrl:n,username:null===t||void 0===t?void 0:t.username},a,{appVersion:oe.settings.appVersionString})),console.error("Error calling post against url, "+n+": "+e.t0),e.t0;case 21:case"end":return e.stop()}}),e,null,[[2,16]])})));return function(t,n,a){return e.apply(this,arguments)}}(),de=function(){var e=Object(T.a)(j.a.mark((function e(t,n,a){var r,o,i,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=oe.getApiUrl(t,n),console.log("API: "+n),e.prev=2,o=JSON.stringify(a),e.next=6,fetch(r,{method:"PUT",body:o,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.access_token),AppVersion:oe.settings.appVersionString}});case 6:return i=e.sent,e.next=9,i.json();case 9:return c=e.sent,ce("api_succeeded",{method:"PUT",baseUrl:n,username:t.username}),e.abrupt("return",c);case 14:throw e.prev=14,e.t0=e.catch(2),ce("api_err",Object(I.a)({method:"PUT",baseUrl:n,username:null===t||void 0===t?void 0:t.username},a,{appVersion:oe.settings.appVersionString})),console.error("Error calling putData against url, "+n+": "+e.t0),e.t0;case 19:case"end":return e.stop()}}),e,null,[[2,14]])})));return function(t,n,a){return e.apply(this,arguments)}}(),me={get:function(){var e=Object(T.a)(j.a.mark((function e(t,n,a){var r,o,i,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=oe.getApiUrl(t,n),console.log("API: "+n),e.prev=2,o={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.access_token),AppVersion:oe.settings.appVersionString},body:null},a&&(o.body=JSON.stringify(a)),e.next=7,fetch(r,o);case 7:return i=e.sent,e.next=10,i.json();case 10:return c=e.sent,ce("api_succeeded",{method:"GET",baseUrl:n,username:t.username}),e.abrupt("return",c);case 15:throw e.prev=15,e.t0=e.catch(2),ce("api_err",{method:"GET",baseUrl:n,username:null===t||void 0===t?void 0:t.username,appVersion:oe.settings.appVersionString}),console.error("Error calling get against url, "+n+": "+e.t0),e.t0;case 20:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(t,n,a){return e.apply(this,arguments)}}(),post:ue,put:function(){var e=Object(T.a)(j.a.mark((function e(t,n,a){var r,o,i,c,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=oe.getApiUrl(t,n),console.log("API: "+n),o={method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.access_token),AppVersion:oe.settings.appVersionString}},a&&(o.body=JSON.stringify(a)),e.prev=4,e.next=7,fetch(r,o);case 7:if(i=e.sent,!(c=i.headers.get("content-type"))||-1===c.indexOf("application/json")){e.next=15;break}return e.next=12,i.json();case 12:return s=e.sent,ce("api_succeeded",{method:"PUT",baseUrl:n,username:t.username}),e.abrupt("return",s);case 15:ce("api_succeeded",{method:"PUT",baseUrl:n,username:t.username}),e.next=23;break;case 18:throw e.prev=18,e.t0=e.catch(4),ce("api_err",Object(I.a)({method:"PUT",baseUrl:n,username:null===t||void 0===t?void 0:t.username},a,{appVersion:oe.settings.appVersionString})),console.error("Error calling put against url, "+n+": "+e.t0),e.t0;case 23:case"end":return e.stop()}}),e,null,[[4,18]])})));return function(t,n,a){return e.apply(this,arguments)}}(),putData:de,del:function(){var e=Object(T.a)(j.a.mark((function e(t,n,a){var r,o,i,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=oe.getApiUrl(t,n),console.log("API: "+n),o={method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.access_token),AppVersion:oe.settings.appVersionString}},a&&(o.body=JSON.stringify(a)),e.prev=4,e.next=7,fetch(r,o);case 7:if(i=e.sent,!(c=i.headers.get("content-type"))||-1===c.indexOf("application/json")){e.next=14;break}return ce("api_succeeded",{method:"DELETE",baseUrl:n,username:t.username}),e.next=13,i.json();case 13:return e.abrupt("return",e.sent);case 14:return ce("api_succeeded",{method:"DELETE",baseUrl:n,username:t.username}),e.abrupt("return");case 18:throw e.prev=18,e.t0=e.catch(4),ce("api_err",Object(I.a)({method:"DELETE",baseUrl:n,username:null===t||void 0===t?void 0:t.username},a,{appVersion:oe.settings.appVersionString})),console.error("Error calling delete against url, "+n+": "+e.t0),e.t0;case 23:case"end":return e.stop()}}),e,null,[[4,18]])})));return function(t,n,a){return e.apply(this,arguments)}}()};function pe(){return(pe=Object(T.a)(j.a.mark((function e(t,n){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v1/employee/notifications/subscribe",a="ios"===oe.settings.platform?l.iOS:l.Android,ce("pushNotifications_subscribeCalled",{token:n,operatingSystem:a,username:t.username,access_token:t.access_token}),e.next=5,me.putData(t,"api/v1/employee/notifications/subscribe",{TokenId:n,OperatingSystem:a});case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fe(){return(fe=Object(T.a)(j.a.mark((function e(t,n){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v1/employee/notifications/unsubscribe",a="ios"===oe.settings.platform?l.iOS:l.Android,e.next=4,me.putData(t,"api/v1/employee/notifications/unsubscribe",{TokenId:n,OperatingSystem:a});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ve(){return(ve=Object(T.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v1/employee/notifications/types",e.next=3,me.get(t,"api/v1/employee/notifications/types");case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ee(){return(Ee=Object(T.a)(j.a.mark((function e(t,n){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v1/employee/notifications/types",a={ids:n},e.next=4,me.put(t,"api/v1/employee/notifications/types",a);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function he(){return(he=Object(T.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v1/employee/notifications/list-types",e.next=3,me.get(t,"api/v1/employee/notifications/list-types");case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ge={subscribe:function(e,t){return pe.apply(this,arguments)},unsubscribe:function(e,t){return fe.apply(this,arguments)},getTypesSelectedByUser:function(e){return ve.apply(this,arguments)},putTypes:function(e,t){return Ee.apply(this,arguments)},listTypes:function(e){return he.apply(this,arguments)}},be=R.c.PushNotifications,ye=function(e,t,n){var a=Object(le.a)({forceRefresh:!0});oe.settings.hasCapacitor&&(be.register().then((function(){console.log("PushNotificationController: register called and returned")})),be.addListener("registration",(function(a){ge.subscribe(e,a.value),t(!0),n("Push registration success, token: "+a.value),ce("pushNotifications_registered",{token:a.value,platform:oe.settings.platform})})),be.addListener("registrationError",(function(e){n("Error on registration: "+JSON.stringify(e)),ce("pushNotifications_registrationError",{error:e,platform:oe.settings.platform})})),be.addListener("pushNotificationReceived",(function(e){var t;e&&(e.data&&e.data.MessageId?(n("NOTIFICATION: "+e.title+": "+e.body+" id:"+e.data.MessageId),a.push("/tabs/messages/"+e.data.MessageId),a.goForward()):n("NOTIFICATION: "+e.title+": "+e.body+" (no id)"),ce("pushNotifications_receivedWhenOpen",{title:e.title,body:e.body,messageId:null!==(t=e.data.MessageId)&&void 0!==t?t:-123}))})),be.addListener("pushNotificationActionPerformed",(function(e){var t;e.notification.data&&e.notification.data.MessageId?(n("TAPPED ON NOTIFICATION: "+e.notification.title+": "+e.notification.body+" id:"+e.notification.data.MessageId),a.push("/tabs/messages/"+e.notification.data.MessageId),a.goForward()):n("TAPPED ON NOTIFICATION: "+e.notification.title+": "+e.notification.body+" (no id)"),ce("pushNotifications_actionPerformed",{title:e.notification.title,body:e.notification.body,messageId:null!==(t=e.notification.data.MessageId)&&void 0!==t?t:-123})})))},Oe={isLoggedin:!1,access_token:void 0,username:"",darkMode:!1,loading:!0,environment:"prod",isPushEnabled:!1},Se={user:Oe,logout:function(){var e=Object(T.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),userLoggedIn:function(e,t,n){return new Promise((function(){return Oe}))},pushEnabled:function(e){}},ke=v.a.createContext(Se),Ie=function(e){var t=Object(f.useState)(Object(I.a)({},Oe)),n=Object(S.a)(t,2),a=n[0],r=n[1];Object(f.useEffect)((function(){var e=!0;return Promise.all([L.getUserState()]).then((function(t){if(e){var n=t[0];r(n?Object(I.a)({},n,{loading:!1}):Object(I.a)({},a,{loading:!1}))}})),function(){e=!1}}),[]),Object(f.useEffect)((function(){a&&!a.isPushEnabled&&a.access_token&&a.access_token.length>0&&"other"!==oe.settings.platform&&ye(a,o,(function(){}))}),[a.isPushEnabled,a.access_token]);var o=function(e){r(Object(I.a)({},a,{isPushEnabled:e}))},i=function(){var e=Object(T.a)(j.a.mark((function e(t,n,a){var o,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.getUserState();case 2:return o=e.sent,i={username:t,access_token:n,environment:a,isLoggedin:!0,darkMode:o?o.darkMode:Oe.darkMode,loading:!1,isPushEnabled:!1},e.next=6,L.putUserState(i);case 6:return r(i),e.abrupt("return",i);case 8:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),c=function(){var e=Object(T.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(I.a)({},a,{isLoggedin:!1,access_token:void 0,latitude:void 0,longitude:void 0,isPushEnabled:!1,requestedGeoPermission:!1,refusedGeoPermission:!1}),r(t),e.next=4,L.putUserState(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return v.a.createElement(ke.Provider,{value:{user:a,userLoggedIn:i,logout:c,pushEnabled:o}},e.children)};var Ce=function(){var e=Object(f.useState)(!1),t=Object(S.a)(e,2),n=t[0],a=t[1],r=Object(f.useState)({header:"",message:"",onDismiss:function(){}}),o=Object(S.a)(r,2),i=o[0],c=o[1];return{showAlert:function(e,t,n){c({header:e,message:t,onDismiss:n}),a(!0)},alertBoxJsx:v.a.createElement(y.b,{isOpen:n,onDidDismiss:function(){a(!1),i.onDismiss()},header:i.header,message:i.message,buttons:["OK"]})}},je=function(e){var t=e.list,n=e.selected,a=e.selectionChanged,r=function(e){if(!n||0===n.length)return!1;for(var t=0;t<n.length;t++)if(n[t].id===e)return!0;return!1};return t?v.a.createElement(y.o,{lines:"none"},v.a.createElement(y.r,null,v.a.createElement(y.o,{lines:"none",key:-1},v.a.createElement(y.P,{mode:"md",key:-1,checked:(null===t||void 0===t?void 0:t.length)===(null===n||void 0===n?void 0:n.length),onClick:function(){return function(){var e=(null===t||void 0===t?void 0:t.length)!==(null===n||void 0===n?void 0:n.length);if((null===t||void 0===t?void 0:t.length)===(null===n||void 0===n?void 0:n.length)){if(e)return;a([])}else{if(!e)return;a(t?t.slice():null)}}()}}),v.a.createElement(y.p,null,"SELECT ALL")),t&&t.map((function(e){return v.a.createElement(y.o,{lines:"none",key:e.id},v.a.createElement(y.P,{mode:"md",key:e.id,onClick:function(){!function(e){if(null!==n)if(!n.map((function(e){return e.id})).includes(e.id)){var t=n.slice();t.push(e),a(t)}else{var r=n.filter((function(t){return t.id!==e.id}));a(r)}}(e)},checked:r(e.id)}),v.a.createElement(y.p,null,e.name))})))):v.a.createElement("div",null,"Loading...")},Te=function(e){var t=e.onDismissModal,n=e.isOpen,a=Object(f.useContext)(ke).user,r=Object(f.useState)(null),o=Object(S.a)(r,2),i=o[0],c=o[1],s=Object(f.useState)(null),l=Object(S.a)(s,2),u=l[0],d=l[1];Object(f.useEffect)((function(){if(!n)return d(null),void c(null);var e=!0;return Promise.all([ge.getTypesSelectedByUser(a),ge.listTypes(a)]).then((function(t){e&&(d(t[0]),c(t[1]))})),function(){e=!1}}),[n,a]);return v.a.createElement(v.a.Fragment,null,v.a.createElement(y.l,{className:"ion-no-border"},v.a.createElement(y.Q,null,v.a.createElement(y.e,{slot:"start"},v.a.createElement(y.d,{onClick:function(){t()}},v.a.createElement(y.m,{icon:k.c,mode:"md",slot:"icon-only"}))),v.a.createElement(y.N,null,"Notifications"))),v.a.createElement(y.h,{class:"outer-content"},v.a.createElement(je,{list:i,selected:u,selectionChanged:function(e){var t=e.map((function(e){return e.id}));ge.putTypes(a,t).then((function(){d(e)}))}})),v.a.createElement(y.j,null,v.a.createElement(y.Q,null)))};var Ae=function(){var e=Object(f.useState)(!1),t=Object(S.a)(e,2),n=t[0],a=t[1],r=Object(f.useState)({message:""}),o=Object(S.a)(r,2),i=o[0],c=o[1];return{showToast:function(e){c({message:e}),a(!0)},simpleToastJsx:v.a.createElement(y.O,{isOpen:n,onDidDismiss:function(){return a(!1)},position:"top",message:i.message,duration:1500})}},De=n(219),Ne=n(220),we=n(221),xe=n(100),Me=n(222),Fe=n(223),Le=n(232),Re=n(224),Pe=n(98),Ue=n(218),Be=new Date(9e3,1,1);function Ve(e,t){return e===U.Shift&&t===p.Approved||e===U.Cover&&t===p.Request||e===U.Cover&&t===p.RequestDenied}function qe(e,t){return e===U.Absent&&t===p.Approved}function ze(e,t){return Ve(e,t)||e===U.Clock&&t===p.Approved}function We(e,t){return e===U.Unavailable&&t===p.Approved||e===U.Vacation&&t===p.Approved||e===U.Absent&&t===p.Approved||e===U.Cover&&t===p.Approved}function _e(e,t){var n;return null!==t&&et.getDurationFromTimeSpan(null===(n=e.Data)||void 0===n?void 0:n.TotalValue.Time.ActualTime)>et.getDurationFromTimeSpan(t.ForgotToClockOutTime)}var Ge={eventMatchesFilter:function(e,t,n,a){return e===m.DontWork&&t===m.DontWork?We(n,a):e>0&&t>0?e===n&&t===a:e>0&&t===m.All?e===n:e===m.All&&t>0?t===a:e===m.Scheduled&&t===m.Scheduled?Ve(n,a)||qe(n,a):e!==m.ClockAndSched||t!==m.ClockAndSched||(ze(n,a)||qe(n,a))},isAbsentExpenseEvent:qe,isClockedIn:function(e){return e.EventTypeId===U.Clock&&e.EventStatusId===p.Approved&&Object(Ue.a)(e.EventEnd,Be)},isDontWorkEvent:We,isExtendedClock:_e,isPositionSpecificEvent:function(e){return e===U.Shift||e===U.Cover||e===U.Clock||e===U.Absent},isShiftTypeEvent:Ve,isTimeClockEvent:ze,showFlagForExtendedClock:function(e,t){return null!==t&&(e.EventTypeId===U.Clock&&!e.IsClockedIn&&_e(e,t))}},Ye=n(97),Je=n(231),He=new Date(9e3,1,1);function Ke(e){return void 0!==e.BusinessId}function Qe(e){if(!e)return 0;var t,n,a=e.split(":");if(a[0].indexOf(".")>=0){var r=a[0].split(".");t=24*parseInt(r[0])+parseInt(r[1]),n=parseInt(a[1])}else t=parseInt(a[0]),n=parseInt(a[1]);return 60*t+n}function Ze(e,t){if(0===e.length)return 0;var n=e.split(":");return 3!==n.length?0:parseInt(n[t])}function Xe(e,t,n){var a=Number(e).toFixed(n).toString(),r="";0===a.indexOf("-")&&(a=a.substring(1),r="-");var o="0000000000"+a;return-1===a.indexOf(".")?r+o.substr(o.length-Math.max(a.length,t)):r+o.substr(o.length-Math.max(a.length,t+n+1))}function $e(e,t){var n="0000000000"+e;return n.substr(n.length-t)}var et={convertTimeWithoutTimeZoneToLocalTime:function(e){var t=Intl.DateTimeFormat().resolvedOptions().timeZone,n=Object(Ye.a)(e,{timeZone:t});return Object(Je.a)(n,"yyyy-MM-dd",{timeZone:t})+"T"+Object(Je.a)(n,"HH:mm:ssXXX",{timeZone:t})},formatDateTimeAsMvcString:function(e){return e.getFullYear()+"-"+$e(e.getMonth()+1,2)+"-"+$e(e.getDate(),2)+"T"+$e(e.getHours(),2)+":"+$e(e.getMinutes(),2)+":00"},getBreakStartEnd:function(e){var t=Object(xe.a)(Object(Ne.a)(e.BreakStart),"h:mmaaa").replace("M","");if(!e.BreakEnd||e.BreakEnd>He)return t;var n=Object(xe.a)(Object(Ne.a)(e.BreakEnd),"h:mmaaa").replace("M","");return"".concat(t," - ").concat(n)},getCurrentLocationDateTime:function(e){var t=(new Date).toISOString().replace("Z","");return Object(De.a)(Object(Ne.a)(t),e.TimeZoneOffset)},getDateString:function(e){return Object(xe.a)(e,"EEE MMM d, yyyy").toUpperCase()},getDuration:function(e){var t=function(e,t){var n=Object(Ne.a)(e),a=t?Object(Ne.a)(t):new Date;return a>He&&(a=new Date),Object(Le.a)(a,n)},n=t(e.EventStart,e.EventEnd);return e.EventBreaks&&e.EventBreaks.map((function(e){return n-=t(e.BreakStart,e.BreakEnd)})),n},getDurationFromTimeSpan:Qe,getDurationString:function(e){if(e<60)return"(".concat(e,"m)");var t="(".concat(Math.floor(e/60),"h");return e%60===0?t+")":t+" ".concat(e%60,"m)")},getDurationStringFromTimeSpan:function(e){if(!e)return"(0m)";var t,n,a=e.split(":");if(a[0].indexOf(".")>=0){var r=a[0].split(".");t=24*parseInt(r[0])+parseInt(r[1]),n=parseInt(a[1])}else t=parseInt(a[0]),n=parseInt(a[1]);return t>0?"(".concat(t,"h ").concat(n,"m)"):"(".concat(n,"m)")},getEventBreakStartEndString:function(e){var t=Object(xe.a)(Object(Ne.a)(e.BreakStart),"h:mmaa").replace("M",""),n=e.BreakEnd?Object(xe.a)(Object(Ne.a)(e.BreakEnd),"h:mmaa").replace("M",""):Object(xe.a)(new Date,"h:mmaa").replace("M","");return"".concat(t," - ").concat(n)},getEventInformationStartEnd:function(e){var t,n=Object(xe.a)(Object(Ne.a)(e.EventStart),"h:mmaaa").replace("M","");return t=!Ke(e)&&e.IsClockedIn||Ke(e)&&Ge.isClockedIn(e)?Object(xe.a)(new Date,"h:mmaaa").replace("M",""):Object(xe.a)(Object(Ne.a)(e.EventEnd),"h:mmaaa").replace("M",""),"".concat(n," - ").concat(t)},getHoursFromTimeSpan:function(e){return Ze(e,0)},getMessageDeliveryTimeString:function(e){return Object(xe.a)(Object(Ne.a)(e),"M/d EEE h:mmaa").replace("M","")},getMinutesFromTimeSpan:function(e){return Ze(e,1)},getMinutesFromTimeString:function(e,t){if(!t||0===t.length)return 0;if(e.TimeFormat===Y.HoursMinutes){if(!/^\d*(:\d{2})?$/.test(t))return 0;if(":"===t[0])return parseInt(t.substring(1));var n=t.split(":");return 1===n.length?60*parseInt(t):60*parseInt(n[0])+parseInt(n[1])}return/^\d+(.\d*)?$/.test(t)?Math.round(60*parseFloat(t)):0},getTimeStringFromMinutes:function(e,t){if(e.TimeFormat===Y.HoursMinutes){if(null===t)return"00:00";var n=Math.floor(t/60),a=t%60;return"".concat($e(n,2),":").concat($e(a,2))}return null===t?"0":Xe(t/60,e.TimeFormatDigits,e.TimeFormatDecimals)},getTimeStringFromOrbitalTime:function(e,t){if("00:00:00"===t.ActualTime)return e.TimeFormat===Y.HoursMinutes?"00:00":Xe(0,e.TimeFormatDigits,e.TimeFormatDecimals);if(e.TimeFormat===Y.HoursMinutes){var n=t.ActualTime.split(":");if(3!==n.length)return t.ActualTime;if(n[0].includes(".")){var a=n[0].split("."),r=24*parseInt(a[0])+parseInt(a[1]);return"".concat(r,":").concat(n[1])}var o=parseInt(n[0]);return"".concat(o,":").concat(n[1])}return Xe(t.ActualHours,e.TimeFormatDigits,e.TimeFormatDecimals)},getTodayStartForLocation:function(e,t){var n=new Date(e.valueOf()),a=Qe(t.DayStartTime.split("T")[1]);n.setMinutes(-1*a,n.getSeconds(),n.getMilliseconds());var r=!Object(Pe.a)(n,e),o=new Date(e.valueOf());return r?o.setHours(-24,a,0,0):o.setHours(0,a,0,0),o},getWeekStart:function(e,t,n){var a=!n||n.indexOf("T")<0?0:Qe(n.split("T")[1]),r=e;r.setHours(0,a,0,0);for(var o=0;Object(xe.a)(r,"EEEE")!==t&&o<20;)r=Object(Re.a)(r,-1),o++;return o>15&&console.error("Could not calculate week start based on date ".concat(e)+'and weekStartsOn "'.concat(t,'"')),r},messageDateString:function(e){var t=Object(Ne.a)(e),n=new Date;return Object(we.a)(t)?Object(xe.a)(t,"h:mmaaa").replace("M",""):Object(Me.a)(n,t)<7?Object(xe.a)(t,"EEE"):Object(Fe.a)(t,n)?Object(xe.a)(t,"MMM d"):Object(xe.a)(t,"M/d/yyyy")}};function tt(){return(tt=Object(T.a)(j.a.mark((function e(t,n,a,r,o,i){var c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={locId:n,posId:a,start:et.formatDateTimeAsMvcString(r),end:et.formatDateTimeAsMvcString(o),sort:i},e.next=3,me.post(t,"api/v2/employees/at-position",c);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function nt(){return(nt=Object(T.a)(j.a.mark((function e(t,n,a,r,o,i){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me.post(t,"api/v2/employees/get-communication-list",{locId:n,depId:a,posId:r,channel:o,role:i});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function at(){return(at=Object(T.a)(j.a.mark((function e(t,n){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={version:oe.settings.appVersionString,buildDate:oe.settings.buildDate,environment:oe.settings.env.item(t.environment).name,os:oe.settings.platform,msg:n},e.next=3,me.post(t,"/api/v2/employees/submit-feedback",a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var rt={getEmployeesByLocationIdPositionIdAndActiveDateRange:function(e,t,n,a,r,o){return tt.apply(this,arguments)},getEmployeeListForCommunication:function(e,t,n,a,r,o){return nt.apply(this,arguments)},submitFeedback:function(e,t){return at.apply(this,arguments)}};function ot(e){var t=Object(f.useState)(!1),n=Object(S.a)(t,2),a=n[0],r=n[1],o=v.a.createElement(y.s,{isOpen:a,onDidDismiss:function(){return r(!1)},spinner:"dots",message:e,duration:1e4});return{showLoading:a,setShowLoading:r,showLoadingJsx:o}}var it=function(e){var t=e.onDismissModal,n=Object(f.useContext)(ke).user,a=Object(f.useState)(""),r=Object(S.a)(a,2),o=r[0],i=r[1],c=ot("Submitting your message...");return v.a.createElement(v.a.Fragment,null,v.a.createElement(y.l,{className:"ion-no-border"},v.a.createElement(y.Q,null,v.a.createElement(y.e,{slot:"start"},v.a.createElement(y.d,{onClick:function(){t(!1)}},v.a.createElement(y.m,{icon:k.c,slot:"icon-only"}))),v.a.createElement(y.N,null,"Ticket Details"))),v.a.createElement(y.h,{class:"outer-content"},v.a.createElement(y.r,null,v.a.createElement(y.o,{lines:"none"},v.a.createElement(y.M,{value:o,placeholder:"Enter message",autoGrow:!0,spellcheck:!0,wrap:"hard",debounce:50,onIonChange:function(e){i(e.detail.value)}}))),c.showLoadingJsx),v.a.createElement(y.j,null,v.a.createElement(y.d,{className:"apply-button",expand:"block",onClick:function(){null!==o&&void 0!==o&&(c.setShowLoading(!0),rt.submitFeedback(n,o).then((function(e){ce("submit-feedback",{succeeded:!e.error}),c.setShowLoading(!1),t(!0)})))},disabled:null===o||void 0===o||0===o.length},"Submit")))},ct=function(){var e=Object(f.useState)(!1),t=Object(S.a)(e,1)[0],n=v.a.useContext(ke).user,a=oe.settings.env.item(n.environment),r="prod"!==a.key?n.username.substr(4):n.username,o=Ce(),i=Object(f.useState)(!1),c=Object(S.a)(i,2),s=c[0],l=c[1],u=Object(f.useState)(!1),d=Object(S.a)(u,2),m=d[0],p=d[1],E=Ae();return v.a.createElement(y.t,{type:"overlay",disabled:t,contentId:"main"},v.a.createElement(y.l,{className:"ion-no-border"},v.a.createElement(y.Q,null,v.a.createElement(y.N,null,"Menu"))),v.a.createElement(y.h,{className:"outer-content"},"prod"!==a.key&&v.a.createElement("div",{className:"username-header"},r.toUpperCase()," (",a.name.toUpperCase(),")"),"prod"===a.key&&v.a.createElement("div",{className:"username-header"},"User ",r),v.a.createElement(y.r,null,v.a.createElement(y.v,{"auto-hide":"false"},v.a.createElement(y.o,{button:!0,onClick:function(){l(!0)}},v.a.createElement(y.p,null,"Notifications"),v.a.createElement(y.m,{slot:"end",icon:k.u}))),v.a.createElement(y.v,{"auto-hide":"false"},v.a.createElement(y.o,{button:!0,onClick:function(){p(!0)}},v.a.createElement(y.p,null,"Submit a Ticket"),v.a.createElement(y.m,{slot:"end",icon:k.t}))),v.a.createElement(y.v,{"auto-hide":"false"},v.a.createElement(y.o,{button:!0,routerLink:"/logout",routerDirection:"none"},v.a.createElement(y.m,{slot:"end",icon:k.r}),v.a.createElement(y.p,null,"Logout")))),o.alertBoxJsx,E.simpleToastJsx),v.a.createElement(y.j,null,v.a.createElement("div",{className:"debug-info"},"Capacitor: ",oe.settings.hasCapacitor?"Yes":"No",v.a.createElement("br",null),"Build Date: ",oe.settings.buildDate,v.a.createElement("br",null),"Version: ",oe.settings.appVersionString)),v.a.createElement(y.w,{isOpen:s},v.a.createElement(Te,{onDismissModal:function(){l(!1)},isOpen:s})),v.a.createElement(y.w,{isOpen:m},v.a.createElement(it,{onDismissModal:function(e){p(!1),e&&E.showToast("Submitted, thank you!")},isOpen:m})))};n(120),n(121),n(122),n(123),n(124),n(125),n(126),n(127),n(128),n(129),n(130);function st(){return(st=Object(T.a)(j.a.mark((function e(t,n,a){var r,o,i,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Authenticating against ".concat(oe.settings.env.item(a).name," (").concat(oe.settings.env.item(a).url,")")),r=oe.settings.env.item(a).url+"token",o="grant_type=password&username=".concat(t,"&password=").concat(n),e.prev=3,e.next=6,fetch(r,{method:"POST",body:o});case 6:return i=e.sent,e.next=9,i.json();case 9:if(!(c=e.sent).error&&!c.error_description){e.next=12;break}return e.abrupt("return",{loggedIn:!1,error:c.error_description,access_token:""});case 12:return e.abrupt("return",{loggedIn:!0,access_token:c.access_token});case 15:return e.prev=15,e.t0=e.catch(3),console.error("Error returned from authentication request: "+e.t0),e.abrupt("return",{loggedIn:!1,err:e.t0,error:"Error attempting to log in",access_token:""});case 19:case"end":return e.stop()}}),e,null,[[3,15]])})))).apply(this,arguments)}function lt(){return(lt=Object(T.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me.get(t,"api/v3/home/get-auth");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ut={authenticateUser:function(e,t,n){return st.apply(this,arguments)},getAuthorizedItems:function(e){return lt.apply(this,arguments)}};function dt(e,t){return e&&e.locations&&0!==e.locations.length?t<=0?null:e.locations.filter((function(e){return e.id===t}))[0]:null}function mt(e,t){if(!e||!e.locations||0===e.locations.length)return null;if(t<=0)return null;var n=null;return e.locations.flatMap((function(e){return e.departments.map((function(e){return 1===e.positions.filter((function(e){return e.id===t})).length?(n=e,e):null}))})),n}function pt(e,t,n,a){if(!e||!e.locations||0===e.locations.length)return!1;if(e.role===W.Employee)return!1;if(e.role===W.LocationAdmin||e.role===W.BusinessAdmin)return!0;if(-1===n){var r=dt(e,t);return!0===(null===r||void 0===r?void 0:r.adminAllDepts)}return(e.locations.flatMap((function(e){return e.departments.filter((function(e){return e.id===n}))}))[0].adminAuth&a)===a}var ft={adminCan:function(e,t){return(e&t)===t},getLocSettingsForLocationId:function(e,t){if(!e||!e.locations||0===e.locations.length)throw new Error("getLocSettingsForLocationId: called with invalid auth parameter");return 0===t?e.locations[0].settings:e.locations.filter((function(e){return e.id===t}))[0].settings},getLocationFromLocationId:dt,getLocationIdFromPositionid:function(e,t){for(var n=0;n<e.locations.length;n++)for(var a=e.locations[n],r=0;r<a.departments.length;r++){if(void 0!==a.departments[r].positions.find((function(e){return e.id===t})))return a.id}throw new Error("getLocationIdFromPositionId: Could not find a location that had positionid "+t)},getDepartmentFromPositionId:mt,getPositionIdsForEmployee:function(e){return e.locations.flatMap((function(e){return e.departments.flatMap((function(e){return e.positions.filter((function(e){return e.hasPosition})).map((function(e){return e.id}))}))}))},canEditSchedules:function(e,t,n){return(e.locations.filter((function(e){return e.id===t}))[0].departments.filter((function(e){return e.id===n}))[0].adminAuth&a.CanEditSchedules)===a.CanEditSchedules},getAdminAuthorizationForDepartment:function(e,t){return e.locations.flatMap((function(e){return e.departments.filter((function(e){return e.id===t}))}))[0].adminAuth},adminIsInDepartment:function(e,t){return e.role===W.Admin&&e.locations.flatMap((function(e){return e.departments.filter((function(e){return e.id===t}))}))[0].positions.filter((function(e){return e.hasPosition})).length>0},canEditNonPositionEvents:function(e,t){var n=e.locations.flatMap((function(e){return e.departments.filter((function(e){return e.id===t}))}))[0];return(n.adminAuth&a.CanEditSchedules)===a.CanEditSchedules&&n.positions.filter((function(e){return e.hasPosition})).length>0},hasPosition:function(e,t){return e.locations.flatMap((function(e){return e.departments.flatMap((function(e){return e.positions.filter((function(e){return e.hasPosition&&e.id===t}))}))})).length>0},isAuthItemsValid:function(e){return null!==e&&void 0!==e&&void 0!==e.locations&&null!==e.locations&&e.locations.length>0},isDeptAdmin:function(e,t){return!(!e||!e.locations||0===e.locations.length)&&(e.role!==W.Employee&&(e.role===W.BusinessAdmin||e.role===W.LocationAdmin||e.locations.flatMap((function(e){return e.departments.filter((function(e){return e.id===t}))}))[0].isDeptAdmin))},isAdminForAllDepts:function(e,t){if(e.role===W.BusinessAdmin||e.role===W.LocationAdmin)return!0;if(e.role===W.Employee)return!1;var n=dt(e,t);return!0===(null===n||void 0===n?void 0:n.adminAllDepts)},isAdminForThisEvent:function(e,t){if(t.role===W.Employee)return!1;if(t.role===W.BusinessAdmin||t.role===W.LocationAdmin)return!0;if(t.role===W.Admin){var n=mt(t,e.position.position.id);return null!==n&&pt(t,e.locationId,n.id,a.CanEditSchedules)}return!1},isAdminAuthorizedFor:pt,getSelectedDepartment:function(e,t,n){var a=dt(e,t);if(null===a)throw new Error('getSelectedDepartment: Could not find locationId "'.concat(t,'"'));if(-1===n)return{location:a,department:null};var r=a.departments.filter((function(e){return e.id===n}))[0];return{location:a,department:r}},getSelectedPositionWithLocId:function(e,t,n){var a=e.filter((function(e){return e.id===t}))[0],r=a.departments.flatMap((function(e){return e.positions.filter((function(e){return e.id===n}))}))[0];return{location:a,position:r}},getSelectedPosition:function(e,t){for(var n=0;n<e.length;n++)for(var a=0;a<e[n].departments.length;a++)for(var r=0;r<e[n].departments[a].positions.length;r++)if(e[n].departments[a].positions[r].id===t)return{location:e[n],position:e[n].departments[a].positions[r]};return{location:{},position:{}}},getAdminDetpartments:function(e){return!e||!e.locations||e.locations.length>0||e.role===W.Employee?[]:e.role===W.BusinessAdmin||e.role===W.LocationAdmin?e.locations.flatMap((function(e){return e.departments})):e.role===W.Admin?e.locations.flatMap((function(e){return e.departments})).filter((function(e){return e.isDeptAdmin})):[]},requiresGeolocation:function(e){for(var t=0;t<e.length;t++)if(e[t].settings.RequireGeoLocation)return!0;return!1}},vt={subscriptionType:G.None,businessId:0,businessName:"",employeeId:0,firstOrNickName:"",firstName:"",nickName:"",middleName:"",lastName:"",fullName:"",timeClock:!1,role:W.Employee,locations:[],loading:!1,payrollEvents:[],tags:[],lastRefresh:void 0},Et={auth:vt,refreshAuth:function(e,t){return new Promise((function(){}))},clearAuth:function(){var e=Object(T.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),authLoading:!1},ht=v.a.createContext(Et);function gt(e,t){return bt.apply(this,arguments)}function bt(){return(bt=Object(T.a)(j.a.mark((function e(t,n){var a,r,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isLoggedin){e.next=5;break}return a=Object(I.a)({},vt),e.next=4,L.putAuthItems(a).then((function(){ce("indexdb_authitems_cleared")}));case 4:return e.abrupt("return",a);case 5:if(n){e.next=12;break}return e.next=8,L.getAuthItems();case 8:if(r=e.sent,!(ft.isAuthItemsValid(r)&&void 0!==r.lastRefresh&&Object(Le.a)(new Date,r.lastRefresh)<re(t).maxStaleAuthItemsInMinutes)){e.next=12;break}return se(t,r),e.abrupt("return",r);case 12:return e.next=14,ut.getAuthorizedItems(t);case 14:if(!((o=e.sent)&&o.locations&&o.locations.length>0)){e.next=23;break}return e.next=18,L.putAuthItems(Object(I.a)({},o,{lastRefresh:new Date}));case 18:return ce("indexdb_authitems_put",{employeeId:o.employeeId}),se(t,o),e.abrupt("return",o);case 23:return e.abrupt("return",null);case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var yt=function(e){var t=Object(f.useState)(Object(I.a)({},vt)),n=Object(S.a)(t,2),a=n[0],r=n[1],o=Object(f.useState)(!1),i=Object(S.a)(o,2),c=i[0],s=i[1],l=function(){var e=Object(T.a)(j.a.mark((function e(t,n){var o,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s(!0),n.isLoggedin||(o=Object(I.a)({},vt),r(o),L.putAuthItems(o).then((function(){ce("indexdb_authitems_cleared")})),s(!1)),!(!t&&a.employeeId>0&&void 0!==a.lastRefresh&&Object(Le.a)(new Date,a.lastRefresh)<re(n).maxStaleAuthItemsInMinutes)){e.next=4;break}return e.abrupt("return",a);case 4:return e.next=6,gt(n,t);case 6:return i=e.sent,s(!1),i&&r(i),e.abrupt("return",i);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),u=function(){var e=Object(T.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r(vt),e.next=3,L.putAuthItems(vt);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return v.a.createElement(ht.Provider,{value:{auth:a,refreshAuth:l,clearAuth:u,authLoading:c}},e.children)};function Ot(e,t){return e.length>0&&t.length>5}var St=function(e){var t=e.history,n=Ce(),a=n.alertBoxJsx,r=n.showAlert,o=v.a.useContext(ke),i=o.user,c=o.userLoggedIn,s=o.logout,l=v.a.useContext(ht).refreshAuth,u=Object(f.useState)(!1),d=Object(S.a)(u,2),m=d[0],p=d[1],E=Object(f.useState)(""),h=Object(S.a)(E,2),g=h[0],b=h[1],O=Object(f.useState)(""),k=Object(S.a)(O,2),I=k[0],C=k[1],A=Object(f.useState)(""),D=Object(S.a)(A,1)[0],N=Object(f.useState)(""),w=Object(S.a)(N,1)[0],x=Object(f.useState)(!1),M=Object(S.a)(x,2),F=M[0],L=M[1],R=function(){var e=Object(T.a)(j.a.mark((function e(){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(g&&I){e.next=2;break}return e.abrupt("return");case 2:n=oe.getUserAndEnvironmentFromInput(g),p(!0),ut.authenticateUser(n.username,I,n.env.key).then((function(e){if(e.loggedIn)c(g,e.access_token,n.env.key).then((function(e){l(!0,e).then((function(){ce("login",{username:n.username,appVersion:oe.settings.appVersionString,environment:n.env.name}),console.log("logged in to ".concat(n.env.name,": ").concat(n.username)),t.push("/tabs/schedule",{direction:"none"}),t.goForward(),p(!1)})).catch((function(){p(!1),r("Failed to log in","Could not retreive user data",(function(){s()}))}))})).catch((function(){p(!1),r("Failed to log in","Could not set access token",(function(){s()}))}));else{p(!1),ce("login_failure",{username:n.username,appVersion:oe.settings.appVersionString,environment:n.env.name});var a=e.error?e.error:"Could not log in";r("Failed to log in",a,(function(){C(""),L(!1)}))}}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(y.W)((function(){i.isLoggedin&&(t.push("/tabs/schedule",{direction:"forward"}),t.goForward())})),v.a.createElement(y.x,{id:"login-page"},v.a.createElement(y.h,{className:"login-content"},v.a.createElement("div",{className:"login-logo"},v.a.createElement("img",{className:"logo",src:"assets/img/OS Logo - 4pt Rounded _ 2 Tone Orange.svg",alt:"Orbital Shift Logo"})),v.a.createElement(y.s,{isOpen:m,onDidDismiss:function(){return p(!1)},spinner:"dots",message:"Logging in...",duration:0}),a,v.a.createElement(y.r,{className:"form-list"},v.a.createElement("div",{className:"item"},v.a.createElement("div",{className:"label"},"User"),v.a.createElement("div",{className:"field-container"},v.a.createElement("input",{className:"input",id:"username",name:"username",type:"text",value:g,onChange:function(e){var t;t=e.target.value,b(t),L(Ot(t,I))}}))),D.length>0&&v.a.createElement(y.L,{color:"light"},v.a.createElement("p",{className:"ion-padding-start"},D)),v.a.createElement("div",{className:"item"},v.a.createElement("div",{className:"label"},"Password"),v.a.createElement("div",{className:"field-container"},v.a.createElement("input",{className:"input",id:"password",name:"password",type:"password",value:I,onChange:function(e){var t;t=e.target.value,C(t),L(Ot(g,t))}}))),w.length>0&&v.a.createElement(y.L,{color:"light"},v.a.createElement("p",{className:"ion-padding-start"},w))),v.a.createElement(y.B,null,v.a.createElement(y.g,null,v.a.createElement(y.d,{className:"login-button",type:"submit",onClick:R,expand:"block",disabled:!F},"LOG IN")))))},kt=n(73);function It(){return(It=Object(T.a)(j.a.mark((function e(t,n){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me.get(t,"api/v2/employee/schedule-events/get/"+n);case 2:if(!(a=e.sent).error){e.next=5;break}return e.abrupt("return",null);case 5:return e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ct(){return(Ct=Object(T.a)(j.a.mark((function e(t,n){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(I.a)({},n,{start:et.formatDateTimeAsMvcString(n.start),end:et.formatDateTimeAsMvcString(n.end)}),e.next=3,me.post(t,"api/v2/employee/schedule-events/filter",a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function jt(){return(jt=Object(T.a)(j.a.mark((function e(t,n){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(I.a)({start:et.formatDateTimeAsMvcString(n.start),end:et.formatDateTimeAsMvcString(n.end)},n),e.next=3,me.post(t,"api/v2/daily-notes/filter",a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Tt(e){return e.length>19?e.slice(0,19):e}function At(){return(At=Object(T.a)(j.a.mark((function e(t,n,a){var r,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={scheduleEventId:n.scheduleEventId,eventType:n.eventType,eventStatus:n.eventStatus,isConfirmed:n.isConfirmed,positionId:n.position.position.id,employeeId:n.employee.id,eventStart:Tt(n.eventStart),eventEnd:Tt(n.eventEnd),tagId:null===(r=n.tag)||void 0===r?void 0:r.id,eventBreaks:n.eventBreaks,isClockedIn:n.isClockedIn,breakStart:null,breakDuration:null,clockOutValue:n.clockoutValue,absentId:n.absentId,absentTime:n.absentTimeMinutes,notes:n.notes,sendMessage:!1,recurrenceId:n.recurrenceId,recurrenceStart:n.recurrenceStart,recurrenceEnd:n.recurrenceEnd,recurrenceType:n.recurrenceType,repeatInterval:n.repeatInterval,repeatWeekdays:n.repeatWeekdays,recurrenceUpdateType:a},e.next=3,me.post(t,"api/v2/employee/schedule-events/update",o);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Dt(){return(Dt=Object(T.a)(j.a.mark((function e(t,n,a){var r,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={sceduleEventId:0,eventType:n.eventType,eventStatus:n.eventStatus,isConfirmed:n.isConfirmed,positionId:n.position.position.id,employeeId:n.employee.id,eventStart:Tt(n.eventStart),eventEnd:Tt(n.eventEnd),tagId:null===(r=n.tag)||void 0===r?void 0:r.id,eventBreaks:n.eventBreaks,isClockedIn:n.isClockedIn,breakStart:null,breakDuration:null,clockOutValue:n.clockoutValue,absentId:n.absentId,absentTime:n.absentTimeMinutes,notes:n.notes,sendMessage:!1,recurrenceId:n.recurrenceId,recurrenceStart:n.recurrenceStart,recurrenceEnd:n.recurrenceEnd,recurrenceType:n.recurrenceType,repeatInterval:n.repeatInterval,repeatWeekdays:n.repeatWeekdays,recurrenceUpdateType:a},e.next=3,me.post(t,"api/v2/employee/schedule-events/create",o);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Nt(){return(Nt=Object(T.a)(j.a.mark((function e(t,n,a){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={scheduleEventId:n,recurrenceUpdateType:a,sendMessage:!1},e.next=3,me.post(t,"api/v2/employee/schedule-events/delete",r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function wt(){return(wt=Object(T.a)(j.a.mark((function e(t,n,a){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={id:n,confirm:a},e.next=3,me.post(t,"api/v2/employee/schedule-events/confirm",r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var xt,Mt={getScheduleEvent:function(e,t){return It.apply(this,arguments)},getScheduleEventsByFilter:function(e,t){return Ct.apply(this,arguments)},getDailyNotesByFilter:function(e,t){return jt.apply(this,arguments)},updateScheduleEvent:function(e,t,n){return At.apply(this,arguments)},createScheduleEvent:function(e,t,n){return Dt.apply(this,arguments)},deleteScheduleEvent:function(e,t,n){return Nt.apply(this,arguments)},updateConfirmedScheduleEvent:function(e,t,n){return wt.apply(this,arguments)}};!function(e){e[e.schedule=0]="schedule",e[e.clock=1]="clock"}(xt||(xt={}));var Ft={settingsLocId:0,dnLocIds:[],start:new Date,end:new Date,filterByEmployee:!1,positionIds:[],eventTypeId:m.ClockAndSched,eventStatusId:m.ClockAndSched,tagId:void 0,view:xt.schedule},Lt={settingsLocId:0,dnLocIds:[],positionIds:[],tagId:void 0,eventTypeId:m.ClockAndSched,eventStatusId:m.ClockAndSched},Rt=function(e){var t=e.startDate,n=e.setStartDate,a=e.onWeekdayClick,r=Object(f.useRef)(t),o=function(e){Object(Pe.a)(e,r.current)||(r.current=e,n(e))};return v.a.createElement("div",{className:"chooser"},v.a.createElement("div",{className:"top"},v.a.createElement("button",{onClick:function(){return o(Object(Re.a)(t,-7))},className:"arrow",key:-1},v.a.createElement(y.m,{mode:"ios",icon:k.b})),v.a.createElement("div",{className:"month-year-container"},v.a.createElement("div",{className:"datetime-picker-container"},v.a.createElement(y.i,{mode:"ios",className:"datetime-picker",displayFormat:"MMM YYYY",pickerFormat:"MMM D YYYY",min:"2005-01-01",max:"2030-01-01",value:t.toISOString(),onIonChange:function(e){o(Object(Ne.a)(e.detail.value))}}),v.a.createElement(y.m,{mode:"md",icon:k.k}))),v.a.createElement("button",{onClick:function(){return o(Object(Re.a)(t,7))},className:"arrow",key:7},v.a.createElement(y.m,{mode:"ios",icon:k.e}))),v.a.createElement("div",{className:"weekday-list"},[0,1,2,3,4,5,6].map((function(e){var n=Object(Re.a)(t,e),r=Object(we.a)(n)?"today":"not-today";return v.a.createElement("button",{key:e,className:"weekday-button",style:{outline:"none"},onClick:function(){a(n)}},v.a.createElement("div",null,v.a.createElement("div",{className:"weekday-abbr"},Object(xe.a)(n,"EEE")),v.a.createElement("div",{className:r}),v.a.createElement("div",{className:"weekday-num"},Object(xe.a)(n,"d"))))}))))},Pt=n(225);var Ut={1:"#9CBA6A",2:"#BFBFBF",3:"#FFAD00",4:"#C41A26",6:"#677A46",7:"#FFAD00"},Bt={1:{color:"black"},2:{color:"#C41A26"},4:{color:"#BCBCBC"}},Vt=function(e){var t,n=e.location,r=e.event,o=e.multiLocation,i=e.showEmployeeName,c=e.onEdit,s=Object(f.useContext)(ht).auth,l=i?{display:"inline-block"}:{display:"none"},u=ft.getLocSettingsForLocationId(s,r.LocationId),d=Object(Ne.a)(r.EventStart),m=!!o||n.departments.filter((function(e){return e.positions.filter((function(e){return e.hasPosition}))})).length>1,E="";o&&r.AbbreviatedLocationName&&(E=r.AbbreviatedLocationName+"/"),m&&r.AbbreviatedDepartmentName&&(E+=r.AbbreviatedDepartmentName+"/"),E+=r.PositionName;var h={borderLeft:"7px solid ".concat(Ut[r.EventTypeId]," ")},g=void 0!==(null===(t=r.EventBreaks)||void 0===t?void 0:t.find((function(e){return null===e.BreakEnd}))),b=Bt[r.EventStatusId],O=Ge.isExtendedClock(r,u)?"orange":"black",S=function(){(function(e,t,n,r,o,i,c,s,l,u){if(u.role===W.BusinessAdmin)return!0;if(u.role===W.LocationAdmin)return!Ge.isPositionSpecificEvent(e)||0!==u.locations.filter((function(e){return e.id===i})).length;var d=Object(Ne.a)(o),m=new Date,f=Object(Ue.a)(m,d),v=!1,E=ft.getAdminAuthorizationForDepartment(u,c);if(u.role===W.Admin)if(n===u.employeeId){if(e===U.Clock)return(E&a.CanEditOwnClockEvents)===a.CanEditOwnClockEvents;if((E&a.CanEditSchedules)===a.CanEditSchedules)return!0;v=!0}else{if(e===U.Clock)return(E&a.CanEditEmployeeClockEvents)===a.CanEditEmployeeClockEvents;if(ft.canEditSchedules(u,i,c))return!0;if(!ft.adminIsInDepartment(u,c))return!1;v=!0}return!(u.role!==W.Employee&&!v)&&(n===u.employeeId?!f&&(e!==U.Clock&&(e===U.Shift?t===p.Approved||t===p.Request:e===U.Cover?t===p.Request:!(Ge.isPositionSpecificEvent(e)||!ft.canEditNonPositionEvents(u,c))||t===p.Request)):e===U.Cover&&t===p.Request)})(r.EventTypeId,r.EventStatusId,r.EmployeeId,r.EventStart,r.EventEnd,r.LocationId,r.DepartmentId,r.PositionId,r.IsConfirmed,s)&&c(r)};return v.a.createElement("button",{className:"card",onClick:function(){S()}},v.a.createElement("div",{className:"card-first-col"},v.a.createElement("div",{className:"day-name"},Object(xe.a)(d,"EEE")," "),v.a.createElement("div",{className:"day-number"},Object(xe.a)(d,"d"))),v.a.createElement("div",{className:"card-second-col",style:h},v.a.createElement("div",{className:"time-row"},g&&v.a.createElement(y.m,{icon:k.h,style:{color:O}}),r.IsClockedIn&&!g&&v.a.createElement(y.m,{icon:k.x,style:{color:O}}),Ge.showFlagForExtendedClock(r,u)&&v.a.createElement(y.m,{icon:k.o,style:{color:"orange"}}),v.a.createElement("span",{style:b},et.getEventInformationStartEnd(r),"\xa0\xa0"),et.getDurationStringFromTimeSpan(r.EventTypeId===U.Absent?r.Time:r.EventDuration)),v.a.createElement("div",{className:"name-row",style:l},r.FirstName," ",r.LastName),v.a.createElement("div",{className:"dept-position-row"},r.IsConfirmed&&v.a.createElement(y.m,{icon:k.m}),E,"\xa0\xa0",r.Tag&&"~".concat(r.Tag))))};var qt=function(){var e=Object(f.useState)(!1),t=Object(S.a)(e,2),n=t[0],a=t[1],r=Object(f.useState)({header:"",message:"",options:[],onDismiss:function(e){}}),o=Object(S.a)(r,2),i=o[0],c=o[1],s=function(e){a(!1),i.onDismiss(e)};return{showDialog:function(e,t,n,r){c({header:e,message:t,options:n,onDismiss:r}),a(!0)},dialogBoxJsx:v.a.createElement(y.w,{isOpen:n,cssClass:"mini-modal orbital-dialog-modal",onDidDismiss:function(){return s(null)}},v.a.createElement(y.h,{className:"modal-content"},v.a.createElement(y.l,{mode:"ios"},v.a.createElement(y.Q,null,v.a.createElement(y.N,null,i.header))),v.a.createElement(y.k,null,i.options.map((function(e){return v.a.createElement(y.B,{key:e.value},v.a.createElement(y.g,{size:"12"},v.a.createElement(y.d,{expand:"block",color:e.color,className:"apply-button",onClick:function(){return s(e.value)}},e.text)))})),v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"12"},v.a.createElement(y.d,{expand:"block",className:"cancel-button",onClick:function(){return s(null)}},"Cancel"))))))}},zt=function(e){var t=e.currentDepartment,n=e.onDepartmentUpdate,r=Object(f.useContext)(ht).auth,o=Object(f.useState)(t),i=Object(S.a)(o,2),c=i[0],s=i[1];if(r&&r.locations&&0!==r.locations.length){var l=null!==c.department?c.department.id:null;return v.a.createElement(v.a.Fragment,null,v.a.createElement(y.o,null,v.a.createElement(y.p,null,"Location"),v.a.createElement(y.E,{mode:"ios",interface:"action-sheet",value:c.location.id,onIonChange:function(e){return function(e){if(e){var t={location:r.locations.filter((function(t){return t.id===e}))[0],department:null};s(t),n(t)}}(e.detail.value)}},r.locations.map((function(e){return v.a.createElement(y.F,{key:e.id,value:e.id},e.name)})))),v.a.createElement(y.o,null,v.a.createElement(y.p,null,"Department"),v.a.createElement(y.E,{mode:"ios",interface:"action-sheet",value:l,onIonChange:function(e){return function(e){if(void 0!==e){var t={location:c.location,department:null===e?null:c.location.departments.filter((function(t){return t.id===e}))[0]};s(t),n(t)}}(e.detail.value)}},ft.isAdminForAllDepts(r,c.location.id)&&v.a.createElement(y.F,{key:-1,value:null},"All Departments"),c.location.departments.filter((function(e){return ft.isAdminAuthorizedFor(r,c.location.id,e.id,a.CanEditSchedules)})).map((function(e){return v.a.createElement(y.F,{key:e.id,value:e.id},e.name)})))))}return v.a.createElement(v.a.Fragment,null,v.a.createElement("div",null,"Loading"))};function Wt(){return(Wt=Object(T.a)(j.a.mark((function e(t,n,a,r,o){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me.post(t,"api/v2/daily-notes/update",{dailyNoteId:n,date:et.formatDateTimeAsMvcString(o),text:a,role:r});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _t(){return(_t=Object(T.a)(j.a.mark((function e(t,n,a,r,o,i){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me.post(t,"api/v2/daily-notes/insert",{locId:n,depId:a,role:r,date:o,text:i});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Gt(){return(Gt=Object(T.a)(j.a.mark((function e(t,n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me.post(t,"api/v2/daily-notes/delete/"+n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Yt(){return(Yt=Object(T.a)(j.a.mark((function e(t,n,a,r,o){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me.post(t,"api/v2/daily-notes/get",{locId:n,depId:a,role:r,date:o});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Jt={getDailyNote:function(e,t,n,a,r){return Yt.apply(this,arguments)},updateDailyNote:function(e,t,n,a,r){return Wt.apply(this,arguments)},insertDailyNote:function(e,t,n,a,r,o){return _t.apply(this,arguments)},deleteDailyNote:function(e,t){return Gt.apply(this,arguments)}};var Ht=function(e){var t=e.onCloseModal,n=e.isOpen,a=e.note,r=e.initialDate,o=Object(f.useState)(a),i=Object(S.a)(o,2),c=i[0],s=i[1],l=Ae(),u=Ce(),d=Object(f.useContext)(ke).user,m=Object(f.useContext)(ht).auth,p=qt(),E=Object(f.useState)(null!==a?a.Role:1),h=Object(S.a)(E,2),g=h[0],b=h[1],O=Object(f.useState)(null!==a?ft.getSelectedDepartment(m,a.LocationId,a.DepartmentId):function(e){for(var t=0;t<e.locations.length;t++){var n=e.locations[t];if(n.adminAllDepts)return{location:n,department:null};for(var a=0;a<n.departments.length;a++){var r=n.departments[a];if(e.role===W.LocationAdmin||e.role===W.BusinessAdmin)return{location:n,department:r};if(r.isDeptAdmin)return{location:n,department:r}}}throw new Error("Could not find a department for this user to add a note")}(m)),I=Object(S.a)(O,2),C=I[0],j=I[1],T=Object(f.useState)(null!==a?a.Notes:""),A=Object(S.a)(T,2),D=A[0],N=A[1],w=Object(f.useRef)(null!==a?a.Notes.length:0),x=Object(f.useState)(null!==a?Object(Ne.a)(a.EventStart):r),M=Object(S.a)(x,2),F=M[0],L=M[1];Object(f.useEffect)((function(){var e=!0;return n&&null===c&&e&&P(C,g,F),function(){e=!1}}),[n,c]);var R,P=function(e,t,n){Jt.getDailyNote(d,e.location.id,null===e.department?-1:e.department.id,t,n).then((function(e){if("message"in e)e.error||s(null);else{if(null!==c&&c.DailyNoteId===e.DailyNoteId)return;a=c,(null===(n=e)&&null!==a||null!==n&&null===a||(null!==n||null!==a)&&((null===n||void 0===n?void 0:n.Role)!==(null===a||void 0===a?void 0:a.Role)||(null===n||void 0===n?void 0:n.DailyNoteId)!==(null===a||void 0===a?void 0:a.DailyNoteId)))&&s(e);var t=Object(Ne.a)(e.EventStart);Object(Pe.a)(t,F)||L(t),(e.LocationId!==C.location.id||-1===e.DepartmentId&&null!==C.department||-1!==e.DepartmentId&&null===C.department||null!==C.department&&e.DepartmentId!==C.department.id)&&j(ft.getSelectedDepartment(m,e.LocationId,e.DepartmentId)),e.Role!==g&&b(e.Role),e.Notes!==D&&(N(e.Notes),w.current=e.Notes.length)}var n,a}))},U=function(e,n,a,r,o){null===c&&0===D.length||null!==c&&c.Notes===D?o&&t(""):null!==c?(0===r.length&&Jt.deleteDailyNote(d,c.DailyNoteId).then((function(e){e.error?u.showAlert("Can't Delete Note",e.message,(function(){})):o?t("Note Deleted"):l.showToast("Note Deleted")})),Jt.updateDailyNote(d,c.DailyNoteId,r,n,a).then((function(e){e.error?u.showAlert("Can't Update Note",e.message,(function(){})):o?t("Note Updated"):l.showToast("Note Updated")}))):Jt.insertDailyNote(d,e.location.id,null===e.department?-1:e.department.id,n,a,r).then((function(e){e.error?u.showAlert("Can't Add Daily Note",e.message,(function(){})):o?t("Note Added"):l.showToast("Note Added")}))};return n&&m&&m.locations&&0!==m.locations.length?v.a.createElement(v.a.Fragment,null,v.a.createElement(y.l,{className:"ion-no-border"},v.a.createElement(y.Q,null,v.a.createElement(y.e,{slot:"start"},v.a.createElement(y.d,{onClick:function(){null===c&&null!=D||null!==c&&c.Notes!==D?U(C,g,F,D,!0):t("")}},v.a.createElement(y.m,{icon:k.c,slot:"icon-only"}))),v.a.createElement(y.N,null,"Daily Notes"))),v.a.createElement(y.h,{class:"edit-daily-modal-content"},v.a.createElement(y.r,null,v.a.createElement(zt,{currentDepartment:C,onDepartmentUpdate:function(e){e.location.id===C.location.id&&e.department===C.department||(j(e),U(C,g,F,D,!1),P(e,g,F))}}),v.a.createElement(y.o,null,v.a.createElement(y.p,null,"Viewable By"),v.a.createElement(y.E,{mode:"ios",interface:"action-sheet",value:g,onIonChange:function(e){var t;(t=e.detail.value)!==g&&(b(t),U(C,g,F,D,!1),P(C,t,F))}},v.a.createElement(y.F,{value:1,key:1},"Employees"),v.a.createElement(y.F,{value:2,key:2},"Admins"))),v.a.createElement(y.o,null,v.a.createElement(y.p,null,"Date"),v.a.createElement(y.i,{mode:"ios",displayFormat:"DDD, M/DD/YY",pickerFormat:"MMM D YYYY",min:"2005-01-01",max:"2030-01-01",value:F.toISOString(),onIonChange:function(e){!function(e){if(null!==e&&void 0!==e){var t=Object(Ne.a)(e);t!==F&&(L(t),U(C,g,F,D,!1),P(C,g,t))}}(e.detail.value)}})),v.a.createElement(y.o,null,v.a.createElement(y.M,{value:D,placeholder:"Enter daily note",maxlength:180,rows:4,spellcheck:!0,wrap:"hard",debounce:50,onIonChange:function(e){var t;null!==(t=e.detail.value)&&void 0!==t&&(t.length!==w.current&&(w.current=t.length),t!==D&&N(t))}})),v.a.createElement("div",{className:"character-counter"},null!==(R=null===D||void 0===D?void 0:D.length)&&void 0!==R?R:0,"/180"))),u.alertBoxJsx,p.dialogBoxJsx,l.simpleToastJsx):v.a.createElement(v.a.Fragment,null,v.a.createElement("div",null,"Loading"),u.alertBoxJsx)},Kt=function(e){var t=e.note,n=e.onForceRefresh,r=Object(Ne.a)(t.EventStart),o=-1===t.DepartmentId?"All Depts":t.DepartmentName,i=Object(f.useState)(!1),c=Object(S.a)(i,2),s=c[0],l=c[1],u=Object(f.useContext)(ht).auth;return v.a.createElement(v.a.Fragment,null,v.a.createElement("button",{className:"card daily-note",onClick:function(){if(u.role!==W.Employee)return!!ft.isAdminAuthorizedFor(u,t.LocationId,t.DepartmentId,a.CanEditSchedules)&&void l(!0)}},v.a.createElement("div",{className:"card-first-col"},v.a.createElement("div",{className:"day-name"},Object(xe.a)(r,"EEE")," "),v.a.createElement("div",{className:"day-number"},Object(xe.a)(r,"d"))),v.a.createElement("div",{className:"card-second-col"},v.a.createElement("div",{className:"first-row"},o,": ",1===t.Role?"Employees":"Admins",v.a.createElement("br",null),t.Notes))),v.a.createElement(y.w,{isOpen:s,onDidDismiss:function(){return l(!1)}},v.a.createElement(Ht,{isOpen:s,note:t,onCloseModal:function(e){return n(e),void l(!1)},initialDate:new Date,newNoteClicked:!0})))};var Qt=function(e){var t=e.date,n=e.onForceRefresh,a=Object(f.useState)(!1),r=Object(S.a)(a,2),o=r[0],i=r[1];if(!function(e){if(e.role===W.Employee)return!1;if(e.role===W.BusinessAdmin||e.role===W.LocationAdmin)return!0;for(var t=0;t<e.locations.length;t++){var n=e.locations[t];if(n.adminAllDepts)return!0;for(var a=0;a<n.departments.length;a++)if(n.departments[a].isDeptAdmin)return!0}return!1}(Object(f.useContext)(ht).auth))return v.a.createElement("span",null);return v.a.createElement(v.a.Fragment,null,v.a.createElement(y.d,{mode:"md",className:"add-dailynote-button",onClick:function(){i(!0)}},"+ Daily Note"),v.a.createElement(y.w,{isOpen:o,onDidDismiss:function(){return i(!1)}},v.a.createElement(Ht,{isOpen:o,note:null,initialDate:t,onCloseModal:function(e){var t;t=e,i(!1),n(t)},newNoteClicked:!0})))},Zt=function(){return v.a.createElement("div",null,v.a.createElement("span",{className:"no-messagesOrEvents-text"},"No Events"))},Xt=Object(f.forwardRef)((function(e,t){var n=e.locations,a=e.header,r=e.events,o=e.notes,i=e.showEmployeeNames,c=e.onEdit,s=e.dailyNotesAddButtonDate,l=e.onForceRefresh,u=v.a.createRef(),d=n.filter((function(e){return e.departments.filter((function(e){return e.positions.filter((function(e){return e.hasPosition}))}))})).length>1;return Object(f.useImperativeHandle)(t,(function(){return{scrollIntoView:function(){null!==u.current&&(u.current.scrollIntoView({behavior:"smooth",block:"start",inline:"start"}),setTimeout((function(){null!==u.current&&u.current.focus()}),1e3))}}})),v.a.createElement(v.a.Fragment,null,v.a.createElement("div",{tabIndex:0,ref:u,className:"event-list-header"},a,null!==s&&v.a.createElement(Qt,{onForceRefresh:l,date:s})),0===o.length&&0===r.length&&v.a.createElement(Zt,null),v.a.createElement("div",null,o.map((function(e){return v.a.createElement(Kt,{onForceRefresh:l,key:e.DailyNoteId,note:e,location:n.filter((function(t){return t.id===e.LocationId}))[0]})}))),v.a.createElement("div",null,r.map((function(e){return v.a.createElement(Vt,{onEdit:c,key:e.ScheduleEventId,event:e,location:n.filter((function(t){return t.id===e.LocationId}))[0],multiLocation:d,showEmployeeName:i})}))))})),$t=Object(f.forwardRef)((function(e,t){var n=e.events,a=e.notes,r=e.hoursPerDay,o=e.listType,i=e.auth,c=e.onEdit,s=e.onForceRefresh,l=e.weekStart,u=new $;switch(o){case"requests":u=function(e,t,n){var a=new $;return a.add("MY REQUESTS",{events:e.filter((function(e){return e.EmployeeId===n})),notes:[],date:null}),a.add("CO-WORKERS",{events:e.filter((function(e){return e.EmployeeId!==n})),notes:[],date:null}),a}(n,0,i.employeeId);break;case"my":u=function(e,t,n,a){var r=new $;if(0===e.length&&0===t.length)return r;var o=new Date(2199,1,1);if(e.length>0&&(o=et.getWeekStart(Object(Ne.a)(e[0].EventStart),n.DayWeekStartsOn,n.DayStartTime)),t.length>0){var i=et.getWeekStart(Object(Ne.a)(t[0].EventStart),n.DayWeekStartsOn,n.DayStartTime);Object(Pt.a)(i,o)&&(o=i)}var c=Object(Re.a)(o,7),s="".concat(Object(xe.a)(o,"MMM d")," - ").concat(Object(xe.a)(c,"MMM d")).toUpperCase()+" "+et.getDurationString(a.map((function(e){return et.getDurationFromTimeSpan(e.time)})).reduce((function(e,t){return e+t}),0));return r.add(s,{events:e,notes:t,date:o}),r}(n,a,i.locations[0].settings,r);break;case"today":u=function(e,t,n,a){for(var r=et.getTodayStartForLocation(new Date,n),o=0,i=0;i<a.length;i++)o+=et.getDurationFromTimeSpan(a[i].time);var c=o>0?et.getDurationString(o):"",s=Object(xe.a)(r,"h:mmaaa").replace("M","")+" "+Object(xe.a)(r,"MMM d, yyyy").toUpperCase()+" "+c,l=new Date(r.valueOf());l.setHours(0,0,0,0);var u=new $;return u.add(s,{events:e,notes:t,date:l}),u}(n,a,i.locations[0].settings,r);break;default:u=function(e,t){var n=new $;return e.map((function(e){var a=Object(xe.a)(Object(Ne.a)(e.EventStart).setHours(0,0,0,0),"MMM d, yyyy").toUpperCase();if(!n.containsKey(a)){var r=t.filter((function(e){return Object(xe.a)(Object(Ne.a)(e.EventStart).setHours(0,0,0,0),"MMM d, yyyy").toUpperCase()===a}));n.add(a,{notes:r,events:[],date:Object(Ne.a)(e.EventStart)})}return n.item(a).events.push(e),a})),n}(n,a)}Object(f.useImperativeHandle)(t,(function(){return{scrollToDate:function(e){for(var t=Object(xe.a)(e,"MMM d, yyyy").toUpperCase(),n=u.keys(),a=0;a<n.length;a++)if(n[a]===t){var r=u.item(n[a]);if(void 0!==r.segmentRef&&null!==r.segmentRef.current){r.segmentRef.current.scrollIntoView();break}}}}}));var d=[-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10].map((function(e){return{segName:Object(xe.a)(Object(Re.a)(l,e).setHours(0,0,0,0),"MMM d, yyyy").toUpperCase(),segRef:Object(f.useRef)(null)}}));return v.a.createElement(v.a.Fragment,null,u.keys().map((function(e){var t=d.find((function(t){return e===t.segName})),n=void 0!==t?t.segRef:d[0].segRef;return u.item(e).segmentRef=n,v.a.createElement(Xt,{ref:n,onEdit:c,key:e,header:e,locations:i.locations,events:u.item(e).events,notes:u.item(e).notes,showEmployeeNames:"all"===o||"CO-WORKERS"===e,showTotalDuration:"requests"!==o,dailyNotesAddButtonDate:u.item(e).date,onForceRefresh:s})})))}));var en={getFilterByEventGroup:function(e,t){return t===m.Custom?Object(I.a)({},e,{eventTypeId:e.eventTypeId,eventStatusId:e.eventStatusId}):Object(I.a)({},e,{eventTypeId:t,eventStatusId:t})},getEventTypeOptions:function(e,t){if(!e||!e.locations||0===e.locations.length)return[];var n=e.locations[0].settings,a=[{value:U.Shift,text:"SHIFT",color:"green"},{value:U.Cover,text:"COVER",color:"red"}];if(t&&a.unshift({value:-1,text:"ALL",color:"black"}),a.push({value:U.Clock,text:"CLOCK",color:"green"}),n.ShowUnavailableEventType&&a.push({value:U.Unavailable,text:"UNAVAILABLE",color:"yellow"}),n.ShowVacationEventType&&a.push({value:U.Vacation,text:"VACATION",color:"yellow"}),n.ShowAbsentEventType){var r=[],o={};return e.locations.flatMap((function(e){return e.departments.flatMap((function(t){return t.positions.map((function(t){return o[t.id]=e}))}))})),e.payrollEvents.map((function(e){return e.name.startsWith("--")?null:(t?e.positionIds.some((function(e){return t.positionIds.indexOf(e)>=0}))&&r.push({value:e.id,text:"".concat(e.name," (").concat(o[e.positionIds[0]].name,")"),color:"yellow"}):r.push({value:e.id,text:"".concat(e.name," (").concat(o[e.positionIds[0]].name,")"),color:"yellow"}),e)})),r.sort((function(e,t){return e.text>t.text?1:-1})),a.concat(r)}return a}},tn={areEqual:function(e,t){if(!e&&t||e&&!t)return!1;if(!e&&!t)return!0;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!tn.contains(t,e[n]))return!1;return!0},contains:function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return!0;return!1},containsAny:function(e,t){for(var n=0;n<e.length;n++)if(t.includes(e[n]))return!0;return!1},unique:function(e){var t=[];return e.map((function(e){tn.contains(t,e)||t.push(e)})),t},uniqueObject:function(e,t){var n=[];return e.map((function(e){for(var a=!1,r=0;r<n.length;r++)if(t(n[r],e)){a=!0;break}a||n.push(e)})),n}};function nn(e,t){return Object(I.a)({},Ft,{start:t.start,end:t.end,tagId:-1,positionIds:e.locations.flatMap((function(e){return e.departments.flatMap((function(e){return e.positions.map((function(e){return e.id}))}))})),dnLocIds:e.locations.map((function(e){return e.id})),settingsLocId:e.locations[0].id})}function an(e,t){return void 0===e&&-1===t||-1===e&&void 0===t||e===t}var rn={getFilter:function(e){var t=Object(I.a)({},Lt),n=localStorage.getItem("scheduleEventFilter");return null!==n&&(t=JSON.parse(n)),ft.isAuthItemsValid(e)&&(void 0!==t.positionIds&&0!==t.positionIds.length||(t.positionIds=e.locations.flatMap((function(e){return e.departments.flatMap((function(e){return e.positions.map((function(e){return e.id}))}))}))),void 0!==t.dnLocIds&&0!==t.dnLocIds.length||(t.dnLocIds=e.locations.map((function(e){return e.id}))),void 0!==t.settingsLocId&&0!==t.settingsLocId||(t.settingsLocId=e.locations[0].id)),t},putFilter:function(e){var t={settingsLocId:e.settingsLocId,dnLocIds:e.dnLocIds,positionIds:e.positionIds,tagId:e.tagId,eventStatusId:e.eventStatusId,eventTypeId:e.eventTypeId};localStorage.setItem("scheduleEventFilter",JSON.stringify(t))},isFilterApplied:function(e,t){var n=nn(e,t);return!(n.eventTypeId===t.eventTypeId&&n.eventStatusId===t.eventStatusId&&an(n.tagId,t.tagId)&&tn.areEqual(n.positionIds,t.positionIds))},getDefaultFilter:nn,clear:function(){localStorage.removeItem("scheduleEventFilter")},tagIsEqual:an};var on=function(e){var t=e.auth,n=e.filter,a=e.onDismissModal,r=e.onCancelModal,o=e.isOpen,i=function(e,t){var n=[],a=[],r=[];return ft.isAuthItemsValid(e)?(e.locations.map((function(e){return e.departments.map((function(o){return o.positions.map((function(i){if(t.positionIds.includes(i.id)){var c=e.id.toString(),s=o.id.toString();n.includes(c)||n.push(c),a.includes(s)||a.push(s),r.push(i.id.toString())}return i.id}))}))})),[n,a,r]):[[],[],[]]}(t,n),c=Object(S.a)(i,3),s=c[0],l=c[1],u=c[2],d=Object(f.useState)(function(e,t){return t.eventTypeId===m.All&&t.eventStatusId===m.All?m.All:t.eventTypeId===m.ClockAndSched&&t.eventStatusId===m.ClockAndSched?m.ClockAndSched:t.eventTypeId===m.DontWork&&t.eventStatusId===m.DontWork?m.DontWork:t.eventTypeId===m.Scheduled&&t.eventStatusId===m.Scheduled?m.Scheduled:m.Custom}(0,n)),p=Object(S.a)(d,2),E=p[0],h=p[1],g=Object(f.useState)(n),b=Object(S.a)(g,2),O=b[0],C=b[1],j=Object(f.useState)(en.getEventTypeOptions(t,n)),T=Object(S.a)(j,2),A=T[0],D=T[1],N=Object(f.useState)(s),w=Object(S.a)(N,2),x=w[0],M=w[1],F=Object(f.useState)(l),L=Object(S.a)(F,2),R=L[0],P=L[1],U=Object(f.useState)(u),B=Object(S.a)(U,2),V=B[0],q=B[1],z=Object(f.useState)(!1),W=Object(S.a)(z,2),_=W[0],G=W[1];Object(f.useEffect)((function(){C(n)}),[n]),Object(f.useEffect)((function(){o&&G(!1)}),[o]);return v.a.createElement(v.a.Fragment,null,v.a.createElement(y.l,{className:"ion-no-border"},v.a.createElement(y.Q,null,v.a.createElement(y.e,{slot:"start"},v.a.createElement(y.d,{onClick:function(){r()}},v.a.createElement(y.m,{icon:k.c,mode:"md",slot:"icon-only"}))),v.a.createElement(y.N,null,"Filter"),v.a.createElement(y.e,{slot:"end"},v.a.createElement(y.d,{onClick:function(){h(m.ClockAndSched),D(en.getEventTypeOptions(t,n)),M(t.locations.map((function(e){return""+e.id}))),P(t.locations.flatMap((function(e){return e.departments})).map((function(e){return""+e.id}))),q(t.locations.flatMap((function(e){return e.departments})).flatMap((function(e){return e.positions})).map((function(e){return""+e.id}))),C(rn.getDefaultFilter(t,n)),G(!1)}},"RESET")))),v.a.createElement(y.h,{class:"outer-content"},v.a.createElement(y.o,null,v.a.createElement(y.p,null,"Events"),v.a.createElement(y.E,{mode:"ios",interface:"action-sheet",value:E,onIonChange:function(e){return t=e.detail.value,h(t),G(!0),void C(en.getFilterByEventGroup(O,t));var t}},v.a.createElement(y.F,{value:m.ClockAndSched},"Clock + Sched"),v.a.createElement(y.F,{value:m.Scheduled},"Scheduled"),v.a.createElement(y.F,{value:m.DontWork},"Don't Work"),v.a.createElement(y.F,{value:m.Custom},"Custom"),v.a.createElement(y.F,{value:m.All},"ALL"))),E===m.Custom&&v.a.createElement(y.o,null,v.a.createElement(y.p,null,"Type"),v.a.createElement(y.E,{mode:"ios",interface:"action-sheet",value:O.eventTypeId,onIonChange:function(e){C(Object(I.a)({},O,{eventTypeId:e.detail.value})),G(!0)}},A.map((function(e){return v.a.createElement(y.F,{key:e.value,value:e.value},e.text)})))),E===m.Custom&&v.a.createElement(y.o,null,v.a.createElement(y.p,null,"Status"),v.a.createElement(y.E,{mode:"ios",interface:"action-sheet",value:O.eventStatusId,onIonChange:function(e){C(Object(I.a)({},O,{eventStatusId:e.detail.value})),G(!0)}},v.a.createElement(y.F,{value:-1},"ALL"),v.a.createElement(y.F,{value:1},"Approved"),v.a.createElement(y.F,{value:2},"Request"),v.a.createElement(y.F,{value:4},"Request Denied"))),v.a.createElement(y.o,null,v.a.createElement(y.p,null,"Tags"),v.a.createElement(y.E,{mode:"ios",interface:"action-sheet",value:O.tagId||-1,onIonChange:function(e){C(Object(I.a)({},O,{tagId:e.detail.value})),G(!0)}},v.a.createElement(y.F,{key:-1,value:-1},"ALL"),t.tags.map((function(e){return v.a.createElement(y.F,{key:e.id,value:e.id},"~",e.name)})))),t.locations.length>1&&v.a.createElement(y.o,null,v.a.createElement(y.p,null,"Locations"),v.a.createElement(y.E,{mode:"ios",multiple:!0,onIonChange:function(e){return n=e.detail.value,M(n),G(!0),P(t.locations.filter((function(e){return n.indexOf(e.id.toString())>=0})).flatMap((function(e){return e.departments})).map((function(e){return""+e.id}))),void D(en.getEventTypeOptions(t,O));var n},value:x},t.locations.map((function(e){return v.a.createElement(y.F,{key:e.id,value:e.id.toString()},e.name)})))),t.locations.flatMap((function(e){return e.departments})).length>1&&v.a.createElement(y.o,null,v.a.createElement(y.p,null,"Departments"),v.a.createElement(y.E,{mode:"ios",multiple:!0,onIonChange:function(e){return n=e.detail.value,P(n),G(!0),void q(t.locations.filter((function(e){return x.indexOf(e.id.toString())>=0})).flatMap((function(e){return e.departments})).filter((function(e){return n.includes(e.id.toString())})).flatMap((function(e){return e.positions})).map((function(e){return""+e.id})));var n},value:R},t.locations.filter((function(e){return x.indexOf(e.id.toString())>=0})).map((function(e){return e.departments.map((function(t){return v.a.createElement(y.F,{key:t.id,value:t.id.toString()},e.abbr,"/",t.name)}))})))),t.locations.flatMap((function(e){return e.departments})).flatMap((function(e){return e.positions})).length>1&&v.a.createElement(y.o,null,v.a.createElement(y.p,null,"Positions"),v.a.createElement(y.E,{mode:"ios",multiple:!0,onIonChange:function(e){return t=e.detail.value,q(t),void G(!0);var t},value:V},t.locations.filter((function(e){return x.indexOf(e.id.toString())>=0})).flatMap((function(e){return e.departments})).filter((function(e){return R.indexOf(e.id.toString())>=0})).map((function(e){return e.positions.map((function(e){return v.a.createElement(y.F,{key:e.id,value:e.id.toString()},e.name)}))}))))),v.a.createElement(y.j,null,v.a.createElement(y.d,{className:"apply-button",expand:"block",onClick:function(){var e=V.map((function(e){return parseInt(e)})),n=Object(I.a)({},O,{positionIds:e}),r=rn.isFilterApplied(t,n);a(n,r)},disabled:!_},"APPLY FILTER")))};var cn=function(e){var t=Object(f.useRef)(null),n={ionicRefresherJsx:v.a.createElement(y.y,{slot:"fixed",ref:t,onIonRefresh:e},v.a.createElement(y.z,{pullingIcon:"arrow-dropdown",pullingText:"Pull down to refresh",refreshingSpinner:"dots",refreshingText:"Refreshing..."}))};return Object(I.a)({},n)};function sn(e){return e.eventType!==U.Absent?e.eventType:e.absentId}function ln(e,t){return e.payrollEvents.filter((function(e){return e.positionIds.includes(t)&&!e.name.startsWith("--")})).map((function(e){return{id:e.id,name:e.name}})).sort((function(e,t){return e.name>t.name?1:t.name>e.name?-1:0}))}function un(e,t){if(!ft.isAuthItemsValid(e))return[];var n=[],r=[],o=t.position.location.settings,i=ft.getDepartmentFromPositionId(e,t.position.position.id);if(null===i)return[];if(function(e,t,n){return e.role===W.BusinessAdmin||e.role===W.LocationAdmin||e.role!==W.Employee&&(t.employee.id===e.employeeId?ft.adminCan(n,a.CanEditOwnClockEvents):ft.adminCan(n,a.CanEditEmployeeClockEvents))}(e,t,ft.getAdminAuthorizationForDepartment(e,i.id))&&r.push(U.Clock),r.push(U.Shift),e.role===W.BusinessAdmin||e.role===W.LocationAdmin||e.role===W.Admin&&void 0!==i&&ft.isAdminAuthorizedFor(e,t.locationId,i.id,a.CanEditSchedules))r.push(U.Cover),o.ShowVacationEventType&&r.push(U.Vacation),o.ShowUnavailableEventType&&r.push(U.Unavailable),o.ShowAbsentEventType&&(n=ln(e,t.position.position.id));else if(e.role===W.Admin&&void 0!==i)o.ShowVacationEventType&&r.push(U.Vacation),o.ShowUnavailableEventType&&r.push(U.Unavailable),o.ShowAbsentEventType&&(n=ln(e,t.position.position.id));else{if(t.scheduleEventId>0&&t.eventType===U.Cover)return[K(t.eventType)];o.ShowVacationEventType&&r.push(U.Vacation),o.ShowUnavailableEventType&&r.push(U.Unavailable),o.ShowAbsentEventType&&(n=ln(e,t.position.position.id))}return r.map((function(e){return K(e)})).concat(n)}function dn(e,t){if(!ft.isAuthItemsValid(e))return[];if(e.role===W.Employee)return 0===t.scheduleEventId?[V(p.Request)]:[V(t.eventStatus)];if(e.role===W.LocationAdmin||e.role===W.BusinessAdmin)return B;var n=ft.getDepartmentFromPositionId(e,t.position.position.id);return null===n?[]:ft.isAdminAuthorizedFor(e,t.locationId,n.id,a.CanEditSchedules)?B:0===t.scheduleEventId?[V(p.Request)]:[V(t.eventStatus)]}var mn=function(e){var t=e.auth,n=e.editorValues,a=e.update,r=Object(f.useState)("Ex: 00:00"),o=Object(S.a)(r,2),i=o[0],c=o[1],s=Object(f.useState)(null),l=Object(S.a)(s,2),u=l[0],d=l[1],m=Object(f.useState)(null),E=Object(S.a)(m,2),h=E[0],g=E[1];Object(f.useEffect)((function(){-1!==n.scheduleEventId&&t.role===W.Employee&&n.scheduleEventId<=0&&n.eventStatus!==p.Request&&a({type:"TYPESTATUS-UPDATED",eventType:n.eventType,eventStatus:p.Request,absentId:n.absentId,absentTimeMinutes:n.absentTimeMinutes})}),[t,n.eventType,n.eventStatus,n.position,n.absentId,n.scheduleEventId]),Object(f.useEffect)((function(){if(!n.isFromEventInfo){var e=un(t,n);if(0!==e.length)void 0===e.find((function(e){return e.id===sn(n)}))&&a({type:"TYPESTATUS-UPDATED",eventType:e[0].id>100?U.Absent:e[0].id,eventStatus:n.eventStatus,absentId:e[0].id>100?e[0].id:void 0,absentTimeMinutes:n.absentTimeMinutes})}}),[n.employee,n.isFromEventInfo]),Object(f.useEffect)((function(){var e=dn(t,n);void 0===e.find((function(e){return e.id===n.eventStatus}))&&a({type:"TYPESTATUS-UPDATED",eventType:n.eventType,eventStatus:e[0].id,absentId:n.absentId,absentTimeMinutes:n.absentTimeMinutes})}),[n.position]),Object(f.useEffect)((function(){-1!==n.scheduleEventId&&u&&g(null===n.absentTimeMinutes?null:et.getTimeStringFromMinutes(u,n.absentTimeMinutes))}),[u,n.absentTimeMinutes,n.scheduleEventId]),Object(f.useEffect)((function(){if(-1!==n.scheduleEventId&&(!u||n.locationId!==u.LocationId)&&t&&t.locations&&0!==t.locations.length){var e=ft.getLocSettingsForLocationId(t,n.locationId);d(e),c(e.TimeFormat===Y.HoursMinutes?"Ex: 00:00":"Ex: 0.0")}}),[n.locationId,n.scheduleEventId]);return v.a.createElement(v.a.Fragment,null,v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"3"},v.a.createElement(y.p,{className:"label"},"Type")),v.a.createElement(y.g,{size:"9"},v.a.createElement(y.E,{mode:"ios",className:"select",interface:"action-sheet",disabled:n.isReadonly||n.isConfirmed||null!==n.transferToEmployeeId,value:sn(n),onIonChange:function(e){!function(e){if(e!==n.eventType){var t=e!==U.Absent&&e<100?null:n.absentTimeMinutes;a({type:"TYPESTATUS-UPDATED",eventType:e>=100?U.Absent:e,eventStatus:n.eventStatus,absentId:e>=100?e:void 0,absentTimeMinutes:t})}}(e.detail.value)}},un(t,n).map((function(e){return v.a.createElement(y.F,{key:e.id,value:e.id},e.name)}))))),v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"3"},v.a.createElement(y.p,{className:"label"},"Status")),v.a.createElement(y.g,{size:"9"},v.a.createElement(y.E,{mode:"ios",className:"select",interface:"action-sheet",disabled:n.isReadonly||n.isConfirmed||null!==n.transferToEmployeeId||t.role===W.Employee&&n.scheduleEventId<=0,value:n.eventStatus,onIonChange:function(e){var t;(t=e.detail.value)!==n.eventStatus&&a({type:"TYPESTATUS-UPDATED",eventType:n.eventType,eventStatus:t,absentId:n.absentId,absentTimeMinutes:n.absentTimeMinutes})}},dn(t,n).map((function(e){return v.a.createElement(y.F,{key:e.id,value:e.id},e.name)}))))),v.a.createElement(y.B,{className:n.eventType===U.Absent?"visible edit-row":"invisible"},v.a.createElement(y.g,{size:"3"},v.a.createElement(y.p,{className:"label"},"Hours")),v.a.createElement(y.g,{size:"9"},v.a.createElement(y.n,{className:"input-textbox",placeholder:i,disabled:n.isReadonly||n.isConfirmed,value:h,onIonChange:function(e){e.detail.value&&g(e.detail.value)},onIonBlur:function(){!function(e){if(void 0===e&&(e=null),null!=e){var t=et.getMinutesFromTimeString(u,e);t!==n.absentTimeMinutes&&a({type:"TYPESTATUS-UPDATED",eventType:n.eventType,eventStatus:n.eventStatus,absentId:n.absentId,absentTimeMinutes:t})}else a({type:"TYPESTATUS-UPDATED",eventType:n.eventType,eventStatus:n.eventStatus,absentId:n.absentId,absentTimeMinutes:null})}(h)}}))))},pn=function(e){var t=e.auth,n=e.editorValues,a=e.update,r=Object(f.useState)([]),o=Object(S.a)(r,2),i=o[0],c=o[1],s=Object(f.useRef)(null);Object(f.useEffect)((function(){-1!==n.scheduleEventId&&t&&t.locations&&t.locations.length>0&&c(function(e){var t=e.length>1;return e.flatMap((function(e){return e.departments.flatMap((function(n){return n.positions.map((function(a){var r=e.departments.length>1,o="";return t&&(o+=(e.abbr?e.abbr:e.name)+"/"),r&&(o+=(n.abbr?n.abbr:n.name)+"/"),o+=a.name,{id:a.id,name:o}}))}))})).sort((function(e,t){return e.name>t.name?1:t.name>e.name?-1:0}))}(t.locations))}),[t,n.scheduleEventId]);return v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"3"},v.a.createElement(y.p,{className:"label"},"Position")),v.a.createElement(y.g,{size:"9"},v.a.createElement(y.E,{mode:"ios",className:"select",interface:"action-sheet",disabled:n.isReadonly||n.isConfirmed||null!==n.transferToEmployeeId,value:n.position.position.id,onIonChange:function(e){return function(e){if(e!==s.current&&e!==n.position.position.id){var r=ft.getSelectedPosition(t.locations,e);a({type:"POSITION-UPDATED",selectedPosition:r})}}(e.detail.value)}},i.map((function(e){return v.a.createElement(y.F,{key:e.id,value:e.id},e.name)})))))},fn=function(e){var t=e.auth,n=e.editorValues,r=e.update,o=Object(f.useState)([]),i=Object(S.a)(o,2),c=i[0],s=i[1],l=ot("Please wait..."),u=Object(f.useContext)(ke).user,d=Object(f.useRef)(null);Object(f.useEffect)((function(){u&&u.isLoggedin&&-1!==n.scheduleEventId&&(ce("edit_event_get_employeeList",{user:u.username}),l.setShowLoading(!0),m(n))}),[u,n.position.position.id,n.scheduleEventId,n.employee.id]);var m=function(e){var n=[{id:t.employeeId,name:t.fullName}];if(t.role===W.Employee)return s(n),void l.setShowLoading(!1);if(t.role===W.Admin){var o=ft.getDepartmentFromPositionId(t,e.position.position.id);if(null===o)return l.setShowLoading(!1),void s(n);if(!ft.isAdminAuthorizedFor(t,e.locationId,o.id,a.CanEditSchedules))return s(n),void l.setShowLoading(!1)}rt.getEmployeesByLocationIdPositionIdAndActiveDateRange(u,e.position.location.id,e.position.position.id,Object(Ne.a)(e.eventStart),Object(Ne.a)(e.eventEnd),e.position.location.settings.EmployeeSort).then((function(t){s(t),t.map((function(e){return e.id})).includes(e.employee.id)||r({type:"EMPLOYEE-UPDATED",employee:{id:-1,name:"SELECT EMPLOYEE"}}),l.setShowLoading(!1)}))};return 0===c.length?v.a.createElement(v.a.Fragment,null,v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"3"},v.a.createElement(y.p,{className:"label"},"Employee")),v.a.createElement(y.g,{size:"9"},v.a.createElement(y.E,{mode:"ios",className:"select",interface:"action-sheet",value:-5},v.a.createElement(y.F,{key:"-5",value:"-5"},n.employee.name)))),l.showLoadingJsx):v.a.createElement(v.a.Fragment,null,v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"3"},v.a.createElement(y.p,{className:"label"},"Employee")),v.a.createElement(y.g,{size:"9"},v.a.createElement(y.E,{mode:"ios",className:"select",interface:"action-sheet",disabled:n.isReadonly||t.role===W.Employee||n.isConfirmed||null!==n.transferToEmployeeId,value:n.employee.id,onIonChange:function(e){!function(e){if(-5!==e&&e!==n.employee.id&&e!==d.current){d.current=e;var t=c.filter((function(t){return t.id===e}))[0];r(-1===e?{type:"EMPLOYEE-UPDATED",employee:{id:-1,name:"SELECT EMPLOYEE"}}:{type:"EMPLOYEE-UPDATED",employee:{id:e,name:t.name}})}}(e.detail.value)}},c.length>1&&v.a.createElement(y.F,{key:-1,value:-1},"Select Employee"),c.map((function(e){return v.a.createElement(y.F,{key:e.id,value:e.id},e.name)}))))),l.showLoadingJsx)},vn=function(e){var t=e.editorValues,n=e.update;return v.a.createElement(v.a.Fragment,null,v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"3"},v.a.createElement(y.p,{className:"label"},"Start")),v.a.createElement(y.g,{size:"9"},v.a.createElement(y.i,{mode:"ios",className:"select",displayFormat:"h:mm A, M/D DDD",disabled:t.isReadonly||t.isConfirmed,pickerFormat:"h:mm A MMM D",minuteValues:"0,5,10,15,20,25,30,35,40,45,50,55",value:t.eventStart,onIonChange:function(e){var a;(a=e.detail.value)&&Object(Ne.a)(a)!==Object(Ne.a)(t.eventStart)&&n({type:"START-UPDATED",eventStart:a})}}))),v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"3"},v.a.createElement(y.p,{className:"label"},"End")),v.a.createElement(y.g,{size:"9"},v.a.createElement(y.i,{mode:"ios",className:"select",displayFormat:"h:mm A, M/D DDD",disabled:t.isReadonly||t.isClockedIn||t.isConfirmed,pickerFormat:"h:mm A MMM D",minuteValues:"0,5,10,15,20,25,30,35,40,45,50,55",value:t.eventEnd,onIonChange:function(e){var a;(a=e.detail.value)&&Object(Ne.a)(a)!==Object(Ne.a)(t.eventEnd)&&n({type:"END-UPDATED",eventEnd:a})}}))))},En=n(30),hn=n(226),gn=n(227),bn=n(228),yn=function(e,t,n){var a=e,r=t,o=!1;return n.map((function(e){var t=Object(hn.a)(Object(Ne.a)(e.BreakStart),3),n=e.BreakEnd?Object(hn.a)(Object(Ne.a)(e.BreakEnd),-3):new Date(2200,1,1);return a<n&&r>t&&(o=!0),o})),o};function On(e,t){var n=Object(Ne.a)(e),a=et.getHoursFromTimeSpan(t),r=et.getMinutesFromTimeSpan(t);return Object(gn.a)(Object(bn.a)(n,a),r)}var Sn=function(e){var t=e.onCancel,n=e.onAdd,a=e.currentBreaks,r=e.eventStart,o=e.eventEnd,i=e.locSettings,c=!Object(Pe.a)(Object(Ne.a)(r),Object(Ne.a)(o)),s=Object(f.useState)(On(r,i.EnhancedBreakManagementDefaultStartTime)),l=Object(S.a)(s,2),u=l[0],d=l[1],m=Object(f.useState)(On(o,i.EnhancedBreakManagementDefaultEndTime)),p=Object(S.a)(m,2),E=p[0],h=p[1],g=Object(f.useState)(!1),b=Object(S.a)(g,2),O=b[0],I=b[1],C=Object(f.useState)(!1),j=Object(S.a)(C,2),T=j[0],A=j[1],D=Object(f.useState)(""),N=Object(S.a)(D,2),w=N[0],x=N[1],M=Object(f.useState)(!0),F=Object(S.a)(M,2),L=F[0],R=F[1],P=Ce();return v.a.createElement(v.a.Fragment,null,v.a.createElement(y.l,{mode:"ios"},v.a.createElement(y.Q,null,v.a.createElement(y.N,null,"Add Break"),v.a.createElement(y.e,{slot:"end"},v.a.createElement(y.d,{onClick:t},v.a.createElement(y.m,{icon:k.n,mode:"ios",slot:"icon-only"}))))),v.a.createElement(y.h,null,v.a.createElement(y.k,null,v.a.createElement(y.B,null,v.a.createElement(y.g,{className:"label",size:"3"},"Start"),v.a.createElement(y.g,{size:"9"},v.a.createElement(y.i,{className:"select",displayFormat:c?"h:mm A, M/D DDD":"h:mm a",pickerFormat:c?"h:mm A MMM D":"h:mm A",min:"2005-01-01",max:"2030-01-01",minuteValues:"0,5,10,15,20,25,30,35,40,45,50,55",value:u.toISOString(),onIonChange:function(e){return function(e){var t=Object(Ne.a)(e);d(t),Object(Pt.a)(t,E)?Object(Ne.a)(r)>t?(R(!1),x("Start before Event begins")):yn(t,E,a)?(R(!1),x("Pre-existing break overlaps")):(R(!0),x("")):(R(!1),x("Start must be before End"))}(e.detail.value)}}))),v.a.createElement(y.B,null,v.a.createElement(y.g,{className:"label",size:"3"},"End"),v.a.createElement(y.g,{size:"9"},v.a.createElement(y.i,{className:"select",displayFormat:c?"h:mm A, M/D DDD":"h:mm a",pickerFormat:c?"h:mm A MMM D":"h:mm A",min:"2005-01-01",max:"2030-01-01",minuteValues:"0,5,10,15,20,25,30,35,40,45,50,55",value:E.toISOString(),onIonChange:function(e){return function(e){var t=Object(Ne.a)(e);h(t),Object(Ue.a)(t,u)?t>Object(Ne.a)(o)?(R(!1),x("End after Event ends")):yn(u,t,a)?(R(!1),x("Pre-existing break overlaps")):(R(!0),x("")):(R(!1),x("End must be after Start"))}(e.detail.value)}}))),v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"3"},v.a.createElement(y.f,{className:"checkbox",checked:O,onIonChange:function(e){I(e.detail.checked)}})),v.a.createElement(y.g,{className:"label",size:"9"},"Restricted Break")),v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"3"},v.a.createElement(y.f,{className:"checkbox",onIonChange:function(e){A(e.detail.checked)}})),v.a.createElement(y.g,{className:"label",size:"9"},"Paid Break")),v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"12",className:"error-message"},w)))),v.a.createElement(y.j,null,v.a.createElement(y.d,{expand:"block",color:"secondary",onClick:function(){u>E?P.showAlert("Invalid Start / End","Break Start cannot come after Break End.",(function(){})):Object(Ne.a)(r)>u?(R(!1),x("Break Start must be after Event Start")):Object(Ne.a)(o)<E?(R(!1),x("Break End must be before Event End")):yn(u,E,a)?(R(!1),x("Pre-existing break overlaps")):n(u,E,O,T)},disabled:!L},"ADD")),P.alertBoxJsx)},kn=function(e){var t=e.auth,n=e.editorValues,a=e.update,r=Object(f.useState)([]),o=Object(S.a)(r,2),i=o[0],c=o[1],s=Object(f.useState)(!1),l=Object(S.a)(s,2),u=l[0],d=l[1];Object(f.useEffect)((function(){-1!==n.scheduleEventId&&c(n.eventBreaks)}),[n.eventBreaks,n.scheduleEventId]);return n.eventType===U.Clock||Ge.isShiftTypeEvent(n.eventType,n.eventStatus)||null!==n.transferToEmployeeId?v.a.createElement(v.a.Fragment,null,v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"3"},v.a.createElement(y.p,{className:"label"},"(B)reaks")),v.a.createElement(y.g,{size:"2"},v.a.createElement(y.d,{size:"small",color:"light",disabled:n.isReadonly||n.isConfirmed,onClick:function(){d(!0)}},v.a.createElement(y.m,{slot:"icon-only",icon:k.a,color:"dark"})))),v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"3"}),v.a.createElement(y.g,{size:"9"},i&&i.map((function(e){return v.a.createElement("div",{key:e.BreakStart,className:"break-div"},"(B) ",et.getBreakStartEnd(e),e.IsPaidBreak?v.a.createElement(y.m,{className:"paid-icon",icon:k.s}):v.a.createElement("span",null),function(e){return e.IsRestricted?v.a.createElement(y.m,{className:"restricted-icon",icon:k.q}):v.a.createElement("span",null)}(e),v.a.createElement("button",{disabled:n.isReadonly||n.isConfirmed,onClick:function(){!function(e){var t=i.filter((function(t){return t.BreakStart!==e}));c(t),a({type:"EVENTBREAKS-UPDATED",breaks:t})}(e.BreakStart)}},v.a.createElement(y.m,{slot:"icon-only",mode:"ios",icon:k.z,color:"gray"})))})))),v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"12"},v.a.createElement("div",{style:{borderBottom:"1px solid #ddd",width:"100%"}}))),v.a.createElement(y.w,{mode:"ios",isOpen:u,cssClass:"mini-modal add-break-modal",onDidDismiss:function(){return d(!1)}},v.a.createElement(Sn,{onCancel:function(){d(!1)},onAdd:function(e,t,r,o){d(!1);var s={BreakStart:et.formatDateTimeAsMvcString(e),BreakEnd:et.formatDateTimeAsMvcString(t),IsRestricted:r,IsPaidBreak:o,ScheduleEventId:n.scheduleEventId},l=[].concat(Object(En.a)(i),[s]);c(l),a({type:"EVENTBREAKS-UPDATED",breaks:l})},currentBreaks:i,eventStart:n.eventStart,eventEnd:n.eventEnd,locSettings:ft.getLocSettingsForLocationId(t,n.locationId)}))):v.a.createElement("div",null)},In=function(e){var t=e.auth,n=e.editorValues,a=e.update,r=Object(f.useState)(-1),o=Object(S.a)(r,2),i=o[0],c=o[1],s=Object(f.useState)([]),l=Object(S.a)(s,2),u=l[0],d=l[1];Object(f.useEffect)((function(){if(-1!==n.scheduleEventId&&t&&t.locations&&t.locations.length>0){var e=t.tags.filter((function(e){return e.positionIds.includes(n.position.position.id)})).map((function(e){return{id:e.id,name:e.name}}));d(e);var a=e.map((function(e){return e.id}));a.includes(i)||(n.tag&&n.tag.id&&a.includes(n.tag.id)?c(n.tag.id):c(-1))}}),[t,n.position,n.scheduleEventId]);return 0===u.length?v.a.createElement(v.a.Fragment,null):v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"3"},v.a.createElement(y.p,{className:"label"},"~Tag")),v.a.createElement(y.g,{size:"9"},v.a.createElement(y.E,{mode:"ios",className:"select",interface:"action-sheet",disabled:n.isReadonly||n.isConfirmed,value:i,onIonChange:function(e){!function(e){if(c(e),e!==n.tag.id)if(-1===e)a({type:"TAG-UPDATED",tag:{id:-1,name:"NONE"}});else{var t=u.filter((function(t){return t.id===e}))[0];a({type:"TAG-UPDATED",tag:t})}}(e.detail.value)}},v.a.createElement(y.F,{value:-1},"None"),u.map((function(e){return v.a.createElement(y.F,{key:e.id,value:e.id},e.name)})))))};var Cn=function(e){var t=e.auth,n=e.editorValues,r=e.update,o=e.onEmployeeUpdated;return function(e,t){if(!ft.isAuthItemsValid(e))return!1;if(-1===t.scheduleEventId)return!1;if(t.scheduleEventId<=0){if(e.role===W.Employee)return!1;if(e.role===W.Admin){var n=ft.getDepartmentFromPositionId(e,t.position.position.id);if(null===n)return!1;if(!ft.isAdminAuthorizedFor(e,t.locationId,n.id,a.CanEditSchedules))return!1}}return t.eventType===U.Shift&&t.eventStatus===p.Approved||t.eventType===U.Cover&&(t.eventStatus===p.Request||t.eventStatus===p.RequestDenied)}(t,n)?function(e,t){if(!ft.isAuthItemsValid(e))return!1;if(e.role===W.Employee)return!0;if(e.role===W.LocationAdmin||e.role===W.BusinessAdmin)return!1;var n=ft.getDepartmentFromPositionId(e,t.position.position.id);return null!==n&&!ft.isAdminAuthorizedFor(e,t.locationId,n.id,a.CanEditSchedules)}(t,n)?v.a.createElement(v.a.Fragment,null,v.a.createElement(y.g,{size:"3"},v.a.createElement(y.p,{className:"label"},"Confirm")),v.a.createElement(y.g,{size:"3"},v.a.createElement(y.d,{onClick:function(){o()}},n.isConfirmed?"Unconfirm":"Confirm",v.a.createElement(y.m,{className:"icon-right-of-checkbox",icon:k.m})))):v.a.createElement(v.a.Fragment,null,v.a.createElement(y.g,{size:"3"},v.a.createElement(y.p,{className:"label"},"Confirm")),v.a.createElement(y.g,{size:"3"},v.a.createElement(y.f,{checked:n.isConfirmed,onClick:function(){r({type:"CONFIRM-UPDATED",isConfirmed:!n.isConfirmed})}}),v.a.createElement(y.m,{className:"icon-right-of-checkbox",icon:k.m}))):v.a.createElement(v.a.Fragment,null)},jn=function(e){var t=e.auth,n=e.editorValues,a=e.update,r=Object(f.useState)(!1),o=Object(S.a)(r,2),i=o[0],c=o[1],s=Object(f.useState)(!1),l=Object(S.a)(s,2),u=l[0],d=l[1];Object(f.useEffect)((function(){-1!==n.scheduleEventId&&t&&t.locations&&t.locations.length>0&&c(n.isClockedIn)}),[t,n.eventStart,n.eventEnd,n.isClockedIn,n.scheduleEventId]),Object(f.useEffect)((function(){-1!==n.scheduleEventId&&d(n.eventType===U.Clock)}),[n.eventType,n.eventStatus,n.scheduleEventId]);return u?v.a.createElement(v.a.Fragment,null,v.a.createElement(y.g,{size:"3"},v.a.createElement(y.p,{className:"label"},"Clocked In")),v.a.createElement(y.g,{size:"3"},v.a.createElement(y.f,{checked:i,onIonChange:function(e){var t;(t=e.detail.checked)!==i&&u&&(c(t),a({type:"ISCLOCKEDIN-UPDATED",isClockedIn:t}))}}),v.a.createElement(y.m,{className:"icon-right-of-checkbox",icon:k.x}))):v.a.createElement(v.a.Fragment,null)},Tn=n(229),An={isFromEventInfo:!1,scheduleEventId:-1,locationId:0,isUpdating:!1,eventType:U.Shift,eventStatus:p.Approved,isConfirmed:!1,position:{location:{},position:{}},employee:{id:-1,name:"SELECT EMPLOYEE"},eventStart:et.convertTimeWithoutTimeZoneToLocalTime(et.formatDateTimeAsMvcString(Object(bn.a)(Object(gn.a)(new Date,0),8))),eventEnd:et.convertTimeWithoutTimeZoneToLocalTime(et.formatDateTimeAsMvcString(Object(bn.a)(Object(gn.a)(new Date,0),17))),tag:{id:-1,name:"SELECT TAG"},eventBreaks:[],isClockedIn:!1,valid:!0,validEventStartEnd:!0,validEmployee:!0,validTag:!0,validEventTypeStatus:!0,validClockoutValue:!0,validRecurrenceStartEnd:!0,validRepeatInterval:!0,validRepeatWeekdays:!0,absentId:void 0,absentName:void 0,absentTimeMinutes:null,notes:"",clockoutValue:void 0,isReadonly:!1,transferToEmployeeId:null,transferFromScheduleEventId:null,transferToScheduleEventId:null};function Dn(e,t){return Object(I.a)({},An,{isFromEventInfo:!0,eventStatus:t.EventStatusId,eventType:t.EventTypeId,eventStart:t.EventStart,eventEnd:t.EventEnd,notes:t.Notes,isClockedIn:t.IsClockedIn,isConfirmed:t.IsConfirmed,scheduleEventId:t.ScheduleEventId,position:ft.getSelectedPositionWithLocId(e.locations,t.LocationId,t.PositionId),employee:{id:t.EmployeeId,name:t.FirstName+" "+t.LastName},eventBreaks:t.EventBreaks})}function Nn(e,t){var n=function(e){return Object(Ne.a)(e.EventEnd)>new Date(2199,1,1)}(t),a={isFromEventInfo:!1,scheduleEventId:t.ScheduleEventId,locationId:t.LocationId,isUpdating:!1,eventType:t.EventTypeId,eventStatus:t.EventStatusId,isConfirmed:void 0!==t.ConfirmedBy&&null!==t.ConfirmedBy,position:{location:wn(e,t.LocationId),position:xn(e,t.PositionId)},employee:{id:t.EmployeeId,name:t.FirstName+" "+t.LastName},eventStart:t.EventStart,eventEnd:n?et.formatDateTimeAsMvcString(new Date):t.EventEnd,tag:{id:t.TagId?t.TagId:-1,name:""},eventBreaks:t.EventBreaks,isClockedIn:n,valid:!0,validEventStartEnd:!0,validEmployee:!0,validTag:!0,validEventTypeStatus:!0,validClockoutValue:!0,absentName:t.AbsentName,absentId:t.AbsentId,absentTimeMinutes:null!==t.AbsentTimeMinutes&&void 0!==t.AbsentTimeMinutes?t.AbsentTimeMinutes:null,notes:t.Notes,clockoutValue:t.ClockOutValue,isReadonly:Fn(e,t),recurrenceId:t.EventRecurrenceId,recurrenceStart:t.EventRecurrenceStart,recurrenceEnd:t.EventRecurrenceEnd,recurrenceType:t.RepeatType,repeatInterval:t.RepeatInterval,repeatWeekdays:t.RepeatWeekdays,validRecurrenceStartEnd:!0,validRepeatInterval:!0,validRepeatWeekdays:!0,transferToEmployeeId:null,transferFromScheduleEventId:t.EventTransfer_ScheduleEventId_From,transferToScheduleEventId:t.EventTransfer_ScheduleEventId_To};return null===a.transferFromScheduleEventId&&null===a.transferToScheduleEventId||a.eventStatus!==p.Approved||a.eventType!==U.Shift&&a.eventType!==U.Cover||!ft.isAdminForThisEvent(a,e)||(a.isReadonly=!0),a}function wn(e,t){return e.locations.filter((function(e){return e.id===t}))[0]}function xn(e,t){return e.locations.flatMap((function(e){return e.departments.flatMap((function(e){return e.positions.filter((function(e){return e.id===t}))}))}))[0]}function Mn(e,t){var n=Object(Ne.a)(e),a=Object(Ne.a)(t);return!!Object(Tn.a)(n,a)||Object(Ue.a)(a,n)}function Fn(e,t){return!(t.ScheduleEventId<=0)&&(e.role===W.Employee?t.EmployeeId!==e.employeeId||(t.EventStatusId!==p.Request||t.EventTypeId===U.Cover):e.role!==W.BusinessAdmin&&e.role!==W.LocationAdmin&&!ft.isAdminAuthorizedFor(e,t.LocationId,t.DepartmentId,a.CanEditSchedules))}function Ln(e,t){var n=et.getHoursFromTimeSpan(t),a=et.getMinutesFromTimeSpan(t);return Object(gn.a)(Object(bn.a)(e,n),a)}function Rn(e,t,n){if(!n)return!0;if(!t.ClockOutValueLabel||0===t.ClockOutValueLabel.length)return!1;return/^\d*(\.\d{0,2})?$/.test(n)}function Pn(e){return e.validEventStartEnd&&e.validEmployee&&e.validTag&&e.validEventTypeStatus&&e.validClockoutValue&&e.validRecurrenceStartEnd&&e.validRepeatInterval&&e.validRepeatWeekdays}var Un=function(e,t){switch(console.log("EDITEVENT REDUCER: ACTION =",t.type),t.type){case"BEGIN-UPDATE":var n=t.ev;return Nn(t.auth,n);case"CANCEL":return An;case"POSITION-UPDATED":var a=t.selectedPosition;return Object(I.a)({},e,{position:a});case"CREATE-EVENT":return function(e){var t=e.locations[0],n=t.settings,a=new Date,r=et.convertTimeWithoutTimeZoneToLocalTime(et.formatDateTimeAsMvcString(Ln(a,n.NewEventDefaultStartTime))),o=et.convertTimeWithoutTimeZoneToLocalTime(et.formatDateTimeAsMvcString(Ln(a,n.NewEventDefaultEndTime)));return Object(I.a)({},An,{eventStart:r,eventEnd:o,employee:{id:e.employeeId,name:e.fullName},position:{location:t,position:t.departments[0].positions[0]},scheduleEventId:0})}(t.auth);case"SET-READONLY":return Object(I.a)({},e,{isReadonly:t.isReadonly});case"TYPESTATUS-UPDATED":var r=e.isClockedIn&&t.eventType===U.Clock&&t.eventStatus===p.Approved,o=Object(I.a)({},e,{eventType:t.eventType,eventStatus:t.eventStatus,absentId:t.absentId,absentTimeMinutes:t.absentTimeMinutes,isClockedIn:r,validEventTypeStatus:!(t.absentId&&null===t.absentTimeMinutes)});return o.valid=Pn(o),o;case"CLOCKOUTVALUE-UPDATED":var i=Object(I.a)({},e,{clockoutValue:t.clockoutValue,validClockoutValue:Rn(0,t.locSettings,t.clockoutValue)});return i.valid=Pn(i),i;case"EMPLOYEE-UPDATED":var c=Object(I.a)({},e,{employee:t.employee,validEmployee:t.employee.id>0});return c.valid=Pn(c),c;case"START-UPDATED":var s=Object(I.a)({},e,{eventStart:t.eventStart,validEventStartEnd:Mn(t.eventStart,e.eventEnd)});return s.valid=Pn(s),s;case"END-UPDATED":var l=Object(I.a)({},e,{eventEnd:t.eventEnd,validEventStartEnd:Mn(e.eventStart,t.eventEnd)});return l.valid=Pn(l),l;case"EVENTBREAKS-UPDATED":return Object(I.a)({},e,{eventBreaks:t.breaks});case"TAG-UPDATED":var u=Object(I.a)({},e,{tag:t.tag,validTag:!0});return u.valid=Pn(u),u;case"CONFIRM-UPDATED":var d=Object(I.a)({},e,{isConfirmed:t.isConfirmed});return d.valid=Pn(d),d;case"NOTES-UPDATED":return Object(I.a)({},e,{notes:t.notes});case"ISCLOCKEDIN-UPDATED":var m=Object(I.a)({},e,{isClockedIn:t.isClockedIn});return t.isClockedIn&&(m.eventEnd=et.convertTimeWithoutTimeZoneToLocalTime(et.formatDateTimeAsMvcString(new Date))),m.valid=Pn(m),m;case"TRANSFERTO-EMPLOYEE-UPDATED":var f=Object(I.a)({},e,{transferToEmployeeId:t.transferToEmployeeId});return null!==t.transferToEmployeeId&&(f.eventStatus=p.Approved),f.valid=Pn(f),f;case"REPEATING-UPDATED":var v=Object(I.a)({},e,{recurrenceStart:t.recurrenceStart,recurrenceEnd:t.recurrenceEnd,recurrenceType:t.recurrenceType,repeatInterval:t.repeatInterval,repeatWeekdays:t.repeatWeekDays});return v.recurrenceStart&&(v.repeatInterval===q.Weekly?v.validRepeatWeekdays=null!==v.repeatWeekdays&&void 0!==v.repeatWeekdays&&v.repeatWeekdays.length>0:(v.repeatWeekdays=void 0,v.validRepeatWeekdays=!0),v.recurrenceEnd?v.validRecurrenceStartEnd=Object(Pt.a)(Object(Ne.a)(v.recurrenceStart),Object(Ne.a)(v.recurrenceEnd)):v.validRecurrenceStartEnd=!1,v.validRepeatInterval=null!==v.repeatInterval&&void 0!==v.repeatInterval&&v.repeatInterval>0),v.valid=Pn(v),v;default:return console.error("ERROR in editorValueReducer, could not find action for "+t.type),e}};function Bn(){return(Bn=Object(T.a)(j.a.mark((function e(t,n){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="api/v1/employee/schedule-events/cover-request/undo?scheduleEventId=".concat(n),e.next=3,me.put(t,a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Vn(){return(Vn=Object(T.a)(j.a.mark((function e(t,n,a,r,o,i,c){var s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v1/employee/schedule-events/cover-request/submit",s={ScheduleEventId:n,LocationId:a,BusinessId:r,BroadcastCoverRequestMessage:o,CoverMessage:i,DirectToEmployeeId:c},e.next=4,me.put(t,"api/v1/employee/schedule-events/cover-request/submit",s);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function qn(){return(qn=Object(T.a)(j.a.mark((function e(t,n,a,r,o,i){var c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v2/requests/shift-request/submit",c={ScheduleEventId:n,LocationId:a,BusinessId:r,BroadcastCoverRequestMessage:o,CoverMessage:i},e.next=4,me.put(t,"api/v2/requests/shift-request/submit",c);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function zn(){return(zn=Object(T.a)(j.a.mark((function e(t,n,a,r,o,i){var c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v1/employee/schedule-events/delete",c={LocationId:n,ScheduleEventId:a,EventTypeId:r,EventStatusId:o,RecUpdateType:i},e.next=4,me.post(t,"api/v1/employee/schedule-events/delete",c);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Wn(){return(Wn=Object(T.a)(j.a.mark((function e(t,n){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v2/requests/shift-request/approve",a={msgId:n},e.next=4,me.post(t,"api/v2/requests/shift-request/approve",a);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _n(){return(_n=Object(T.a)(j.a.mark((function e(t,n,a,r,o,i){var c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v1/employee/schedule-events/delete",c={LocationId:n,ScheduleEventId:a,EventTypeId:r,EventStatusId:o,RecUpdateType:i},e.next=4,me.post(t,"api/v1/employee/schedule-events/delete",c);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Gn(){return(Gn=Object(T.a)(j.a.mark((function e(t,n,a){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v2/requests/transfers/to-list",r={scheduleEventId:n,directCoverList:a},e.next=4,me.post(t,"api/v2/requests/transfers/to-list",r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Yn(){return(Yn=Object(T.a)(j.a.mark((function e(t,n,a){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v2/requests/transfers/transfer",r={transferToEmployeeId:n,coverRequestEventId:a},e.next=4,me.post(t,"api/v2/requests/transfers/transfer",r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Jn(){return(Jn=Object(T.a)(j.a.mark((function e(t,n){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v2/requests/undo-cover",a={scheduleEventId:n},e.next=4,me.post(t,"api/v2/requests/undo-cover",a);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Hn,Kn={approveShiftRequest:function(e,t){return Wn.apply(this,arguments)},undoCoverRequest:function(e,t){return Bn.apply(this,arguments)},createCoverRequest:function(e,t,n,a,r,o,i){return Vn.apply(this,arguments)},makeShiftRequest:function(e,t,n,a,r,o){return qn.apply(this,arguments)},removeShiftRequest:function(e,t,n,a,r,o){return zn.apply(this,arguments)},deleteEvent:function(e,t,n,a,r,o){return _n.apply(this,arguments)},getCoverRequestListItems:function(e,t,n){return Gn.apply(this,arguments)},transferCoverToEmployee:function(e,t,n){return Yn.apply(this,arguments)},undoCoverApproved:function(e,t){return Jn.apply(this,arguments)}},Qn=function(e){var t,n,a=e.editorValues,r=e.update;return v.a.createElement("div",null,v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"3"},v.a.createElement(y.p,{className:"label"},"Notes")),v.a.createElement(y.g,{size:"9"},v.a.createElement(y.M,{className:"textarea",placeholder:"Enter event note",maxlength:120,spellcheck:!0,rows:4,value:a.notes,disabled:a.isReadonly||a.isConfirmed,onIonChange:function(e){return(t=e.detail.value)||(t=""),void(t!==a.notes&&r({type:"NOTES-UPDATED",notes:t}));var t}}))),v.a.createElement("div",{className:"character-counter"},null!==(t=null===(n=a.notes)||void 0===n?void 0:n.length)&&void 0!==t?t:0,"/120"))},Zn=function(e){var t=e.auth,n=e.editorValues,a=e.update,r=Object(f.useState)(!1),o=Object(S.a)(r,2),i=o[0],c=o[1],s=Object(f.useState)(null),l=Object(S.a)(s,2),u=l[0],d=l[1];Object(f.useEffect)((function(){if(!(0===n.locationId||u&&n.locationId===u.LocationId)&&t&&t.locations&&0!==t.locations.length&&n.locationId){var e=ft.getLocSettingsForLocationId(t,n.locationId);d(e)}}),[n.locationId,t]),Object(f.useEffect)((function(){u&&c(void 0!==u.ClockOutValueLabel&&null!==u.ClockOutValueLabel&&u.ClockOutValueLabel.length>0&&n.eventType===U.Clock&&!n.isClockedIn)}),[n.eventType,n.isClockedIn,u]);return i&&null!==u?v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"3"},v.a.createElement(y.p,{className:"label"},u.ClockOutValueLabel)),v.a.createElement(y.g,{size:"9"},v.a.createElement(y.n,{className:"input-textbox",placeholder:"Enter value",disabled:n.isReadonly||n.isConfirmed,value:n.clockoutValue,onIonChange:function(e){return null===(t=e.detail.value)&&(t=void 0),void(t!==n.clockoutValue&&a({type:"CLOCKOUTVALUE-UPDATED",locSettings:u,clockoutValue:t}));var t}}))):v.a.createElement("div",null)},Xn=n(230),$n=function(e){var t=e.locSettings,n=e.editorValues,a=e.update,r=Object(f.useState)([!1,!1,!1,!1,!1,!1,!1]),o=Object(S.a)(r,2),i=o[0],c=o[1];if(Object(f.useEffect)((function(){if(n.repeatWeekdays){for(var e=[!1,!1,!1,!1,!1,!1,!1],t=0;t<n.repeatWeekdays.length;t++)e[parseInt(n.repeatWeekdays[t])]=!0;c(e)}else c([!1,!1,!1,!1,!1,!1,!1])}),[n.repeatWeekdays]),null===t)return v.a.createElement("div",null);var s=et.getWeekStart(new Date,t.DayWeekStartsOn,t.DayStartTime);return v.a.createElement("div",{className:"weeklist-container"},[0,1,2,3,4,5,6].map((function(e){var t=Object(Re.a)(s,e),r=Object(Xn.a)(t);return v.a.createElement("span",{key:e,className:"day"},v.a.createElement(y.f,{className:"day-checkbox",disabled:n.isReadonly,onClick:function(){return function(e){var t=i.slice();t[e]=!i[e],c(t);for(var r="",o=0;o<t.length;o++)t[o]&&(r+=o);a({type:"REPEATING-UPDATED",repeatWeekDays:r,repeatInterval:n.repeatInterval,recurrenceType:n.recurrenceType,recurrenceEnd:n.recurrenceEnd,recurrenceStart:n.recurrenceStart})}(r)},checked:i[r]}),v.a.createElement("span",{className:"day-abbr"},Object(xe.a)(t,"EE").substr(0,2)))})))},ea=function(e){var t=e.auth,n=e.editorValues,a=e.update,r=Object(f.useState)(null),o=Object(S.a)(r,2),i=o[0],c=o[1],s=Object(f.useState)(!1),l=Object(S.a)(s,2),u=l[0],d=l[1],m=Object(f.useState)(!1),p=Object(S.a)(m,2),E=p[0],h=p[1];return Object(f.useEffect)((function(){-1!==n.scheduleEventId&&(n.locationId>0?c(ft.getLocSettingsForLocationId(t,n.locationId)):0===n.locationId&&c(t.locations[0].settings))}),[n.locationId,n.scheduleEventId]),Object(f.useEffect)((function(){-1!==n.scheduleEventId&&d(n.eventType===U.Shift||n.eventType===U.Unavailable)}),[n.eventType,n.scheduleEventId]),Object(f.useEffect)((function(){u&&-1!==n.scheduleEventId&&n.recurrenceStart&&h(!0)}),[E,u,n.recurrenceStart,n.scheduleEventId]),u?v.a.createElement(v.a.Fragment,null,v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"3"},v.a.createElement(y.p,{className:"label"},"(R)epeats")),v.a.createElement(y.g,{size:"2"},v.a.createElement(y.f,{checked:E,onClick:function(){a(E?{type:"REPEATING-UPDATED",repeatWeekDays:void 0,repeatInterval:void 0,recurrenceType:void 0,recurrenceEnd:void 0,recurrenceStart:void 0}:{type:"REPEATING-UPDATED",repeatWeekDays:void 0,repeatInterval:1,recurrenceType:q.Weekly,recurrenceEnd:void 0,recurrenceStart:et.formatDateTimeAsMvcString(new Date)}),h(!E)},disabled:n.isReadonly||n.isConfirmed}))),E&&v.a.createElement(v.a.Fragment,null,v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"1"},v.a.createElement(y.m,{icon:k.i,mode:"md"})),v.a.createElement(y.g,{size:"5"},v.a.createElement(y.i,{mode:"ios",value:n.recurrenceStart,className:"select",displayFormat:"M/D/YY, DDD",pickerFormat:"MMM DD YYYY",disabled:n.isReadonly||n.isConfirmed,min:"2005-01-01",max:"2030-01-01",onIonChange:function(e){var t;t=e.detail.value,a(t?{type:"REPEATING-UPDATED",repeatWeekDays:n.repeatWeekdays,repeatInterval:n.repeatInterval,recurrenceType:n.recurrenceType,recurrenceEnd:n.recurrenceEnd,recurrenceStart:t}:{type:"REPEATING-UPDATED",repeatWeekDays:n.repeatWeekdays,repeatInterval:n.repeatInterval,recurrenceType:n.recurrenceType,recurrenceEnd:n.recurrenceEnd,recurrenceStart:void 0})}})),v.a.createElement(y.g,{size:"1"},v.a.createElement(y.m,{icon:k.i,mode:"md",style:{textAlign:"right"}})),v.a.createElement(y.g,{size:"5"},v.a.createElement(y.i,{mode:"ios",value:n.recurrenceEnd,className:"select",displayFormat:"M/D/YY, DDD",pickerFormat:"MMM DD YYYY",disabled:n.isReadonly||n.isConfirmed,min:"2005-01-01",max:"2030-01-01",onIonChange:function(e){var t;t=e.detail.value,a(t?{type:"REPEATING-UPDATED",repeatWeekDays:n.repeatWeekdays,repeatInterval:n.repeatInterval,recurrenceType:n.recurrenceType,recurrenceEnd:t,recurrenceStart:n.recurrenceStart}:{type:"REPEATING-UPDATED",repeatWeekDays:n.repeatWeekdays,repeatInterval:n.repeatInterval,recurrenceType:n.recurrenceType,recurrenceEnd:void 0,recurrenceStart:n.recurrenceStart})}}))),v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"1"},v.a.createElement(y.m,{icon:k.w,mode:"md"})),v.a.createElement(y.g,{size:"5"},v.a.createElement(y.E,{mode:"ios",interface:"action-sheet",className:"select",value:n.recurrenceType,disabled:n.isReadonly||n.isConfirmed,onIonChange:function(e){var t;t=e.detail.value,a(t?{type:"REPEATING-UPDATED",repeatWeekDays:n.repeatWeekdays,repeatInterval:n.repeatInterval,recurrenceType:parseInt(t),recurrenceEnd:n.recurrenceEnd,recurrenceStart:n.recurrenceStart}:{type:"REPEATING-UPDATED",repeatWeekDays:n.repeatWeekdays,repeatInterval:n.repeatInterval,recurrenceType:void 0,recurrenceEnd:n.recurrenceEnd,recurrenceStart:n.recurrenceStart})}},v.a.createElement(y.F,{value:q.Weekly},"Weekly"),v.a.createElement(y.F,{value:q.MonthlyByDayOfMonth},"Monthly (Day of Month)"),v.a.createElement(y.F,{value:q.MonthlyByDayOfWeek},"Monthly (Day of Week)"))),v.a.createElement(y.g,{size:"1"},"#"),v.a.createElement(y.g,{size:"5"},v.a.createElement(y.n,{className:"input-textbox",disabled:n.isReadonly||n.isConfirmed,value:n.repeatInterval?n.repeatInterval.toString():void 0,onIonChange:function(e){return t=e.detail.value,void a(t?{type:"REPEATING-UPDATED",repeatWeekDays:n.repeatWeekdays,repeatInterval:parseInt(t),recurrenceType:n.recurrenceType,recurrenceEnd:n.recurrenceEnd,recurrenceStart:n.recurrenceStart}:{type:"REPEATING-UPDATED",repeatWeekDays:n.repeatWeekdays,repeatInterval:void 0,recurrenceType:n.recurrenceType,recurrenceEnd:n.recurrenceEnd,recurrenceStart:n.recurrenceStart});var t}}))),v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"12"},v.a.createElement($n,{locSettings:i,editorValues:n,update:a}))))):v.a.createElement("span",null)},ta=function(e){var t=e.onSelect,n=e.updateType;if("NO"===n)return v.a.createElement("div",null);var a=function(e){t(e)},r="UPDATE"===n?"Update Repeating":"Delete Repeating";return v.a.createElement(v.a.Fragment,null,v.a.createElement(y.l,{mode:"ios"},v.a.createElement(y.Q,null,v.a.createElement(y.N,null,r))),v.a.createElement(y.h,null,v.a.createElement(y.k,null,v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"12"},v.a.createElement(y.d,{expand:"block",color:"danger",className:"apply-button",onClick:function(){return a(z.UpdateSingleEvent)}},"This event"))),v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"12"},v.a.createElement(y.d,{expand:"block",color:"danger",className:"apply-button",onClick:function(){return a(z.UpdateEntireSeries)}},"Entire series"))),v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"12"},v.a.createElement(y.d,{expand:"block",color:"danger",className:"apply-button",onClick:function(){return a(z.UpdateSeriesForward)}},"This event forward"))))),v.a.createElement(y.j,null,v.a.createElement(y.d,{expand:"block",className:"cancel-button",onClick:function(){return a(null)}},"Cancel")))},na=function(e){var t=e.onCancel,n=e.onOk,a=e.editorValues,r=e.eventRequestType,o=e.buttonText,i=Object(f.useContext)(ke).user,c=Object(f.useContext)(ht).auth,s=Object(f.useState)(""),l=Object(S.a)(s,2),u=l[0],d=l[1],m=Object(f.useState)(null),p=Object(S.a)(m,2),E=p[0],h=p[1],g=Object(f.useState)(null),b=Object(S.a)(g,2),O=b[0],I=b[1],C=ft.getLocSettingsForLocationId(c,a.locationId);Object(f.useEffect)((function(){r===Hn.CreateCoverRequest&&a.scheduleEventId>0&&Kn.getCoverRequestListItems(i,a.scheduleEventId,!0).then((function(e){I(e),e&&e.length>0&&h(e[0].value)}))}),[a.scheduleEventId,r]);return r===Hn.None?v.a.createElement(v.a.Fragment,null):v.a.createElement(v.a.Fragment,null,v.a.createElement(y.h,null,v.a.createElement(y.l,{mode:"ios"},v.a.createElement(y.Q,null,v.a.createElement(y.N,null,o),v.a.createElement(y.e,{slot:"end"},v.a.createElement(y.d,{onClick:t},v.a.createElement(y.m,{icon:k.n,mode:"ios",slot:"icon-only"}))))),v.a.createElement(y.k,null,v.a.createElement(y.B,{hidden:!C.EnableDirectCoverRequest||r!==Hn.CreateCoverRequest},v.a.createElement(y.g,{className:"label",size:"3"},"To"),v.a.createElement(y.g,{size:"9"},v.a.createElement(y.E,{className:"select",value:E,onIonChange:function(e){h(parseInt(e.detail.value))}},O&&O.map((function(e){return v.a.createElement(y.F,{key:e.value,value:e.value,disabled:e.disabled},e.text)}))))),v.a.createElement(y.B,{hidden:r===Hn.CreateCoverRequest},v.a.createElement(y.g,{size:"12"},r===Hn.UndoCoverRequest&&v.a.createElement("div",{className:"usage-message"},"This will remove your Cover-Request, setting the event to Shift-Approved."),r===Hn.ApproveShiftRequest&&v.a.createElement("div",{className:"usage-message"},"This will approve the Shift-Request from ",a.employee.name),r===Hn.CreateShiftRequest&&v.a.createElement("div",{className:"usage-message"},"This will create a Shift-Request to be approved by an admin."),r===Hn.DeleteRequest&&v.a.createElement("div",{className:"usage-message"},"This will delete your Request."))),v.a.createElement(y.B,{hidden:r!==Hn.CreateCoverRequest},v.a.createElement(y.g,{className:"label",size:"3"},"Notes"),v.a.createElement(y.g,{size:"9"},v.a.createElement(y.M,{className:"select",maxlength:200,rows:4,value:u,onIonChange:function(e){d(e.detail.value)}}))),v.a.createElement(y.B,null,v.a.createElement(y.g,{className:"label",size:"3"}),v.a.createElement(y.g,{size:"9",className:"error-message"},v.a.createElement("div",null))))),v.a.createElement(y.j,null,v.a.createElement(y.d,{expand:"block",color:"secondary",onClick:function(){n(E,null!==u&&void 0!==u?u:"",!1)}},"OK")))};!function(e){e[e.None=0]="None",e[e.UndoCoverRequest=1]="UndoCoverRequest",e[e.CreateShiftRequest=2]="CreateShiftRequest",e[e.DeleteRequest=3]="DeleteRequest",e[e.CreateCoverRequest=4]="CreateCoverRequest",e[e.ApproveShiftRequest=5]="ApproveShiftRequest",e[e.UndoCover=6]="UndoCover"}(Hn||(Hn={}));var aa=function(e){var t=e.auth,n=e.cancelEditModal,a=e.editorValues,r=e.messageId,o=Object(f.useContext)(ke).user,i=Object(f.useState)(!1),c=Object(S.a)(i,2),s=c[0],l=c[1],u=Ce(),d=ot("Please wait..."),m=function(e,t){var n=ft.isAdminForThisEvent(e,t);if(e.scheduleEventId<=0)return Hn.None;if((null!==e.transferToScheduleEventId||null!==e.transferFromScheduleEventId)&&e.eventStatus===p.Approved&&(e.eventType===U.Cover||e.eventType===U.Shift)&&n)return Hn.UndoCover;if(e.eventType===U.Cover&&e.eventStatus===p.Request)return e.employee.id===t.employeeId?n?Hn.None:Hn.UndoCoverRequest:ft.hasPosition(t,e.position.position.id)?Hn.CreateShiftRequest:Hn.None;if(e.eventType===U.Shift&&e.eventStatus===p.Request){if(n)return Hn.ApproveShiftRequest;if(e.employee.id===t.employeeId)return Hn.DeleteRequest}return e.eventType===U.Shift&&e.eventStatus===p.Approved&&e.employee.id===t.employeeId?Hn.CreateCoverRequest:Hn.None}(a,t),E=function(e,t){var n=ft.isAdminForThisEvent(e,t);if(e.eventStatus===p.Approved&&(e.eventType===U.Cover||e.eventType===U.Shift)&&(null!==e.transferFromScheduleEventId||null!==e.transferToScheduleEventId)&&n)return"Undo Cover-Approved";if(e.eventType===U.Shift&&e.eventStatus===p.Approved)return"Create Cover-Request";if(e.eventType===U.Shift&&e.eventStatus===p.Request){if(n)return"Approve Shift-Request";if(e.employee.id===t.employeeId)return"Delete Shift-Request"}return e.eventType===U.Cover&&e.eventStatus===p.Request?e.employee.id===t.employeeId?"Undo Cover-Request":"Make Shift-Request":"UNKNOWN"}(a,t),h=function(e){l(!1),n(e)};return ft.isAuthItemsValid(t)&&m!==Hn.None?v.a.createElement(v.a.Fragment,null,v.a.createElement(y.d,{className:"apply-button",expand:"block",onClick:function(){l(!0)}},E),v.a.createElement(y.w,{isOpen:s,cssClass:"mini-modal event-request-modal",onDidDismiss:function(){return l(!1)}},v.a.createElement(na,{onCancel:function(){l(!1)},onOk:function(e,t,n){switch(d.setShowLoading(!0),m){case Hn.CreateCoverRequest:Kn.createCoverRequest(o,a.scheduleEventId,a.locationId,0,n,t,e).then((function(){d.setShowLoading(!1),h("Cover-Request Created")}));break;case Hn.CreateShiftRequest:Kn.makeShiftRequest(o,a.scheduleEventId,a.locationId,0,n,t).then((function(e){d.setShowLoading(!1),e.error?u.showAlert("Shift-Request Failed",e.message,(function(){})):h(e.message)}));break;case Hn.DeleteRequest:Kn.removeShiftRequest(o,a.locationId,a.scheduleEventId,a.eventType,a.eventStatus,void 0).then((function(){d.setShowLoading(!1),h("Shift-Request Removed")}));break;case Hn.UndoCoverRequest:Kn.undoCoverRequest(o,a.scheduleEventId).then((function(){d.setShowLoading(!1),h("Removed Cover-Request")}));break;case Hn.ApproveShiftRequest:if(null===r||void 0===r)break;Kn.approveShiftRequest(o,r).then((function(e){d.setShowLoading(!1),e.error?u.showAlert("Could not approve",e.message,(function(){})):h("Approved")}));break;case Hn.UndoCover:Kn.undoCoverApproved(o,a.scheduleEventId).then((function(e){d.setShowLoading(!1),e.error?u.showAlert("Could not undo Cover",e.message,(function(){})):h("Cover Undone")}))}},editorValues:a,eventRequestType:m,buttonText:E}),u.alertBoxJsx,d.showLoadingJsx)):v.a.createElement(v.a.Fragment,null)},ra=function(e){var t=e.editorValues,n=e.update,a=Object(f.useContext)(ke).user,r=Object(f.useState)([]),o=Object(S.a)(r,2),i=o[0],c=o[1];return Object(f.useEffect)((function(){t.scheduleEventId<=0||!a.isLoggedin||Kn.getCoverRequestListItems(a,t.scheduleEventId,!1).then((function(e){c(e)}))}),[t.scheduleEventId,a]),t.eventType===U.Cover&&t.eventStatus===p.Request||null!==t.transferToEmployeeId?v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"3"},v.a.createElement(y.p,{className:"label"},"Transfer To")),v.a.createElement(y.g,{size:"9"},v.a.createElement(y.E,{mode:"ios",className:"select",placeholder:"None",interface:"action-sheet",disabled:t.isReadonly||t.isConfirmed,value:t.transferToEmployeeId,onIonChange:function(e){var a;void 0!==(a=e.detail.value)&&a!==t.transferToEmployeeId&&n({type:"TRANSFERTO-EMPLOYEE-UPDATED",transferToEmployeeId:a})}},i.map((function(e){return v.a.createElement(y.F,{key:e.value,value:0===e.value?null:e.value,disabled:e.disabled},e.text)}))))):v.a.createElement(v.a.Fragment,null)};var oa=function(e){var t=e.auth,n=e.scheduleEventId,a=e.onDismissModal,r=e.onCancelModal,o=e.isOpen,i=e.initialEvent,c=ot("Please wait..."),s=Ce(),l=v.a.useContext(ke).user,u=Object(f.useReducer)(Un,i),d=Object(S.a)(u,2),m=d[0],p=d[1],E=Object(f.useState)(null),h=Object(S.a)(E,2),g=h[0],b=h[1],O=Object(f.useState)(null),I=Object(S.a)(O,2),C=I[0],j=I[1],T=Object(f.useState)("NO"),A=Object(S.a)(T,2),D=A[0],N=A[1],w=Object(f.useState)("NONE"),x=Object(S.a)(w,2),M=x[0],F=x[1],L=null!==n,R=qt(),P="New Event",U="CREATE";L&&(P="Edit Event",U="UPDATE"),Object(f.useEffect)((function(){o&&t&&t.locations&&0!==t.locations.length&&(!n||null!==g&&n===g.ScheduleEventId?(null!==g&&b(null),p({type:"CREATE-EVENT",auth:t})):(c.setShowLoading(!0),ce("edit_event_get_scheduleevent",{user:l.username,scheduleEventId:n}),Mt.getScheduleEvent(l,n).then((function(e){c.setShowLoading(!1),e?(!function(e){if(e.EventStart=et.convertTimeWithoutTimeZoneToLocalTime(e.EventStart),e.EventEnd=et.convertTimeWithoutTimeZoneToLocalTime(e.EventEnd),e.EventBreaks)for(var t=0;t<e.EventBreaks.length;t++)e.EventBreaks[t].BreakStart=et.convertTimeWithoutTimeZoneToLocalTime(e.EventBreaks[t].BreakStart),e.EventBreaks[t].BreakEnd&&et.convertTimeWithoutTimeZoneToLocalTime(e.EventBreaks[t].BreakEnd)}(e),b(e),p({type:"BEGIN-UPDATE",ev:e,auth:t})):s.showAlert("No Event","The event may have been removed or you no longer have access",z)}))))}),[n,l,o,t]),Object(f.useEffect)((function(){null!==C&&"NONE"!==M&&("CREATEUPDATE"===M?B():V(null!==m.recurrenceId&&void 0!==m.recurrenceId))}),[C,M]);var B=function(){var e=0===m.scheduleEventId?Mt.createScheduleEvent:Mt.updateScheduleEvent,t=0===m.scheduleEventId?"edit_event_create":"edit_event_update",r=0===m.scheduleEventId?"Event Created":"Event Updated";e(l,m,C).then((function(e){e.error?s.showAlert("Cannot update",e.message,(function(){})):(ce(t,{user:l.username,scheduleEventId:n}),null!==m.transferToEmployeeId&&m.scheduleEventId>0?Kn.transferCoverToEmployee(l,m.transferToEmployeeId,m.scheduleEventId).then((function(t){t.error?s.showAlert("Cannot transfer",e.message,(function(){})):a("Transferred")})):a(r))}))},V=function(e){var t=function(){Mt.deleteScheduleEvent(l,m.scheduleEventId,C).then((function(e){e.error?s.showAlert("Cannot delete",e.message,(function(){a("Could not delete event")})):(ce("edit_event_delete",{user:l.username,scheduleEventId:n}),a("Deleted Event"))}))};e?t():R.showDialog("Delete event?","",[{text:"Delete",color:"danger",value:1}],(function(e){1===e&&t()}))},q=function(e){N("NO"),j(e),null===e&&F("NONE")},z=function(){p({type:"CANCEL"}),Object(le.a)().push("/tabs/schedule"),r()};return o&&t&&t.locations&&0!==t.locations.length?v.a.createElement(v.a.Fragment,null,v.a.createElement(y.l,{className:"ion-no-border"},v.a.createElement(y.Q,null,v.a.createElement(y.e,{slot:"start"},v.a.createElement(y.d,{onClick:z},v.a.createElement(y.m,{icon:k.c,mode:"md",slot:"icon-only"}))),v.a.createElement(y.N,null,P))),v.a.createElement(y.h,{class:"outer-content"},v.a.createElement(y.k,null,v.a.createElement(mn,{editorValues:m,update:p,auth:t}),v.a.createElement(y.B,null,v.a.createElement(Cn,{auth:t,editorValues:m,update:p,onEmployeeUpdated:function(){var e=!m.isConfirmed;Mt.updateConfirmedScheduleEvent(l,m.scheduleEventId,e).then((function(t){t.error?s.showAlert("confirm",t.message,(function(){})):a(e?"Confirmed":"Unconfirmed")}))}}),v.a.createElement(jn,{auth:t,editorValues:m,update:p})),v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"12"},v.a.createElement("div",{style:{width:"100%",borderBottom:"1px solid #ddd"}}))),v.a.createElement(pn,{auth:t,editorValues:m,update:p}),v.a.createElement(fn,{auth:t,editorValues:m,update:p}),v.a.createElement(vn,{auth:t,editorValues:m,update:p}),v.a.createElement(ea,{auth:t,editorValues:m,update:p}),v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"12"},v.a.createElement("div",{style:{width:"100%",borderBottom:"1px solid #ddd"}}))),v.a.createElement(kn,{auth:t,editorValues:m,update:p}),v.a.createElement(In,{auth:t,editorValues:m,update:p}),v.a.createElement(ra,{auth:t,editorValues:m,update:p}),v.a.createElement(Zn,{auth:t,editorValues:m,update:p}),v.a.createElement(Qn,{auth:t,editorValues:m,update:p})),s.alertBoxJsx,R.dialogBoxJsx,c.showLoadingJsx,v.a.createElement(y.w,{isOpen:"NO"!==D,onDidDismiss:function(){q(null)},cssClass:"mini-modal recurrence-update-modal"},v.a.createElement(ta,{onSelect:q,updateType:D}))),v.a.createElement(y.j,null,m.isReadonly&&v.a.createElement(aa,{auth:t,update:p,cancelEditModal:function(e){return a(e)},editorValues:m}),v.a.createElement(y.d,{className:"apply-button",expand:"block",onClick:function(){F("CREATEUPDATE"),m.recurrenceId?null!==C?B():N("UPDATE"):B()},disabled:!m.valid,hidden:m.isReadonly},U),v.a.createElement(y.d,{className:"delete-button",expand:"block",onClick:function(){F("DELETE"),m.recurrenceId?null!==C?V(!0):N("DELETE"):V(null!==m.recurrenceId&&void 0!==m.recurrenceId)},hidden:m.isReadonly||m.scheduleEventId<=0},"DELETE"))):v.a.createElement(v.a.Fragment,null,v.a.createElement("div",null,"Loading"),s.alertBoxJsx)},ia=n(21),ca=n.n(ia),sa=function(e){e.threeRows;return v.a.createElement("button",{className:"card"},v.a.createElement("div",{className:"card-first-col"},v.a.createElement("div",{className:"day-name"},v.a.createElement(ca.a,{width:40,height:40})," ")),v.a.createElement("div",{style:{padding:"0px 10px"}},v.a.createElement("div",null,v.a.createElement(ca.a,{width:5,height:40}))),v.a.createElement("div",null,v.a.createElement("div",null,v.a.createElement(ca.a,{width:240,height:40}))))};function la(e,t,n){var a=Object(f.useRef)();Object(f.useEffect)((function(){a.current=e}),[e]),Object(f.useEffect)((function(){if(null!==n){var e=setInterval((function(){a.current&&t&&a.current()}),n);return function(){return clearInterval(e)}}}),[n,t])}var ua=[],da=[];function ma(e,t){return!!t.positionIds.includes(e.PositionId)&&((void 0===t.tagId||-1===t.tagId||t.tagId===e.TagId)&&Ge.eventMatchesFilter(t.eventTypeId,t.eventStatusId,e.EventTypeId,e.EventStatusId))}function pa(e,t,n){if(-1===t.DepartmentId){if(!n.positionIds.map((function(t){return ft.getLocationIdFromPositionid(e,t)})).includes(t.LocationId))return!1}else if(t.DepartmentId>0&&!n.positionIds.map((function(t){var n;return null===(n=ft.getDepartmentFromPositionId(e,t))||void 0===n?void 0:n.id})).includes(t.DepartmentId))return!1;return!0}var fa=function(e){var t=e.match,n=Object(f.useRef)(null),a=v.a.useContext(ke).user,r=v.a.useContext(ht),o=r.auth,i=r.refreshAuth,c=Ae(),s=cn((function(e){ut(o,ct,e)})),l=o&&o.locations&&o.locations.length>0?et.getWeekStart(Object(kt.a)(new Date),o.locations[0].settings.DayWeekStartsOn,o.locations[0].settings.DayStartTime):et.getWeekStart(Object(kt.a)(new Date),"Monday",""),u=Object(f.useState)(ua),d=Object(S.a)(u,2),E=d[0],h=d[1],g=Object(f.useState)(da),b=Object(S.a)(g,2),O=b[0],C=b[1],j=Object(f.useState)(ua),T=Object(S.a)(j,2),A=T[0],D=T[1],N=Object(f.useState)(da),w=Object(S.a)(N,2),x=w[0],M=w[1],F=Object(f.useState)([]),L=Object(S.a)(F,2),R=L[0],P=L[1],U=Object(f.useState)(ua),B=Object(S.a)(U,2),V=B[0],q=B[1],z=Object(f.useState)(da),W=Object(S.a)(z,2),_=W[0],G=W[1],Y=Object(f.useState)(ua),J=Object(S.a)(Y,2),H=J[0],K=J[1],Q=Object(f.useState)(da),Z=Object(S.a)(Q,2),X=Z[0],$=Z[1],ee=Object(f.useState)([]),te=Object(S.a)(ee,2),ne=te[0],ae=te[1],oe=Object(f.useState)(ua),ie=Object(S.a)(oe,2),ce=ie[0],se=ie[1],le=Object(f.useState)(da),ue=Object(S.a)(le,2),de=ue[0],me=ue[1],pe=Object(f.useState)(ua),fe=Object(S.a)(pe,2),ve=fe[0],Ee=fe[1],he=Object(f.useState)(da),ge=Object(S.a)(he,2),be=ge[0],ye=ge[1],Oe=Object(f.useState)([]),Se=Object(S.a)(Oe,2),Ie=Se[0],Ce=Se[1],je=Object(f.useState)(!0),Te=Object(S.a)(je,2),De=Te[0],Ne=Te[1],we=Object(f.useState)(!1),xe=Object(S.a)(we,2),Me=xe[0],Fe=xe[1],Le=Object(f.useState)("my"),Pe=Object(S.a)(Le,2),Ue=Pe[0],Be=Pe[1],Ve=Object(f.useState)(!1),qe=Object(S.a)(Ve,2),ze=qe[0],We=qe[1],_e=Object(f.useState)(!1),Ye=Object(S.a)(_e,2),Je=Ye[0],He=Ye[1],Ke=Object(f.useState)(null),Qe=Object(S.a)(Ke,2),Ze=Qe[0],Xe=Qe[1],$e=Object(f.useState)(An),tt=Object(S.a)($e,2),nt=tt[0],at=tt[1],rt=rn.getFilter(o),ot=Object(f.useState)({tagId:rt.tagId,positionIds:rt.positionIds,dnLocIds:rt.dnLocIds,settingsLocId:rt.settingsLocId,eventTypeId:rt.eventTypeId,eventStatusId:rt.eventStatusId,start:l,end:Object(Re.a)(l,7),filterByEmployee:!1,view:xt.schedule}),it=Object(S.a)(ot,2),ct=it[0],st=it[1];Object(y.W)((function(){Fe(!0)})),Object(y.X)((function(){Fe(!1)})),la((function(){i(!1,a).then((function(e){e&&ut(e,ct)}))}),Me&&!Je&&!ze,re(a).refreshScheduleTimer),Object(f.useEffect)((function(){a.isLoggedin&&void 0!==ct&&(Ne(!0),ut(o,ct))}),[a.isLoggedin]),Object(f.useEffect)((function(){t.params.scheduleEventId&&(Xe(parseInt(t.params.scheduleEventId)),He(!0))}),[t.params.scheduleEventId]);var lt=Object(f.useCallback)((function(e){Xe(e.ScheduleEventId),at(Dn(o,e)),He(!0)}),[o.locations]);if(!ft.isAuthItemsValid(o))return v.a.createElement("div",null);var ut=function(e,t,n){var r=rn.getDefaultFilter(e,t),o=Object(I.a)({},r,{start:t.start,end:t.end,filterByEmployee:!1,eventTypeId:m.All,eventStatusId:m.All});Mt.getScheduleEventsByFilter(a,o).then((function(a){Ne(!1),n&&n.detail.complete();var r=function(e,t,n){return e.filter((function(e){return Ge.eventMatchesFilter(n.eventTypeId,n.eventStatusId,e.EventTypeId,e.EventStatusId)&&e.EmployeeId===t.employeeId}))}(a.events,e,o);h(r),C(a.dailyNotes),D(r.filter((function(e){return ma(e,t)})));var i=a.dailyNotes.filter((function(n){return pa(e,n,t)}));M(i),P([a.totalTimeForEmployee]);var c=a.events.filter((function(e){return e.EventStatusId===p.Request}));q(c),G([]),K(c.filter((function(e){return ma(e,Object(I.a)({},t,{eventStatusId:p.Request,eventTypeId:m.All}))}))),$([]),ae(a.hoursPerDay);var s=function(e,t){return e.filter((function(e){return Ge.eventMatchesFilter(t.eventTypeId,t.eventStatusId,e.EventTypeId,e.EventStatusId)}))}(a.events,o);se(s),me(a.dailyNotes),Ee(s.filter((function(e){return ma(e,t)}))),ye(i),Ce(a.hoursPerDay)}))},dt=function(e){Be(e)},mt=function(e){e&&e.length>0&&c.showToast(e),ut(o,ct)};return v.a.createElement(y.x,{id:"schedule-page"},v.a.createElement(y.l,{className:"ion-no-border"},v.a.createElement(y.Q,{mode:"md"},v.a.createElement(y.e,{slot:"start"},v.a.createElement(y.u,null)),v.a.createElement(y.N,{slot:"start"},"Schedule"),v.a.createElement(y.e,{slot:"end"},v.a.createElement(y.d,{onClick:function(){Xe(null),He(!0)}},v.a.createElement(y.m,{icon:k.a,mode:"md",slot:"icon-only"})),v.a.createElement(y.d,{onClick:function(){return We(!0)}},v.a.createElement("div",{className:rn.isFilterApplied(o,ct)?"filter-applied":"filter-not-applied"},"\xb7"),v.a.createElement(y.m,{icon:k.p,mode:"ios",slot:"icon-only"}))))),v.a.createElement(y.C,{mode:"md",value:Ue},v.a.createElement(y.D,{mode:"md",value:"my",onClick:function(){return dt("my")}},"MY"),v.a.createElement(y.D,{mode:"md",value:"requests",onClick:function(){return dt("requests")}},"REQUESTS"),v.a.createElement(y.D,{mode:"md",value:"all",onClick:function(){return dt("all")}},"ALL")),v.a.createElement(Rt,{startDate:et.getWeekStart(ct.start,o.locations[0].settings.DayWeekStartsOn,""),setStartDate:function(e){if(e!==ct.start){var t=Object(I.a)({},ct,{start:e,end:Object(Re.a)(e,7)});st(t),Ne(!0),ut(o,t)}},onWeekdayClick:function(e){n.current.scrollToDate(e)}}),v.a.createElement(y.h,null,s.ionicRefresherJsx,!De&&"my"===Ue&&0===(null===E||void 0===E?void 0:E.length)&&v.a.createElement(Zt,null),!De&&"my"===Ue&&(null===E||void 0===E?void 0:E.length)>0&&v.a.createElement($t,{events:A,listType:Ue,notes:x,hoursPerDay:R,auth:o,onEdit:lt,onForceRefresh:mt,ref:n,weekStart:ct.start}),!De&&"requests"===Ue&&0===V.length&&v.a.createElement(Zt,null),!De&&"requests"===Ue&&V.length>0&&v.a.createElement($t,{events:H,listType:Ue,notes:X,hoursPerDay:ne,auth:o,onEdit:lt,onForceRefresh:mt,ref:n,weekStart:ct.start}),!De&&"all"===Ue&&0===(null===ce||void 0===ce?void 0:ce.length)&&v.a.createElement(Zt,null),!De&&"all"===Ue&&(null===ce||void 0===ce?void 0:ce.length)>0&&v.a.createElement($t,{events:ve,listType:Ue,notes:be,hoursPerDay:Ie,auth:o,onEdit:lt,onForceRefresh:mt,ref:n,weekStart:ct.start}),De&&v.a.createElement(v.a.Fragment,null,v.a.createElement("div",{style:{marginTop:"10px"}}),v.a.createElement(ca.a,{height:40,width:310}),v.a.createElement("br",null),v.a.createElement(sa,{threeRows:"my"!==Ue}),v.a.createElement(sa,{threeRows:"my"!==Ue}),v.a.createElement(sa,{threeRows:"my"!==Ue}))),c.simpleToastJsx,v.a.createElement(y.w,{isOpen:ze,onDidDismiss:function(){return We(!1)}},v.a.createElement(on,{filter:ct,auth:o,onDismissModal:function(e,t){st(e),t?(c.showToast("Filter applied"),rn.putFilter(e),D(E.filter((function(t){return ma(t,e)}))),M(O.filter((function(t){return pa(o,t,e)}))),K(V.filter((function(t){return ma(t,Object(I.a)({},e,{eventStatusId:p.Request,eventTypeId:m.All}))}))),$(_.filter((function(t){return pa(o,t,e)}))),Ee(ce.filter((function(t){return ma(t,e)}))),ye(de.filter((function(t){return pa(o,t,e)})))):(rn.clear(),D(E),M(O),K(V),$(_),Ee(ce),ye(de)),We(!1)},isOpen:ze,onCancelModal:function(){return We(!1)}})),v.a.createElement(y.w,{isOpen:Je,onDidDismiss:function(){return He(!1)}},v.a.createElement(oa,{isOpen:Je,auth:o,onCancelModal:function(){return He(!1)},onDismissModal:function(e){return function(e){e&&c.showToast(e),ut(o,ct),He(!1)}(e)},scheduleEventId:Ze,initialEvent:nt})))},va=function(e){var t=e.auth,n=e.onDismissModal,a=e.tcData,o=Object(f.useState)([]),i=Object(S.a)(o,2),c=i[0],s=i[1],l={key:"Cancel",name:"",breakType:r.UnscheduledUnpaid};return Object(f.useEffect)((function(){if(0!==t.locations.length&&a.ClockedInScheduleEvent){var e=t.locations.filter((function(e){return e.id===a.ClockedInScheduleEvent.LocationId}))[0].settings,n=[];switch(a.ScheduleEventsForClockIn.length>0&&a.ScheduleEventsForClockIn[0].EventBreaks.map((function(e){return n.push({key:e.BreakStart,name:et.getEventBreakStartEndString(e),breakType:r.Scheduled})})),e.UnscheduledBreakOptions){case J.Both:n.push({key:"UnScheduledUnpaid",name:"Unscheduled",breakType:r.UnscheduledUnpaid}),n.push({key:"UnScheduledPaid",name:"Unscheduled $",breakType:r.UnscheduledPaid});break;case J.Paid:n.push({key:"UnScheduledPaid",name:"Unscheduled $",breakType:r.UnscheduledPaid});break;case J.Unpaid:n.push({key:"UnScheduledUnpaid",name:"Unscheduled",breakType:r.UnscheduledUnpaid})}s(n)}}),[a,t]),v.a.createElement(v.a.Fragment,null,v.a.createElement(y.l,{mode:"ios"},v.a.createElement(y.Q,null,v.a.createElement(y.N,null,"Choose Break"),v.a.createElement(y.e,{slot:"end"},v.a.createElement(y.d,{onClick:function(){return n(l)}},v.a.createElement(y.m,{icon:k.n,mode:"ios",slot:"icon-only"}))))),v.a.createElement(y.h,{class:"outer-content"},c.map((function(e){return v.a.createElement(y.d,{className:"apply-button",expand:"block",key:e.key,color:"secondary",onClick:function(){n(e)}},e.name)}))))};function Ea(){return(Ea=Object(T.a)(j.a.mark((function e(t,n,a){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me.get(t,"api/v1/employee/timeclock/?lat=".concat(n,"&lng=").concat(a));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ha(){return(ha=Object(T.a)(j.a.mark((function e(t,n,a,r,o){var i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i="/api/v2/employee/timeclock/clockin/".concat(n,"/").concat(a,"?lat=").concat(r,"&lng=").concat(o),e.next=3,me.post(t,i,{});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ga(){return(ga=Object(T.a)(j.a.mark((function e(t,n,a,r){var o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={ClockOutValue:r,TimeClockBreak:null,BreakStart:null},e.next=3,me.post(t,"/api/v2/employee/timeclock/clockout?lat=".concat(n,"&lng=").concat(a),o);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ba(){return(ba=Object(T.a)(j.a.mark((function e(t,n,a,r,o,i){var c,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c="/api/v2/employee/timeclock/switch/".concat(n,"/").concat(a,"?lat=").concat(r,"&lng=").concat(o),s={ClockOutValue:i,TimeClockBreak:null,BreakStart:null},e.next=4,me.post(t,c,s);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ya(){return(ya=Object(T.a)(j.a.mark((function e(t,n,a,r,o,i,c){var s,l;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s="/api/v2/employee/timeclock/startbreak?lat=".concat(o,"&lng=").concat(i),l={clockEventId:n.ScheduleEventId,shiftEventId:a?a.ScheduleEventId:null,shiftBreakStart:c,breakType:r},e.next=4,me.post(t,s,l);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Oa(){return(Oa=Object(T.a)(j.a.mark((function e(t,n,a,r,o){var i,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=a?a.ScheduleEventId:"",c=null!==a?"/api/v2/employee/timeclock/endbreak/".concat(n.ScheduleEventId,"/").concat(i,"?lat=").concat(r,"&lng=").concat(o):"/api/v2/employee/timeclock/endbreak/".concat(n.ScheduleEventId,"/-1?lat=").concat(r,"&lng=").concat(o),e.next=4,me.post(t,c,{});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Sa(){return(Sa=Object(T.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/api/v2/employee/timeclock/geolocations",e.next=3,me.get(t,"/api/v2/employee/timeclock/geolocations");case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ka={getTimeClockSettings:function(e,t,n){return Ea.apply(this,arguments)},clockIn:function(e,t,n,a,r){return ha.apply(this,arguments)},clockOut:function(e,t,n,a){return ga.apply(this,arguments)},switchPositionOrTag:function(e,t,n,a,r,o){return ba.apply(this,arguments)},startBreak:function(e,t,n,a,r,o,i){return ya.apply(this,arguments)},endBreak:function(e,t,n,a,r){return Oa.apply(this,arguments)},getGeoLocations:function(e){return Sa.apply(this,arguments)}},Ia=function(e){var t=e.onCancel,n=e.onOk,a=e.locSettings,r=Object(f.useState)(void 0),o=Object(S.a)(r,2),i=o[0],c=o[1];return v.a.createElement(v.a.Fragment,null,v.a.createElement(y.l,{mode:"ios"},v.a.createElement(y.Q,null,v.a.createElement(y.N,null,"Clock Out"),v.a.createElement(y.e,{slot:"end"},v.a.createElement(y.d,{onClick:t},v.a.createElement(y.m,{icon:k.n,mode:"ios",slot:"icon-only"}))))),v.a.createElement(y.h,null,v.a.createElement(y.k,null,v.a.createElement(y.B,null,v.a.createElement(y.g,{className:"label",size:"5"},a.ClockOutValueLabel),v.a.createElement(y.g,{size:"7"},v.a.createElement(y.n,{placeholder:"Enter value",type:"number",className:"input",autoCorrect:"off",clearInput:!0,value:null===i||void 0===i?void 0:i.toString(),onIonChange:function(e){var t;(t=e.detail.value)?c(parseFloat(t)):void 0!==i&&c(void 0)}}))))),v.a.createElement(y.j,null,v.a.createElement(y.d,{expand:"block",onClick:function(){n(i)},className:"clockout-button"},"CLOCK OUT")))},Ca=function(e){var t=e.tcData,n=e.locSettings,a=e.selectedPosId,r=e.selectedTagId,o=e.onSwitch,i=Object(f.useState)(!0),c=Object(S.a)(i,2),s=c[0],l=c[1],u=v.a.createElement("span",null);return Object(f.useEffect)((function(){if(t.UserClockedIn){var e=t.ClockedInScheduleEvent.PositionId,n=t.ClockedInScheduleEvent.TagId;n||(n=-1),l(e===a&&n===r)}}),[t.UserClockedIn,t.ClockedInScheduleEvent,a,r]),(n.ClockInWithDifferentTag||n.EnablePositionChangeForEmployeePosition)&&t.UserClockedIn?v.a.createElement(y.d,{className:"ion-no-margin",disabled:s,color:"secondary",expand:"block",onClick:o},"SWITCH"):u};function ja(e,t,n){if(!e||!t||0===n.length)return"";if(!google||!google.maps||!google.maps.geometry||!google.maps.geometry.spherical||!google.maps.geometry.spherical.computeDistanceBetween)return"";for(var a=new google.maps.LatLng(e,t),r=null,o=999999999,i=0;i<n.length;i++){var c=n[i];if(c.lat&&c.lng){var s=new google.maps.LatLng(c.lat,c.lng),l=3.28084*google.maps.geometry.spherical.computeDistanceBetween(a,s)-c.proximity;l<o&&(o=l,r=c)}}if(999999999===o)return"";if(o<0)return"At "+r.locationName;var u=189394e-9*o;return u>.1?"".concat(Math.round(10*(u+Number.EPSILON))/10," mi to ").concat(r.locationName):"".concat(Math.round(o)," ft to ").concat(r.locationName)}function Ta(e){return null!==e&&!(void 0===e.coords.latitude||void 0===e.coords.longitude)}var Aa=function(e){var t=e.pos,n=Object(f.useRef)(null),a=Object(f.useRef)(),r=Object(f.useRef)(),o=v.a.useContext(ke).user,i=Object(f.useState)(""),c=Object(S.a)(i,2),s=c[0],l=c[1],u=Object(f.useState)([]),d=Object(S.a)(u,2),m=d[0],p=d[1],E=Object(f.useState)(!1),h=Object(S.a)(E,2),g=h[0],b=h[1];return Object(f.useEffect)((function(){if(null!==n.current&&Ta(t))if(void 0===a.current)a.current=new google.maps.Map(n.current,{center:{lat:t.coords.latitude,lng:t.coords.longitude},zoom:16,disableDefaultUI:!0,fullscreenControl:!1}),function(){Ta(t)&&(r.current=new google.maps.Circle({strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.25,radius:6.5,center:{lat:t.coords.latitude,lng:t.coords.longitude},map:a.current}));ka.getGeoLocations(o).then((function(e){p(e),e.forEach((function(e){var t=new google.maps.InfoWindow({content:"<h5>".concat(e.addr,"</h5>")});if(e.lat&&e.lng){var n=new google.maps.LatLng(e.lat,e.lng),r=new google.maps.Marker({position:n,map:a.current,title:e.addr});new google.maps.Circle({strokeColor:"#FF0000",strokeOpacity:.5,strokeWeight:1,fillColor:"#DD0000",fillOpacity:.2,radius:.3048*e.proximity,center:n,map:a.current}),r.addListener("click",(function(){t.open(a.current,r)}))}})),Ta(t)&&l(ja(t.coords.latitude,t.coords.longitude,e))}))}(),google.maps.event.addListenerOnce(a.current,"idle",(function(){n.current&&n.current.classList.add("show-map")}));else{if(a.current&&Ta(t)){var e=new google.maps.LatLng(t.coords.latitude,t.coords.longitude);a.current.setCenter(e),r.current&&r.current.setMap(null),r.current=new google.maps.Circle({strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.25,radius:6.5,center:e,map:a.current})}l(ja(t.coords.latitude,t.coords.longitude,m))}}),[t,google,google.maps]),v.a.createElement(v.a.Fragment,null,v.a.createElement(y.d,{className:"map-button",onClick:function(){null!==t&&(b(!g),l(ja(t.coords.latitude,t.coords.longitude,m)))}},s,v.a.createElement(y.m,{id:"show-map-button",icon:g?k.d:k.f})),v.a.createElement("div",{id:"map-container",hidden:!g},v.a.createElement("div",{ref:n,className:"map-canvas"})))};var Da=function(){var e=Object(f.useState)(!1),t=Object(S.a)(e,2),n=t[0],a=t[1],r=Object(f.useState)({message:"",onCancel:function(){},onYes:function(){}}),o=Object(S.a)(r,2),i=o[0],c=o[1];return{showDialog:function(e,t,n){c({message:e,onYes:t,onCancel:n}),a(!0)},dialogJsx:v.a.createElement(y.b,{mode:"ios",isOpen:n,onDidDismiss:function(){a(!1)},message:i.message,buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:i.onCancel},{text:"Yes",handler:i.onYes}]})}},Na={enableHighAccuracy:!0,maximumAge:1e3};var wa=function(e){var t=e.updateCallback,n=e.isShowing,a=v.a.useContext(ke).user,r=v.a.useContext(ht).auth,o=Object(f.useState)(""),i=Object(S.a)(o,2),c=i[0],s=i[1],l=Object(f.useState)(null),u=Object(S.a)(l,2),d=u[0],m=u[1],p=Da(),E=Ae();return Object(f.useEffect)((function(){var e;ft.requiresGeolocation(r.locations)&&(n?s(function(e){var t=function(t){if(t&&t.coords){var n=!1;if(null===d)n=!0;else if(function(){var e=!(void 0===google||void 0===google.maps||void 0===google.maps.geometry||void 0===google.maps.geometry.spherical||void 0===google.maps.geometry.spherical.computeDistanceBetween||void 0===google.maps.LatLng);return e||console.log("WARNING: google maps not yet loaded"),e}()){var r=new google.maps.LatLng(d.coords.latitude,d.coords.longitude),o=new google.maps.LatLng(t.coords.latitude,t.coords.longitude);n=3.28084*google.maps.geometry.spherical.computeDistanceBetween(r,o)>re(a).minimumFeetForGeolocationUpdate}else n=!0;n&&(console.log("GEO: position changed"),m(t),e(t.coords.latitude,t.coords.longitude))}},n=function(t){console.log("GEO: Could not get geolocation, error code "+t.code),1===t.code&&e()},r="";if(oe.settings.hasCapacitor&&R.a.isPluginAvailable("Geolocation")){console.log("GEO: Using Cap plugin to watch position");try{r=R.b.watchPosition(Na,t),R.b.getCurrentPosition(Na).then((function(e){t(e)}))}catch(o){n({code:1})}}else{if(!navigator||!navigator.geolocation)return console.log("GEO: Location unavailable via cap/nav"),"";console.log("GEO: Using browser API"),r=navigator.geolocation.watchPosition(t,n,Na),navigator.geolocation.getCurrentPosition((function(e){t(e)}))}return console.log("GEO: start watching, watchId "+r),r}(t)):(""!==(e=c)&&(oe.settings.hasCapacitor&&R.a.isPluginAvailable("Geolocation")?R.b.clearWatch({id:e}).then((function(){console.log("GEO: cleared watchId ".concat(e," from Capacitor plugin"))})):navigator&&navigator.geolocation&&(navigator.geolocation.clearWatch(e),console.log("GEO: cleared watchId ".concat(e," from browser API")))),m(null),s("")))}),[n,a.isLoggedin]),v.a.createElement(v.a.Fragment,null,r&&r.locations&&r.locations.length>0&&ft.requiresGeolocation(r.locations)&&v.a.createElement(Aa,{pos:d}),p.dialogJsx,E.simpleToastJsx)},xa=function(e){var t=e.onUpdate,n=e.refreshToggle,a=v.a.useContext(ke).user,i=v.a.useContext(ht).auth,c=Object(f.useState)([]),s=Object(S.a)(c,2),l=s[0],u=s[1],m=Object(f.useState)(0),p=Object(S.a)(m,2),E=p[0],h=p[1],g=Object(f.useRef)(0),b=Object(f.useState)(!1),O=Object(S.a)(b,2),C=O[0],j=O[1],T=Object(f.useState)([]),A=Object(S.a)(T,2),D=A[0],N=A[1],w=Object(f.useState)(null),x=Object(S.a)(w,2),M=x[0],F=x[1],L=Object(f.useRef)(null),R=Object(f.useState)("START BREAK"),P=Object(S.a)(R,2),U=P[0],B=P[1],V=Object(f.useState)({}),q=Object(S.a)(V,2),z=q[0],W=q[1],G=Object(f.useState)(!1),Y=Object(S.a)(G,2),H=Y[0],K=Y[1],Q=Object(f.useState)(!1),Z=Object(S.a)(Q,2),X=Z[0],$=Z[1],ee=Object(f.useState)("Please wait..."),te=Object(S.a)(ee,2),ne=te[0],ae=te[1],oe=Object(f.useState)({show:!1,header:"Alert",message:""}),ie=Object(S.a)(oe,2),ce=ie[0],se=ie[1],le=Object(f.useState)(null),ue=Object(S.a)(le,2),de=ue[0],me=ue[1],pe=Object(f.useState)(!1),fe=Object(S.a)(pe,2),ve=fe[0],Ee=fe[1],he=Object(f.useState)(!1),ge=Object(S.a)(he,2),be=ge[0],ye=ge[1],Oe=Object(f.useState)(!1),Se=Object(S.a)(Oe,2),Ie=Se[0],Ce=Se[1],je=Ae(),Te=Object(f.useState)(void 0),De=Object(S.a)(Te,2),we=De[0],Me=De[1],Fe=Object(f.useState)(void 0),Le=Object(S.a)(Fe,2),Re=Le[0],Pe=Le[1];Object(y.W)((function(){Ce(!0)})),Object(y.X)((function(){Ce(!1)})),Object(f.useEffect)((function(){be!==n&&ye(n),Ue(we,Re)}),[n]),Object(f.useEffect)((function(){if(de&&i&&i.locations&&0!==i.locations.length&&de.ShowTimeClock){var e,t=tn.unique(de.PositionsToClockInto.map((function(e){return e.LocationId}))),n=tn.unique(de.PositionsToClockInto.map((function(e){return e.DepartmentId})));e=t.length>1?de.PositionsToClockInto.map((function(e){return{id:e.PositionId,name:e.PositionNameWithLocAndDeptAbbreviation}})):n.length>1?de.PositionsToClockInto.map((function(e){return{id:e.PositionId,name:e.PositionNameWithDeptAbbreviation}})):de.PositionsToClockInto.map((function(e){return{id:e.PositionId,name:e.PositionName}}));var a=E;0===a&&(de.UserClockedIn?(a=de.ClockedInScheduleEvent.PositionId,h(a)):de.ScheduleEventsForClockIn&&de.ScheduleEventsForClockIn.length>0?(a=de.ScheduleEventsForClockIn[0].PositionId,h(a)):e.length>0?(a=e[0].id,h(a)):a=0);var r=de.UserClockedIn?de.ClockedInScheduleEvent.LocationId:0!==a?i.locations.filter((function(e){return e.departments.flatMap((function(e){return e.positions.flatMap((function(e){return e.id===a}))}))}))[0].id:i.locations[0].id,o=i.locations.filter((function(e){return e.id===r}))[0].settings;W(o),o.EnableEnhancedBreakManagement&&(o.UnscheduledBreakOptions!==J.None||de.ClockedInScheduleEvent.EventBreaks&&de.ClockedInScheduleEvent.EventBreaks.length>0)?B(de.UserClockedIn&&de.CurrentEventBreak?"END BREAK":"START BREAK"):B("NONE"),u(e),Be(a)}}),[i,de,we,Re]),la((function(){Ue(we,Re)}),Ie,re(a).refreshTimeclockSettingsTimer);var Ue=function(e,t){ka.getTimeClockSettings(a,e,t).then((function(e){me(e)}))},Be=function(e){if(!de)return-1;var t=de.UserClockedIn?de.ClockedInScheduleEvent.LocationId:i.locations.filter((function(t){return t.departments.flatMap((function(t){return t.positions.flatMap((function(t){return t.id===e}))}))}))[0].id;if(!(i.locations.filter((function(e){return e.id===t}))[0].settings.ClockInWithDifferentTag&&de.TagsPerPosition[e]&&de.TagsPerPosition[e].length>1))return j(!1),-1;j(!0);var n=de.TagsPerPosition[e].map((function(e){return{id:e.TagId,name:e.TagName}}));n.unshift({id:-1,name:"NONE"}),N(n);var a=-1;return de.UserClockedIn?a=de.ClockedInScheduleEvent.TagId?de.ClockedInScheduleEvent.TagId:(de.ClockedInScheduleEvent.TagId,-1):de.TagsPerPosition[e]&&de.TagsPerPosition[e].length>0&&(a=de.ScheduleEventsForClockIn&&de.ScheduleEventsForClockIn[0]&&de.ScheduleEventsForClockIn[0].TagId?de.ScheduleEventsForClockIn[0].TagId:-1),F(a),a},Ve=function(e,t){se({show:!0,header:e,message:t})},qe=function(e){ve&&Ee(!1),ae("Clocking Out..."),$(!0),ka.clockOut(a,we,Re,e).then((function(e){$(!1),0===e.ClockOutResponseCode?(je.showToast("Clocked out at "+Object(xe.a)(Object(Ne.a)(e.ClockOutEvent.EventEnd),"h:mmaaa")),t(),Ue(we,Re)):Ve("Could not Clock Out","Unable to Clock out, ".concat(e.Message))}))};return i&&de?v.a.createElement(v.a.Fragment,null,v.a.createElement(y.k,{className:"clock-controls"},je.simpleToastJsx,v.a.createElement(y.s,{isOpen:X,onDidDismiss:function(){return $(!1)},spinner:"dots",message:ne}),ft.requiresGeolocation(i.locations)&&v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"12"},v.a.createElement(wa,{updateCallback:function(e,t){we!==e&&Me(e),Re!==t&&Pe(t),Ue(e,t)},isShowing:Ie}))),de.PositionsToClockInto&&de.PositionsToClockInto.length>1&&v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"3"},v.a.createElement(y.p,null,"Position")),v.a.createElement(y.g,{size:"9"},v.a.createElement(y.E,{className:"select",mode:"ios",interface:"action-sheet",onIonChange:function(e){var t;(t=e.detail.value)!==E&&t!==g.current&&(h(t),Be(t))},disabled:!((de.UserClockedIn&&de.UserMayClockOut||!de.UserClockedIn&&de.UserMayClockIn)&&z.ClockInRequirement!==o.MatchingShift),value:E},l.map((function(e){return v.a.createElement(y.F,{key:e.id,value:e.id},e.name)}))))),C&&v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"3"},v.a.createElement(y.p,null,"~Tag")),v.a.createElement(y.g,{size:"9"},v.a.createElement(y.E,{className:"select",mode:"ios",interface:"action-sheet",onIonChange:function(e){var t;(t=e.detail.value)!==M&&t!==L.current&&F(t)},disabled:!((de.UserClockedIn&&de.UserMayClockOut||!de.UserClockedIn&&de.UserMayClockIn)&&z.ClockInRequirement!==o.MatchingShift),value:M},D.map((function(e){return v.a.createElement(y.F,{key:e.id,value:e.id},e.name)}))))),(de.PositionsToClockInto&&de.PositionsToClockInto.length>1||C)&&v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"12",className:"ion-no-margin"},v.a.createElement(Ca,{tcData:de,locSettings:z,selectedPosId:E,selectedTagId:M,onSwitch:function(){ae("Switching..."),$(!0),ka.switchPositionOrTag(a,E,M,we,Re).then((function(e){$(!1),e.AllowedToSwitchPositions||e.AllowedToSwitchTags?(je.showToast("Switched"),t(),Ue(we,Re)):Ve("Could not switch","".concat(e.ClockInMessage," ").concat(e.ClockOutMessage))}))}}))),!de.UserClockedIn&&v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"12",className:"ion-no-margin"},v.a.createElement(y.d,{className:"clockin-button",onClick:function(){ae("Clocking in..."),$(!0),ka.clockIn(a,E,M,we,Re).then((function(e){$(!1),0===e.ClockInResponseCode?(je.showToast("Clocked in at "+Object(xe.a)(Object(Ne.a)(e.ClockInEvent.EventStart),"h:mmaaa")),t(),Ue(we,Re)):Ve("Could not Clock In","Unable to Clock in, ".concat(e.Message))}))},disabled:!de.UserMayClockIn},v.a.createElement(y.m,{mode:"md",icon:k.x})," CLOCK IN"))),de.UserClockedIn&&v.a.createElement(y.B,null,v.a.createElement(y.g,{className:"clockout-button-container"},v.a.createElement(y.d,{className:"clockout-button",disabled:!de.UserMayClockOut,expand:"block",onClick:function(){z.ClockOutValueLabel?Ee(!0):qe()}},v.a.createElement(y.m,{mode:"md",icon:k.x})," CLOCK OUT"),"NONE"!==U&&v.a.createElement(y.d,{onClick:function(){if("NONE"!==U&&de)return"END BREAK"===U?(ae("Ending Break..."),$(!0),void ka.endBreak(a,de.ClockedInScheduleEvent,de.ScheduleEventsForClockIn.length>0?de.ScheduleEventsForClockIn[0]:null,we,Re).then((function(e){$(!1),e.EndBreakResponseCode===d.Success?(je.showToast("Ended break at ".concat(Object(xe.a)(Object(Ne.a)(e.BreakEnd),"h:mmaaa"))),t(),Ue(we,Re)):Ve("Did not come off break",e.Message)}))):void(z.UnscheduledBreakOptions!==J.None||de.ClockedInScheduleEvent.EventBreaks&&de.ClockedInScheduleEvent.EventBreaks.length>0?K(!0):Ve("No implemented","Not implemented in ClockPanel.tsx for this scenario"))},expand:"block",className:"break-button",disabled:!de.UserMayClockOut},v.a.createElement(y.m,{icon:k.h}),U)))),v.a.createElement(y.w,{isOpen:H,cssClass:"mini-modal break-selector-modal"},v.a.createElement(va,{auth:i,tcData:de,onDismissModal:function(e){return n=e,void(de&&(K(!1),"Cancel"!==n.key&&(ae("Starting Break..."),$(!0),ka.startBreak(a,de.ClockedInScheduleEvent,de.ScheduleEventsForClockIn[0],n.breakType,we,Re,n.breakType===r.Scheduled?n.key:void 0).then((function(e){$(!1),e.StartBreakResponseCode===_.Success?(je.showToast("Break started at "+Object(xe.a)(Object(Ne.a)(e.BreakStart),"h:mmaaa")),t(),Ue(we,Re)):Ve("Could not start break","Unable to start break, ".concat(e.Message))})))));var n}})),v.a.createElement(y.w,{cssClass:"mini-modal clockout-modal",isOpen:ve,onDidDismiss:function(){Ee(!1)}},v.a.createElement(Ia,{onCancel:function(){Ee(!1)},onOk:qe,locSettings:z})),v.a.createElement(y.b,{isOpen:ce.show,onDidDismiss:function(){return se(Object(I.a)({},ce,{show:!1}))},header:ce.header,message:ce.message,buttons:["OK"]})):v.a.createElement("div",null,"Loading...")};var Ma=function(e){var t,n,a=e.startDate,r=e.endDate,o=e.onNextPayPeriod,i=e.onPrevPayPeriod,c=null===a||null===r?"":(n=r,(t=a)&&n?t.getMonth()!==n.getMonth()?Object(xe.a)(t,"MMM d").toUpperCase()+" - "+Object(xe.a)(Object(Re.a)(n,-1),"MMM d").toUpperCase():Object(xe.a)(t,"MMM d").toUpperCase()+" - "+Object(xe.a)(Object(Re.a)(n,-1),"d"):" ");return v.a.createElement("div",{className:"chooser"},v.a.createElement("div",{className:"top"},v.a.createElement("button",{onClick:i,className:"arrow",key:-1},v.a.createElement(y.m,{mode:"ios",icon:k.b})),v.a.createElement("div",{className:"month-year-container"},v.a.createElement("div",{className:"datetime-picker-container"},v.a.createElement("div",{className:"datetime-picker"},c))),v.a.createElement("button",{onClick:o,className:"arrow",key:7},v.a.createElement(y.m,{mode:"ios",icon:k.e}))))};function Fa(){return(Fa=Object(T.a)(j.a.mark((function e(t,n,a){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=et.formatDateTimeAsMvcString(a),e.next=3,me.get(t,"api/v2/payroll/get/"+n+"/"+r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var La={getPayPeriodDateForEmployee:function(e,t,n){return Fa.apply(this,arguments)}};var Ra=function(e){var t=e.time,n=e.locSettings,a=e.fontColor;if(null===t)return v.a.createElement("span",null," -- ");var r=0===t.ActualHours?"#ddd":a;return v.a.createElement("span",{style:{color:r}},function(e,t){return et.getTimeStringFromOrbitalTime(e,t)}(n,t))};var Pa=function(e){var t=e.onClose,n=e.data,a=e.locSettings,r=Object(f.useContext)(ht).auth;return n?v.a.createElement(v.a.Fragment,null,v.a.createElement(y.l,{mode:"ios"},v.a.createElement(y.Q,null,v.a.createElement(y.N,null,et.getDateString(Object(Ne.a)(n.date))),v.a.createElement(y.e,{slot:"end"},v.a.createElement(y.d,{onClick:t},v.a.createElement(y.m,{icon:k.n,mode:"ios",slot:"icon-only"}))))),v.a.createElement(y.h,null,v.a.createElement(y.k,null,n.regular.ActualHours>0&&v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"7"},"Regular"),v.a.createElement(y.g,{size:"5"},v.a.createElement(Ra,{time:n.regular,locSettings:a,fontColor:"black"}))),n.dailyOvertime.ActualHours>0&&v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"7"},"Daily Overtime"),v.a.createElement(y.g,{size:"5"},v.a.createElement(Ra,{time:n.dailyOvertime,locSettings:a,fontColor:"red"}))),n.weeklyOvertime.ActualHours>0&&v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"7"},"Weekly Overtime"),v.a.createElement(y.g,{size:"5"},v.a.createElement(Ra,{time:n.weeklyOvertime,locSettings:a,fontColor:"red"}))),n.special.ActualHours>0&&v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"7"},"Special Dates"),v.a.createElement(y.g,{size:"5"},v.a.createElement(Ra,{time:n.special,locSettings:a,fontColor:"black"}))),n.timePerAbsent&&n.timePerAbsent.map((function(e){return v.a.createElement(y.B,{key:e.absentId},v.a.createElement(y.g,{size:"7"},function(e,t){return e.payrollEvents.filter((function(e){return e.id===t}))[0].name}(r,e.absentId)),v.a.createElement(y.g,{size:"5"},v.a.createElement(Ra,{time:e.time,locSettings:a,fontColor:"#AD850C"})))}))))):v.a.createElement("div",null,"loading")};var Ua,Ba=function(e){var t,n=e.payrollRow,a=e.colsToDisplay,r=e.colSize,o=Object(f.useContext)(ht).auth,i=ft.getLocSettingsForLocationId(o,o.locations[0].id),c=Object(f.useState)(!1),s=Object(S.a)(c,2),l=s[0],u=s[1];return null===n?v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"3"},v.a.createElement(ca.a,{width:60})),v.a.createElement(y.g,{size:"3"},v.a.createElement(ca.a,{width:60})),v.a.createElement(y.g,{size:"3"},v.a.createElement(ca.a,{width:60})),v.a.createElement(y.g,{size:"3"},v.a.createElement(ca.a,{width:60}))):v.a.createElement(v.a.Fragment,null,v.a.createElement(y.B,null,v.a.createElement(y.g,{size:r},v.a.createElement("button",{className:"payperiod-list-buttons",onClick:function(){return u(!0)}},(t=n.date,Object(xe.a)(Object(Ne.a)(t),"EEE d")))),v.a.createElement(y.g,{size:r,color:"secondary",hidden:(a&Ua.Regular)!==Ua.Regular},v.a.createElement(Ra,{time:null===n||void 0===n?void 0:n.regular,locSettings:i,fontColor:"black"})),v.a.createElement(y.g,{size:r,hidden:(a&Ua.DailyOvertime)!==Ua.DailyOvertime},v.a.createElement(Ra,{time:null===n||void 0===n?void 0:n.dailyOvertime,locSettings:i,fontColor:"red"})),v.a.createElement(y.g,{size:r,hidden:(a&Ua.WeeklyOvertime)!==Ua.WeeklyOvertime},v.a.createElement(Ra,{time:null===n||void 0===n?void 0:n.weeklyOvertime,locSettings:i,fontColor:"red"})),v.a.createElement(y.g,{size:r,hidden:(a&Ua.Special)!==Ua.Special},v.a.createElement(Ra,{time:null===n||void 0===n?void 0:n.special,locSettings:i,fontColor:"black"})),v.a.createElement(y.g,{size:r,hidden:(a&Ua.Absent)!==Ua.Absent},v.a.createElement(Ra,{time:null===n||void 0===n?void 0:n.absent,locSettings:i,fontColor:"black"}))),v.a.createElement(y.w,{cssClass:"mini-modal detail-modal",isOpen:l,onDidDismiss:function(){return u(!1)}},v.a.createElement(Pa,{onClose:function(){return u(!1)},locSettings:i,data:n})))};!function(e){e[e.None=0]="None",e[e.Regular=1]="Regular",e[e.DailyOvertime=2]="DailyOvertime",e[e.WeeklyOvertime=4]="WeeklyOvertime",e[e.Special=8]="Special",e[e.Absent=16]="Absent",e[e.All=31]="All"}(Ua||(Ua={}));var Va=function(e){var t=e.payrollData,n=Object(f.useContext)(ht).auth,a=ft.getLocSettingsForLocationId(n,n.locations[0].id),r=Object(f.useState)(Ua.None),o=Object(S.a)(r,2),i=o[0],c=o[1],s=Object(f.useState)("3"),l=Object(S.a)(s,2),u=l[0],d=l[1];return Object(f.useEffect)((function(){if(t){var e=function(e){var t=Ua.Regular,n=2;return e.totalDailyOvertime.ActualHours>0&&(t|=Ua.DailyOvertime,n++),e.totalWeeklyOvertime.ActualHours>0&&(t|=Ua.WeeklyOvertime,n++),e.totalSpecial.ActualHours>0&&(t|=Ua.Special,n++),e.totalAbsent.ActualHours>0&&(t|=Ua.Absent,n++),{cols:t,count:n}}(t),n=e.count,a=e.cols;c(a),d(n>=5?"2":"3")}}),[t]),null===t?v.a.createElement("div",{className:"grid-container"},v.a.createElement(y.k,{class:"ion-text-end"},v.a.createElement(y.B,{className:"list-header",class:"ion-text-center"},v.a.createElement(y.g,{size:"3"},v.a.createElement(ca.a,{width:40})),v.a.createElement(y.g,{size:"3"},v.a.createElement(ca.a,{width:40})),v.a.createElement(y.g,{size:"3"},v.a.createElement(ca.a,{width:40})),v.a.createElement(y.g,{size:"3"},v.a.createElement(ca.a,{width:40}))),[1,2,3,4,5,6,7,8,9,10].map((function(e){return v.a.createElement(Ba,{payrollRow:null,colSize:"3",colsToDisplay:Ua.None,key:e})})))):v.a.createElement("div",{className:"grid-container"},v.a.createElement(y.k,{class:"ion-text-end"},v.a.createElement(y.B,{className:"list-header",class:"ion-text-center"},v.a.createElement(y.g,{size:u},"DATE"),v.a.createElement(y.g,{size:u,hidden:(i&Ua.Regular)!==Ua.Regular},"REG"),v.a.createElement(y.g,{size:u,hidden:(i&Ua.DailyOvertime)!==Ua.DailyOvertime},"DAILY OT"),v.a.createElement(y.g,{size:u,hidden:(i&Ua.WeeklyOvertime)!==Ua.WeeklyOvertime},"WKLY OT"),v.a.createElement(y.g,{size:u,hidden:(i&Ua.Special)!==Ua.Special},"SPECIAL"),v.a.createElement(y.g,{size:u,hidden:(i&Ua.Absent)!==Ua.Absent},"ABSENT")),null===t||void 0===t?void 0:t.list.map((function(e){return v.a.createElement(Ba,{key:e.date,payrollRow:e,colsToDisplay:i,colSize:u})})),v.a.createElement(y.B,{className:"list-footer"},v.a.createElement(y.g,{size:u},"TOTAL"),v.a.createElement(y.g,{size:u,hidden:(i&Ua.Regular)!==Ua.Regular},v.a.createElement(Ra,{time:null===t||void 0===t?void 0:t.totalRegular,locSettings:a,fontColor:"black"})),v.a.createElement(y.g,{size:u,hidden:(i&Ua.DailyOvertime)!==Ua.DailyOvertime},v.a.createElement(Ra,{time:null===t||void 0===t?void 0:t.totalDailyOvertime,locSettings:a,fontColor:"red"})),v.a.createElement(y.g,{size:u,hidden:(i&Ua.WeeklyOvertime)!==Ua.WeeklyOvertime},v.a.createElement(Ra,{time:null===t||void 0===t?void 0:t.totalWeeklyOvertime,locSettings:a,fontColor:"red"})),v.a.createElement(y.g,{size:u,hidden:(i&Ua.Special)!==Ua.Special},v.a.createElement(Ra,{time:null===t||void 0===t?void 0:t.totalSpecial,locSettings:a,fontColor:"black"})),v.a.createElement(y.g,{size:u,hidden:(i&Ua.Absent)!==Ua.Absent},v.a.createElement(Ra,{time:null===t||void 0===t?void 0:t.totalAbsent,locSettings:a,fontColor:"black"})))))},qa=function(e){var t=e.date,n=v.a.useContext(ke).user,a=v.a.useContext(ht).auth,r=Object(f.useState)(null),o=Object(S.a)(r,2),i=o[0],c=o[1],s=Object(f.useState)(null),l=Object(S.a)(s,2),u=l[0],d=l[1],m=Object(f.useState)(null),p=Object(S.a)(m,2),E=p[0],h=p[1],g=Object(f.useState)(null),b=Object(S.a)(g,2),O=b[0],k=b[1],I=Ce(),C=cn((function(e){j(e)}));function j(e){La.getPayPeriodDateForEmployee(n,a.locations[0].id,i).then((function(t){t.error?I.showAlert("Error","Could not retrieve Payroll data: "+t.message,(function(){})):(d(Object(Ne.a)(t.start)),h(Object(Ne.a)(t.end)),k(t),e&&e.detail.complete())}))}Object(f.useEffect)((function(){var e=t;null===t&&(e=new Date),c(e)}),[t]),Object(f.useEffect)((function(){null!=i&&j()}),[i]);return v.a.createElement(v.a.Fragment,null,v.a.createElement(Ma,{startDate:u,endDate:E,onNextPayPeriod:function(){c(Object(Re.a)(E,1))},onPrevPayPeriod:function(){c(Object(Re.a)(u,-1))}}),v.a.createElement(y.h,null,C.ionicRefresherJsx,a&&a.locations&&a.locations.length>0&&v.a.createElement(Va,{payrollData:O}),I.alertBoxJsx))};var za=function(e){var t=e.refreshToggle,n=e.onUpdate,a=Object(f.useState)([]),r=Object(S.a)(a,2),o=r[0],i=r[1],c=Object(f.useState)([]),s=Object(S.a)(c,2),l=s[0],u=s[1],d=Object(f.useState)([]),p=Object(S.a)(d,2),E=p[0],h=p[1],g=Ae(),b=cn((function(e){G(e)})),O=v.a.useContext(ke).user,k=Ce(),I=Object(f.useState)(!1),C=Object(S.a)(I,2),j=C[0],T=C[1],A=Object(f.useState)(null),D=Object(S.a)(A,2),N=D[0],w=D[1],x=Object(f.useState)(An),M=Object(S.a)(x,2),F=M[0],L=M[1],R=Object(f.useState)(!1),P=Object(S.a)(R,2),U=P[0],B=P[1],V=Object(f.useState)(!1),q=Object(S.a)(V,2),z=q[0],W=q[1],_=Object(f.useContext)(ht).auth;Object(y.W)((function(){W(!0)})),Object(y.X)((function(){W(!1)}));la((function(){G()}),z&&!j,re(O).refreshScheduleTimer);function G(e){try{var t=function(e){for(var t=ft.getPositionIdsForEmployee(e),n=[],a=0;a<t.length;a++){var r=ft.getLocationIdFromPositionid(e,t[a]);n.includes(r)||n.push(r)}var o=ft.getLocSettingsForLocationId(e,n[0]),i=et.getTodayStartForLocation(new Date,o),c=Object(De.a)(i,24);return{settingsLocId:n[0],positionIds:t,start:i,end:c,filterByEmployee:!0,dnLocIds:n,tagId:void 0,eventTypeId:m.All,eventStatusId:m.All,view:xt.clock}}(_);Mt.getScheduleEventsByFilter(O,t).then((function(t){B(!1),e&&e.detail.complete(),n(),i(t.events),u(t.dailyNotes),h(t.hoursPerDay)}))}catch(e){console.log("Error in ClockTodayTab.getData: "+e.message)}}Object(f.useEffect)((function(){O&&O.isLoggedin&&(B(!0),G(void 0))}),[t]);return v.a.createElement(v.a.Fragment,null,v.a.createElement(y.h,null,b.ionicRefresherJsx,U&&(l&&l.length>0||o&&o.length>0)&&v.a.createElement(y.G,{className:"center",name:"dots"}),U&&(0===l.length||0===o.length)&&v.a.createElement(v.a.Fragment,null,v.a.createElement("div",{style:{marginTop:"10px"}}),v.a.createElement(ca.a,{height:40,width:310}),v.a.createElement("br",null),v.a.createElement(sa,{threeRows:!1}),v.a.createElement(sa,{threeRows:!1})),!U&&v.a.createElement($t,{events:o,listType:"today",notes:l,hoursPerDay:E,auth:_,onEdit:function(e){w(e.ScheduleEventId),L(Dn(_,e)),T(!0)},onForceRefresh:function(e){e&&e.length>0&&g.showToast(e),G()},weekStart:new Date})),g.simpleToastJsx,v.a.createElement(y.w,{isOpen:j,onDidDismiss:function(){return T(!1)}},v.a.createElement(oa,{isOpen:j,auth:_,onCancelModal:function(){return T(!1)},onDismissModal:function(){return G(void 0),void T(!1)},scheduleEventId:N,initialEvent:F})),k.alertBoxJsx)},Wa=function(){var e=Object(f.useState)("today"),t=Object(S.a)(e,2),n=t[0],a=t[1],r=Object(f.useState)(!1),o=Object(S.a)(r,2),i=o[0],c=o[1],s=Object(f.useState)(!1),l=Object(S.a)(s,2),u=l[0],d=l[1];return v.a.createElement(y.x,null,v.a.createElement(y.l,{className:"ion-no-border"},v.a.createElement(y.Q,{mode:"md"},v.a.createElement(y.e,{slot:"start"},v.a.createElement(y.u,null)),v.a.createElement(y.N,{slot:"start"},"Clock"))),v.a.createElement(y.C,{mode:"md",onIonChange:function(e){return t=e.detail.value,void a(t);var t}},v.a.createElement(y.D,{mode:"md",value:"today"},"TODAY"),v.a.createElement(y.D,{mode:"md",value:"pay-periods"},"PAY PERIOD")),"today"===n&&v.a.createElement(za,{refreshToggle:i,onUpdate:function(){console.log("onTodayPanelUpdate"),d(!u)}}),"pay-periods"===n&&v.a.createElement(qa,{date:null}),v.a.createElement(y.j,null,"today"===n&&v.a.createElement(xa,{refreshToggle:u,onUpdate:function(){c(!i)}})))},_a=function(e){var t=e.message,n=e.onMessageClick;if(!t)return v.a.createElement("div",null);var a=t.isViewed?"normal":"bold";return v.a.createElement("button",{className:"message",onClick:n},v.a.createElement("div",{className:"top-line"},v.a.createElement("span",{className:"subject",style:{fontWeight:a}},t.isPinned&&v.a.createElement(y.m,{icon:k.g,style:{color:"gray"}}),t.subject),v.a.createElement("span",{className:"time"},et.messageDateString(t.deliveryDateTime)," ")),v.a.createElement("div",{className:"bottom-line"},t.previewLine))},Ga=function(e){var t=e.onDismissModal,n=e.onCancelModal,a=e.filterData,r=Object(f.useState)({msgTypeIds:a.msgTypes?a.msgTypes.map((function(e){return e.messageTypeId})):[],employeeId:-1}),o=Object(S.a)(r,2),i=o[0],c=o[1],s=Object(f.useState)(!1),l=Object(S.a)(s,2),u=l[0],d=l[1];return v.a.createElement(v.a.Fragment,null,v.a.createElement(y.l,{className:"ion-no-border"},v.a.createElement(y.Q,null,v.a.createElement(y.e,{slot:"start"},v.a.createElement(y.d,{onClick:function(){n()}},v.a.createElement(y.m,{icon:k.c,slot:"icon-only"}))),v.a.createElement(y.N,null,"Filter"),v.a.createElement(y.e,{slot:"end"},v.a.createElement(y.d,{onClick:function(){c({msgTypeIds:a.msgTypes.map((function(e){return e.messageTypeId})),employeeId:-1}),d(!1)}},"RESET")))),v.a.createElement(y.h,{class:"outer-content"},v.a.createElement(y.o,null,v.a.createElement(y.p,null,"From"),v.a.createElement(y.E,{mode:"ios",interface:"action-sheet",value:i.employeeId,onIonChange:function(e){c(Object(I.a)({},i,{employeeId:e.detail.value})),d(!0)}},v.a.createElement(y.F,{key:-1,value:-1},"EVERYONE"),a&&a.employees&&a.employees.map((function(e){return v.a.createElement(y.F,{key:e.employeeId,value:e.employeeId},e.name)})))),v.a.createElement(y.o,{lines:"none"},v.a.createElement(y.p,null,"Message Types")),a.msgTypes&&v.a.createElement(je,{list:a.msgTypes.map((function(e){return{id:e.messageTypeId,name:e.name,description:""}})),selected:a.msgTypes.filter((function(e){return i.msgTypeIds.includes(e.messageTypeId)})).map((function(e){return{id:e.messageTypeId,name:e.name,description:""}})),selectionChanged:function(e){c(Object(I.a)({},i,{msgTypeIds:e.map((function(e){return e.id}))})),d(!0)}})),v.a.createElement(y.j,null,v.a.createElement(y.d,{className:"apply-button",expand:"block",onClick:function(){t(i)},disabled:!u},"APPLY FILTER")))},Ya=new $;function Ja(){return(Ja=Object(T.a)(j.a.mark((function e(t,n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me.get(t,"api/v2/employee/messages/"+n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ha(){return(Ha=Object(T.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me.get(t,"api/v2/employee/messages");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ka(){return(Ka=Object(T.a)(j.a.mark((function e(t,n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me.get(t,"api/v1/employee/messages/"+n+"/readCount");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Qa(){return(Qa=Object(T.a)(j.a.mark((function e(t,n,a){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me.post(t,"api/v1/employee/messages/"+n+"/togglePin",{isPinned:a});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Za(){return(Za=Object(T.a)(j.a.mark((function e(t,n,a){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me.post(t,"api/v1/employee/messages/"+n+"/toggleView",{isViewed:a});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Xa(){return(Xa=Object(T.a)(j.a.mark((function e(t,n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me.del(t,"api/v1/employee/messages/"+n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $a(){return($a=Object(T.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isLoggedin){e.next=2;break}return e.abrupt("return",0);case 2:return e.next=4,me.get(t,"api/v2/employee/messages/unreadCount");case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function er(){return(er=Object(T.a)(j.a.mark((function e(t,n,a,r,o){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me.post(t,"api/v2/employee/messages/send",{locId:n,channel:a,empIds:r,text:o});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}[{id:1,typeName:"CoverRequestMessage",description:"Cover-Request"},{id:2,typeName:"CoverApprovedMessage",description:"Cover-Approved"},{id:3,typeName:"DirectCoverRequestMessage",description:"Direct Cover-Request"},{id:5,typeName:"ShiftRequestMessage",description:"Shift-Request"},{id:6,typeName:"ShiftRequestDeniedMessage",description:"Shift-Denied"},{id:10,typeName:"ShiftRequestReceivedMessage",description:"Shift-Request Received"},{id:20,typeName:"NoClockInAlertMessage",description:"No Clock In Alert"},{id:21,typeName:"NoClockOutAlertMessage",description:"No Clock Out Alert"},{id:22,typeName:"LateClockInMessage",description:"Late Clock In Alert"},{id:23,typeName:"EarlyClockOutAlertMessage",description:"Early Clock Out Alert"},{id:50,typeName:"ScheduleEventUpdatedMessage",description:"Schedule Event Updated"},{id:60,typeName:"PublishedScheduleUpdatedMessage",description:"Published Schedule Updated"},{id:80,typeName:"PasswordRecoveryMessage",description:"Password Recovery"},{id:81,typeName:"VerifyCellPhoneMessage",description:"Verify Cell Phone"},{id:82,typeName:"VerifyCellPhoneCompleteMessage",description:"Verify Cell Phone Completed"},{id:83,typeName:"VerifyEmailMessage",description:"Verify Email"},{id:100,typeName:"CustomMessage",description:"Custom Messages"},{id:101,typeName:"WeeklyScheduleForEmployeeMessage",description:"Employee Weekly Schedule"},{id:555,typeName:"WelcomeMessage",description:"Welcome"},{id:603,typeName:"UpdatePaymentInformationMessage",description:"Update Payment Information"},{id:700,typeName:"UpgradeSubscriptionMessage",description:"Upgrade Subscription (to Orbital)"},{id:701,typeName:"FailedSignupMessage",description:"Failed Signup"},{id:702,typeName:"GenericErrorMessage",description:"Error Message"},{id:704,typeName:"SignupMessage",description:"Signup Completed"},{id:705,typeName:"DatesOutOfSyncMessage",description:"Dates Out of Sync"},{id:708,typeName:"CancelSubscriptionMessage",description:"Canceled Subscription  "}].map((function(e){return Ya.add(""+e.id,e)}));var tr={getUserMessage:function(e,t){return Ja.apply(this,arguments)},getUserMessages:function(e){return Ha.apply(this,arguments)},getReadCount:function(e,t){return Ka.apply(this,arguments)},setIsPinned:function(e,t,n){return Qa.apply(this,arguments)},setIsViewed:function(e,t,n){return Za.apply(this,arguments)},deleteMessage:function(e,t){return Xa.apply(this,arguments)},getUnreadCount:function(e){return $a.apply(this,arguments)},sendMessage:function(e,t,n,a,r){return er.apply(this,arguments)}},nr=v.a.createContext({unreadMessagesCount:0,unreadMessageCountWhenViewed:0,refreshCount:function(){},messagesViewed:function(){},hasNewMessages:!1});function ar(e){localStorage.setItem("unreadMessageCountWhenViewed",e.toString())}var rr=function(e){var t=Object(f.useContext)(ke).user,n=Object(f.useState)({unreadMessagesCount:0,unreadMessageCountWhenViewed:0}),a=Object(S.a)(n,2),r=a[0],o=a[1];function i(){t.isLoggedin&&tr.getUnreadCount(t).then((function(e){var t=r.unreadMessageCountWhenViewed;(0===t&&(t=function(){var e=localStorage.getItem("unreadMessageCountWhenViewed");return null!==e?parseInt(e):0}()),e<t&&ar(t=e),e!==r.unreadMessagesCount||t!==r.unreadMessageCountWhenViewed)&&o({unreadMessageCountWhenViewed:t,unreadMessagesCount:e})}))}return Object(f.useEffect)((function(){t.isLoggedin&&i()}),[t.isLoggedin]),la((function(){i()}),!0,re(t).checkUnreadMessageCountTimer),v.a.createElement(nr.Provider,{value:{refreshCount:function(){i()},messagesViewed:function(){var e=r.unreadMessagesCount;e!==r.unreadMessageCountWhenViewed&&(o(Object(I.a)({},r,{unreadMessageCountWhenViewed:e})),ar(e))},unreadMessagesCount:r.unreadMessagesCount,unreadMessageCountWhenViewed:r.unreadMessageCountWhenViewed,hasNewMessages:r.unreadMessagesCount>r.unreadMessageCountWhenViewed}},e.children)},or=function(e){var t=e.message,n=e.onCloseModal,a=e.updateMessages,r=Ce(),o=Da(),i=v.a.useContext(ke).user,c=v.a.useContext(ht).auth,s=Object(f.useState)(null),l=Object(S.a)(s,2),u=l[0],d=l[1],m=Object(f.useState)(null),p=Object(S.a)(m,2),E=p[0],h=p[1],g=Object(f.useState)(null),b=Object(S.a)(g,2),O=b[0],I=b[1],C=Object(f.useState)(!1),j=Object(S.a)(C,2),T=j[0],A=j[1],D=Object(f.useContext)(nr).refreshCount;Object(f.useEffect)((function(){t&&(t.scheduleEventId?Mt.getScheduleEvent(i,t.scheduleEventId).then((function(e){e&&d(e)})):u&&(d(null),I(null)),tr.getReadCount(i,t.messageId).then((function(e){h(e)})),t.isViewed||tr.setIsViewed(i,t.messageId,!0).then((function(){a({type:"UPDATE-VIEWED",msgId:t.messageId,isViewed:!0})})),A(t.isPinned))}),[null===t||void 0===t?void 0:t.messageId]);var N=function(e){(null===t||void 0===t?void 0:t.isViewed)||D(),n(e)};return t&&c&&c.locations&&0!==c.locations.length?v.a.createElement(v.a.Fragment,null,v.a.createElement(y.l,{className:"ion-no-border"},v.a.createElement(y.Q,null,v.a.createElement(y.e,{slot:"start"},v.a.createElement(y.d,{onClick:function(){N(null)}},v.a.createElement(y.m,{icon:k.c,mode:"md",slot:"icon-only"}))),v.a.createElement(y.e,{slot:"end"},v.a.createElement(y.d,{onClick:function(){!function(){var e=!T;tr.setIsPinned(i,t.messageId,e).then((function(){A(e),a({type:"UPDATE-PINNED",msgId:t.messageId,isPinned:e})}))}()}},v.a.createElement(y.m,{icon:k.g,style:T?{color:"black"}:{color:"lightgray"}})),v.a.createElement(y.d,{onClick:function(){o.showDialog("Delete this message?",(function(){tr.deleteMessage(i,t.messageId).then((function(){a({type:"DELETE",msgId:t.messageId}),N("Message Deleted")}))}),(function(){}))}},v.a.createElement(y.m,{icon:k.z}))))),v.a.createElement(y.h,{class:"outer-contentMessage"},v.a.createElement(y.k,null,v.a.createElement(y.B,{class:"messageIonRow-header"},v.a.createElement(y.g,{class:"messageHeaderSubject",size:"12"},t.subject),v.a.createElement(y.g,{class:"messageHeaderDetails",size:"12"},"From: ",t.fromEmployeeFirstName," ",t.fromEmployeeLastName),v.a.createElement(y.g,{class:"messageHeaderDetails",size:"9"},et.getMessageDeliveryTimeString(t.deliveryDateTime)),v.a.createElement(y.g,{class:"readCounter",size:"3"},null!==E&&v.a.createElement("span",null,E," Read"))),v.a.createElement("div",null),v.a.createElement(y.B,{class:"messageIonRow-content"},v.a.createElement(y.g,{class:"messageBlock",size:"12"},v.a.createElement("div",{dangerouslySetInnerHTML:{__html:null===t||void 0===t?void 0:t.messageText}}))),null!==O&&v.a.createElement(y.B,null,v.a.createElement(y.g,{size:"12"},O))),r.alertBoxJsx,o.dialogJsx),v.a.createElement(y.j,null,null!==u&&v.a.createElement(aa,{auth:c,update:function(){},cancelEditModal:N,editorValues:Nn(c,u),messageId:t.messageId}))):v.a.createElement(v.a.Fragment,null,v.a.createElement("div",null,"Loading"),r.alertBoxJsx)};function ir(e,t){var n=ft.getLocationFromLocationId(e,t);if(null===n)throw new Error("Can't find location");return{location:n,department:null,position:null}}var cr=function(e){var t,n=e.currentPosition,a=e.onPositionUpdate,r=Object(f.useContext)(ht).auth,o=Object(f.useState)(n),i=Object(S.a)(o,2),c=i[0],s=i[1],l=function(e){if(void 0!==e){var t=function(e,t,n){if(null===n)return ir(e,t.location.id);var a=t.location.departments.filter((function(e){return e.id===n}))[0];return{location:t.location,department:a,position:null}}(r,c,e);s(t),a(t)}};return r&&r.locations&&0!==r.locations.length?v.a.createElement(v.a.Fragment,null,v.a.createElement(y.o,null,v.a.createElement(y.p,null,"Location"),v.a.createElement(y.E,{mode:"ios",interface:"action-sheet",value:c.location.id,onIonChange:function(e){return function(e){if(e){var t=ir(r,e);s(t),a(t)}}(e.detail.value)}},r.locations.filter((function(e){return function(e,t){return e.role===W.LocationAdmin||e.role===W.BusinessAdmin||e.role!==W.Employee&&void 0!==t.departments.find((function(e){return e.isDeptAdmin}))}(r,e)})).map((function(e){return v.a.createElement(y.F,{key:e.id,value:e.id},e.name)})))),v.a.createElement(y.o,null,v.a.createElement(y.p,null,"Department"),v.a.createElement(y.E,{mode:"ios",interface:"action-sheet",value:null===c.department?null:c.department.id,onIonChange:function(e){return l(e.detail.value)}},v.a.createElement(y.F,{key:-1,value:null},"All Departments"),c.location.departments&&c.location.departments.filter((function(e){return ft.isDeptAdmin(r,e.id)})).map((function(e){return v.a.createElement(y.F,{key:e.id,value:e.id},e.name)})))),v.a.createElement(y.o,null,v.a.createElement(y.p,null,"Position"),v.a.createElement(y.E,{mode:"ios",interface:"action-sheet",value:null===c.position?null:c.position.id,onIonChange:function(e){return function(e){if(void 0!==e){var t=function(e,t,n){if(null===n)return{location:t.location,department:t.department,position:null};var a=t.department.positions.filter((function(e){return e.id===n}))[0];return{location:t.location,department:t.department,position:a}}(0,c,e);s(t),a(t)}}(e.detail.value)}},v.a.createElement(y.F,{key:-1,value:null},"All Positions"),(t=c,null!==t.department?t.department.positions:t.location.departments.flatMap((function(e){return e.positions}))).map((function(e){return v.a.createElement(y.F,{key:e.id,value:e.id},null===c.department?ft.getDepartmentFromPositionId(r,e.id).abbr+"/"+e.name:e.name)}))))):v.a.createElement(v.a.Fragment,null,v.a.createElement("div",null,"Loading"))},sr=v.a.createElement(y.m,{icon:k.t}),lr=v.a.createElement(y.m,{icon:k.v}),ur=v.a.createElement(y.m,{icon:k.u});function dr(e,t){switch(t){case-1:return e.hasEmail||e.hasText||e.hasPush;case 1:return e.hasEmail;case 2:return e.hasText;case 3:return e.hasPush;default:return!1}}var mr=function(e){var t=e.onCancel,n=e.onOk,a=e.employeeList,r=e.selectedEmployeeList,o=e.channel,i=Object(f.useState)([]),c=Object(S.a)(i,2),s=c[0],l=c[1],u=Object(f.useState)(!1),d=Object(S.a)(u,2),m=d[0],p=d[1];return Object(f.useEffect)((function(){var e=a.map((function(e){return{id:e.id,name:e.name,hasEmail:e.hasEmail,hasText:e.hasText,hasPush:e.hasPush,isChecked:r.some((function(t){return t.id===e.id}))}}));l(e)}),[a,r]),v.a.createElement(v.a.Fragment,null,v.a.createElement(y.l,{mode:"ios"},v.a.createElement(y.Q,null,v.a.createElement(y.N,null,"Employees"),v.a.createElement(y.e,{slot:"end"},v.a.createElement(y.d,{onClick:t},v.a.createElement(y.m,{icon:k.n,mode:"ios",slot:"icon-only"}))))),v.a.createElement(y.h,null,v.a.createElement(y.k,null,v.a.createElement(y.B,{key:-1},v.a.createElement(y.g,{size:"3"},v.a.createElement(y.f,{className:"checkbox",checked:m,onClick:function(){var e=!m,t=s.map((function(t){return dr(t,o)?Object(I.a)({},t,{isChecked:e}):Object(I.a)({},t,{isChecked:!1})}));l(t),p(e)}})),v.a.createElement(y.g,{className:"label",size:"6"},"Select All"),v.a.createElement(y.g,{size:"1"},sr),v.a.createElement(y.g,{size:"1"},lr),v.a.createElement(y.g,{size:"1"},ur)),s.map((function(e){return v.a.createElement(y.B,{key:e.id},v.a.createElement(y.g,{size:"3"},v.a.createElement(y.f,{className:"checkbox",checked:e.isChecked,disabled:!dr(e,o),onClick:function(){!function(e){var t=0,n=s.map((function(n){return dr(n,o)?n.isChecked?n.id===e?Object(I.a)({},n,{isChecked:!1}):(t++,Object(I.a)({},n,{isChecked:dr(n,o)})):n.id===e?(t++,Object(I.a)({},n,{isChecked:dr(n,o)})):Object(I.a)({},n,{isChecked:!1}):Object(I.a)({},n,{isChecked:!1})})),r=a.filter((function(e){return dr(e,o)})).length;p(t===r),l(n)}(e.id)}})),v.a.createElement(y.g,{className:"label",size:"6"},e.name),v.a.createElement(y.g,{size:"1"},e.hasEmail&&sr),v.a.createElement(y.g,{size:"1"},e.hasText&&lr),v.a.createElement(y.g,{size:"1"},e.hasText&&ur))})))),v.a.createElement(y.j,null,v.a.createElement(y.d,{expand:"block",color:"secondary",onClick:function(){n(s.filter((function(e){return e.isChecked})))}},"OK")))},pr=[{id:-1,text:"All Channels"},{id:1,text:"Email"},{id:2,text:"Text"},{id:3,text:"Push Notification"}];var fr=function(e){var t=e.onUpdate,n=Object(f.useContext)(ke).user,a=Object(f.useContext)(ht).auth,r=Object(f.useState)("All"),o=Object(S.a)(r,2),i=o[0],c=o[1],s=Object(f.useState)(function(e){for(var t=0;t<e.locations.length;t++){var n=e.locations[t];if(n.adminAllDepts)return{location:n,department:null,position:null};for(var a=0;a<n.departments.length;a++){var r=n.departments[a];if(r.isDeptAdmin)return{location:n,department:r,position:null}}}throw new Error("Could not find a department where this user could send messages")}(a)),l=Object(S.a)(s,2),u=l[0],d=l[1],m=Object(f.useState)(-1),p=Object(S.a)(m,2),E=p[0],h=p[1],g=Object(f.useState)([]),b=Object(S.a)(g,2),O=b[0],k=b[1],I=Object(f.useState)([]),C=Object(S.a)(I,2),j=C[0],T=C[1],A=Object(f.useState)(!1),D=Object(S.a)(A,2),N=D[0],w=D[1],x=ot("Retreiving employee list");function M(e,t,a,r,o){x.setShowLoading(!0),rt.getEmployeeListForCommunication(n,e,t,a,r,o).then((function(e){T(e)})).finally((function(){x.setShowLoading(!1)}))}var F;return Object(f.useEffect)((function(){a.locations&&a.locations.length>0&&M(a.locations[0].id,-1,-1,0,"All")}),[a.locations]),a&&a.locations&&0!==a.locations.length?v.a.createElement(v.a.Fragment,null,v.a.createElement(y.o,null,v.a.createElement(y.p,null,"Role"),v.a.createElement(y.E,{mode:"ios",interface:"action-sheet",value:i,onIonChange:function(e){var t;(t=e.detail.value)!==i&&(c(t),k([]),M(u.location.id,null===u.department?-1:u.department.id,null===u.position?-1:u.position.id,E,t))}},v.a.createElement(y.F,{value:"All",key:-1},"All"),v.a.createElement(y.F,{value:W.BusinessAdmin,key:2},"Business Admin"),v.a.createElement(y.F,{value:W.LocationAdmin,key:3},"Location Admin"),v.a.createElement(y.F,{value:W.Admin,key:4},"Admin"),v.a.createElement(y.F,{value:W.Employee,key:5},"Employee"))),v.a.createElement(cr,{currentPosition:u,onPositionUpdate:function(e){d(e),k([]),M(e.location.id,null===e.department?-1:e.department.id,null===e.position?-1:e.position.id,E,i)}}),v.a.createElement(y.o,null,v.a.createElement(y.p,null,"Send To"),v.a.createElement(y.E,{mode:"ios",interface:"action-sheet",value:E,onIonChange:function(e){var t;null!==(t=e.detail.value)&&void 0!==t&&t!==E&&(k([]),h(t))}},pr.map((function(e){return v.a.createElement(y.F,{key:e.id,value:e.id},e.text)})))),v.a.createElement(y.o,null,v.a.createElement(y.p,null,"Employees (",j.filter((function(e){return dr(e,E)})).length," ","/ ",j.length,")"),v.a.createElement(y.d,{className:"button-selectEmployees-messages",onClick:function(){return w(!0)}},0===(F=O).length?"None Selected":1===F.length?F[0].name:"".concat(F.length," Selected"))),x.showLoadingJsx,v.a.createElement(y.w,{mode:"ios",cssClass:"mini-modal add-break-modal",onDidDismiss:function(){return w(!1)},isOpen:N},v.a.createElement(mr,{channel:E,onCancel:function(){w(!1)},onOk:function(e){k(e),w(!1),t(e,u.location.id,E)},employeeList:j,selectedEmployeeList:O}))):v.a.createElement(v.a.Fragment,null,v.a.createElement("div",null,"Loading"))},vr=function(e){var t=e.onCloseModal,n=e.isOpen,a=Object(f.useContext)(ke).user,r=Object(f.useContext)(ht).auth,o=Object(f.useState)(""),i=Object(S.a)(o,2),c=i[0],s=i[1],l=Object(f.useState)([]),u=Object(S.a)(l,2),d=u[0],m=u[1],p=Object(f.useState)(0),E=Object(S.a)(p,2),h=E[0],g=E[1],b=Object(f.useState)(0),O=Object(S.a)(b,2),I=O[0],C=O[1],j=ot("Sending"),T=Ce();return n&&r&&r.locations&&0!==r.locations.length?v.a.createElement(v.a.Fragment,null,v.a.createElement(y.l,{className:"ion-no-border"},v.a.createElement(y.Q,null,v.a.createElement(y.e,{slot:"start"},v.a.createElement(y.d,{onClick:function(){return t("")}},v.a.createElement(y.m,{icon:k.c,slot:"icon-only"}))),v.a.createElement(y.N,null,"New Message"))),v.a.createElement(y.h,{class:"edit-daily-modal-content"},v.a.createElement(y.r,null,v.a.createElement(fr,{onUpdate:function(e,t,n){m(e.map((function(e){return e.id}))),t!==h&&g(t),n!==I&&C(n)}}),v.a.createElement(y.o,{lines:"none"},v.a.createElement(y.M,{value:c,placeholder:"Enter message",spellcheck:!0,wrap:"hard",autoGrow:!0,debounce:250,onIonChange:function(e){var t;null!==(t=e.detail.value)&&void 0!==t&&t!==c&&s(t)}}))),j.showLoadingJsx),v.a.createElement(y.j,null,v.a.createElement(y.d,{className:"apply-button",expand:"block",onClick:function(){j.setShowLoading(!0),tr.sendMessage(a,h,I,d,c).then((function(e){j.setShowLoading(!1),e.error?T.showAlert("Could not send","Could not send message. "+e.message,(function(){})):1===d.length?t("Message sent"):t("Messages sent")}))},disabled:0===d.length||0===c.length||j.showLoading},"Send"))):v.a.createElement("div",null,"Loading")},Er=[],hr=function(e,t){switch(t.type){case"LOADED-FROM-API":return t.data;case"CLEAR":return[];case"UPDATE-PINNED":return e.map((function(e){return e.messageId===t.msgId?Object(I.a)({},e,{isPinned:t.isPinned}):e}));case"UPDATE-VIEWED":return e.map((function(e){return e.messageId===t.msgId?Object(I.a)({},e,{isViewed:t.isViewed}):e}));case"DELETE":return e.filter((function(e){return e.messageId!==t.msgId}))}},gr=function(e){var t=e.match,n=e.history,a=v.a.useContext(ke).user,r=v.a.useContext(ht),o=r.auth,i=r.refreshAuth,c=v.a.useContext(nr),s=c.unreadMessagesCount,l=c.messagesViewed;Object(y.U)((function(){l()}),[l]),Object(y.V)((function(){l()}),[l]),Object(f.useEffect)((function(){o&&o.locations&&0!==o.locations.length||i(!1,a)}),[o]);var u=cn((function(e){K(e)})),d=Object(f.useState)(!1),m=Object(S.a)(d,2),p=m[0],E=m[1],h=Object(f.useState)(!0),g=Object(S.a)(h,2),b=g[0],O=g[1],I=Object(f.useReducer)(hr,[]),C=Object(S.a)(I,2),j=C[0],T=C[1],A=Object(f.useState)(Er),D=Object(S.a)(A,2),N=D[0],w=D[1],x=Object(f.useState)({}),M=Object(S.a)(x,2),F=M[0],L=M[1],R=Object(f.useState)({}),P=Object(S.a)(R,2),U=P[0],B=P[1],V=Object(f.useState)(null),q=Object(S.a)(V,2),z=q[0],W=q[1],_=Ae(),G=Object(f.useState)(!1),Y=Object(S.a)(G,2),J=Y[0],H=Y[1];Object(f.useEffect)((function(){if(a&&a.isLoggedin&&o&&o.locations&&o.locations.length>0)return K(void 0)}),[a.isLoggedin,s,o]),Object(f.useEffect)((function(){Q(U,j)}),[j]),Object(f.useEffect)((function(){t.params.messageId&&null===z&&tr.getUserMessage(a,parseInt(t.params.messageId)).then((function(e){e||(_.showToast("The requested message has been removed"),n.push("/tabs/messages/")),W(e)}))}),[t.params.messageId]);var K=function(e){var t=!0;return 0===j.length&&!1===b&&O(!0),tr.getUserMessages(a).then((function(n){t&&(T({type:"LOADED-FROM-API",data:n}),Q(U,n),O(!1),e&&e.detail.complete())})),function(){t=!1}},Q=function(e,t){e&&e.msgTypeIds?-1!==e.employeeId?e.msgTypeIds.length>0?w(t.filter((function(t){return t.fromEmployeeId===e.employeeId&&tn.contains(e.msgTypeIds,t.messageTypeId)}))):w(t.filter((function(t){return t.fromEmployeeId===e.employeeId}))):e.msgTypeIds.length>0?w(t.filter((function(t){return tn.contains(e.msgTypeIds,t.messageTypeId)}))):w(t):w(t)};return v.a.createElement(y.x,null,v.a.createElement(y.l,{className:"ion-no-border"},v.a.createElement(y.Q,{mode:"md"},v.a.createElement(y.e,{slot:"start"},v.a.createElement(y.u,null)),v.a.createElement(y.N,{slot:"start"},"Messages"),v.a.createElement(y.e,{slot:"end"},v.a.createElement(y.d,{hidden:void 0===o.locations.find((function(e){return e.departments.find((function(e){return ft.isDeptAdmin(o,e.id)}))})),onClick:function(){H(!0)}},v.a.createElement(y.m,{icon:k.a,mode:"md",slot:"icon-only"})),v.a.createElement(y.d,{onClick:function(){var e=tn.uniqueObject(j.map((function(e){return{employeeId:e.fromEmployeeId,name:e.fromEmployeeFirstName+" "+e.fromEmployeeLastName}})),(function(e,t){return e.employeeId===t.employeeId})),t=tn.uniqueObject(j.map((function(e){return{messageTypeId:e.messageTypeId,name:Ya.item(String(e.messageTypeId)).description}})),(function(e,t){return e.messageTypeId===t.messageTypeId}));L({msgTypes:t,employees:e}),E(!0)}},v.a.createElement(y.m,{icon:k.p,mode:"ios",slot:"icon-only"}))))),v.a.createElement(y.h,{className:"outer-content"},u.ionicRefresherJsx,b&&v.a.createElement(v.a.Fragment,null,[1,2,3,4,5,6].map((function(e){return v.a.createElement("div",{key:e,style:{margin:"10px 8px"}},v.a.createElement(ca.a,{width:300,height:40}))}))),!b&&0===N.length&&v.a.createElement("div",{className:"no-messagesOrEvents-text"},"No Messages"),v.a.createElement("div",{className:"message-list"},!b&&N.length>0&&N.filter((function(e){return e.isPinned})).map((function(e){return v.a.createElement(_a,{key:e.messageId,message:e,onMessageClick:function(){return W(e)}})}))),v.a.createElement("div",{className:"message-list"},!b&&N.length>0&&N.filter((function(e){return!e.isPinned})).map((function(e){return v.a.createElement(_a,{key:e.messageId,message:e,onMessageClick:function(){return W(e)}})})))),v.a.createElement(y.w,{isOpen:p},v.a.createElement(Ga,{filterData:F,onDismissModal:function(e){B(e),Q(e,j),E(!1)},onCancelModal:function(){return E(!1)}})),v.a.createElement(y.w,{isOpen:null!==z},v.a.createElement(or,{message:z,updateMessages:T,onCloseModal:function(e){W(null),e&&_.showToast(e)}})),v.a.createElement(y.w,{isOpen:J},v.a.createElement(vr,{onCloseModal:function(e){H(!1),null!==e&&e.length>0&&_.showToast(e),setTimeout((function(){K()}),4e3)},isOpen:J})),_.simpleToastJsx)},br=function(){var e=Object(f.useContext)(nr),t=e.unreadMessagesCount,n=e.hasNewMessages;return v.a.createElement(v.a.Fragment,null,v.a.createElement("div",{className:n?"hasMessages":"noMessages"},t),v.a.createElement(y.m,{icon:k.l}),v.a.createElement(y.p,null,"Messages"))},yr=function(){var e=Object(f.useContext)(ht).auth;return v.a.createElement(y.K,null,v.a.createElement(y.A,null,v.a.createElement(g.b,{exact:!0,path:"/tabs",to:"/tabs/schedule"}),v.a.createElement(g.c,{path:"/tabs/schedule/:scheduleEventId",render:function(e){return v.a.createElement(fa,e)}}),v.a.createElement(g.c,{path:"/tabs/schedule",render:function(e){return v.a.createElement(fa,e)},exact:!0}),v.a.createElement(g.c,{path:"/tabs/messages/:messageId",render:function(e){return v.a.createElement(gr,e)}}),v.a.createElement(g.c,{path:"/tabs/messages",render:function(e){return v.a.createElement(gr,e)},exact:!0}),v.a.createElement(g.c,{path:"/tabs/clock",render:function(){return v.a.createElement(Wa,null)},exact:!0})),v.a.createElement(y.I,{slot:"bottom"},v.a.createElement(y.J,{key:"1",tab:"schedule",href:"/tabs/schedule"},v.a.createElement(y.m,{icon:k.j}),v.a.createElement(y.p,null,"Schedule")),v.a.createElement(y.J,{hidden:!e.timeClock,key:"2",tab:"clock",href:"/tabs/clock"},v.a.createElement(y.m,{icon:k.y}),v.a.createElement(y.p,null,"Clock")),v.a.createElement(y.J,{key:"3",tab:"map",href:"/tabs/messages"},v.a.createElement(br,null))))},Or=function(){var e=v.a.useContext(ke).user;return e.loading?v.a.createElement("div",null):e.isLoggedin?v.a.createElement(yr,null):v.a.createElement(g.b,{to:"/login"})},Sr=function(e){var t=e.history,n=v.a.useContext(ke),a=n.user,r=n.logout,o=v.a.useContext(ht).clearAuth;return Object(y.U)((function(){Promise.all([o(),r()]).then((function(){localStorage.clear(),ce("logout",{user:a.username}),console.log("logged out (".concat(a.username,")")),setTimeout((function(){t.push("/login",{direction:"none"}),t.goForward()}),250)}))})),v.a.createElement(y.x,{id:"logout-page"},v.a.createElement(y.h,{className:"login-content"},v.a.createElement("div",{className:"login-logo"},v.a.createElement("img",{className:"logo",src:"assets/img/OS Logo - 4pt Rounded _ 2 Tone Orange.svg",alt:"Orbital Shift Logo"})),v.a.createElement(y.r,{className:"form-list"},v.a.createElement("div",{className:"item"},v.a.createElement("div",{className:"label"},"User")))))},kr=n(74),Ir=function(){return v.a.createElement(v.a.Fragment,null,v.a.createElement(y.h,{id:"splash"},v.a.createElement("div",{className:"login-logo"},v.a.createElement("img",{className:"logo",src:"assets/img/OS Logo - 4pt Rounded _ 2 Tone Orange.svg",alt:"Orbital Shift Logo"})),v.a.createElement(y.s,{isOpen:!0,spinner:"dots",message:"Loading...",showBackdrop:!1,duration:0}),v.a.createElement("footer",null,oe.settings.appVersionString," (",oe.settings.buildDate,")")))},Cr=function(){var e,t=Object(f.useContext)(ke).user,n=Object(f.useContext)(ht),a=n.auth,r=n.refreshAuth;return Object(f.useEffect)((function(){oe.settings.hasCapacitor&&kr.a.lock(kr.a.ORIENTATIONS.PORTRAIT).then((function(){console.log("screen locked to portrait")})),console.log("firebase initialized"),P.initializeApp(ie),ce("app_render",{vers:oe.settings.appVersionString,platform:oe.settings.platform})}),[]),Object(f.useEffect)((function(){t.isLoggedin&&!ft.isAuthItemsValid(a)&&r(!1,t)}),[t.isLoggedin,a,r,t]),e=t.isLoggedin?t.isLoggedin&&ft.isAuthItemsValid(a)?v.a.createElement(v.a.Fragment,null,v.a.createElement(g.c,{path:"/tabs",render:function(e){return v.a.createElement(Or,e)}}),v.a.createElement(g.c,{path:"/",exact:!0},v.a.createElement(g.b,{to:"/tabs/schedule"}))):v.a.createElement(Ir,null):v.a.createElement(v.a.Fragment,null,v.a.createElement(g.c,{path:"/tabs",render:function(e){return v.a.createElement(Or,e)}}),v.a.createElement(g.c,{path:"/",exact:!0},v.a.createElement(g.b,{to:"/tabs/schedule"}))),v.a.createElement(y.c,null,v.a.createElement(O.a,null,v.a.createElement(O.a,null,v.a.createElement(y.H,{contentId:"main"},v.a.createElement(ct,null),v.a.createElement(y.A,{id:"main"},v.a.createElement(g.c,{path:"/login",render:function(e){return v.a.createElement(St,e)}}),v.a.createElement(g.c,{path:"/logout",render:function(e){return v.a.createElement(Sr,e)}}),e)))))},jr=function(){return v.a.createElement(b.a,null,v.a.createElement(Ie,null,v.a.createElement(yt,null,v.a.createElement(rr,null,v.a.createElement(Cr,null)))))};h.a.render(v.a.createElement(jr,null),document.getElementById("root"))},9:function(e,t,n){}},[[104,7,51]]]);
//# sourceMappingURL=main.ed8ecc66.chunk.js.map