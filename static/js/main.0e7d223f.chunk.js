(this["webpackJsonpcom.orbitalshift.app"]=this["webpackJsonpcom.orbitalshift.app"]||[]).push([[6],{100:function(e,t,n){e.exports=n(128)},106:function(e,t,n){var a={"./ion-action-sheet-ios.entry.js":[131,67],"./ion-action-sheet-md.entry.js":[132,68],"./ion-alert-ios.entry.js":[133,59],"./ion-alert-md.entry.js":[134,60],"./ion-app_8-ios.entry.js":[135,53],"./ion-app_8-md.entry.js":[136,54],"./ion-avatar_3-ios.entry.js":[137,8],"./ion-avatar_3-md.entry.js":[138,9],"./ion-back-button-ios.entry.js":[139,10],"./ion-back-button-md.entry.js":[140,11],"./ion-backdrop-ios.entry.js":[141,12],"./ion-backdrop-md.entry.js":[142,13],"./ion-button_2-ios.entry.js":[143,69],"./ion-button_2-md.entry.js":[144,70],"./ion-card_5-ios.entry.js":[145,14],"./ion-card_5-md.entry.js":[146,15],"./ion-checkbox-ios.entry.js":[147,16],"./ion-checkbox-md.entry.js":[148,17],"./ion-chip-ios.entry.js":[149,18],"./ion-chip-md.entry.js":[150,19],"./ion-col_3.entry.js":[151,20],"./ion-datetime_3-ios.entry.js":[152,57],"./ion-datetime_3-md.entry.js":[153,58],"./ion-fab_3-ios.entry.js":[154,21],"./ion-fab_3-md.entry.js":[155,22],"./ion-img.entry.js":[156,23],"./ion-infinite-scroll_2-ios.entry.js":[157,24],"./ion-infinite-scroll_2-md.entry.js":[158,25],"./ion-input-ios.entry.js":[159,26],"./ion-input-md.entry.js":[160,27],"./ion-item-option_3-ios.entry.js":[161,71],"./ion-item-option_3-md.entry.js":[162,72],"./ion-item_8-ios.entry.js":[163,73],"./ion-item_8-md.entry.js":[164,74],"./ion-loading-ios.entry.js":[165,28],"./ion-loading-md.entry.js":[166,29],"./ion-menu_3-ios.entry.js":[167,75],"./ion-menu_3-md.entry.js":[168,76],"./ion-modal-ios.entry.js":[169,55],"./ion-modal-md.entry.js":[170,56],"./ion-nav_2.entry.js":[171,66],"./ion-popover-ios.entry.js":[172,30],"./ion-popover-md.entry.js":[173,31],"./ion-progress-bar-ios.entry.js":[174,32],"./ion-progress-bar-md.entry.js":[175,33],"./ion-radio_2-ios.entry.js":[176,34],"./ion-radio_2-md.entry.js":[177,35],"./ion-range-ios.entry.js":[178,77],"./ion-range-md.entry.js":[179,78],"./ion-refresher_2-ios.entry.js":[180,61],"./ion-refresher_2-md.entry.js":[181,62],"./ion-reorder_2-ios.entry.js":[182,36],"./ion-reorder_2-md.entry.js":[183,37],"./ion-ripple-effect.entry.js":[184,38],"./ion-route_4.entry.js":[185,79],"./ion-searchbar-ios.entry.js":[186,80],"./ion-searchbar-md.entry.js":[187,81],"./ion-segment_2-ios.entry.js":[188,82],"./ion-segment_2-md.entry.js":[189,83],"./ion-select_3-ios.entry.js":[190,84],"./ion-select_3-md.entry.js":[191,85],"./ion-slide_2-ios.entry.js":[192,86],"./ion-slide_2-md.entry.js":[193,87],"./ion-spinner.entry.js":[194,39],"./ion-split-pane-ios.entry.js":[195,40],"./ion-split-pane-md.entry.js":[196,41],"./ion-tab-bar_2-ios.entry.js":[197,42],"./ion-tab-bar_2-md.entry.js":[198,43],"./ion-tab_2.entry.js":[199,44],"./ion-text.entry.js":[200,45],"./ion-textarea-ios.entry.js":[201,46],"./ion-textarea-md.entry.js":[202,47],"./ion-toast-ios.entry.js":[203,63],"./ion-toast-md.entry.js":[204,64],"./ion-toggle-ios.entry.js":[205,48],"./ion-toggle-md.entry.js":[206,49],"./ion-virtual-scroll.entry.js":[207,50]};function r(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],r=t[0];return n.e(t[1]).then((function(){return n(r)}))}r.keys=function(){return Object.keys(a)},r.id=106,e.exports=r},108:function(e,t,n){var a={"./ion-icon.entry.js":[211,90]};function r(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],r=t[0];return n.e(t[1]).then((function(){return n(r)}))}r.keys=function(){return Object.keys(a)},r.id=108,e.exports=r},126:function(e,t,n){},128:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(52),c=n.n(o),i=n(16),l=n(56),s=n(1),u=n(68),d=n(2),m=n(7),p=(n(9),n(6)),f=n(3),E=n.n(f),v=n(5),h=n(98),g=function(){return Object(h.a)("osKeyStore",1,{upgrade:function(e){e.createObjectStore("userStore"),e.createObjectStore("authItems")}})},b=function(){var e=Object(v.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g();case 2:return n=e.sent,e.next=5,n.put("userStore",t,"user");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(v.a)(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g();case 2:return t=e.sent,e.next=5,t.get("userStore","user");case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=function(){var e=Object(v.a)(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g();case 2:return t=e.sent,e.next=5,t.get("userStore","user").then((function(e){return e?e.access_token:void 0}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=Object(v.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g();case 2:return n=e.sent,e.next=5,n.put("authItems",t,"authItems");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=Object(v.a)(E.a.mark((function e(){var t,n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g();case 2:return t=e.sent,e.next=5,t.get("authItems","authItems");case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j={getKeyStore:g,putUserState:b,getUserState:y,getAccessToken:O,putAuthItems:k,getAuthItems:C},I=n(36),S=n(70),T=(n(129),{apiKey:"AIzaSyAS526InuG-53VGKi5SA780Mh0YwHkhMDE",authDomain:"orbital-shift-team-dashboard.firebaseapp.com",databaseURL:"https://orbital-shift-team-dashboard.firebaseio.com",projectId:"orbital-shift-team-dashboard",storageBucket:"orbital-shift-team-dashboard.appspot.com",messagingSenderId:"475985033328",appId:"1:475985033328:web:77740655a89e28de035cb5",measurementId:"G-TGE8788D28"});function N(e,t){S.analytics().logEvent(e,t)}var D=n(12),x=n(13),A=function(){function e(){Object(D.a)(this,e),this.items={},this._count=0}return Object(x.a)(e,[{key:"containsKey",value:function(e){return this.items.hasOwnProperty(e)}},{key:"count",value:function(){return this._count}},{key:"add",value:function(e,t){this.items.hasOwnProperty(e)||this._count++,this.items[e]=t}},{key:"remove",value:function(e){var t=this.items[e];return delete this.items[e],this._count--,t}},{key:"item",value:function(e){return this.items[e]}},{key:"keys",value:function(){var e=[];for(var t in this.items)this.items.hasOwnProperty(t)&&e.push(t);return e}},{key:"values",value:function(){var e=[];for(var t in this.items)this.items.hasOwnProperty(t)&&e.push(this.items[t]);return e}}]),e}(),w={constants:{checkUnreadMessageCountTimer:3e4,refreshAuthItemsTimer:3e5},key:"prod",name:"",url:""},P=[Object(p.a)({},w,{key:"prod",name:"Production",url:"https://api.orbitalshift.com/"}),Object(p.a)({},w,{key:"sbx",name:"Sandbox",url:"https://sandboxapi.orbitalshift.com/"}),Object(p.a)({},w,{key:"loc",name:"Local",url:"http://localhost:54825/"}),Object(p.a)({},w,{key:"emu",name:"Local (Emu)",url:"http://10.0.2.2:54825/"}),Object(p.a)({},w,{key:"tst",name:"TestServer",url:"http://TestServer:8000/"})],M=new A;P.map((function(e){return M.add(e.key,e)}));var R,U={env:M,versionName:"2.0.0",versionCode:"6119",revisionHash:"73db719",buildDate:"Sat 05/02/2020 3:09P",appVersionString:"2.0.0.6119 (73db719)",hasCapacitor:Object(s.U)("capacitor"),platform:Object(s.U)("ios")?"ios":Object(s.U)("android")?"android":"other"},L=function(e){return e.isLoggedin?U.env.item(e.environment).constants:w.constants},F={settings:U,getApiUrl:function(e,t){return U.env.item(e.environment).url+t},getUserAndEnvironmentFromInput:function(e){if(e.length<4)return{username:e,env:U.env.item("prod")};var t=e.toLowerCase().substring(0,4),n=e.substring(4);switch(t){case"sbx ":return{username:n,env:U.env.item("sbx")};case"loc ":return{username:n,env:U.env.item("loc")};case"emu ":return{username:n,env:U.env.item("emu")};case"tst ":return{username:n,env:U.env.item("tst")};default:return{username:e,env:U.env.item("prod")}}}},B=function(){var e=Object(v.a)(E.a.mark((function e(t,n,a){var r,o,c,i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=F.getApiUrl(t,n),console.log("API: "+n),e.prev=2,e.next=5,fetch(r,{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.access_token),AppVersion:F.settings.appVersionString}});case 5:if(o=e.sent,!(c=o.headers.get("content-type"))||-1===c.indexOf("application/json")){e.next=13;break}return e.next=10,o.json();case 10:return i=e.sent,N("api_succeeded",{method:"POST",baseUrl:n,username:t.username}),e.abrupt("return",i);case 13:N("api_succeeded",{method:"POST",baseUrl:n,username:t.username}),e.next=21;break;case 16:throw e.prev=16,e.t0=e.catch(2),N("api_err",Object(p.a)({method:"POST",baseUrl:n,username:null===t||void 0===t?void 0:t.username},a,{appVersion:F.settings.appVersionString})),console.error("Error calling post against url, "+n+": "+e.t0),e.t0;case 21:case"end":return e.stop()}}),e,null,[[2,16]])})));return function(t,n,a){return e.apply(this,arguments)}}(),z=function(){var e=Object(v.a)(E.a.mark((function e(t,n,a){var r,o,c,i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=F.getApiUrl(t,n),console.log("API: "+n),e.prev=2,o=JSON.stringify(a),e.next=6,fetch(r,{method:"PUT",body:o,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.access_token),AppVersion:F.settings.appVersionString}});case 6:return c=e.sent,e.next=9,c.json();case 9:return i=e.sent,N("api_succeeded",{method:"PUT",baseUrl:n,username:t.username}),e.abrupt("return",i);case 14:throw e.prev=14,e.t0=e.catch(2),N("api_err",Object(p.a)({method:"PUT",baseUrl:n,username:null===t||void 0===t?void 0:t.username},a,{appVersion:F.settings.appVersionString})),console.error("Error calling putData against url, "+n+": "+e.t0),e.t0;case 19:case"end":return e.stop()}}),e,null,[[2,14]])})));return function(t,n,a){return e.apply(this,arguments)}}(),V={get:function(){var e=Object(v.a)(E.a.mark((function e(t,n,a){var r,o,c,i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=F.getApiUrl(t,n),console.log("API: "+n),e.prev=2,o={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.access_token),AppVersion:F.settings.appVersionString},body:null},a&&(o.body=JSON.stringify(a)),e.next=7,fetch(r,o);case 7:return c=e.sent,e.next=10,c.json();case 10:return i=e.sent,N("api_succeeded",{method:"GET",baseUrl:n,username:t.username}),e.abrupt("return",i);case 15:throw e.prev=15,e.t0=e.catch(2),N("api_err",{method:"GET",baseUrl:n,username:null===t||void 0===t?void 0:t.username,appVersion:F.settings.appVersionString}),console.error("Error calling get against url, "+n+": "+e.t0),e.t0;case 20:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(t,n,a){return e.apply(this,arguments)}}(),post:B,put:function(){var e=Object(v.a)(E.a.mark((function e(t,n,a){var r,o,c,i,l;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=F.getApiUrl(t,n),console.log("API: "+n),o={method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.access_token),AppVersion:F.settings.appVersionString}},a&&(o.body=JSON.stringify(a)),e.prev=4,e.next=7,fetch(r,o);case 7:if(c=e.sent,!(i=c.headers.get("content-type"))||-1===i.indexOf("application/json")){e.next=15;break}return e.next=12,c.json();case 12:return l=e.sent,N("api_succeeded",{method:"PUT",baseUrl:n,username:t.username}),e.abrupt("return",l);case 15:N("api_succeeded",{method:"PUT",baseUrl:n,username:t.username}),e.next=23;break;case 18:throw e.prev=18,e.t0=e.catch(4),N("api_err",Object(p.a)({method:"PUT",baseUrl:n,username:null===t||void 0===t?void 0:t.username},a,{appVersion:F.settings.appVersionString})),console.error("Error calling put against url, "+n+": "+e.t0),e.t0;case 23:case"end":return e.stop()}}),e,null,[[4,18]])})));return function(t,n,a){return e.apply(this,arguments)}}(),putData:z,del:function(){var e=Object(v.a)(E.a.mark((function e(t,n,a){var r,o,c,i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=F.getApiUrl(t,n),console.log("API: "+n),o={method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.access_token),AppVersion:F.settings.appVersionString}},a&&(o.body=JSON.stringify(a)),e.prev=4,e.next=7,fetch(r,o);case 7:if(c=e.sent,!(i=c.headers.get("content-type"))||-1===i.indexOf("application/json")){e.next=14;break}return N("api_succeeded",{method:"DELETE",baseUrl:n,username:t.username}),e.next=13,c.json();case 13:return e.abrupt("return",e.sent);case 14:return N("api_succeeded",{method:"DELETE",baseUrl:n,username:t.username}),e.abrupt("return");case 18:throw e.prev=18,e.t0=e.catch(4),N("api_err",Object(p.a)({method:"DELETE",baseUrl:n,username:null===t||void 0===t?void 0:t.username},a,{appVersion:F.settings.appVersionString})),console.error("Error calling delete against url, "+n+": "+e.t0),e.t0;case 23:case"end":return e.stop()}}),e,null,[[4,18]])})));return function(t,n,a){return e.apply(this,arguments)}}()};!function(e){e[e.iOS=1]="iOS",e[e.Android=2]="Android"}(R||(R={}));var q={subscribe:function(){var e=Object(v.a)(E.a.mark((function e(t,n){var a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v1/employee/notifications/subscribe",a="ios"===F.settings.platform?R.iOS:R.Android,N("pushNotifications_subscribeCalled",{token:n,operatingSystem:a,username:t.username,access_token:t.access_token}),e.next=5,V.putData(t,"api/v1/employee/notifications/subscribe",{TokenId:n,OperatingSystem:a});case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),unsubscribe:function(){var e=Object(v.a)(E.a.mark((function e(t,n){var a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v1/employee/notifications/unsubscribe",a="ios"===F.settings.platform?R.iOS:R.Android,e.next=4,V.putData(t,"api/v1/employee/notifications/unsubscribe",{TokenId:n,OperatingSystem:a});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),getTypesSelectedByUser:function(){var e=Object(v.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v1/employee/notifications/types",e.next=3,V.get(t,"api/v1/employee/notifications/types");case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),putTypes:function(){var e=Object(v.a)(E.a.mark((function e(t,n){var a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v1/employee/notifications/types",a={ids:n},e.next=4,V.put(t,"api/v1/employee/notifications/types",a);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),listTypes:function(){var e=Object(v.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v1/employee/notifications/list-types",e.next=3,V.get(t,"api/v1/employee/notifications/list-types");case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},W=n(26),G=I.c.PushNotifications,_=function(e,t,n){var a=Object(W.a)({forceRefresh:!0});F.settings.hasCapacitor&&(G.register().then((function(){console.log("PushNotificationController: register called and returned")})),G.addListener("registration",(function(a){q.subscribe(e,a.value),t(!0),n("Push registration success, token: "+a.value),N("pushNotifications_registered",{token:a.value,platform:F.settings.platform})})),G.addListener("registrationError",(function(e){n("Error on registration: "+JSON.stringify(e)),N("pushNotifications_registrationError",{error:e,platform:F.settings.platform})})),G.addListener("pushNotificationReceived",(function(e){var t;e&&(e.data&&e.data.MessageId?(n("NOTIFICATION: "+e.title+": "+e.body+" id:"+e.data.MessageId),a.push("/tabs/messages/"+e.data.MessageId),a.goForward()):n("NOTIFICATION: "+e.title+": "+e.body+" (no id)"),N("pushNotifications_receivedWhenOpen",{title:e.title,body:e.body,messageId:null!==(t=e.data.MessageId)&&void 0!==t?t:-123}))})),G.addListener("pushNotificationActionPerformed",(function(e){var t;e.notification.data&&e.notification.data.MessageId?(n("TAPPED ON NOTIFICATION: "+e.notification.title+": "+e.notification.body+" id:"+e.notification.data.MessageId),a.push("/tabs/messages/"+e.notification.data.MessageId),a.goForward()):n("TAPPED ON NOTIFICATION: "+e.notification.title+": "+e.notification.body+" (no id)"),N("pushNotifications_actionPerformed",{title:e.notification.title,body:e.notification.body,messageId:null!==(t=e.notification.data.MessageId)&&void 0!==t?t:-123})})))},Y={isLoggedin:!1,access_token:void 0,username:"",darkMode:!1,loading:!0,latitude:void 0,longitude:void 0,lastLocationUpdate:void 0,environment:"prod",isPushEnabled:!1,requestedGeoPermission:!1,refusedGeoPermission:!1},J={enableHighAccuracy:!0,maximumAge:1e3},H={user:Y,logout:function(){var e=Object(v.a)(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),userLoggedIn:function(e,t,n){return new Promise((function(){return Y}))},startWatchPosition:function(e){return""},clearWatchPosition:function(e){},pushEnabled:function(e){},requestGeoPermission:function(){},setRefusedGeoPermission:function(e){}},K=r.a.createContext(H),Q=function(e){var t=Object(a.useState)(Object(p.a)({},Y)),n=Object(d.a)(t,2),o=n[0],c=n[1];var i=function(){var e=Object(v.a)(E.a.mark((function e(){var t,n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.requestedGeoPermission){e.next=2;break}return e.abrupt("return");case 2:if(e.prev=2,!F.settings.hasCapacitor||!I.a.isPluginAvailable("Geolocation")){e.next=9;break}return console.log("ApplicationUserContext: request geolocation permission via cap"),e.next=7,I.b.getCurrentPosition(J);case 7:e.next=16;break;case 9:if(!navigator||!navigator.geolocation){e.next=15;break}return console.log("ApplicationUserContext: request geolocation permission via nav"),e.next=13,navigator.geolocation.getCurrentPosition((function(e){}));case 13:e.next=16;break;case 15:console.log("Could not request geolocation through Cap or nav");case 16:return t=Object(p.a)({},o,{latitude:void 0,longitude:void 0,lastLocationUpdate:new Date,requestedGeoPermission:!0}),e.next=19,j.putUserState(t);case 19:c(t),console.log("ApplicationUserContext: RequestedGeoPermission set to true"),e.next=30;break;case 23:return e.prev=23,e.t0=e.catch(2),n=Object(p.a)({},o,{latitude:void 0,longitude:void 0,lastLocationUpdate:new Date,requestedGeoPermission:!0}),e.next=28,j.putUserState(n);case 28:c(n),console.log("ApplicationUserContext: RequestedGeoPermission set to true");case 30:case"end":return e.stop()}}),e,null,[[2,23]])})));return function(){return e.apply(this,arguments)}}(),l=function(){var e=Object(v.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(p.a)({},o,{refusedGeoPermission:t}),e.next=3,j.putUserState(n);case 3:c(n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){var e=!0;return Promise.all([j.getUserState()]).then((function(t){if(e){var n=t[0];c(n?Object(p.a)({},n,{loading:!1}):Object(p.a)({},o,{loading:!1}))}})),function(){e=!1}}),[]),Object(a.useEffect)((function(){o&&!o.isPushEnabled&&o.access_token&&o.access_token.length>0&&"other"!==F.settings.platform&&_(o,s,(function(){}))}),[o.isPushEnabled,o.access_token]);var s=function(e){c(Object(p.a)({},o,{isPushEnabled:e}))},u=function(){var e=Object(v.a)(E.a.mark((function e(t,n,a){var r,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.getUserState();case 2:return r=e.sent,o={username:t,access_token:n,environment:a,isLoggedin:!0,darkMode:r?r.darkMode:Y.darkMode,loading:!1,latitude:void 0,longitude:void 0,isPushEnabled:!1,requestedGeoPermission:!1,refusedGeoPermission:!1},e.next=6,j.putUserState(o);case 6:return c(o),e.abrupt("return",o);case 8:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),m=function(){var e=Object(v.a)(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(p.a)({},o,{isLoggedin:!1,access_token:void 0,latitude:void 0,longitude:void 0,isPushEnabled:!1,requestedGeoPermission:!1,refusedGeoPermission:!1}),c(t),e.next=4,j.putUserState(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(K.Provider,{value:{user:o,userLoggedIn:u,logout:m,startWatchPosition:function(e){var t=function(t){if(t&&t.coords){var n,a="unknown";if(google&&google.maps&&google.maps.geometry&&google.maps.geometry.spherical&&google.maps.geometry.spherical.computeDistanceBetween&&o.latitude&&o.longitude)if(o.latitude&&o.longitude){var r=new google.maps.LatLng(o.latitude,o.longitude),i=new google.maps.LatLng(t.coords.latitude,t.coords.longitude),l=3.28084*google.maps.geometry.spherical.computeDistanceBetween(r,i);n=l>2,a="distance greater than 2 feet ("+l+")"}else n=!0,a="original lat/lng were empty";else n=o.latitude!==t.coords.latitude||o.longitude!==t.coords.longitude,a="position different";if(n){console.log("Position changed, calling callback and setting user state, "+a);var s=Object(p.a)({},o,{latitude:t.coords.latitude,longitude:t.coords.longitude,lastLocationUpdate:new Date});c(s),e(t.coords.latitude,t.coords.longitude)}}},n=function(t){console.log("Could not get geolocation, error code "+t.code),1===t.code&&e(void 0,void 0,"Could not get location: permission denied")},a="";if(F.settings.hasCapacitor&&I.a.isPluginAvailable("Geolocation")){console.log("ApplicatinUserContext: Using Cap plugin to watch position");try{a=I.b.watchPosition(J,t)}catch(r){n({code:1})}}else{if(!navigator||!navigator.geolocation)return console.log("ApplicationUserContext.startWatchPosition: Geolocation unavailable via cap/nav"),"";console.log("ApplicatinUserContext: Using browser API"),a=navigator.geolocation.watchPosition(t,n,J)}return console.log("ApplicationUserContext.startWatchPosition: start "+a),a},clearWatchPosition:function(e){""!==e&&(F.settings.hasCapacitor&&I.a.isPluginAvailable("Geolocation")?I.b.clearWatch({id:e}).then((function(){console.log("ApplicationUserContext.stopWatchPosition: cleared "+e+" from Capacitor plugin")})):navigator&&navigator.geolocation&&(navigator.geolocation.clearWatch(parseInt(e)),console.log("ApplicationUserContext.stopWatchPosition: cleared browser API watchId "+e)))},pushEnabled:s,requestGeoPermission:i,setRefusedGeoPermission:l}},e.children)};var $=function(){var e=Object(a.useState)(!1),t=Object(d.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)({header:"",message:"",onDismiss:function(){}}),i=Object(d.a)(c,2),l=i[0],u=i[1];return{showAlert:function(e,t,n){u({header:e,message:t,onDismiss:n}),o(!0)},alertBoxJsx:r.a.createElement(s.b,{isOpen:n,onDidDismiss:function(){o(!1),l.onDismiss()},header:l.header,message:l.message,buttons:["OK"]})}},X=function(e){var t=e.list,n=e.selected,a=e.selectionChanged,o=function(e){if(!n||0===n.length)return!1;for(var t=0;t<n.length;t++)if(n[t].id===e)return!0;return!1};return t?r.a.createElement(s.o,null,r.a.createElement(s.r,null,r.a.createElement(s.o,{key:-1},r.a.createElement(s.Q,{mode:"md",key:-1,checked:(null===t||void 0===t?void 0:t.length)===(null===n||void 0===n?void 0:n.length),onClick:function(){return function(){var e=(null===t||void 0===t?void 0:t.length)!==(null===n||void 0===n?void 0:n.length);if((null===t||void 0===t?void 0:t.length)===(null===n||void 0===n?void 0:n.length)){if(e)return;a([])}else{if(!e)return;a(t?t.slice():null)}}()}}),r.a.createElement(s.p,null,"SELECT ALL")),t&&t.map((function(e){return r.a.createElement(s.o,{key:e.id},r.a.createElement(s.Q,{mode:"md",key:e.id,onClick:function(){!function(e){if(null!==n)if(!n.map((function(e){return e.id})).includes(e.id)){var t=n.slice();t.push(e),a(t)}else{var r=n.filter((function(t){return t.id!==e.id}));a(r)}}(e)},checked:o(e.id)}),r.a.createElement(s.p,null,e.name))})))):r.a.createElement("div",null,"Loading...")},Z=function(e){var t=e.onDismissModal,n=e.isOpen,o=Object(a.useContext)(K).user,c=Object(a.useState)(null),i=Object(d.a)(c,2),l=i[0],u=i[1],p=Object(a.useState)(null),f=Object(d.a)(p,2),E=f[0],v=f[1];Object(a.useEffect)((function(){if(!n)return v(null),void u(null);var e=!0;return Promise.all([q.getTypesSelectedByUser(o),q.listTypes(o)]).then((function(t){e&&(v(t[0]),u(t[1]))})),function(){e=!1}}),[n,o]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(s.l,{className:"ion-no-border"},r.a.createElement(s.R,null,r.a.createElement(s.e,{slot:"start"},r.a.createElement(s.d,{onClick:function(){t()}},r.a.createElement(s.m,{icon:m.c,mode:"md",slot:"icon-only"}))),r.a.createElement(s.O,null,"Notifications"))),r.a.createElement(s.h,{class:"outer-content"},r.a.createElement(X,{list:l,selected:E,selectionChanged:function(e){var t=e.map((function(e){return e.id}));q.putTypes(o,t).then((function(){v(e)}))}})),r.a.createElement(s.j,null,r.a.createElement(s.R,null)))},ee=n(225);var te,ne=function(){var e,t,n=Object(a.useState)(!1),o=Object(d.a)(n,1)[0],c=r.a.useContext(K).user,i=F.settings.env.item(c.environment),l="prod"!==i.key?c.username.substr(4):c.username,u=$(),p=Object(a.useState)(!1),f=Object(d.a)(p,2),E=f[0],v=f[1];return r.a.createElement(s.u,{type:"overlay",disabled:o,contentId:"main"},r.a.createElement(s.l,{className:"ion-no-border"},r.a.createElement(s.R,null,r.a.createElement(s.O,null,"Menu"))),r.a.createElement(s.h,{class:"outer-content"},"prod"!==i.key&&r.a.createElement("div",{className:"header"},l.toUpperCase()," (",i.name.toUpperCase(),")"),"prod"===i.key&&r.a.createElement("div",{className:"header"},l),r.a.createElement(s.r,null,r.a.createElement(s.w,{"auto-hide":"false"},r.a.createElement(s.o,{button:!0,routerLink:"/account",routerDirection:"none"},r.a.createElement(s.p,null,"Settings"),r.a.createElement(s.m,{slot:"end",icon:m.u}))),r.a.createElement(s.w,{"auto-hide":"false"},r.a.createElement(s.o,{button:!0,onClick:function(){v(!0)}},r.a.createElement(s.p,null,"Notifications"),r.a.createElement(s.m,{slot:"end",icon:m.r}))),r.a.createElement(s.w,{"auto-hide":"false"},r.a.createElement(s.o,{button:!0,routerLink:"/account",routerDirection:"none"},r.a.createElement(s.p,null,"Submit a Ticket"),r.a.createElement(s.m,{slot:"end",icon:m.q}))),r.a.createElement(s.w,{"auto-hide":"false"},r.a.createElement(s.o,{button:!0,routerLink:"/logout",routerDirection:"none"},r.a.createElement(s.m,{slot:"end",icon:m.o}),r.a.createElement(s.p,null,"Logout")))),u.alertBoxJsx),r.a.createElement(s.j,{className:"footer"},r.a.createElement("div",{className:"debug-info"},"Geo: ",(e=c.latitude,t=c.longitude,e&&t?"".concat(e,"/").concat(t):"N/A"),r.a.createElement("br",null),"Updated:"," ",c.lastLocationUpdate?Object(ee.a)(c.lastLocationUpdate,"M/d EEE h:mmaa"):"N/A",r.a.createElement("br",null),"Capacitor: ",F.settings.hasCapacitor?"Yes":"No",r.a.createElement("br",null),"Build Date: ",F.settings.buildDate,r.a.createElement("br",null),"Version: ",F.settings.appVersionString)),r.a.createElement(s.x,{isOpen:E},r.a.createElement(Z,{onDismissModal:function(){v(!1)},isOpen:E})))},ae=(n(116),n(117),n(118),n(119),n(120),n(121),n(122),n(123),n(124),n(125),n(126),{authenticateUser:function(){var e=Object(v.a)(E.a.mark((function e(t,n,a){var r,o,c,i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Authenticating against ".concat(F.settings.env.item(a).name," (").concat(F.settings.env.item(a).url,")")),r=F.settings.env.item(a).url+"token",o="grant_type=password&username=".concat(t,"&password=").concat(n),e.prev=3,e.next=6,fetch(r,{method:"POST",body:o});case 6:return c=e.sent,e.next=9,c.json();case 9:if(!(i=e.sent).error&&!i.error_description){e.next=12;break}return e.abrupt("return",{loggedIn:!1,error:i.error_description,access_token:""});case 12:return e.abrupt("return",{loggedIn:!0,access_token:i.access_token});case 15:return e.prev=15,e.t0=e.catch(3),console.error("Error returned from authentication request: "+e.t0),e.abrupt("return",{loggedIn:!1,err:e.t0,error:"Error attempting to log in",access_token:""});case 19:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(t,n,a){return e.apply(this,arguments)}}(),getHomePageData:function(){var e=Object(v.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.get(t,"api/v3/home/get/0");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getAuthorizedItems:function(){var e=Object(v.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.get(t,"api/v3/home/get-auth");case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()});!function(e){e.Employee="Employee",e.Admin="Admin",e.LocationAdmin="Location Admin",e.BusinessAdmin="Business Admin",e.Orbital="Orbital"}(te||(te={}));var re,oe,ce,ie,le,se,ue={auth:{locations:[],tags:[],payrollEvents:[],employeeId:0,loading:!1,role:te.Employee},currentEvents:[],nextEvent:void 0,dailyNotes:[]};!function(e){e[e.HoursMinutes=0]="HoursMinutes",e[e.HoursAndDecimals=1]="HoursAndDecimals"}(re||(re={})),function(e){e[e.Unit=1]="Unit",e[e.Money=2]="Money"}(oe||(oe={})),function(e){e[e.None=0]="None",e[e.CanViewWages=1]="CanViewWages",e[e.CanEditPublishedTo=2]="CanEditPublishedTo",e[e.CanEditTemplates=4]="CanEditTemplates",e[e.CanEditSchedules=8]="CanEditSchedules",e[e.CanEditEmployeeClockEvents=16]="CanEditEmployeeClockEvents",e[e.CanEditOwnClockEvents=32]="CanEditOwnClockEvents",e[e.CanEditUserAccounts=64]="CanEditUserAccounts"}(ce||(ce={})),function(e){e[e.Both=0]="Both",e[e.Unpaid=1]="Unpaid",e[e.Paid=2]="Paid",e[e.None=3]="None"}(ie||(ie={})),function(e){e[e.UnscheduledUnpaid=0]="UnscheduledUnpaid",e[e.UnscheduledPaid=1]="UnscheduledPaid",e[e.Scheduled=2]="Scheduled"}(le||(le={})),function(e){e[e.FirstName=1]="FirstName",e[e.LastName=2]="LastName",e[e.EmploymentStart=3]="EmploymentStart",e[e.EarliestEventStart=4]="EarliestEventStart"}(se||(se={}));var de={employeeId:0,role:te.Employee,locations:[],loading:!1,payrollEvents:[],tags:[]},me={auth:de,refreshAuth:function(e,t){return new Promise((function(){}))},clearAuth:function(){var e=Object(v.a)(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),authLoading:!1},pe=r.a.createContext(me);function fe(e,t){return Ee.apply(this,arguments)}function Ee(){return(Ee=Object(v.a)(E.a.mark((function e(t,n){var a,r,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isLoggedin){e.next=5;break}return a=Object(p.a)({},de),e.next=4,j.putAuthItems(a).then((function(){N("indexdb_authitems_cleared")}));case 4:return e.abrupt("return",a);case 5:if(n){e.next=11;break}return e.next=8,j.getAuthItems();case 8:if(!((r=e.sent)&&r.locations&&r.locations.length>0)){e.next=11;break}return e.abrupt("return",r);case 11:return e.next=13,ae.getAuthorizedItems(t);case 13:if(!((o=e.sent)&&o.locations&&o.locations.length>0)){e.next=21;break}return e.next=17,j.putAuthItems(o);case 17:return N("indexdb_authitems_put",{employeeId:o.employeeId}),e.abrupt("return",o);case 21:return e.abrupt("return",null);case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ve=function(e){var t=Object(a.useState)(Object(p.a)({},de)),n=Object(d.a)(t,2),o=n[0],c=n[1],i=Object(a.useState)(!1),l=Object(d.a)(i,2),s=l[0],u=l[1],m=function(){var e=Object(v.a)(E.a.mark((function e(t,n){var a,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u(!0),n.isLoggedin||(a=Object(p.a)({},de),c(a),j.putAuthItems(a).then((function(){N("indexdb_authitems_cleared")})),u(!1)),t||!(o.employeeId>0)){e.next=4;break}return e.abrupt("return",o);case 4:return e.next=6,fe(n,t);case 6:return r=e.sent,u(!1),r&&c(r),e.abrupt("return",r);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),f=function(){var e=Object(v.a)(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(de),e.next=3,j.putAuthItems(de);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(pe.Provider,{value:{auth:o,refreshAuth:m,clearAuth:f,authLoading:s}},e.children)};function he(e,t){return e.length>0&&t.length>5}var ge=function(e){var t=e.history,n=$(),o=n.alertBoxJsx,c=n.showAlert,i=r.a.useContext(K),l=i.user,u=i.userLoggedIn,m=r.a.useContext(pe).refreshAuth,p=Object(a.useState)(!1),f=Object(d.a)(p,2),h=f[0],g=f[1],b=Object(a.useState)(""),y=Object(d.a)(b,2),O=y[0],k=y[1],C=Object(a.useState)(""),j=Object(d.a)(C,2),I=j[0],S=j[1],T=Object(a.useState)(""),D=Object(d.a)(T,1)[0],x=Object(a.useState)(""),A=Object(d.a)(x,1)[0],w=Object(a.useState)(!1),P=Object(d.a)(w,2),M=P[0],R=P[1],U=function(){var e=Object(v.a)(E.a.mark((function e(){var n,a,r,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!O||!I){e.next=23;break}return n=F.getUserAndEnvironmentFromInput(O),g(!0),e.next=5,ae.authenticateUser(n.username,I,n.env.key);case 5:if(!(a=e.sent).loggedIn){e.next=19;break}return e.next=9,u(O,a.access_token,n.env.key);case 9:return r=e.sent,e.next=12,m(!0,r);case 12:N("login",{username:n.username,appVersion:F.settings.appVersionString,environment:n.env.name}),console.log("logged in to ".concat(n.env.name,": ").concat(n.username)),t.push("/tabs/schedule",{direction:"none"}),t.goForward(),g(!1),e.next=23;break;case 19:g(!1),N("login_failure",{username:n.username,appVersion:F.settings.appVersionString,environment:n.env.name}),o=a.error?a.error:"Could not log in",c("Failed to log in",o,(function(){S(""),R(!1)}));case 23:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(s.W)((function(){l.isLoggedin&&(t.push("/tabs/schedule",{direction:"forward"}),t.goForward())})),r.a.createElement(s.y,{id:"login-page"},r.a.createElement(s.h,{className:"login-content"},r.a.createElement("div",{className:"login-logo"},r.a.createElement("img",{className:"logo",src:"assets/img/OS Logo - 4pt Rounded _ 2 Tone Orange.svg",alt:"Orbital Shift Logo"})),r.a.createElement(s.t,{isOpen:h,onDidDismiss:function(){return g(!1)},spinner:"dots",message:"Logging in...",duration:5e3}),o,r.a.createElement(s.r,{className:"form-list"},r.a.createElement("div",{className:"item"},r.a.createElement("div",{className:"label"},"User"),r.a.createElement("div",{className:"field-container"},r.a.createElement("input",{className:"input",id:"username",name:"username",type:"text",value:O,onChange:function(e){var t;t=e.target.value,k(t),R(he(t,I))}}))),D.length>0&&r.a.createElement(s.M,{color:"light"},r.a.createElement("p",{className:"ion-padding-start"},D)),r.a.createElement("div",{className:"item"},r.a.createElement("div",{className:"label"},"Password"),r.a.createElement("div",{className:"field-container"},r.a.createElement("input",{className:"input",id:"password",name:"password",type:"password",value:I,onChange:function(e){var t;t=e.target.value,S(t),R(he(O,t))}}))),A.length>0&&r.a.createElement(s.M,{color:"light"},r.a.createElement("p",{className:"ion-padding-start"},A))),r.a.createElement(s.C,null,r.a.createElement(s.g,null,r.a.createElement(s.d,{className:"login-button",type:"submit",onClick:U,expand:"block",disabled:!M},"LOG IN")))))},be=n(213),ye=n(214),Oe=n(215),ke=n(216),Ce=(n(226),n(217)),je=n(218),Ie=new Date(9e3,1,1);function Se(e){if(!e)return 0;var t,n,a=e.split(":");if(a[0].indexOf(".")>=0){var r=a[0].split(".");t=24*parseInt(r[0])+parseInt(r[1]),n=parseInt(a[1])}else t=parseInt(a[0]),n=parseInt(a[1]);return 60*t+n}function Te(e){if(!e)return"(0m)";var t,n,a=e.split(":");if(a[0].indexOf(".")>=0){var r=a[0].split(".");t=24*parseInt(r[0])+parseInt(r[1]),n=parseInt(a[1])}else t=parseInt(a[0]),n=parseInt(a[1]);return t>0?"(".concat(t,"h ").concat(n,"m)"):"(".concat(n,"m)")}function Ne(e){return Object(ee.a)(e,"EEE MMM d, yyyy").toUpperCase()}function De(e){var t=Object(ee.a)(Object(be.a)(e.BreakStart),"h:mmaaa").replace("M","");if(!e.BreakEnd||e.BreakEnd>Ie)return t;var n=Object(ee.a)(Object(be.a)(e.BreakEnd),"h:mmaaa").replace("M","");return"".concat(t," - ").concat(n)}function xe(e){var t=Object(ee.a)(Object(be.a)(e.BreakStart),"h:mmaa").replace("M",""),n=e.BreakEnd?Object(ee.a)(Object(be.a)(e.BreakEnd),"h:mmaa").replace("M",""):Object(ee.a)(new Date,"h:mmaa").replace("M","");return"".concat(t," - ").concat(n)}function Ae(e,t,n){var a=!n||n.indexOf("T")<0?0:Se(n.split("T")[1]),r=e;r.setHours(0,a,0,0);for(var o=0;Object(ee.a)(r,"EEEE")!==t&&o<20;)r=Object(Ce.a)(r,-1),o++;return o>15&&console.error("Could not calculate week start based on date ".concat(e)+'and weekStartsOn "'.concat(t,'"')),r}function we(e){return e.getFullYear()+"-"+Me(e.getMonth()+1,2)+"-"+Me(e.getDate(),2)+"T"+Me(e.getHours(),2)+":"+Me(e.getMinutes(),2)+":00"}function Pe(e,t,n){var a=Number(e).toFixed(n).toString(),r="";0===a.indexOf("-")&&(a=a.substring(1),r="-");var o="0000000000"+a;return-1===a.indexOf(".")?r+o.substr(o.length-Math.max(a.length,t)):r+o.substr(o.length-Math.max(a.length,t+n+1))}function Me(e,t){var n="0000000000"+e;return n.substr(n.length-t)}var Re,Ue=n(71),Le={getScheduleEvent:function(){var e=Object(v.a)(E.a.mark((function e(t,n){var a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.get(t,"api/v2/employee/schedule-events/get/"+n);case 2:if(!(a=e.sent).error){e.next=5;break}return e.abrupt("return",null);case 5:return e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),getScheduleEventsByFilter:function(){var e=Object(v.a)(E.a.mark((function e(t,n){var a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(p.a)({start:we(n.start),end:we(n.end)},n),e.next=3,V.post(t,"api/v2/employee/schedule-events/filter",a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),getDailyNotesByFilter:function(){var e=Object(v.a)(E.a.mark((function e(t,n){var a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(p.a)({start:we(n.start),end:we(n.end)},n),e.next=3,V.post(t,"api/v2/daily-notes/filter",a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),updateScheduleEvent:function(){var e=Object(v.a)(E.a.mark((function e(t,n,a){var r,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={scheduleEventId:n.scheduleEventId,eventType:n.eventType,eventStatus:n.eventStatus,isConfirmed:n.isConfirmed,positionId:n.position.position.id,employeeId:n.employee.id,eventStart:n.eventStart,eventEnd:n.eventEnd,tagId:null===(r=n.tag)||void 0===r?void 0:r.id,eventBreaks:n.eventBreaks,isClockedIn:n.isClockedIn,breakStart:null,breakDuration:null,clockOutValue:n.clockoutValue,absentTime:n.absentTimeMinutes,notes:n.notes,sendMessage:!1,recurrenceId:n.recurrenceId,recurrenceStart:n.recurrenceStart,recurrenceEnd:n.recurrenceEnd,recurrenceType:n.recurrenceType,repeatInterval:n.repeatInterval,repeatWeekdays:n.repeatWeekdays,recurrenceUpdateType:a},e.next=3,V.post(t,"api/v2/employee/schedule-events/update",o);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),createScheduleEvent:function(){var e=Object(v.a)(E.a.mark((function e(t,n,a){var r,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={sceduleEventId:0,eventType:n.eventType,eventStatus:n.eventStatus,isConfirmed:n.isConfirmed,positionId:n.position.position.id,employeeId:n.employee.id,eventStart:n.eventStart,eventEnd:n.eventEnd,tagId:null===(r=n.tag)||void 0===r?void 0:r.id,eventBreaks:n.eventBreaks,isClockedIn:n.isClockedIn,breakStart:null,breakDuration:null,clockOutValue:n.clockoutValue,absentTime:n.absentTimeMinutes,notes:n.notes,sendMessage:!1,recurrenceId:n.recurrenceId,recurrenceStart:n.recurrenceStart,recurrenceEnd:n.recurrenceEnd,recurrenceType:n.recurrenceType,repeatInterval:n.repeatInterval,repeatWeekdays:n.repeatWeekdays,recurrenceUpdateType:a},e.next=3,V.post(t,"api/v2/employee/schedule-events/create",o);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),deleteScheduleEvent:function(){var e=Object(v.a)(E.a.mark((function e(t,n,a){var r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={scheduleEventId:n,recurrenceUpdateType:a,sendMessage:!1},e.next=3,V.post(t,"api/v2/employee/schedule-events/delete",r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}()},Fe={settingsLocId:0,dnLocIds:[],start:new Date,end:new Date,filterByEmployee:!1,filterByPosition:!0,positionIds:[],eventTypeId:-1,eventStatusId:-1,tagId:void 0},Be=n(95),ze=function(e){var t=e.startDate,n=e.setStartDate,o=Object(a.useRef)(t),c=function(e){Object(Be.a)(e,o.current)||(o.current=e,n(e))};return r.a.createElement("div",{className:"chooser"},r.a.createElement("div",{className:"top"},r.a.createElement("button",{onClick:function(){return c(Object(Ce.a)(t,-7))},className:"arrow",key:-1},r.a.createElement(s.m,{mode:"ios",icon:m.b})),r.a.createElement("div",{className:"month-year-container"},r.a.createElement("div",{className:"datetime-picker-container"},r.a.createElement(s.i,{className:"datetime-picker",displayFormat:"MMM YYYY",pickerFormat:"MMM D YYYY",min:"2005-01-01",max:"2030-01-01",value:t.toISOString(),onIonChange:function(e){c(Object(be.a)(e.detail.value))}}),r.a.createElement(s.m,{mode:"md",icon:m.k}))),r.a.createElement("button",{onClick:function(){return c(Object(Ce.a)(t,7))},className:"arrow",key:7},r.a.createElement(s.m,{mode:"ios",icon:m.e}))),r.a.createElement("div",{className:"weekday-list"},[0,1,2,3,4,5,6].map((function(e){var n=Object(Ce.a)(t,e),a=Object(ye.a)(n)?"today":"not-today";return r.a.createElement("button",{key:e,className:"weekday-button",style:{outline:"none"}},r.a.createElement("div",null,r.a.createElement("div",{className:"weekday-abbr"},Object(ee.a)(n,"EEE")),r.a.createElement("div",{className:a}),r.a.createElement("div",{className:"weekday-num"},Object(ee.a)(n,"d"))))}))))},Ve=n(219);!function(e){e[e.Shift=1]="Shift",e[e.Unavailable=2]="Unavailable",e[e.Vacation=3]="Vacation",e[e.Cover=4]="Cover",e[e.Clock=6]="Clock",e[e.Absent=7]="Absent"}(Re||(Re={}));var qe,We=Re;!function(e){e[e.Approved=1]="Approved",e[e.Request=2]="Request",e[e.RequestDenied=4]="RequestDenied"}(qe||(qe={}));var Ge,_e=qe,Ye=function(e,t){return e&&e.locations&&0!==e.locations.length?t<=0?null:e.locations.filter((function(e){return e.id===t}))[0]:null},Je=function(e,t){if(!e||!e.locations||0===e.locations.length)throw new Error("getLocSettingsForLocationId: called with invalid auth parameter");return 0===t?e.locations[0].settings:e.locations.filter((function(e){return e.id===t}))[0].settings},He=Ye,Ke=function(e,t){if(!e||!e.locations||0===e.locations.length)return null;if(t<=0)return null;var n=null;return e.locations.flatMap((function(e){return e.departments.map((function(e){return 1===e.positions.filter((function(e){return e.id===t})).length?(n=e,e):null}))})),n},Qe=function(e){return e===We.Shift||e===We.Cover||e===We.Clock||e===We.Absent},$e=function(e,t,n){return(e.locations.filter((function(e){return e.id===t}))[0].departments.filter((function(e){return e.id===n}))[0].adminAuth&ce.CanEditSchedules)===ce.CanEditSchedules},Xe=function(e,t){return e.locations.flatMap((function(e){return e.departments.filter((function(e){return e.id===t}))}))[0].adminAuth},Ze=function(e,t){return e.role===te.Admin&&e.locations.flatMap((function(e){return e.departments.filter((function(e){return e.id===t}))}))[0].positions.filter((function(e){return e.hasPosition})).length>0},et=function(e,t){var n=e.locations.flatMap((function(e){return e.departments.filter((function(e){return e.id===t}))}))[0];return(n.adminAuth&ce.CanEditSchedules)===ce.CanEditSchedules&&n.positions.filter((function(e){return e.hasPosition})).length>0},tt=function(e,t){return e===We.Shift&&t===_e.Approved||e===We.Cover&&t===_e.Request||e===We.Cover&&t===_e.RequestDenied},nt=function(e,t){return!(!e||!e.locations||0===e.locations.length)&&(e.role!==te.Employee&&(e.role===te.BusinessAdmin||e.role===te.LocationAdmin||e.locations.flatMap((function(e){return e.departments.filter((function(e){return e.id===t}))}))[0].isDeptAdmin))},at=function(e,t){if(e.role===te.BusinessAdmin||e.role===te.LocationAdmin)return!0;if(e.role===te.Employee)return!1;var n=Ye(e,t);return!0===(null===n||void 0===n?void 0:n.adminAllDepts)},rt=function(e,t,n,a){if(!e||!e.locations||0===e.locations.length)return!1;if(e.role===te.Employee)return!1;if(e.role===te.LocationAdmin||e.role===te.BusinessAdmin)return!0;if(-1===n){var r=Ye(e,t);return!0===(null===r||void 0===r?void 0:r.adminAllDepts)}return(e.locations.flatMap((function(e){return e.departments.filter((function(e){return e.id===n}))}))[0].adminAuth&a)===a},ot=function(e,t,n){var a=Ye(e,t);if(null===a)throw new Error('getSelectedDepartment: Could not find locationId "'.concat(t,'"'));if(-1===n)return{location:a,department:null};var r=a.departments.filter((function(e){return e.id===n}))[0];return{location:a,department:r}},ct=function(e,t,n){var a=e.filter((function(e){return e.id===t}))[0],r=a.departments.flatMap((function(e){return e.positions.filter((function(e){return e.id===n}))}))[0];return{location:a,position:r}},it=function(e,t){for(var n=0;n<e.length;n++)for(var a=0;a<e[n].departments.length;a++)for(var r=0;r<e[n].departments[a].positions.length;r++)if(e[n].departments[a].positions[r].id===t)return{location:e[n],position:e[n].departments[a].positions[r]};return{location:{},position:{}}},lt=function(e){for(var t=0;t<e.length;t++)if(e[t].settings.RequireGeoLocation)return!0;return!1};!function(e){e[e.None=0]="None",e[e.UndoCoverRequest=1]="UndoCoverRequest",e[e.CreateShiftRequest=2]="CreateShiftRequest",e[e.DeleteShiftRequest=3]="DeleteShiftRequest",e[e.CreateCoverRequest=4]="CreateCoverRequest",e[e.Delete=5]="Delete"}(Ge||(Ge={}));var st=function(e,t,n,a,r,o,c,i,l,s){var u=ct(s.locations,o,i),d=dt(s,u,n,t,!0),m=ut(s,u,n),f={buttonText:"",enableConfirm:!0,isReadonly:!1,text:"",usage:Ge.None,eventTypeOptionList:m,eventStatusOptionList:d};if(s.role===te.BusinessAdmin)return f;if(s.role===te.LocationAdmin)return Qe(e)&&0===s.locations.filter((function(e){return e.id===o})).length?null:f;var E=Object(be.a)(r),v=new Date,h=Object(je.a)(v,E),g=!1,b=Xe(s,c);if(s.role===te.Admin)if(n===s.employeeId){if(e===We.Clock)return(b&ce.CanEditOwnClockEvents)===ce.CanEditOwnClockEvents?f:null;if((b&ce.CanEditSchedules)===ce.CanEditSchedules)return f;g=!0}else{if(e===We.Clock)return(b&ce.CanEditEmployeeClockEvents)===ce.CanEditEmployeeClockEvents?f:null;if($e(s,o,c))return f;if(!Ze(s,c))return null;g=!0}return s.role===te.Employee||g?n===s.employeeId?h||e===We.Clock?null:e===We.Shift?t===_e.Approved?Object(p.a)({},f,{buttonText:"Create Cover-Request",isReadonly:!0,usage:Ge.CreateCoverRequest}):t===_e.Request?Object(p.a)({},f,{buttonText:"Undo Shift-Request",enableConfirm:!1,isReadonly:!0,text:"Click OK to remove your Shift-Request",usage:Ge.DeleteShiftRequest}):null:e===We.Cover?t===_e.Request?Object(p.a)({},f,{buttonText:"Undo Cover-Request",enableConfirm:!0,isReadonly:!0,usage:Ge.UndoCoverRequest}):null:!Qe(e)&&et(s,c)?Object(p.a)({},f,{buttonText:"Delete Request",enableConfirm:!1,isReadonly:!0,text:"Click OK to delete this event",usage:Ge.Delete}):null:e===We.Cover&&t===_e.Request?Object(p.a)({},f,{buttonText:"Make Shift-Request",enableConfirm:!1,isReadonly:!0,text:"",usage:Ge.CreateShiftRequest}):null:null},ut=function(e,t,n){if(!e||!e.locations||0===e.locations.length||!t||!t.location||!t.location.settings)return[];var a=[{value:We.Shift,text:"SHIFT",color:"green"}],r=t.location.settings,o=Ke(e,t.position.id),c=Xe(e,o.id);if((e.role===te.BusinessAdmin||e.role===te.LocationAdmin||e.role===te.Admin&&(e.employeeId===n&&(c&ce.CanEditOwnClockEvents)===ce.CanEditOwnClockEvents||e.employeeId!==n&&(c&ce.CanEditEmployeeClockEvents)===ce.CanEditEmployeeClockEvents))&&a.push({value:We.Clock,text:"CLOCK",color:"green"}),(e.role===te.BusinessAdmin||e.role===te.LocationAdmin||e.role===te.Admin&&(c&ce.CanEditSchedules)===ce.CanEditSchedules)&&a.push({value:We.Cover,text:"COVER",color:"red"}),r.ShowUnavailableEventType&&a.push({value:We.Unavailable,text:"UNAVAILABLE",color:"yellow"}),r.ShowVacationEventType&&a.push({value:We.Vacation,text:"VACATION",color:"yellow"}),r.ShowAbsentEventType){var i=e.payrollEvents.filter((function(e){return e.positionIds.includes(t.position.id)&&!e.name.startsWith("--")})).map((function(e){return{value:e.id,text:e.name,color:"yellow"}}));return a.concat(i)}return a},dt=function(e,t,n,a,r){var o=[],c=Ke(e,t.position.id),i=Xe(e,c.id);if((e.role===te.LocationAdmin||e.role===te.BusinessAdmin||e.role===te.Admin&&(i&ce.CanEditSchedules)===ce.CanEditSchedules)&&o.push({value:_e.Approved,text:"APPROVED",color:"black"}),o.push({value:_e.Request,text:"REQUEST",color:"red"}),(e.role===te.LocationAdmin||e.role===te.BusinessAdmin||e.role===te.Admin&&(i&ce.CanEditSchedules)===ce.CanEditSchedules)&&o.push({value:_e.RequestDenied,text:"REQUEST-DENIED",color:"black"}),r&&0===o.filter((function(e){return e.value===a})).length)switch(a){case _e.Approved:o.push({value:_e.Approved,text:"APPROVED",color:"black"});break;case _e.Request:o.push({value:_e.Request,text:"REQUEST",color:"red"});break;case _e.RequestDenied:o.push({value:_e.RequestDenied,text:"REQUEST-DENIED",color:"black"})}return o},mt={1:"#9CBA6A",2:"#BFBFBF",3:"#FFAD00",4:"#C41A26",6:"#677A46",7:"#FFAD00"},pt={1:{color:"black"},2:{color:"#C41A26"},4:{color:"#BCBCBC"}},ft=function(e){var t=e.location,n=e.event,o=e.multiLocation,c=e.showEmployeeName,i=e.onEdit,l=Object(a.useContext)(pe).auth,u=c?{display:"inline-block"}:{display:"none"},d=Object(be.a)(n.EventStart),p=!!o||t.departments.filter((function(e){return e.positions.filter((function(e){return e.hasPosition}))})).length>1,f="";o&&n.AbbreviatedLocationName&&(f=n.AbbreviatedLocationName+"/"),p&&n.AbbreviatedDepartmentName&&(f+=n.AbbreviatedDepartmentName+"/"),f+=n.PositionName;var E={borderLeft:"7px solid ".concat(mt[n.EventTypeId]," ")},v=pt[n.EventStatusId];return r.a.createElement("button",{className:"card",onClick:function(){!function(){var e=st(n.EventTypeId,n.EventStatusId,n.EmployeeId,n.EventStart,n.EventEnd,n.LocationId,n.DepartmentId,n.PositionId,n.IsConfirmed,l);null!==e&&i(n,e)}()}},r.a.createElement("div",{className:"card-first-col"},r.a.createElement("div",{className:"day-name"},Object(ee.a)(d,"EEE")," "),r.a.createElement("div",{className:"day-number"},Object(ee.a)(d,"d"))),r.a.createElement("div",{className:"card-second-col",style:E},r.a.createElement("div",{className:"time-row"},n.IsClockedIn&&r.a.createElement(s.m,{icon:m.v}),r.a.createElement("span",{style:v},function(e){var t=Object(ee.a)(Object(be.a)(e.EventStart),"h:mmaaa").replace("M",""),n=Object(ee.a)(Object(be.a)(e.EventEnd),"h:mmaaa").replace("M","");return"".concat(t," - ").concat(n)}(n),"\xa0\xa0"),Te(n.EventTypeId===We.Absent?n.Time:n.EventDuration)," ",n.FirstName),r.a.createElement("div",{className:"name-row",style:u},n.FirstName," ",n.LastName),r.a.createElement("div",{className:"dept-position-row"},f,"\xa0\xa0",n.Tag&&"~".concat(n.Tag))))};var Et=function(){var e=Object(a.useState)(!1),t=Object(d.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)({header:"",message:"",options:[],onDismiss:function(e){}}),i=Object(d.a)(c,2),l=i[0],u=i[1],m=function(e){o(!1),l.onDismiss(e)};return{showDialog:function(e,t,n,a){u({header:e,message:t,options:n,onDismiss:a}),o(!0)},dialogBoxJsx:r.a.createElement(s.x,{isOpen:n,cssClass:"orbital-dialog-modal",onDidDismiss:function(){return m(null)}},r.a.createElement(s.h,{className:"modal-content"},r.a.createElement(s.l,{mode:"ios"},r.a.createElement(s.R,null,r.a.createElement(s.O,null,l.header))),r.a.createElement(s.k,null,l.options.map((function(e){return r.a.createElement(s.C,{key:e.value},r.a.createElement(s.g,{size:"12"},r.a.createElement(s.d,{expand:"block",color:e.color,className:"apply-button",onClick:function(){return m(e.value)}},e.text)))})),r.a.createElement(s.C,null,r.a.createElement(s.g,{size:"12"},r.a.createElement(s.d,{expand:"block",className:"cancel-btn",onClick:function(){return m(null)}},"Cancel"))))))}},vt=function(e){var t=e.currentDepartment,n=e.onDepartmentUpdate,o=Object(a.useContext)(pe).auth,c=Object(a.useState)(t),i=Object(d.a)(c,2),l=i[0],u=i[1];if(o&&o.locations&&0!==o.locations.length){var m=null!==l.department?l.department.id:null;return r.a.createElement(r.a.Fragment,null,r.a.createElement(s.o,null,r.a.createElement(s.p,null,"Location"),r.a.createElement(s.F,{interface:"popover",style:{maxWidth:"100%"},value:l.location.id,onIonChange:function(e){return function(e){if(e){var t={location:o.locations.filter((function(t){return t.id===e}))[0],department:null};u(t),n(t)}}(e.detail.value)}},o.locations.map((function(e){return r.a.createElement(s.G,{key:e.id,value:e.id},e.name)})))),r.a.createElement(s.o,null,r.a.createElement(s.p,null,"Department"),r.a.createElement(s.F,{interface:"popover",style:{maxWidth:"100%"},value:m,onIonChange:function(e){return function(e){if(void 0!==e){var t={location:l.location,department:null===e?null:l.location.departments.filter((function(t){return t.id===e}))[0]};u(t),n(t)}}(e.detail.value)}},at(o,l.location.id)&&r.a.createElement(s.G,{key:-1,value:null},"All Departments"),l.location.departments.filter((function(e){return rt(o,l.location.id,e.id,ce.CanEditSchedules)})).map((function(e){return r.a.createElement(s.G,{key:e.id,value:e.id},e.name)})))))}return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,"Loading"))},ht=function(){var e=Object(v.a)(E.a.mark((function e(t,n,a,r,o){var c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.post(t,"api/v2/daily-notes/update",{dailyNoteId:n,date:we(o),text:a,role:r});case 2:return c=e.sent,e.abrupt("return",c);case 4:case"end":return e.stop()}}),e)})));return function(t,n,a,r,o){return e.apply(this,arguments)}}(),gt=function(){var e=Object(v.a)(E.a.mark((function e(t,n,a,r,o,c){var i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.post(t,"api/v2/daily-notes/insert",{locId:n,depId:a,role:r,date:o,text:c});case 2:return i=e.sent,e.abrupt("return",i);case 4:case"end":return e.stop()}}),e)})));return function(t,n,a,r,o,c){return e.apply(this,arguments)}}(),bt=function(){var e=Object(v.a)(E.a.mark((function e(t,n){var a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.post(t,"api/v2/daily-notes/delete/"+n);case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),yt={getDailyNote:function(){var e=Object(v.a)(E.a.mark((function e(t,n,a,r,o){var c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.post(t,"api/v2/daily-notes/get",{locId:n,depId:a,role:r,date:o});case 2:return c=e.sent,e.abrupt("return",c);case 4:case"end":return e.stop()}}),e)})));return function(t,n,a,r,o){return e.apply(this,arguments)}}(),updateDailyNote:ht,insertDailyNote:gt,deleteDailyNote:bt};var Ot=function(){var e=Object(a.useState)(!1),t=Object(d.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)({message:""}),i=Object(d.a)(c,2),l=i[0],u=i[1];return{showToast:function(e){u({message:e}),o(!0)},simpleToastJsx:r.a.createElement(s.P,{isOpen:n,onDidDismiss:function(){return o(!1)},position:"top",message:l.message,duration:1500})}};var kt=function(e){var t=e.onCloseModal,n=e.isOpen,o=e.note,c=e.initialDate,i=Object(a.useState)(o),l=Object(d.a)(i,2),u=l[0],p=l[1],f=Ot(),E=$(),v=Object(a.useContext)(K).user,h=Object(a.useContext)(pe).auth,g=Et(),b=Object(a.useState)(null!==o?o.Role:1),y=Object(d.a)(b,2),O=y[0],k=y[1],C=Object(a.useState)(null!==o?ot(h,o.LocationId,o.DepartmentId):function(e){for(var t=0;t<e.locations.length;t++){var n=e.locations[t];if(n.adminAllDepts)return{location:n,department:null};for(var a=0;a<n.departments.length;a++){var r=n.departments[a];if(e.role===te.LocationAdmin||e.role===te.BusinessAdmin)return{location:n,department:r};if(r.isDeptAdmin)return{location:n,department:r}}}throw new Error("Could not find a department for this user to add a note")}(h)),j=Object(d.a)(C,2),I=j[0],S=j[1],T=Object(a.useState)(null!==o?o.Notes:""),N=Object(d.a)(T,2),D=N[0],x=N[1],A=Object(a.useRef)(null!==o?o.Notes.length:0),w=Object(a.useState)(null!==o?Object(be.a)(o.EventStart):c),P=Object(d.a)(w,2),M=P[0],R=P[1];Object(a.useEffect)((function(){var e=!0;return n&&null===u&&e&&U(I,O,M),function(){e=!1}}),[n,u]);var U=function(e,t,n){yt.getDailyNote(v,e.location.id,null===e.department?-1:e.department.id,t,n).then((function(e){if("message"in e)e.error||p(null);else{if(null!==u&&u.DailyNoteId===e.DailyNoteId)return;a=u,(null===(n=e)&&null!==a||null!==n&&null===a||(null!==n||null!==a)&&((null===n||void 0===n?void 0:n.Role)!==(null===a||void 0===a?void 0:a.Role)||(null===n||void 0===n?void 0:n.DailyNoteId)!==(null===a||void 0===a?void 0:a.DailyNoteId)))&&p(e);var t=Object(be.a)(e.EventStart);Object(Be.a)(t,M)||R(t),(e.LocationId!==I.location.id||-1===e.DepartmentId&&null!==I.department||-1!==e.DepartmentId&&null===I.department||null!==I.department&&e.DepartmentId!==I.department.id)&&S(ot(h,e.LocationId,e.DepartmentId)),e.Role!==O&&k(e.Role),e.Notes!==D&&(x(e.Notes),A.current=e.Notes.length)}var n,a}))},L=function(e,n,a,r,o){null===u&&0===D.length||null!==u&&u.Notes===D?o&&t(""):null!==u?(0===r.length&&yt.deleteDailyNote(v,u.DailyNoteId).then((function(e){e.error?E.showAlert("Can't Delete Note",e.message,(function(){})):o?t("Note Deleted"):f.showToast("Note Deleted")})),yt.updateDailyNote(v,u.DailyNoteId,r,n,a).then((function(e){e.error?E.showAlert("Can't Update Note",e.message,(function(){})):o?t("Note Updated"):f.showToast("Note Updated")}))):yt.insertDailyNote(v,e.location.id,null===e.department?-1:e.department.id,n,a,r).then((function(e){e.error?E.showAlert("Can't Add Daily Note",e.message,(function(){})):o?t("Note Added"):f.showToast("Note Added")}))};return n&&h&&h.locations&&0!==h.locations.length?r.a.createElement(r.a.Fragment,null,r.a.createElement(s.l,{className:"ion-no-border"},r.a.createElement(s.R,null,r.a.createElement(s.e,{slot:"start"},r.a.createElement(s.d,{onClick:function(){null===u&&null!=D||null!==u&&u.Notes!==D?L(I,O,M,D,!0):t("")}},r.a.createElement(s.m,{icon:m.c,mode:"md",slot:"icon-only"}))),r.a.createElement(s.O,{className:"IonTitle--DailyNote"},"Daily Notes"))),r.a.createElement(s.h,{class:"edit-daily-modal-content"},r.a.createElement(s.r,null,r.a.createElement(vt,{currentDepartment:I,onDepartmentUpdate:function(e){e.location.id===I.location.id&&e.department===I.department||(S(e),L(I,O,M,D,!1),U(e,O,M))}}),r.a.createElement(s.o,null,r.a.createElement(s.p,null,"Viewable By"),r.a.createElement(s.F,{interface:"popover",value:O,onIonChange:function(e){var t;(t=e.detail.value)!==O&&(k(t),L(I,O,M,D,!1),U(I,t,M))}},r.a.createElement(s.G,{value:1,key:1},"Employees"),r.a.createElement(s.G,{value:2,key:2},"Admins"))),r.a.createElement(s.o,null,r.a.createElement(s.p,null,"Date"),r.a.createElement(s.i,{displayFormat:"DDDD M / DD / YYYY",pickerFormat:"MMM DD YYYY",min:"2005-01-01",max:"2030-01-01",value:M.toISOString(),onIonChange:function(e){!function(e){if(null!==e&&void 0!==e){var t=Object(be.a)(e);t!==M&&(R(t),L(I,O,M,D,!1),U(I,O,t))}}(e.detail.value)}})),r.a.createElement(s.o,null,r.a.createElement(s.N,{value:D,placeholder:"Enter a Note",rows:5,spellcheck:!0,wrap:"hard",debounce:50,onIonChange:function(e){var t;null!==(t=e.detail.value)&&void 0!==t&&(t.length!==A.current&&(A.current=t.length),t!==D&&x(t))}})),r.a.createElement("div",{className:"character-counter"},A.current,"/180"))),E.alertBoxJsx,g.dialogBoxJsx,f.simpleToastJsx):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,"Loading"),E.alertBoxJsx)},Ct=function(e){var t=e.note,n=e.onForceRefresh,o=Object(be.a)(t.EventStart),c=-1===t.DepartmentId?"All Depts":t.DepartmentName,i=Object(a.useState)(!1),l=Object(d.a)(i,2),u=l[0],m=l[1],p=Object(a.useContext)(pe).auth;return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"card daily-note",onClick:function(){if(p.role!==te.Employee)return!!rt(p,t.LocationId,t.DepartmentId,ce.CanEditSchedules)&&void m(!0)}},r.a.createElement("div",{className:"card-first-col"},r.a.createElement("div",{className:"day-name"},Object(ee.a)(o,"EEE")," "),r.a.createElement("div",{className:"day-number"},Object(ee.a)(o,"d"))),r.a.createElement("div",{className:"card-second-col"},r.a.createElement("div",{className:"first-row"},c,": ",1===t.Role?"Employees":"Admins",r.a.createElement("br",null),t.Notes))),r.a.createElement(s.x,{isOpen:u,onDidDismiss:function(){return m(!1)}},r.a.createElement(kt,{isOpen:u,note:t,onCloseModal:function(e){return n(e),void m(!1)},initialDate:new Date,newNoteClicked:!0})))};var jt,It=function(e){var t=e.date,n=e.onForceRefresh,o=Object(a.useState)(!1),c=Object(d.a)(o,2),i=c[0],l=c[1];if(!function(e){if(e.role===te.Employee)return!1;if(e.role===te.BusinessAdmin||e.role===te.LocationAdmin)return!0;for(var t=0;t<e.locations.length;t++){var n=e.locations[t];if(n.adminAllDepts)return!0;for(var a=0;a<n.departments.length;a++)if(n.departments[a].isDeptAdmin)return!0}return!1}(Object(a.useContext)(pe).auth))return r.a.createElement("span",null);return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"add-daily-note-button",onClick:function(){l(!0)}},"+ Daily Note"),r.a.createElement(s.x,{isOpen:i,onDidDismiss:function(){return l(!1)}},r.a.createElement(kt,{isOpen:i,note:null,initialDate:t,onCloseModal:function(e){var t;t=e,l(!1),n(t)},newNoteClicked:!0})))},St=function(e){var t=e.locations,n=e.header,a=e.events,o=e.notes,c=e.showEmployeeNames,i=e.onEdit,l=e.dailyNotesAddButtonDate,s=e.onForceRefresh,u=t.filter((function(e){return e.departments.filter((function(e){return e.positions.filter((function(e){return e.hasPosition}))}))})).length>1;return 0===a.length?r.a.createElement("div",null):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"header"},n,null!==l&&r.a.createElement(It,{onForceRefresh:s,date:l})),r.a.createElement("div",null,o.map((function(e){return r.a.createElement(Ct,{onForceRefresh:s,key:e.DailyNoteId,note:e,location:t.filter((function(t){return t.id===e.LocationId}))[0]})}))),r.a.createElement("div",null,a.map((function(e){return r.a.createElement(ft,{onEdit:i,key:e.ScheduleEventId,event:e,location:t.filter((function(t){return t.id===e.LocationId}))[0],multiLocation:u,showEmployeeName:c})}))))},Tt=function(e,t,n,a){var r=new A;if(0===e.length&&0===t.length)return r;var o=new Date(2199,1,1);if(e.length>0&&(o=Ae(Object(be.a)(e[0].EventStart),n.DayWeekStartsOn,n.DayStartTime)),t.length>0){var c=Ae(Object(be.a)(t[0].EventStart),n.DayWeekStartsOn,n.DayStartTime);Object(Ve.a)(c,o)&&(o=c)}var i=Object(Ce.a)(o,6),l="".concat(Object(ee.a)(o,"MMM d")," - ").concat(Object(ee.a)(i,"MMM d")).toUpperCase()+" "+function(e){if(e<60)return"(".concat(e,"m)");var t="(".concat(Math.floor(e/60),"h");return e%60===0?t+")":t+" ".concat(e%60,"m)")}(a.map((function(e){return Se(e.time)})).reduce((function(e,t){return e+t}),0));return r.add(l,{events:e,notes:t,date:o}),r},Nt=function(e){var t=e.events,n=e.listType,a=e.notes,o=e.hoursPerDay,c=e.auth,i=e.onEdit,l=e.onForceRefresh;if(0===t.length)return r.a.createElement("div",null,"No Events");var s=new A;switch(n){case"requests":s=function(e,t,n){var a=new A;return a.add("MY REQUESTS",{events:e.filter((function(e){return e.EmployeeId===n})),notes:[],date:null}),a.add("CO-WORKERS",{events:e.filter((function(e){return e.EmployeeId!==n})),notes:[],date:null}),a}(t,0,c.employeeId);break;case"my":s=Tt(t,a,c.locations[0].settings,o);break;default:s=function(e,t){var n=new A;return e.map((function(e){var a=Object(ee.a)(Object(be.a)(e.EventStart).setHours(0,0,0,0),"MMM d, yyyy").toUpperCase();if(!n.containsKey(a)){var r=t.filter((function(e){return Object(ee.a)(Object(be.a)(e.EventStart).setHours(0,0,0,0),"MMM d, yyyy").toUpperCase()===a}));n.add(a,{notes:r,events:[],date:Object(be.a)(e.EventStart)})}return n.item(a).events.push(e),a})),n}(t,a)}return r.a.createElement(r.a.Fragment,null,s.keys().map((function(e){return r.a.createElement(St,{onEdit:i,key:e,header:e,locations:c.locations,events:s.item(e).events,notes:s.item(e).notes,showEmployeeNames:"my"!==n&&"MY REQUESTS"!==e,showTotalDuration:"requests"!==n,dailyNotesAddButtonDate:s.item(e).date,onForceRefresh:l})})))};!function(e){e[e.All=-1]="All",e[e.Scheduled=-2]="Scheduled",e[e.DontWork=-3]="DontWork",e[e.ClockAndSched=-6]="ClockAndSched",e[e.Custom=0]="Custom"}(jt||(jt={}));var Dt=jt,xt=function(e,t){if(!e||!e.locations||0===e.locations.length)return[];var n=e.locations[0].settings,a=[{value:We.Shift,text:"SHIFT",color:"green"},{value:We.Cover,text:"COVER",color:"red"}];if(t&&a.unshift({value:-1,text:"ALL",color:"black"}),a.push({value:We.Clock,text:"CLOCK",color:"green"}),n.ShowUnavailableEventType&&a.push({value:We.Unavailable,text:"UNAVAILABLE",color:"yellow"}),n.ShowVacationEventType&&a.push({value:We.Vacation,text:"VACATION",color:"yellow"}),n.ShowAbsentEventType){var r=[],o={};return e.locations.flatMap((function(e){return e.departments.flatMap((function(t){return t.positions.map((function(t){return o[t.id]=e}))}))})),e.payrollEvents.map((function(e){return e.name.startsWith("--")?null:(t?e.positionIds.some((function(e){return t.positionIds.indexOf(e)>=0}))&&r.push({value:e.id,text:"".concat(e.name," (").concat(o[e.positionIds[0]].name,")"),color:"yellow"}):r.push({value:e.id,text:"".concat(e.name," (").concat(o[e.positionIds[0]].name,")"),color:"yellow"}),e)})),r.sort((function(e,t){return e.text>t.text?1:-1})),a.concat(r)}return a},At={areEqual:function(e,t){if(!e&&t||e&&!t)return!1;if(!e&&!t)return!0;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!At.contains(t,e[n]))return!1;return!0},contains:function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return!0;return!1},containsAny:function(e,t){for(var n=0;n<e.length;n++)if(t.includes(e[n]))return!0;return!1},unique:function(e){var t=[];return e.map((function(e){At.contains(t,e)||t.push(e)})),t},uniqueObject:function(e,t){var n=[];return e.map((function(e){for(var a=!1,r=0;r<n.length;r++)if(t(n[r],e)){a=!0;break}a||n.push(e)})),n}},wt=At,Pt=function(e){var t=e.auth,n=e.filter,o=e.onDismissModal,c=e.onCancelModal,i=e.isOpen,l=Object(a.useState)(n),u=Object(d.a)(l,2),f=u[0],E=u[1],v=Object(a.useState)(!1),h=Object(d.a)(v,2),g=h[0],b=h[1],y=Object(a.useState)(Dt.ClockAndSched),O=Object(d.a)(y,2),k=O[0],C=O[1],j=Object(a.useState)(xt(t,n)),I=Object(d.a)(j,2),S=I[0],T=I[1],N=Object(a.useState)(t.locations.map((function(e){return""+e.id}))),D=Object(d.a)(N,2),x=D[0],A=D[1],w=Object(a.useState)(t.locations.flatMap((function(e){return e.departments})).map((function(e){return""+e.id}))),P=Object(d.a)(w,2),M=P[0],R=P[1],U=Object(a.useState)(t.locations.flatMap((function(e){return e.departments})).flatMap((function(e){return e.positions})).map((function(e){return""+e.id}))),L=Object(d.a)(U,2),F=L[0],B=L[1],z=Object(a.useState)(!1),V=Object(d.a)(z,2),q=V[0],W=V[1];Object(a.useEffect)((function(){E(n)}),[n]),Object(a.useEffect)((function(){i&&W(!1)}),[i]);var G=function(e){return Object(p.a)({},Fe,{start:n.start,end:n.end,tagId:-1,positionIds:e.locations.flatMap((function(e){return e.departments.flatMap((function(e){return e.positions.map((function(e){return e.id}))}))})),dnLocIds:e.locations.map((function(e){return e.id})),settingsLocId:e.locations[0].id})},_=function(e){var t,n;C(e),W(!0),E((t=f,(n=e)===Dt.Custom?Object(p.a)({},t,{eventTypeId:-1,eventStatusId:-1}):Object(p.a)({},t,{eventTypeId:n,eventStatusId:n}))),b(e===Dt.Custom)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(s.l,{className:"ion-no-border"},r.a.createElement(s.R,null,r.a.createElement(s.e,{slot:"start"},r.a.createElement(s.d,{onClick:function(){c()}},r.a.createElement(s.m,{icon:m.c,mode:"md",slot:"icon-only"}))),r.a.createElement(s.O,null,"Filter"),r.a.createElement(s.e,{slot:"end"},r.a.createElement(s.d,{onClick:function(){b(!1),C(Dt.ClockAndSched),T(xt(t,n)),A(t.locations.map((function(e){return""+e.id}))),R(t.locations.flatMap((function(e){return e.departments})).map((function(e){return""+e.id}))),B(t.locations.flatMap((function(e){return e.departments})).flatMap((function(e){return e.positions})).map((function(e){return""+e.id}))),E(G(t)),W(!0)}},"RESET")))),r.a.createElement(s.h,{class:"outer-content"},r.a.createElement(s.o,null,r.a.createElement(s.p,null,"Events"),r.a.createElement(s.F,{value:k,onIonChange:function(e){return _(e.detail.value)},interface:"action-sheet"},r.a.createElement(s.G,{value:Dt.ClockAndSched},"Clock + Sched"),r.a.createElement(s.G,{value:Dt.Scheduled},"Scheduled"),r.a.createElement(s.G,{value:Dt.DontWork},"Don't Work"),r.a.createElement(s.G,{value:Dt.Custom},"Custom"),r.a.createElement(s.G,{value:Dt.All},"All"))),g&&r.a.createElement(s.o,null,r.a.createElement(s.p,null,"Type"),r.a.createElement(s.F,{value:f.eventTypeId,onIonChange:function(e){return E(Object(p.a)({},f,{eventTypeId:e.detail.value}))},interface:"action-sheet"},S.map((function(e){return r.a.createElement(s.G,{key:e.value,value:e.value},e.text)})))),g&&r.a.createElement(s.o,null,r.a.createElement(s.p,null,"Status"),r.a.createElement(s.F,{value:f.eventStatusId,onIonChange:function(e){return E(Object(p.a)({},f,{eventStatusId:e.detail.value}))},interface:"action-sheet"},r.a.createElement(s.G,{value:-1},"All"),r.a.createElement(s.G,{value:1},"Approved"),r.a.createElement(s.G,{value:2},"Request"),r.a.createElement(s.G,{value:4},"Request Denied"))),r.a.createElement(s.o,null,r.a.createElement(s.p,null,"Tags"),r.a.createElement(s.F,{value:f.tagId||-1,onIonChange:function(e){E(Object(p.a)({},f,{tagId:e.detail.value})),W(!0)},interface:"action-sheet"},r.a.createElement(s.G,{key:-1,value:-1},"ALL"),t.tags.map((function(e){return r.a.createElement(s.G,{key:e.id,value:e.id},"~",e.name)})))),t.locations.length>1&&r.a.createElement(s.o,null,r.a.createElement(s.p,null,"Locations"),r.a.createElement(s.F,{multiple:!0,onIonChange:function(e){return n=e.detail.value,A(n),W(!0),R(t.locations.filter((function(e){return n.indexOf(e.id.toString())>=0})).flatMap((function(e){return e.departments})).map((function(e){return""+e.id}))),void T(xt(t,f));var n},value:x},t.locations.map((function(e){return r.a.createElement(s.G,{key:e.id,value:e.id.toString()},e.name)})))),t.locations.flatMap((function(e){return e.departments})).length>1&&r.a.createElement(s.o,null,r.a.createElement(s.p,null,"Departments"),r.a.createElement(s.F,{multiple:!0,onIonChange:function(e){return n=e.detail.value,R(n),W(!0),void B(t.locations.filter((function(e){return x.indexOf(e.id.toString())>=0})).flatMap((function(e){return e.departments})).flatMap((function(e){return e.positions})).map((function(e){return""+e.id})));var n},value:M},t.locations.filter((function(e){return x.indexOf(e.id.toString())>=0})).map((function(e){return e.departments.map((function(t){return r.a.createElement(s.G,{key:t.id,value:t.id.toString()},e.abbr,"/",t.name)}))})))),t.locations.flatMap((function(e){return e.departments})).flatMap((function(e){return e.positions})).length>1&&r.a.createElement(s.o,null,r.a.createElement(s.p,null,"Positions"),r.a.createElement(s.F,{multiple:!0,onIonChange:function(e){return t=e.detail.value,B(t),void W(!0);var t},value:F},t.locations.filter((function(e){return x.indexOf(e.id.toString())>=0})).flatMap((function(e){return e.departments})).filter((function(e){return M.indexOf(e.id.toString())>=0})).map((function(e){return e.positions.map((function(e){return r.a.createElement(s.G,{key:e.id,value:e.id.toString()},e.name)}))}))))),r.a.createElement(s.j,null,r.a.createElement(s.d,{className:"apply-button",expand:"block",onClick:function(){var e=F.map((function(e){return parseInt(e)})),n=G(t),a=Object(p.a)({},f,{positionIds:e}),r=!(n.eventTypeId===a.eventTypeId&&n.eventStatusId===a.eventStatusId&&n.tagId===a.tagId&&wt.areEqual(n.positionIds,a.positionIds));o(a,r)},disabled:!q},"APPLY FILTER")))};var Mt=function(e){var t=Object(a.useRef)(null),n={ionicRefresherJsx:r.a.createElement(s.z,{slot:"fixed",ref:t,onIonRefresh:e},r.a.createElement(s.A,{pullingIcon:"arrow-dropdown",pullingText:"Pull down to refresh",refreshingSpinner:"dots",refreshingText:"Refreshing..."}))};return Object(p.a)({},n)},Rt=function(e){var t=e.auth,n=e.editorValues,o=e.update,c=e.eventTypes,i=e.eventStatuses,l=Object(a.useState)(We.Shift),u=Object(d.a)(l,2),m=u[0],p=u[1],f=Object(a.useState)(_e.Approved),E=Object(d.a)(f,2),v=E[0],h=E[1],g=Object(a.useState)("Ex: 00:00"),b=Object(d.a)(g,2),y=b[0],O=b[1],k=Object(a.useState)(null),C=Object(d.a)(k,2),j=C[0],I=C[1],S=Object(a.useState)(null),T=Object(d.a)(S,2),N=T[0],D=T[1];Object(a.useEffect)((function(){-1!==n.scheduleEventId&&(t.role===te.Employee&&n.scheduleEventId<=0&&v!==_e.Request&&o({type:"TYPESTATUS-UPDATED",eventType:m,eventStatus:_e.Request,absentId:n.absentId,absentTimeMinutes:n.absentTimeMinutes}),n.absentId?p(n.absentId):p(n.eventType),h(n.eventStatus))}),[t,n.eventType,n.eventStatus,n.position,n.absentId,n.scheduleEventId]),Object(a.useEffect)((function(){-1!==n.scheduleEventId&&j&&D(null===n.absentTimeMinutes?null:function(e,t){if(e.TimeFormat===re.HoursMinutes){if(null===t)return"00:00";var n=Math.floor(t/60),a=t%60;return"".concat(Me(n,2),":").concat(Me(a,2))}return null===t?"0":Pe(t/60,e.TimeFormatDigits,e.TimeFormatDecimals)}(j,n.absentTimeMinutes))}),[j,n.absentTimeMinutes,n.scheduleEventId]),Object(a.useEffect)((function(){if(-1!==n.scheduleEventId&&(!j||n.locationId!==j.LocationId)&&t&&t.locations&&0!==t.locations.length){var e=Je(t,n.locationId);I(e),O(e.TimeFormat===re.HoursMinutes?"Ex: 00:00":"Ex: 0.0")}}),[n.locationId,n.scheduleEventId]),Object(a.useEffect)((function(){n.scheduleEventId>0&&h(n.eventStatus)}),[n.eventStatus,n.scheduleEventId]);var x=function(e){if(void 0===e&&(e=null),null!=e){var t=function(e,t){if(!t||0===t.length)return 0;if(e.TimeFormat===re.HoursMinutes){if(!/^\d*(:\d{2})?$/.test(t))return 0;if(":"===t[0])return parseInt(t.substring(1));var n=t.split(":");return 1===n.length?60*parseInt(t):60*parseInt(n[0])+parseInt(n[1])}return/^\d+(.\d*)?$/.test(t)?Math.round(60*parseFloat(t)):0}(j,e);t!==n.absentTimeMinutes&&o({type:"TYPESTATUS-UPDATED",eventType:m,eventStatus:v,absentId:m>=100?m:void 0,absentTimeMinutes:t})}else o({type:"TYPESTATUS-UPDATED",eventType:m,eventStatus:v,absentId:m>=100?m:void 0,absentTimeMinutes:null})};return r.a.createElement(r.a.Fragment,null,r.a.createElement(s.C,{className:"edit-row"},r.a.createElement(s.g,{size:"3"},r.a.createElement(s.p,{className:"label"},"Type")),r.a.createElement(s.g,{size:"9"},r.a.createElement(s.F,{className:"select",interface:"popover",disabled:n.isReadonly,value:m,onIonChange:function(e){!function(e){if(e!==n.eventType){p(e);var t=e!==We.Absent&&e<100?null:n.absentTimeMinutes;o({type:"TYPESTATUS-UPDATED",eventType:e,eventStatus:v,absentId:e>=100?e:void 0,absentTimeMinutes:t})}}(e.detail.value)}},c.map((function(e){return r.a.createElement(s.G,{key:e.value,value:e.value},e.text)}))))),r.a.createElement(s.C,{className:"edit-row"},r.a.createElement(s.g,{size:"3"},r.a.createElement(s.p,{className:"label"},"Status")),r.a.createElement(s.g,{size:"9"},r.a.createElement(s.F,{className:"select",interface:"popover",disabled:n.isReadonly||t.role===te.Employee&&n.scheduleEventId<=0,value:v,onIonChange:function(e){var t;(t=e.detail.value)!==n.eventStatus&&(h(t),o({type:"TYPESTATUS-UPDATED",eventType:m,eventStatus:t,absentId:m>=100?m:void 0,absentTimeMinutes:n.absentTimeMinutes}))}},i&&i.map((function(e){return r.a.createElement(s.G,{key:e.value,value:e.value},e.text)}))))),r.a.createElement(s.C,{className:m>100?"visible edit-row":"invisible"},r.a.createElement(s.g,{size:"3"},r.a.createElement(s.p,{className:"label"},"Hours")),r.a.createElement(s.g,{size:"9"},r.a.createElement(s.n,{className:"input-textbox",placeholder:y,disabled:n.isReadonly,value:N,onIonChange:function(e){e.detail.value&&D(e.detail.value)},onIonBlur:function(){x(N)}}))))},Ut=function(e){var t=e.auth,n=e.editorValues,o=e.update,c=Object(a.useState)({location:{},position:{}}),i=Object(d.a)(c,2),l=i[0],u=i[1],m=Object(a.useState)([]),p=Object(d.a)(m,2),f=p[0],E=p[1];Object(a.useEffect)((function(){if(-1!==n.scheduleEventId&&t&&t.locations&&t.locations.length>0)if(n.position&&n.scheduleEventId>0){var e=ct(t.locations,n.position.location.id,n.position.position.id);e.position.id!==l.position.id&&u(e)}else{var a=ct(t.locations,t.locations[0].id,t.locations[0].departments[0].positions[0].id);u(a)}}),[n.position,t,n.scheduleEventId]),Object(a.useEffect)((function(){-1!==n.scheduleEventId&&t&&t.locations&&t.locations.length>0&&E(function(e){var t=e.length>1;return e.flatMap((function(e){return e.departments.flatMap((function(n){return n.positions.map((function(a){var r=e.departments.length>1,o="";return t&&(o+=(e.abbr?e.abbr:e.name)+"/"),r&&(o+=(n.abbr?n.abbr:n.name)+"/"),o+=a.name,{id:a.id,name:o}}))}))}))}(t.locations))}),[t,n.scheduleEventId]);return r.a.createElement(s.C,{className:"edit-row"},r.a.createElement(s.g,{size:"3"},r.a.createElement(s.p,{className:"label"},"Position")),r.a.createElement(s.g,{size:"9"},r.a.createElement(s.F,{className:"select",interface:"popover",disabled:n.isReadonly,value:l.position.id,onIonChange:function(e){return function(e){var a=it(t.locations,e);a.position.id!==n.position.position.id&&(u(a),o({type:"POSITION-UPDATED",selectedPosition:a}))}(e.detail.value)}},f.map((function(e){return r.a.createElement(s.G,{key:e.id,value:e.id},e.name)})))))},Lt={getEmployeesByLocationIdPositionIdAndActiveDateRange:function(){var e=Object(v.a)(E.a.mark((function e(t,n,a,r,o,c){var i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={locId:n,posId:a,start:we(r),end:we(o),sort:c},e.next=3,V.post(t,"api/v2/employees/at-position",i);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n,a,r,o,c){return e.apply(this,arguments)}}(),getEmployeeListForCommunication:function(){var e=Object(v.a)(E.a.mark((function e(t,n,a,r,o,c){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.post(t,"api/v2/employees/get-communication-list",{locId:n,depId:a,posId:r,channel:o,role:c});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n,a,r,o,c){return e.apply(this,arguments)}}()};function Ft(e){var t=Object(a.useState)(!1),n=Object(d.a)(t,2),o=n[0],c=n[1],i=r.a.createElement(s.t,{isOpen:o,onDidDismiss:function(){return c(!1)},spinner:"dots",message:e,duration:1e4});return{showLoading:o,setShowLoading:c,showLoadingJsx:i}}var Bt,zt=function(e){var t=e.auth,n=e.editorValues,o=e.update,c=Object(a.useState)([]),i=Object(d.a)(c,2),l=i[0],u=i[1],m=Ft("Please wait..."),p=Object(a.useState)(-1),f=Object(d.a)(p,2),E=f[0],v=f[1],h=Object(a.useContext)(K).user;Object(a.useEffect)((function(){h&&h.isLoggedin&&-1!==n.scheduleEventId&&(m.setShowLoading(!0),g(n))}),[h,n.position.position.id,n.scheduleEventId]);var g=function(e){Lt.getEmployeesByLocationIdPositionIdAndActiveDateRange(h,n.position.location.id,n.position.position.id,Object(be.a)(n.eventStart),Object(be.a)(n.eventEnd),n.position.location.settings.EmployeeSort).then((function(a){u(a);var r=a.map((function(e){return e.id}));if(0===n.scheduleEventId&&r.includes(t.employeeId)){v(t.employeeId);var c=a.filter((function(e){return e.id===t.employeeId}))[0];o({type:"EMPLOYEE-UPDATED",employee:{id:c.id,name:c.name}})}else{var i=r.includes(e.employee.id)?e.employee.id:-1;v(i)}m.setShowLoading(!1)}))};return 0===l.length?r.a.createElement(r.a.Fragment,null,r.a.createElement(s.C,{className:"edit-row"},r.a.createElement(s.g,{size:"3"},r.a.createElement(s.p,{className:"label"},"Employee")),r.a.createElement(s.g,{size:"9"},r.a.createElement(s.F,{className:"select",interface:"popover",value:-5},r.a.createElement(s.G,{key:"-5",value:"-5"},n.employee.name)))),m.showLoadingJsx):r.a.createElement(r.a.Fragment,null,r.a.createElement(s.C,{className:"edit-row"},r.a.createElement(s.g,{size:"3"},r.a.createElement(s.p,{className:"label"},"Employee")),r.a.createElement(s.g,{size:"9"},r.a.createElement(s.F,{className:"select",interface:"popover",disabled:n.isReadonly,value:E,onIonChange:function(e){!function(e){if(-5!==e&&e!==n.employee.id){v(e);var t=l.filter((function(t){return t.id===e}))[0];o(-1===e?{type:"EMPLOYEE-UPDATED",employee:{id:-1,name:"SELECT EMPLOYEE"}}:{type:"EMPLOYEE-UPDATED",employee:{id:e,name:t.name}})}}(e.detail.value)}},r.a.createElement(s.G,{key:-1,value:-1},"Select Employee"),l.map((function(e){return r.a.createElement(s.G,{key:e.id,value:e.id},e.name)}))))),m.showLoadingJsx)},Vt=function(e){var t=e.editorValues,n=e.update;return r.a.createElement(r.a.Fragment,null,r.a.createElement(s.C,{className:"edit-row"},r.a.createElement(s.g,{size:"3"},r.a.createElement(s.p,{className:"label"},"Start")),r.a.createElement(s.g,{size:"9"},r.a.createElement(s.i,{className:"select",displayFormat:"M/D/YY h:mma",disabled:t.isReadonly,pickerFormat:"MMM DD YYYY h:mm A",min:"2005-01-01",max:"2030-01-01",minuteValues:"0,5,10,15,20,25,30,35,40,45,50,55",value:t.eventStart,onIonChange:function(e){var a;(a=e.detail.value)&&Object(be.a)(a)!==Object(be.a)(t.eventStart)&&n({type:"START-UPDATED",eventStart:a})}}))),r.a.createElement(s.C,{className:"edit-row"},r.a.createElement(s.g,{size:"3"},r.a.createElement(s.p,{className:"label"},"End")),r.a.createElement(s.g,{size:"9"},r.a.createElement(s.i,{className:"select",displayFormat:"M/D/YY h:mma",disabled:t.isReadonly||t.isClockedIn,pickerFormat:"MMM DD YYYY h:mm A",min:"2005-01-01",max:"2030-01-01",minuteValues:"0,5,10,15,20,25,30,35,40,45,50,55",value:t.eventEnd,onIonChange:function(e){var a;(a=e.detail.value)&&Object(be.a)(a)!==Object(be.a)(t.eventEnd)&&n({type:"END-UPDATED",eventEnd:a})}}))))},qt=n(30),Wt=n(220),Gt=n(221),_t=n(222),Yt=function(e,t,n){var a=e,r=t,o=!1;return n.map((function(e){var t=Object(Wt.a)(Object(be.a)(e.BreakStart),3),n=e.BreakEnd?Object(Wt.a)(Object(be.a)(e.BreakEnd),-3):new Date(2200,1,1);return a<n&&r>t&&(o=!0),o})),o},Jt=function(e){var t=e.onCancel,n=e.onAdd,o=e.currentBreaks,c=e.eventStart,i=e.eventEnd,l=Object(a.useState)(Object(Gt.a)(Object(_t.a)(new Date,12),0)),u=Object(d.a)(l,2),m=u[0],p=u[1],f=Object(a.useState)(Object(Gt.a)(Object(_t.a)(new Date,13),0)),E=Object(d.a)(f,2),v=E[0],h=E[1],g=Object(a.useState)(!1),b=Object(d.a)(g,2),y=b[0],O=b[1],k=Object(a.useState)(!1),C=Object(d.a)(k,2),j=C[0],I=C[1],S=Object(a.useState)(""),T=Object(d.a)(S,2),N=T[0],D=T[1],x=Object(a.useState)(!0),A=Object(d.a)(x,2),w=A[0],P=A[1],M=$();return r.a.createElement(r.a.Fragment,null,r.a.createElement(s.h,null,r.a.createElement(s.l,{mode:"ios"},r.a.createElement(s.R,null,r.a.createElement(s.O,null,"Add Break"))),r.a.createElement(s.k,null,r.a.createElement(s.C,null,r.a.createElement(s.g,{className:"label",size:"3"},"Start"),r.a.createElement(s.g,{size:"9"},r.a.createElement(s.i,{className:"select",displayFormat:"h:mm a",pickerFormat:"h:mm A",min:"2005-01-01",max:"2030-01-01",minuteValues:"0,5,10,15,20,25,30,35,40,45,50,55",value:m.toISOString(),onIonChange:function(e){return function(e){var t=Object(be.a)(e);p(t),Object(Ve.a)(t,v)?Object(be.a)(c)>t?(P(!1),D("Start before Event begins")):Yt(t,v,o)?(P(!1),D("Pre-existing break overlaps")):(P(!0),D("")):(P(!1),D("Start must be before End"))}(e.detail.value)}}))),r.a.createElement(s.C,null,r.a.createElement(s.g,{className:"label",size:"3"},"End"),r.a.createElement(s.g,{size:"9"},r.a.createElement(s.i,{className:"select",displayFormat:"h:mm a",pickerFormat:"h:mm A",min:"2005-01-01",max:"2030-01-01",minuteValues:"0,5,10,15,20,25,30,35,40,45,50,55",value:v.toISOString(),onIonChange:function(e){return function(e){var t=Object(be.a)(e);h(t),Object(je.a)(t,m)?t>Object(be.a)(i)?(P(!1),D("End after Event ends")):Yt(m,t,o)?(P(!1),D("Pre-existing break overlaps")):(P(!0),D("")):(P(!1),D("End must be after Start"))}(e.detail.value)}}))),r.a.createElement(s.C,null,r.a.createElement(s.g,{className:"label",size:"3"}),r.a.createElement(s.g,{size:"9",className:"error-message"},N)),r.a.createElement(s.C,null,r.a.createElement(s.g,{size:"12"},r.a.createElement("div",{style:{width:"100%",borderBottom:"1px solid #AAA"}}))),r.a.createElement(s.C,null,r.a.createElement(s.g,{size:"3"},r.a.createElement(s.f,{className:"checkbox",checked:y,onIonChange:function(e){O(e.detail.checked)}})),r.a.createElement(s.g,{className:"label",size:"9"},"Restricted Break")),r.a.createElement(s.C,null,r.a.createElement(s.g,{size:"3"},r.a.createElement(s.f,{className:"checkbox",onIonChange:function(e){I(e.detail.checked)}})),r.a.createElement(s.g,{className:"label",size:"9"},"Paid Break")))),r.a.createElement(s.j,null,r.a.createElement(s.d,{expand:"block",color:"secondary",onClick:function(){m>v?M.showAlert("Invalid Start / End","Start of break cannot come after end of break.",(function(){})):n(m,v,y,j)},disabled:!w},"ADD"),r.a.createElement(s.d,{expand:"block",onClick:t},"CANCEL")),M.alertBoxJsx)},Ht=function(e){var t=e.editorValues,n=e.update,o=Object(a.useState)([]),c=Object(d.a)(o,2),i=c[0],l=c[1],u=Object(a.useState)(!1),p=Object(d.a)(u,2),f=p[0],E=p[1];Object(a.useEffect)((function(){-1!==t.scheduleEventId&&l(t.eventBreaks)}),[t.eventBreaks,t.scheduleEventId]);return t.eventType===We.Clock||tt(t.eventType,t.eventStatus)?r.a.createElement(r.a.Fragment,null,r.a.createElement(s.C,{className:"edit-row",style:{marginBottom:"20px"}},r.a.createElement(s.g,{size:"3"},r.a.createElement(s.d,{color:"light",disabled:t.isReadonly,onClick:function(){E(!0)}},r.a.createElement(s.m,{slot:"icon-only",icon:m.a,color:"dark"}))),r.a.createElement(s.g,{size:"9"},(!i||0===i.length)&&r.a.createElement("div",{className:"break-div"},"(B) NONE"),i&&i.map((function(e){return r.a.createElement("div",{key:e.BreakStart,className:"break-div"},"(B) ",De(e),e.IsPaidBreak?r.a.createElement(s.m,{className:"paid-icon",icon:m.p}):r.a.createElement("span",null),function(e){return e.IsRestricted?r.a.createElement(s.m,{className:"restricted-icon",icon:m.n}):r.a.createElement("span",null)}(e),r.a.createElement("button",{disabled:t.isReadonly,onClick:function(){!function(e){var t=i.filter((function(t){return t.BreakStart!==e}));l(t),n({type:"EVENTBREAKS-UPDATED",breaks:t})}(e.BreakStart)}},r.a.createElement(s.m,{slot:"icon-only",mode:"ios",icon:m.x,color:"gray"})))})))),r.a.createElement(s.x,{isOpen:f,cssClass:"add-break-modal",onDidDismiss:function(){return E(!1)}},r.a.createElement(Jt,{onCancel:function(){E(!1)},onAdd:function(e,a,r,o){E(!1);var c={BreakStart:we(e),BreakEnd:we(a),IsRestricted:r,IsPaidBreak:o,ScheduleEventId:t.scheduleEventId},s=[].concat(Object(qt.a)(i),[c]);l(s),n({type:"EVENTBREAKS-UPDATED",breaks:s})},currentBreaks:i,eventStart:t.eventStart,eventEnd:t.eventEnd}))):r.a.createElement("div",null)},Kt=function(e){var t=e.auth,n=e.editorValues,o=e.update,c=Object(a.useState)(-1),i=Object(d.a)(c,2),l=i[0],u=i[1],m=Object(a.useState)([]),p=Object(d.a)(m,2),f=p[0],E=p[1];Object(a.useEffect)((function(){if(-1!==n.scheduleEventId&&t&&t.locations&&t.locations.length>0){var e=t.tags.filter((function(e){return e.positionIds.includes(n.position.position.id)})).map((function(e){return{id:e.id,name:e.name}}));E(e);var a=e.map((function(e){return e.id}));a.includes(l)||(n.tag&&n.tag.id&&a.includes(n.tag.id)?u(n.tag.id):u(-1))}}),[t,n.position,n.scheduleEventId]);return r.a.createElement(s.C,{className:"edit-row"},r.a.createElement(s.g,{size:"3"},r.a.createElement(s.p,{className:"label"},"Tag")),r.a.createElement(s.g,{size:"9"},r.a.createElement(s.F,{className:"select",interface:"popover",disabled:n.isReadonly,value:l,onIonChange:function(e){!function(e){if(u(e),e!==n.tag.id)if(-1===e)o({type:"TAG-UPDATED",tag:{id:-1,name:"NONE"}});else{var t=f.filter((function(t){return t.id===e}))[0];o({type:"TAG-UPDATED",tag:t})}}(e.detail.value)}},r.a.createElement(s.G,{value:-1},"NONE"),f.map((function(e){return r.a.createElement(s.G,{key:e.id,value:e.id},e.name)})))))},Qt=function(e){var t=e.auth,n=e.editorValues,o=e.update,c=Object(a.useState)(!1),i=Object(d.a)(c,2),l=i[0],u=i[1],m=Object(a.useState)(!1),p=Object(d.a)(m,2),f=p[0],E=p[1];Object(a.useEffect)((function(){-1!==n.scheduleEventId&&t&&t.locations&&t.locations.length>0&&u(n.isConfirmed)}),[t,n.eventStart,n.eventEnd,n.isClockedIn,n.scheduleEventId]),Object(a.useEffect)((function(){if(-1!==n.scheduleEventId){var e=n.eventType===We.Shift&&n.eventStatus===_e.Approved||n.eventType===We.Cover&&(n.eventStatus===_e.Request||n.eventStatus===_e.RequestDenied);E(e)}}),[n.eventType,n.eventStatus,n.scheduleEventId]);return f?r.a.createElement(r.a.Fragment,null,r.a.createElement(s.g,{size:"2"},r.a.createElement(s.f,{checked:l,onIonChange:function(e){var t;(t=e.detail.checked)!==l&&f&&(u(t),o({type:"CONFIRM-UPDATED",isConfirmed:t}))}})),r.a.createElement(s.g,{size:"4"},r.a.createElement(s.p,{className:"label"},"Confirm"))):r.a.createElement(r.a.Fragment,null,r.a.createElement(s.g,{size:"0"},r.a.createElement("span",null)),r.a.createElement(s.g,{size:"0"},r.a.createElement("span",null)))},$t=function(e){var t=e.auth,n=e.editorValues,o=e.update,c=Object(a.useState)(!1),i=Object(d.a)(c,2),l=i[0],u=i[1],p=Object(a.useState)(!1),f=Object(d.a)(p,2),E=f[0],v=f[1];Object(a.useEffect)((function(){-1!==n.scheduleEventId&&t&&t.locations&&t.locations.length>0&&u(n.isClockedIn)}),[t,n.eventStart,n.eventEnd,n.isClockedIn,n.scheduleEventId]),Object(a.useEffect)((function(){-1!==n.scheduleEventId&&v(n.eventType===We.Clock)}),[n.eventType,n.eventStatus,n.scheduleEventId]);return E?r.a.createElement(r.a.Fragment,null,r.a.createElement(s.g,{size:"2"},r.a.createElement(s.f,{checked:l,onIonChange:function(e){var t;(t=e.detail.checked)!==l&&E&&(u(t),o({type:"ISCLOCKEDIN-UPDATED",isClockedIn:t}))}})),r.a.createElement(s.g,{size:"4"},r.a.createElement(s.p,{className:"label"},r.a.createElement(s.m,{icon:m.v}),"Clocked In"))):r.a.createElement(r.a.Fragment,null,r.a.createElement(s.g,{size:"0"},r.a.createElement("span",null)),r.a.createElement(s.g,{size:"0"},r.a.createElement("span",null)))},Xt=n(223);!function(e){e[e.Daily=0]="Daily",e[e.Weekly=1]="Weekly",e[e.MonthlyByDayOfMonth=2]="MonthlyByDayOfMonth",e[e.MonthlyByDayOfWeek=3]="MonthlyByDayOfWeek",e[e.Yearly=4]="Yearly"}(Bt||(Bt={}));var Zt=function(e,t){return e.locations.filter((function(e){return e.id===t}))[0]},en=function(e,t){return e.locations.flatMap((function(e){return e.departments.flatMap((function(e){return e.positions.filter((function(e){return e.id===t}))}))}))[0]},tn=function(e,t){var n=Object(be.a)(e),a=Object(be.a)(t);return!!Object(Xt.a)(n,a)||Object(je.a)(a,n)};function nn(e,t){return Object(p.a)({},cn,{eventStatus:t.EventStatusId,eventType:t.EventTypeId,eventStart:t.EventStart,eventEnd:t.EventEnd,notes:t.Notes,isClockedIn:t.IsClockedIn,isConfirmed:t.IsConfirmed,scheduleEventId:t.ScheduleEventId,position:ct(e.locations,t.LocationId,t.PositionId),employee:{id:t.EmployeeId,name:t.FirstName+" "+t.LastName},eventBreaks:t.EventBreaks})}var an,rn=function(e,t,n){if(!n)return!0;if(!t.ClockOutValueLabel||0===t.ClockOutValueLabel.length)return!1;return/^\d*(\.\d{0,2})?$/.test(n)},on=function(e){return e.validEventStartEnd&&e.validEmployee&&e.validTag&&e.validEventTypeStatus&&e.validClockoutValue&&e.validRecurrenceStartEnd&&e.validRepeatInterval&&e.validRepeatWeekdays},cn={scheduleEventId:-1,locationId:0,isUpdating:!1,eventType:We.Shift,eventStatus:_e.Approved,isConfirmed:!1,position:{location:{},position:{}},employee:{id:-1,name:"SELECT EMPLOYEE"},eventStart:we(Object(_t.a)(Object(Gt.a)(new Date,0),8)),eventEnd:we(Object(_t.a)(Object(Gt.a)(new Date,0),17)),tag:{id:-1,name:"SELECT TAG"},eventBreaks:[],isClockedIn:!1,isDirty:!1,valid:!0,validEventStartEnd:!0,validEmployee:!0,validTag:!0,validEventTypeStatus:!0,validClockoutValue:!0,validRecurrenceStartEnd:!0,validRepeatInterval:!0,validRepeatWeekdays:!0,absentId:void 0,absentName:void 0,absentTimeMinutes:null,notes:"",clockoutValue:void 0,isReadonly:!1},ln=function(e,t){switch(console.log("REDUCER: ACTION =",t.type,"   Current State Emp =",e.employee.id),t.type){case"BEGIN-UPDATE":var n=t.ev,a=t.auth,r=function(e){return Object(be.a)(e.EventEnd)>new Date(2199,1,1)}(n);return{scheduleEventId:n.ScheduleEventId,locationId:n.LocationId,isUpdating:!1,eventType:n.EventTypeId,eventStatus:n.EventStatusId,isConfirmed:void 0!==n.ConfirmedBy&&null!==n.ConfirmedBy,position:{location:Zt(a,n.LocationId),position:en(a,n.PositionId)},employee:{id:n.EmployeeId,name:n.FirstName+" "+n.LastName},eventStart:n.EventStart,eventEnd:r?we(new Date):n.EventEnd,tag:{id:n.TagId?n.TagId:-1,name:""},eventBreaks:n.EventBreaks,isClockedIn:r,isDirty:!1,valid:!0,validEventStartEnd:!0,validEmployee:!0,validTag:!0,validEventTypeStatus:!0,validClockoutValue:!0,absentName:n.AbsentName,absentId:n.AbsentId,absentTimeMinutes:n.AbsentTimeMinutes?n.AbsentTimeMinutes:null,notes:n.Notes,clockoutValue:n.ClockOutValue,isReadonly:t.eventEditAuth.isReadonly,recurrenceId:n.EventRecurrenceId,recurrenceStart:n.EventRecurrenceStart,recurrenceEnd:n.EventRecurrenceEnd,recurrenceType:n.RepeatType,repeatInterval:n.RepeatInterval,repeatWeekdays:n.RepeatWeekdays,validRecurrenceStartEnd:!0,validRepeatInterval:!0,validRepeatWeekdays:!0};case"CANCEL":return cn;case"POSITION-UPDATED":var o=t.selectedPosition;return Object(p.a)({},e,{position:o,isDirty:!0});case"CREATE-EVENT":var c=t.auth.locations[0];return Object(p.a)({},cn,{position:{location:c,position:c.departments[0].positions[0]},scheduleEventId:0,isDirty:!0});case"SET-READONLY":return Object(p.a)({},e,{isReadonly:t.isReadonly});case"TYPESTATUS-UPDATED":var i=Object(p.a)({},e,{eventType:t.eventType,eventStatus:t.eventStatus,absentId:t.absentId,absentTimeMinutes:t.absentTimeMinutes,isDirty:!0,validEventTypeStatus:!(t.absentId&&null===t.absentTimeMinutes)});return i.valid=on(i),i;case"CLOCKOUTVALUE-UPDATED":var l=Object(p.a)({},e,{clockoutValue:t.clockoutValue,validClockoutValue:rn(0,t.locSettings,t.clockoutValue),isDirty:!0});return l.valid=on(l),l;case"EMPLOYEE-UPDATED":var s=Object(p.a)({},e,{employee:t.employee,isDirty:!0,validEmployee:t.employee.id>0});return s.valid=on(s),s;case"START-UPDATED":var u=Object(p.a)({},e,{eventStart:t.eventStart,isDirty:!0,validEventStartEnd:tn(t.eventStart,e.eventEnd)});return u.valid=on(u),u;case"END-UPDATED":var d=Object(p.a)({},e,{eventEnd:t.eventEnd,isDirty:!0,validEventStartEnd:tn(e.eventStart,t.eventEnd)});return d.valid=on(d),d;case"EVENTBREAKS-UPDATED":return Object(p.a)({},e,{eventBreaks:t.breaks,isDirty:!0});case"TAG-UPDATED":var m=Object(p.a)({},e,{tag:t.tag,isDirty:!0,validTag:!0});return m.valid=on(m),m;case"CONFIRM-UPDATED":var f=Object(p.a)({},e,{isConfirmed:t.isConfirmed,isDirty:!0});return f.valid=on(f),f;case"NOTES-UPDATED":return Object(p.a)({},e,{notes:t.notes,isDirty:!0});case"ISCLOCKEDIN-UPDATED":var E=Object(p.a)({},e,{isClockedIn:t.isClockedIn,isDirty:!0});if(t.isClockedIn){var v=we(new Date);E.eventStart=v,E.eventEnd=v}return E.valid=on(E),E;case"REPEATING-UPDATED":var h=Object(p.a)({},e,{recurrenceStart:t.recurrenceStart,recurrenceEnd:t.recurrenceEnd,recurrenceType:t.recurrenceType,repeatInterval:t.repeatInterval,repeatWeekdays:t.repeatWeekDays,isDirty:!0});return h.recurrenceStart&&(h.repeatInterval===Bt.Weekly?h.validRepeatWeekdays=null!==h.repeatWeekdays&&void 0!==h.repeatWeekdays&&h.repeatWeekdays.length>0:(h.repeatWeekdays=void 0,h.validRepeatWeekdays=!0),h.recurrenceEnd?h.validRecurrenceStartEnd=Object(Ve.a)(Object(be.a)(h.recurrenceStart),Object(be.a)(h.recurrenceEnd)):h.validRecurrenceStartEnd=!1,h.validRepeatInterval=null!==h.repeatInterval&&void 0!==h.repeatInterval&&h.repeatInterval>0),h.valid=on(h),h;default:return console.error("ERROR in editorValueReducer, could not find action for "+t.type),e}},sn=function(e){var t=e.editorValues,n=e.update;return r.a.createElement(s.C,{className:"edit-row"},r.a.createElement(s.g,{size:"3"},r.a.createElement(s.p,{className:"label"},"Notes")),r.a.createElement(s.g,{size:"9"},r.a.createElement(s.N,{className:"textarea",maxlength:200,rows:4,value:t.notes,disabled:t.isReadonly,onIonChange:function(e){return(a=e.detail.value)||(a=""),void(a!==t.notes&&n({type:"NOTES-UPDATED",notes:a}));var a}})))},un=function(e){var t=e.auth,n=e.editorValues,o=e.update,c=Object(a.useState)(!1),i=Object(d.a)(c,2),l=i[0],u=i[1],m=Object(a.useState)(null),p=Object(d.a)(m,2),f=p[0],E=p[1];Object(a.useEffect)((function(){if(!(0===n.locationId||f&&n.locationId===f.LocationId)&&t&&t.locations&&0!==t.locations.length&&n.locationId){var e=Je(t,n.locationId);E(e)}}),[n.locationId,t]),Object(a.useEffect)((function(){f&&u(void 0!==f.ClockOutValueLabel&&null!==f.ClockOutValueLabel&&f.ClockOutValueLabel.length>0&&n.eventType===We.Clock&&!n.isClockedIn)}),[n.eventType,n.isClockedIn,f]);return l&&null!==f?r.a.createElement(s.C,{className:"edit-row"},r.a.createElement(s.g,{size:"3"},r.a.createElement(s.p,{className:"label"},f.ClockOutValueLabel)),r.a.createElement(s.g,{size:"9"},r.a.createElement(s.n,{className:"input-textbox",value:n.clockoutValue,onIonChange:function(e){return null===(t=e.detail.value)&&(t=void 0),void(t!==n.clockoutValue&&o({type:"CLOCKOUTVALUE-UPDATED",locSettings:f,clockoutValue:t}));var t}}))):r.a.createElement("div",null)},dn={undoCoverRequest:function(){var e=Object(v.a)(E.a.mark((function e(t,n){var a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="api/v1/employee/schedule-events/cover-request/undo?scheduleEventId=".concat(n),e.next=3,V.put(t,a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),createCoverRequest:function(){var e=Object(v.a)(E.a.mark((function e(t,n,a,r,o,c,i){var l;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v1/employee/schedule-events/cover-request/submit",l={ScheduleEventId:n,LocationId:a,BusinessId:r,BroadcastCoverRequestMessage:o,CoverMessage:c,DirectToEmployeeId:i},e.next=4,V.put(t,"api/v1/employee/schedule-events/cover-request/submit",l);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n,a,r,o,c,i){return e.apply(this,arguments)}}(),makeShiftRequest:function(){var e=Object(v.a)(E.a.mark((function e(t,n,a,r,o,c){var i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v2/requests/shift-request/submit",i={ScheduleEventId:n,LocationId:a,BusinessId:r,BroadcastCoverRequestMessage:o,CoverMessage:c},e.next=4,V.put(t,"api/v2/requests/shift-request/submit",i);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n,a,r,o,c){return e.apply(this,arguments)}}(),removeShiftRequest:function(){var e=Object(v.a)(E.a.mark((function e(t,n,a,r,o,c){var i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v1/employee/schedule-events/delete",i={LocationId:n,ScheduleEventId:a,EventTypeId:r,EventStatusId:o,RecUpdateType:c},e.next=4,V.post(t,"api/v1/employee/schedule-events/delete",i);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n,a,r,o,c){return e.apply(this,arguments)}}(),deleteEvent:function(){var e=Object(v.a)(E.a.mark((function e(t,n,a,r,o,c){var i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v1/employee/schedule-events/delete",i={LocationId:n,ScheduleEventId:a,EventTypeId:r,EventStatusId:o,RecUpdateType:c},e.next=4,V.post(t,"api/v1/employee/schedule-events/delete",i);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n,a,r,o,c){return e.apply(this,arguments)}}(),getCoverRequestListItems:function(){var e=Object(v.a)(E.a.mark((function e(t,n,a){var r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"api/v2/requests/transfers/to-list",r={scheduleEventId:n,directCoverList:a},e.next=4,V.post(t,"api/v2/requests/transfers/to-list",r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}()},mn=function(e){var t=e.onCancel,n=e.onOk,o=e.eventEditAuth,c=e.locSettings,i=e.scheduleEventId,l=Object(a.useContext)(K).user,u=Object(a.useState)(""),m=Object(d.a)(u,2),p=m[0],f=m[1],E=Object(a.useState)(null),v=Object(d.a)(E,2),h=v[0],g=v[1],b=Object(a.useState)(null),y=Object(d.a)(b,2),O=y[0],k=y[1];Object(a.useEffect)((function(){o.usage===Ge.CreateCoverRequest&&i>0&&dn.getCoverRequestListItems(l,i,!0).then((function(e){k(e),e&&e.length>0&&g(e[0].value)}))}),[i,o.usage]);return o.usage===Ge.None?r.a.createElement("div",null):r.a.createElement(r.a.Fragment,null,r.a.createElement(s.h,null,r.a.createElement(s.l,{mode:"ios"},r.a.createElement(s.R,null,r.a.createElement(s.O,null,o.buttonText))),r.a.createElement(s.k,null,r.a.createElement(s.C,{hidden:!c.EnableDirectCoverRequest||o.usage!==Ge.CreateCoverRequest},r.a.createElement(s.g,{className:"label",size:"3"},"To"),r.a.createElement(s.g,{size:"9"},r.a.createElement(s.F,{className:"select",value:h,onIonChange:function(e){g(parseInt(e.detail.value))}},O&&O.map((function(e){return r.a.createElement(s.G,{key:e.value,value:e.value,disabled:e.disabled},e.text)}))))),r.a.createElement(s.C,{hidden:o.usage===Ge.CreateCoverRequest},r.a.createElement(s.g,{size:"12"},r.a.createElement("div",{className:"usage-message"},o.text))),r.a.createElement(s.C,{hidden:o.usage!==Ge.CreateCoverRequest},r.a.createElement(s.g,{className:"label",size:"3"},"Notes"),r.a.createElement(s.g,{size:"9"},r.a.createElement(s.N,{className:"select",maxlength:200,rows:4,value:p,onIonChange:function(e){f(e.detail.value)}}))),r.a.createElement(s.C,null,r.a.createElement(s.g,{className:"label",size:"3"}),r.a.createElement(s.g,{size:"9",className:"error-message"},r.a.createElement("div",null))))),r.a.createElement(s.j,null,r.a.createElement(s.d,{expand:"block",color:"secondary",onClick:function(){n(h,null!==p&&void 0!==p?p:"",!1)}},"OK"),r.a.createElement(s.d,{expand:"block",onClick:t},"CANCEL")))},pn=function(e){var t=e.auth,n=e.cancelEditModal,o=e.eventType,c=e.eventStatus,i=e.scheduleEventId,l=e.locationId,u=e.eventEditAuth,m=Object(a.useContext)(K).user,p=Object(a.useState)(!1),f=Object(d.a)(p,2),E=f[0],v=f[1],h=$(),g=function(e){v(!1),n(e)};return!u||!t||!t.locations||0===t.locations.length||u.usage===Ge.None||i<=0?r.a.createElement("div",null):r.a.createElement(r.a.Fragment,null,r.a.createElement(s.d,{className:"apply-button",expand:"block",onClick:function(){v(!0)}},u.buttonText),r.a.createElement(s.x,{isOpen:E,cssClass:"event-request-modal",onDidDismiss:function(){return v(!1)}},r.a.createElement(mn,{onCancel:function(){v(!1)},onOk:function(e,t,n){switch(u.usage){case Ge.CreateCoverRequest:dn.createCoverRequest(m,i,l,0,n,t,e).then((function(){g("Cover-Request Created")}));break;case Ge.CreateShiftRequest:dn.makeShiftRequest(m,i,l,0,n,t).then((function(e){e.error?h.showAlert("Shift-Request Failed",e.message,(function(){})):g(e.message)}));break;case Ge.DeleteShiftRequest:dn.removeShiftRequest(m,l,i,o,c,void 0).then((function(){g("Shift-Request Removed")}));break;case Ge.UndoCoverRequest:dn.undoCoverRequest(m,i).then((function(){g("Removed Cover-Request")}));break;case Ge.Delete:dn.deleteEvent(m,l,i,o,c,void 0).then((function(){g("Deleted")}))}},auth:t,eventEditAuth:u,scheduleEventId:i,locSettings:Je(t,l)}),h.alertBoxJsx))},fn=n(224),En=function(e){var t=e.locSettings,n=e.editorValues,o=e.update,c=Object(a.useState)([!1,!1,!1,!1,!1,!1,!1]),i=Object(d.a)(c,2),l=i[0],u=i[1];if(Object(a.useEffect)((function(){if(n.repeatWeekdays){for(var e=[!1,!1,!1,!1,!1,!1,!1],t=0;t<n.repeatWeekdays.length;t++)e[parseInt(n.repeatWeekdays[t])]=!0;u(e)}else u([!1,!1,!1,!1,!1,!1,!1])}),[n.repeatWeekdays]),null===t)return r.a.createElement("div",null);var m=Ae(new Date,t.DayWeekStartsOn,t.DayStartTime);return r.a.createElement("div",{className:"weeklist-container"},[0,1,2,3,4,5,6].map((function(e){var t=Object(Ce.a)(m,e),a=Object(fn.a)(t);return r.a.createElement("span",{key:e,className:"day"},r.a.createElement(s.f,{className:"day-checkbox",disabled:n.isReadonly,onClick:function(){return function(e){var t=l.slice();t[e]=!l[e],u(t);for(var a="",r=0;r<t.length;r++)t[r]&&(a+=r);o({type:"REPEATING-UPDATED",repeatWeekDays:a,repeatInterval:n.repeatInterval,recurrenceType:n.recurrenceType,recurrenceEnd:n.recurrenceEnd,recurrenceStart:n.recurrenceStart})}(a)},checked:l[a]}),r.a.createElement("span",{className:"day-abbr"},Object(ee.a)(t,"EE").substr(0,3)))})))},vn=function(e){var t=e.auth,n=e.editorValues,o=e.update,c=Object(a.useState)(null),i=Object(d.a)(c,2),l=i[0],u=i[1],p=Object(a.useState)(!1),f=Object(d.a)(p,2),E=f[0],v=f[1],h=Object(a.useState)(!1),g=Object(d.a)(h,2),b=g[0],y=g[1];return Object(a.useEffect)((function(){-1!==n.scheduleEventId&&(n.locationId>0?u(Je(t,n.locationId)):0===n.locationId&&u(t.locations[0].settings))}),[n.locationId,n.scheduleEventId]),Object(a.useEffect)((function(){-1!==n.scheduleEventId&&v(n.eventType===We.Shift||n.eventType===We.Unavailable)}),[n.eventType,n.scheduleEventId]),Object(a.useEffect)((function(){E&&-1!==n.scheduleEventId&&n.recurrenceStart&&y(!0)}),[b,E,n.recurrenceStart,n.scheduleEventId]),E?r.a.createElement(r.a.Fragment,null,r.a.createElement(s.C,null,r.a.createElement(s.g,{size:"2"},r.a.createElement(s.f,{checked:b,onClick:function(){o(b?{type:"REPEATING-UPDATED",repeatWeekDays:void 0,repeatInterval:void 0,recurrenceType:void 0,recurrenceEnd:void 0,recurrenceStart:void 0}:{type:"REPEATING-UPDATED",repeatWeekDays:void 0,repeatInterval:1,recurrenceType:Bt.Weekly,recurrenceEnd:void 0,recurrenceStart:we(new Date)}),y(!b)},disabled:n.isReadonly})),r.a.createElement(s.g,{size:"4"},r.a.createElement(s.p,{className:"label"},"(R)epeating"))),b&&r.a.createElement(r.a.Fragment,null,r.a.createElement(s.C,{className:"edit-row"},r.a.createElement(s.g,{size:"1"},r.a.createElement(s.m,{icon:m.i,mode:"md"})),r.a.createElement(s.g,{size:"5"},r.a.createElement(s.i,{value:n.recurrenceStart,className:"select",displayFormat:"M/D/YY",pickerFormat:"MMM DD YYYY",disabled:n.isReadonly,min:"2005-01-01",max:"2030-01-01",onIonChange:function(e){var t;t=e.detail.value,o(t?{type:"REPEATING-UPDATED",repeatWeekDays:n.repeatWeekdays,repeatInterval:n.repeatInterval,recurrenceType:n.recurrenceType,recurrenceEnd:n.recurrenceEnd,recurrenceStart:t}:{type:"REPEATING-UPDATED",repeatWeekDays:n.repeatWeekdays,repeatInterval:n.repeatInterval,recurrenceType:n.recurrenceType,recurrenceEnd:n.recurrenceEnd,recurrenceStart:void 0})}})),r.a.createElement(s.g,{size:"1"},r.a.createElement(s.m,{icon:m.i,mode:"md",style:{textAlign:"right"}})),r.a.createElement(s.g,{size:"5"},r.a.createElement(s.i,{value:n.recurrenceEnd,className:"select",displayFormat:"M/D/YY",pickerFormat:"MMM DD YYYY",disabled:n.isReadonly,min:"2005-01-01",max:"2030-01-01",onIonChange:function(e){var t;t=e.detail.value,o(t?{type:"REPEATING-UPDATED",repeatWeekDays:n.repeatWeekdays,repeatInterval:n.repeatInterval,recurrenceType:n.recurrenceType,recurrenceEnd:t,recurrenceStart:n.recurrenceStart}:{type:"REPEATING-UPDATED",repeatWeekDays:n.repeatWeekdays,repeatInterval:n.repeatInterval,recurrenceType:n.recurrenceType,recurrenceEnd:void 0,recurrenceStart:n.recurrenceStart})}}))),r.a.createElement(s.C,{className:"edit-row"},r.a.createElement(s.g,{size:"1"},r.a.createElement(s.m,{icon:m.t,mode:"md"})),r.a.createElement(s.g,{size:"5"},r.a.createElement(s.F,{className:"select",value:n.recurrenceType,disabled:n.isReadonly,onIonChange:function(e){var t;t=e.detail.value,o(t?{type:"REPEATING-UPDATED",repeatWeekDays:n.repeatWeekdays,repeatInterval:n.repeatInterval,recurrenceType:parseInt(t),recurrenceEnd:n.recurrenceEnd,recurrenceStart:n.recurrenceStart}:{type:"REPEATING-UPDATED",repeatWeekDays:n.repeatWeekdays,repeatInterval:n.repeatInterval,recurrenceType:void 0,recurrenceEnd:n.recurrenceEnd,recurrenceStart:n.recurrenceStart})}},r.a.createElement(s.G,{value:Bt.Weekly},"Weekly"),r.a.createElement(s.G,{value:Bt.MonthlyByDayOfMonth},"Monthly (Day of Month)"),r.a.createElement(s.G,{value:Bt.MonthlyByDayOfWeek},"Monthly (Day of Week)"))),r.a.createElement(s.g,{size:"1"},"#"),r.a.createElement(s.g,{size:"5"},r.a.createElement(s.n,{className:"input-textbox",disabled:n.isReadonly,value:n.repeatInterval?n.repeatInterval.toString():void 0,onIonChange:function(e){return t=e.detail.value,void o(t?{type:"REPEATING-UPDATED",repeatWeekDays:n.repeatWeekdays,repeatInterval:parseInt(t),recurrenceType:n.recurrenceType,recurrenceEnd:n.recurrenceEnd,recurrenceStart:n.recurrenceStart}:{type:"REPEATING-UPDATED",repeatWeekDays:n.repeatWeekdays,repeatInterval:void 0,recurrenceType:n.recurrenceType,recurrenceEnd:n.recurrenceEnd,recurrenceStart:n.recurrenceStart});var t}}))),r.a.createElement(s.C,null,r.a.createElement(s.g,{size:"12"},r.a.createElement(En,{locSettings:l,editorValues:n,update:o})),r.a.createElement("div",{style:{borderBottom:"1px solid #ddd",width:"100%"}})))):r.a.createElement("span",null)};!function(e){e[e.UpdateSingleEvent=0]="UpdateSingleEvent",e[e.UpdateEntireSeries=1]="UpdateEntireSeries",e[e.UpdateSeriesForward=2]="UpdateSeriesForward"}(an||(an={}));var hn=function(e){var t=e.onSelect,n=e.updateType;if("NO"===n)return r.a.createElement("div",null);var a=function(e){t(e)},o="UPDATE"===n?"Update Recurring Events":"Delete Recurring Events";return r.a.createElement(r.a.Fragment,null,r.a.createElement(s.h,null,r.a.createElement(s.l,{mode:"ios"},r.a.createElement(s.R,null,r.a.createElement(s.O,null,o))),r.a.createElement(s.k,null,r.a.createElement(s.C,null,r.a.createElement(s.g,{size:"12"},r.a.createElement(s.d,{expand:"block",color:"danger",className:"apply-button",onClick:function(){return a(an.UpdateSingleEvent)}},"This event"))),r.a.createElement(s.C,null,r.a.createElement(s.g,{size:"12"},r.a.createElement(s.d,{expand:"block",color:"danger",className:"apply-button",onClick:function(){return a(an.UpdateEntireSeries)}},"Entire series"))),r.a.createElement(s.C,null,r.a.createElement(s.g,{size:"12"},r.a.createElement(s.d,{expand:"block",color:"danger",className:"apply-button",onClick:function(){return a(an.UpdateSeriesForward)}},"This event forward"))),r.a.createElement(s.C,null,r.a.createElement(s.g,{size:"12"},r.a.createElement(s.d,{expand:"block",className:"cancel-btn",onClick:function(){return a(null)}},"Cancel"))))))},gn=function(e){var t=e.auth,n=e.scheduleEventId,o=e.onDismissModal,c=e.onCancelModal,i=e.isOpen,l=e.eventEditAuth,u=e.initialEvent,p=Ft("Please wait..."),f=$(),E=r.a.useContext(K).user,v=Object(a.useReducer)(ln,u),h=Object(d.a)(v,2),g=h[0],b=h[1],y=Object(a.useState)(null),O=Object(d.a)(y,2),k=O[0],C=O[1],j=Object(a.useState)(null),I=Object(d.a)(j,2),S=I[0],T=I[1],N=Object(a.useState)("NO"),D=Object(d.a)(N,2),x=D[0],A=D[1],w=Object(a.useState)("NONE"),P=Object(d.a)(w,2),M=P[0],R=P[1],U=null!==n,L=Et(),F="New Event",B="CREATE";U&&(F="Edit Event",B="UPDATE"),Object(a.useEffect)((function(){i&&t&&t.locations&&0!==t.locations.length&&(n?(p.setShowLoading(!0),Le.getScheduleEvent(E,n).then((function(e){p.setShowLoading(!1),e?(C(e),b({type:"BEGIN-UPDATE",ev:e,auth:t,eventEditAuth:l})):f.showAlert("No Event","The event may have been removed or you no longer have access",G)}))):(null!==k&&C(null),b({type:"CREATE-EVENT",auth:t})))}),[n,E,i,t]),Object(a.useEffect)((function(){null!==S&&"NONE"!==M&&("CREATEUPDATE"===M?z():V(null!==g.recurrenceId&&void 0!==g.recurrenceId))}),[S,M]);var z=function(){(0===g.scheduleEventId?Le.createScheduleEvent:Le.updateScheduleEvent)(E,g,S).then((function(e){e.error?f.showAlert("Cannot update",e.message,(function(){o("Could not update event")})):o("Event Updated")}))},V=function(e){var t=function(){Le.deleteScheduleEvent(E,g.scheduleEventId,S).then((function(e){e.error?f.showAlert("Cannot delete",e.message,(function(){o("Could not delete event")})):o("Deleted Event")}))};e?t():L.showDialog("Delete event?","",[{text:"Delete",color:"danger",value:1}],(function(e){1===e&&t()}))},q=function(e){A("NO"),T(e),null===e&&R("NONE")},G=function(){b({type:"CANCEL"}),Object(W.a)().push("/tabs/schedule"),c()};return i&&t&&t.locations&&0!==t.locations.length?r.a.createElement(r.a.Fragment,null,r.a.createElement(s.l,{className:"ion-no-border"},r.a.createElement(s.R,null,r.a.createElement(s.e,{slot:"start"},r.a.createElement(s.d,{onClick:G},r.a.createElement(s.m,{icon:m.c,mode:"md",slot:"icon-only"}))),r.a.createElement(s.O,null,F))),r.a.createElement(s.h,{class:"outer-content"},r.a.createElement(s.k,null,r.a.createElement(Rt,{editorValues:g,update:b,auth:t,eventTypes:l.eventTypeOptionList,eventStatuses:l.eventStatusOptionList}),r.a.createElement(s.C,{className:"edit-row"},r.a.createElement(Qt,{auth:t,editorValues:g,update:b}),r.a.createElement($t,{auth:t,editorValues:g,update:b})),r.a.createElement(s.C,{className:"edit-row"},r.a.createElement(s.g,{size:"12"},r.a.createElement("div",{style:{width:"100%",borderBottom:"1px solid #ddd"}}))),r.a.createElement(Ut,{auth:t,editorValues:g,update:b}),r.a.createElement(zt,{auth:t,editorValues:g,update:b}),r.a.createElement(Vt,{auth:t,editorValues:g,update:b}),r.a.createElement(vn,{auth:t,editorValues:g,update:b}),r.a.createElement(Ht,{auth:t,editorValues:g,update:b}),r.a.createElement(Kt,{auth:t,editorValues:g,update:b}),r.a.createElement(un,{auth:t,editorValues:g,update:b}),r.a.createElement(sn,{auth:t,editorValues:g,update:b})),f.alertBoxJsx,L.dialogBoxJsx,p.showLoadingJsx,r.a.createElement(s.x,{isOpen:"NO"!==x,onDidDismiss:function(){q(null)},cssClass:"recurrence-update-modal"},r.a.createElement(hn,{onSelect:q,updateType:x}))),r.a.createElement(s.j,{className:"outer-content footer"},r.a.createElement(pn,{auth:t,eventType:g.eventType,eventEnd:g.eventEnd,eventStatus:g.eventStatus,eventEmployeeId:g.employee.id,eventPositionId:g.position.position.id,scheduleEventId:g.scheduleEventId,locationId:g.locationId,eventEditAuth:l,update:b,cancelEditModal:function(e){return o(e)},setUsageText:function(){}}),r.a.createElement(s.d,{className:"apply-button",expand:"block",onClick:function(){R("CREATEUPDATE"),g.recurrenceId?null!==S?z():A("UPDATE"):z()},disabled:!g.isDirty||!g.valid,hidden:g.isReadonly},B),r.a.createElement(s.d,{className:"delete-button",expand:"block",onClick:function(){R("DELETE"),g.recurrenceId?null!==S?V(!0):A("DELETE"):V(null!==g.recurrenceId&&void 0!==g.recurrenceId)},hidden:g.isReadonly||g.scheduleEventId<=0},"DELETE"))):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,"Loading"),f.alertBoxJsx)},bn=n(15),yn=n.n(bn),On=function(e){var t=e.threeRows;return r.a.createElement("button",{className:"card"},r.a.createElement("div",{className:"card-first-col"},r.a.createElement("div",{className:"day-name"},r.a.createElement(yn.a,null)," "),r.a.createElement("div",{className:"day-number"},r.a.createElement(yn.a,null))),r.a.createElement("div",{style:{padding:"3px"}},r.a.createElement(yn.a,{width:5,height:45})),r.a.createElement("div",{className:"card-second-col"},r.a.createElement("div",{className:"time-row"},r.a.createElement("span",null,r.a.createElement(yn.a,{width:150,height:9}),"\xa0\xa0"),r.a.createElement(yn.a,null)),t&&r.a.createElement("div",null,r.a.createElement(yn.a,{width:80,height:10})),r.a.createElement("div",{className:"dept-position-row"},r.a.createElement(yn.a,{width:150,height:10}),"\xa0\xa0")))},kn=function(){return r.a.createElement("div",{className:"no-events-wrapper"},r.a.createElement("span",{className:"no-events-span"},"No Events"))};function Cn(e,t){var n=Object(a.useRef)();Object(a.useEffect)((function(){n.current=e}),[e]),Object(a.useEffect)((function(){if(null!==t){var e=setInterval((function(){n.current&&n.current()}),t);return function(){return clearInterval(e)}}}),[t])}function jn(e,t){return e===We.Shift&&t===_e.Approved||e===We.Cover&&t===_e.Request||e===We.Cover&&t===_e.RequestDenied}function In(e,t){return e===We.Absent&&t===_e.Approved}function Sn(e,t,n,a){if(e>0&&t>0){if(e===n&&t===a)return!0}else if(e>0&&t===Dt.All){if(e===n)return!0}else{if(e!==Dt.All||t!==a)return e===Dt.Scheduled&&t===Dt.Scheduled?jn(n,a)||In(n,a):e!==Dt.ClockAndSched||t!==Dt.ClockAndSched||(function(e,t){return jn(e,t)||e===We.Clock&&t===_e.Approved}(n,a)||In(n,a));if(t===a)return!0}return!1}var Tn=[],Nn=[];var Dn,xn=function(e){var t=e.match,n=r.a.useContext(K).user,o=r.a.useContext(pe),c=o.auth,i=o.refreshAuth,l=Ot(),u=Mt((function(e){Ye(c,qe,e)})),f=Object(a.useState)("filter-not-applied"),E=Object(d.a)(f,2),v=E[0],h=E[1],g=c&&c.locations&&c.locations.length>0?Ae(Object(Ue.a)(new Date),c.locations[0].settings.DayWeekStartsOn,c.locations[0].settings.DayStartTime):Ae(Object(Ue.a)(new Date),"Monday",""),b=Object(a.useState)(Tn),y=Object(d.a)(b,2),O=y[0],k=y[1],C=Object(a.useState)(Nn),j=Object(d.a)(C,2),I=j[0],S=j[1],T=Object(a.useState)([]),N=Object(d.a)(T,2),D=N[0],x=N[1],A=Object(a.useState)(Tn),w=Object(d.a)(A,2),P=w[0],M=w[1],R=Object(a.useState)(Nn),U=Object(d.a)(R,2),F=U[0],B=U[1],z=Object(a.useState)([]),V=Object(d.a)(z,2),q=V[0],W=V[1],G=Object(a.useState)(Tn),_=Object(d.a)(G,2),Y=_[0],J=_[1],H=Object(a.useState)(Nn),Q=Object(d.a)(H,2),$=Q[0],X=Q[1],Z=Object(a.useState)([]),ee=Object(d.a)(Z,2),ne=ee[0],ae=ee[1],re=Object(a.useState)(!0),oe=Object(d.a)(re,2),ie=oe[0],le=oe[1],se=Object(a.useState)("my"),ue=Object(d.a)(se,2),de=ue[0],me=ue[1],fe=Object(a.useState)(!1),Ee=Object(d.a)(fe,2),ve=Ee[0],he=Ee[1],ge=Object(a.useState)(!1),be=Object(d.a)(ge,2),ye=be[0],Oe=be[1],ke=Object(a.useState)(null),je=Object(d.a)(ke,2),Ie=je[0],Se=je[1],Te=Object(a.useState)(cn),Ne=Object(d.a)(Te,2),De=Ne[0],xe=Ne[1],we=Object(a.useState)(null),Pe=Object(d.a)(we,2),Me=Pe[0],Re=Pe[1],Be=Object(a.useState)(Object(p.a)({},Fe,{start:g,end:Object(Ce.a)(g,6),positionIds:c.locations.flatMap((function(e){return e.departments.flatMap((function(e){return e.positions.map((function(e){return e.id}))}))})),filterByEmployee:!0})),Ve=Object(d.a)(Be,2),qe=Ve[0],We=Ve[1];Cn((function(){i(!1,n).then((function(e){e&&Ye(e,qe)}))}),L(n).refreshAuthItemsTimer),Object(a.useEffect)((function(){if(c&&c.locations&&c.locations.length>0){var e=Object(p.a)({},qe,{positionIds:c.locations.flatMap((function(e){return e.departments.flatMap((function(e){return e.positions.map((function(e){return e.id}))}))})),dnLocIds:c.locations.map((function(e){return e.id})),settingsLocId:c.locations[0].id});We(e),("my"===de&&0===O.length||"requests"===de&&0===P.length||"all"===de&&0===Y.length)&&(le(!0),Ye(c,e))}else i(!1,n)}),[c]),Object(a.useEffect)((function(){t.params.scheduleEventId&&(Se(parseInt(t.params.scheduleEventId)),Oe(!0))}),[t.params.scheduleEventId]);var Ye=function(e,t,a){var r=Object(p.a)({},t,{filterByEmployee:!1,eventTypeId:Dt.All,eventStatusId:Dt.All});Le.getScheduleEventsByFilter(n,r).then((function(n){le(!1),a&&a.detail.complete(),k(function(e,t,n){return e.filter((function(e){return Sn(n.eventTypeId,n.eventStatusId,e.EventTypeId,e.EventStatusId)&&e.EmployeeId===t.employeeId}))}(n.events,e,t)),S(n.dailyNotes),x(n.hoursPerDay),M(n.events.filter((function(e){return e.EventStatusId===_e.Request}))),B([]),W(n.hoursPerDay),J(function(e,t){return e.filter((function(e){return Sn(t.eventTypeId,t.eventStatusId,e.EventTypeId,e.EventStatusId)}))}(n.events,t)),X(n.dailyNotes),ae(n.hoursPerDay)}))},Je=Object(a.useCallback)((function(e,t){Se(e.ScheduleEventId),Re(t),xe(nn(c,e)),Oe(!0)}),[c.locations]),He=function(e){me(e)},Ke=function(e){e&&e.length>0&&l.showToast(e),Ye(c,qe)};return c&&c.locations&&0!==c.locations.length?r.a.createElement(s.y,{id:"schedule-page"},r.a.createElement(s.l,{className:"ion-no-border"},r.a.createElement(s.R,{mode:"md"},r.a.createElement(s.e,{slot:"start"},r.a.createElement(s.v,null)),r.a.createElement(s.O,{slot:"start"},"Schedule"),r.a.createElement(s.e,{slot:"end"},r.a.createElement(s.d,{onClick:function(){Se(null),Re(function(e){for(var t=e.locations[0],n=e.locations[0].departments[0],a=e.locations[0].departments[0].positions[0],r=!1,o=0;o<e.locations.length&&!r;o++)for(var c=0;c<e.locations[o].departments.length&&!r;c++)for(var i=0;i<e.locations[o].departments[c].positions.length&&!r;i++)e.locations[o].departments[c].positions[i].hasPosition&&(t=e.locations[o],n=e.locations[o].departments[c],a=e.locations[o].departments[c].positions[i],r=!0);var l={location:t,position:a},s=_e.Request;(e.role===te.BusinessAdmin||e.role===te.LocationAdmin||e.role===te.Admin&&(n.adminAuth&ce.CanEditSchedules)===ce.CanEditSchedules)&&(s=_e.Approved);var u=dt(e,l,e.employeeId,s,!1),d=ut(e,l,e.employeeId);return{buttonText:"",enableConfirm:!0,isReadonly:!1,text:"",usage:Ge.None,eventTypeOptionList:d,eventStatusOptionList:u}}(c)),Oe(!0)}},r.a.createElement(s.m,{icon:m.a,mode:"md",slot:"icon-only"})),r.a.createElement(s.d,{onClick:function(){return he(!0)}},r.a.createElement("div",{className:v},"\xb7"),r.a.createElement(s.m,{icon:m.m,mode:"ios",slot:"icon-only"}))))),r.a.createElement(s.D,{mode:"md",value:de},r.a.createElement(s.E,{mode:"md",value:"my",onClick:function(){return He("my")}},"MY"),r.a.createElement(s.E,{mode:"md",value:"requests",onClick:function(){return He("requests")}},"REQUESTS"),r.a.createElement(s.E,{mode:"md",value:"all",onClick:function(){return He("all")}},"ALL")),r.a.createElement(ze,{startDate:Ae(qe.start,c.locations[0].settings.DayWeekStartsOn,c.locations[0].settings.DayStartTime),setStartDate:function(e){if(e!==qe.start){var t=Object(p.a)({},qe,{start:e,end:Object(Ce.a)(e,6)});We(t),le(!0),Ye(c,t)}}}),r.a.createElement(s.h,null,u.ionicRefresherJsx,!ie&&"my"===de&&0===(null===O||void 0===O?void 0:O.length)&&r.a.createElement(kn,null),!ie&&"my"===de&&(null===O||void 0===O?void 0:O.length)>0&&r.a.createElement(Nt,{events:O,listType:de,notes:I,hoursPerDay:D,auth:c,onEdit:Je,onForceRefresh:Ke}),!ie&&"requests"===de&&0===P.length&&r.a.createElement(kn,null),!ie&&"requests"===de&&P.length>0&&r.a.createElement(Nt,{events:P,listType:de,notes:F,hoursPerDay:q,auth:c,onEdit:Je,onForceRefresh:Ke}),!ie&&"all"===de&&0===(null===Y||void 0===Y?void 0:Y.length)&&r.a.createElement(kn,null),!ie&&"all"===de&&(null===Y||void 0===Y?void 0:Y.length)>0&&r.a.createElement(Nt,{events:Y,listType:de,notes:$,hoursPerDay:ne,auth:c,onEdit:Je,onForceRefresh:Ke}),ie&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{marginTop:"10px"}}),r.a.createElement(yn.a,{height:24,width:220}),r.a.createElement("br",null),r.a.createElement(On,{threeRows:"my"!==de}),r.a.createElement(On,{threeRows:"my"!==de}),r.a.createElement(On,{threeRows:"my"!==de}))),l.simpleToastJsx,r.a.createElement(s.x,{isOpen:ve,onDidDismiss:function(){return he(!1)}},r.a.createElement(Pt,{filter:qe,auth:c,onDismissModal:function(e,t){We(e),h(t?"filter-applied":"filter-not-applied"),he(!1),le(!0),Ye(c,e)},isOpen:ve,onCancelModal:function(){return he(!1)}})),r.a.createElement(s.x,{isOpen:ye,onDidDismiss:function(){return Oe(!1)}},r.a.createElement(gn,{isOpen:ye,auth:c,onCancelModal:function(){return Oe(!1)},onDismissModal:function(e){return function(e){e&&l.showToast(e),Ye(c,qe),Oe(!1)}(e)},scheduleEventId:Ie,initialEvent:De,eventEditAuth:Me}))):r.a.createElement("div",null,"Schedule Page")};!function(e){e[e.MatchingShift=1]="MatchingShift",e[e.AnyShift=2]="AnyShift",e[e.NoShift=3]="NoShift"}(Dn||(Dn={}));var An,wn,Pn=function(e){var t=e.auth,n=e.onDismissModal,o=e.tcData,c=Object(a.useState)([]),i=Object(d.a)(c,2),l=i[0],u=i[1],p={key:"Cancel",name:"",breakType:le.UnscheduledUnpaid};return Object(a.useEffect)((function(){if(0!==t.locations.length&&o.ClockedInScheduleEvent){var e=t.locations.filter((function(e){return e.id===o.ClockedInScheduleEvent.LocationId}))[0].settings,n=[];switch(o.ScheduleEventsForClockIn.length>0&&o.ScheduleEventsForClockIn[0].EventBreaks.map((function(e){return n.push({key:e.BreakStart,name:xe(e),breakType:le.Scheduled})})),e.UnscheduledBreakOptions){case ie.Both:n.push({key:"UnScheduledUnpaid",name:"Unscheduled",breakType:le.UnscheduledUnpaid}),n.push({key:"UnScheduledPaid",name:"Unscheduled $",breakType:le.UnscheduledPaid});break;case ie.Paid:n.push({key:"UnScheduledPaid",name:"Unscheduled $",breakType:le.UnscheduledPaid});break;case ie.Unpaid:n.push({key:"UnScheduledUnpaid",name:"Unscheduled",breakType:le.UnscheduledUnpaid})}u(n)}}),[o,t]),r.a.createElement(r.a.Fragment,null,r.a.createElement(s.l,{className:"ion-no-border"},r.a.createElement(s.R,null,r.a.createElement(s.e,{slot:"start"},r.a.createElement(s.d,{onClick:function(){return n(p)}},r.a.createElement(s.m,{icon:m.c,mode:"md",slot:"icon-only"}))),r.a.createElement(s.O,null,"Choose Break"))),r.a.createElement(s.h,{class:"outer-content"},l.map((function(e){return r.a.createElement(s.d,{className:"apply-button",expand:"block",key:e.key,color:"secondary",onClick:function(){n(e)}},e.name)}))),r.a.createElement(s.j,null,r.a.createElement(s.d,{className:"cancel-button",expand:"block",color:"tertiary",onClick:function(){return n(p)}},"CANCEL")))},Mn={getTimeClockSettings:function(){var e=Object(v.a)(E.a.mark((function e(t,n,a){var r,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=null!==n&&void 0!==n?n:t.latitude,o=null!==a&&void 0!==a?a:t.longitude,e.next=4,V.get(t,"api/v1/employee/timeclock/?lat=".concat(r,"&lng=").concat(o));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),clockIn:function(){var e=Object(v.a)(E.a.mark((function e(t,n,a){var r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="/api/v2/employee/timeclock/clockin/".concat(n,"/").concat(a,"?lat=").concat(t.latitude,"&lng=").concat(t.longitude),e.next=3,V.post(t,r,{});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),clockOut:function(){var e=Object(v.a)(E.a.mark((function e(t,n){var a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={ClockOutValue:n,TimeClockBreak:null,BreakStart:null},e.next=3,V.post(t,"/api/v2/employee/timeclock/clockout?lat=".concat(t.latitude,"&lng=").concat(t.longitude),a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),switchPositionOrTag:function(){var e=Object(v.a)(E.a.mark((function e(t,n,a,r){var o,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o="/api/v2/employee/timeclock/switch/".concat(n,"/").concat(a,"?lat=").concat(t.latitude,"&lng=").concat(t.longitude),c={ClockOutValue:r,TimeClockBreak:null,BreakStart:null},e.next=4,V.post(t,o,c);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}(),startBreak:function(){var e=Object(v.a)(E.a.mark((function e(t,n,a,r,o){var c,i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c="/api/v2/employee/timeclock/startbreak?lat=".concat(t.latitude,"&lng=").concat(t.longitude),i={clockEventId:n.ScheduleEventId,shiftEventId:a?a.ScheduleEventId:null,shiftBreakStart:o,breakType:r},e.next=4,V.post(t,c,i);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n,a,r,o){return e.apply(this,arguments)}}(),endBreak:function(){var e=Object(v.a)(E.a.mark((function e(t,n,a){var r,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a?a.ScheduleEventId:"",o=null!==a?"/api/v2/employee/timeclock/endbreak/".concat(n.ScheduleEventId,"/").concat(r,"?lat=").concat(t.latitude,"&lng=").concat(t.longitude):"/api/v2/employee/timeclock/endbreak/".concat(n.ScheduleEventId,"/-1?lat=").concat(t.latitude,"&lng=").concat(t.longitude),e.next=4,V.post(t,o,{});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),getGeoLocations:function(){var e=Object(v.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/api/v2/employee/timeclock/geolocations",e.next=3,V.get(t,"/api/v2/employee/timeclock/geolocations");case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};!function(e){e[e.Success=0]="Success",e[e.BreakAlreadyExists=1]="BreakAlreadyExists",e[e.AlreadyOnBreak=2]="AlreadyOnBreak",e[e.ErrorInsertingBreak=3]="ErrorInsertingBreak",e[e.UserNotAtSpecifiedLocation=4]="UserNotAtSpecifiedLocation",e[e.EventDoesNotMatchCurrentUser=5]="EventDoesNotMatchCurrentUser",e[e.InvalidUnscheduledBreak=6]="InvalidUnscheduledBreak"}(An||(An={})),function(e){e[e.Success=0]="Success",e[e.CannotEndRestrictedBreakEarly=1]="CannotEndRestrictedBreakEarly",e[e.ErrorUpdatingEventBreak=2]="ErrorUpdatingEventBreak",e[e.UserNotAtSpecifiedLocation=3]="UserNotAtSpecifiedLocation",e[e.EventDoesNotMatchCurrentUser=4]="EventDoesNotMatchCurrentUser",e[e.BreakNoLongerExists=5]="BreakNoLongerExists"}(wn||(wn={}));var Rn=function(e){var t=e.onCancel,n=e.onOk,o=e.locSettings,c=Object(a.useState)(void 0),i=Object(d.a)(c,2),l=i[0],u=i[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(s.h,null,r.a.createElement(s.l,{mode:"ios"},r.a.createElement(s.R,null,r.a.createElement(s.O,null,"Clock Out"))),r.a.createElement(s.k,null,r.a.createElement(s.C,null,r.a.createElement(s.g,{className:"label",size:"12"},o.ClockOutValueLabel)),r.a.createElement(s.C,null,r.a.createElement(s.g,{size:"2"}),r.a.createElement(s.g,{size:"8"},r.a.createElement(s.n,{placeholder:"Enter value",type:"number",className:"input",autoCorrect:"off",clearInput:!0,value:null===l||void 0===l?void 0:l.toString(),onIonChange:function(e){var t;(t=e.detail.value)?u(parseFloat(t)):void 0!==l&&u(void 0)}})),r.a.createElement(s.g,{size:"2"})))),r.a.createElement(s.j,null,r.a.createElement(s.d,{expand:"block",onClick:function(){n(l)},className:"clockout-button"},"CLOCK OUT"),r.a.createElement(s.d,{expand:"block",className:"cancel-button",onClick:t},"CANCEL")))},Un=function(e){var t=e.tcData,n=e.locSettings,o=e.selectedPosId,c=e.selectedTagId,i=e.onSwitch,l=Object(a.useState)(!0),u=Object(d.a)(l,2),m=u[0],p=u[1],f=r.a.createElement("span",null);return Object(a.useEffect)((function(){if(t.UserClockedIn){var e=t.ClockedInScheduleEvent.PositionId,n=t.ClockedInScheduleEvent.TagId;n||(n=-1),p(e===o&&n===c)}}),[t.UserClockedIn,t.ClockedInScheduleEvent,o,c]),(n.ClockInWithDifferentTag||n.EnablePositionChangeForEmployeePosition)&&t.UserClockedIn?r.a.createElement("div",{className:"switch-button-container"},r.a.createElement(s.d,{className:"switch-button",disabled:m,color:"secondary",expand:"block",onClick:i},"SWITCH")):f};function Ln(e,t,n){if(!e||!t||0===n.length)return"";if(!google||!google.maps||!google.maps.geometry||!google.maps.geometry.spherical||!google.maps.geometry.spherical.computeDistanceBetween)return"";for(var a=new google.maps.LatLng(e,t),r=null,o=999999999,c=0;c<n.length;c++){var i=n[c];if(i.lat&&i.lng){var l=new google.maps.LatLng(i.lat,i.lng),s=3.28084*google.maps.geometry.spherical.computeDistanceBetween(a,l)-i.proximity;s<o&&(o=s,r=i)}}if(999999999===o)return"";if(o<0)return"At "+r.locationName;var u=189394e-9*o;return u>.1?"".concat(Math.round(10*(u+Number.EPSILON))/10," mi to ").concat(r.locationName):"".concat(Math.round(o)," ft to ").concat(r.locationName)}var Fn=function(){var e=Object(a.useRef)(null),t=Object(a.useRef)(),n=Object(a.useRef)(),o=r.a.useContext(K).user,c=Object(a.useState)(""),i=Object(d.a)(c,2),l=i[0],u=i[1],p=Object(a.useState)([]),f=Object(d.a)(p,2),E=f[0],v=f[1],h=Object(a.useState)(!1),g=Object(d.a)(h,2),b=g[0],y=g[1];return Object(a.useEffect)((function(){if(console.log("MAP: useEffect running"),null!==e.current&&o.latitude&&o.longitude)if(void 0===t.current)t.current=new google.maps.Map(e.current,{center:{lat:o.latitude,lng:o.longitude},zoom:16,disableDefaultUI:!0,fullscreenControl:!1}),function(){o.latitude&&o.longitude&&(n.current=new google.maps.Circle({strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.25,radius:6.5,center:{lat:o.latitude,lng:o.longitude},map:t.current}));Mn.getGeoLocations(o).then((function(e){v(e),e.forEach((function(e){var n=new google.maps.InfoWindow({content:"<h5>".concat(e.addr,"</h5>")});if(e.lat&&e.lng){var a=new google.maps.LatLng(e.lat,e.lng),r=new google.maps.Marker({position:a,map:t.current,title:e.addr});new google.maps.Circle({strokeColor:"#FF0000",strokeOpacity:.5,strokeWeight:1,fillColor:"#DD0000",fillOpacity:.2,radius:.3048*e.proximity,center:a,map:t.current}),r.addListener("click",(function(){n.open(t.current,r)}))}})),u(Ln(o.latitude,o.longitude,e))}))}(),google.maps.event.addListenerOnce(t.current,"idle",(function(){e.current&&e.current.classList.add("show-map")}));else{if(t.current&&o.latitude&&o.longitude){var a=new google.maps.LatLng(o.latitude,o.longitude);t.current.setCenter(a),n.current&&n.current.setMap(null),n.current=new google.maps.Circle({strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.25,radius:6.5,center:a,map:t.current})}u(Ln(o.latitude,o.longitude,E))}}),[o,o.latitude,o.longitude,google,google.maps]),r.a.createElement(r.a.Fragment,null,r.a.createElement(s.d,{className:"map-button",onClick:function(){y(!b),u(Ln(o.latitude,o.longitude,E))}},l,r.a.createElement(s.m,{id:"show-map-button",icon:b?m.d:m.f})),r.a.createElement("div",{id:"map-container",hidden:!b},r.a.createElement("div",{ref:e,className:"map-canvas"})))};var Bn=function(){var e=Object(a.useState)(!1),t=Object(d.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)({message:"",onCancel:function(){},onYes:function(){}}),i=Object(d.a)(c,2),l=i[0],u=i[1];return{showDialog:function(e,t,n){u({message:e,onYes:t,onCancel:n}),o(!0)},dialogJsx:r.a.createElement(s.b,{isOpen:n,onDidDismiss:function(){o(!1)},message:l.message,buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:l.onCancel},{text:"Yes",handler:l.onYes}]})}},zn=function(e){var t=e.updateCallback,n=e.isShowing,o=r.a.useContext(K),c=o.user,i=o.startWatchPosition,l=o.clearWatchPosition,s=o.requestGeoPermission,u=o.setRefusedGeoPermission,m=r.a.useContext(pe).auth,p=Bn(),f=Object(a.useState)(""),E=Object(d.a)(f,2),v=E[0],h=E[1],g=Ot();return Object(a.useEffect)((function(){if(n){if(m&&m.locations&&m.locations.length>0&&lt(m.locations))if(c.requestedGeoPermission||c.refusedGeoPermission){if(c.requestedGeoPermission&&!c.refusedGeoPermission){var e=i((function(n,a,r){N("geolocation_updated",{user:c.username}),void 0!==n&&void 0!==a&&(r&&r.length>0?(N("geolocation error: "+r),console.log("geolocation error: "+r),g.showToast("Cannot read geolocation data"),l(e)):setTimeout((function(){t(n,a)}),150))}));h(e)}}else console.log("GeoLocationComponent: Prompting user"),p.showDialog("To clock in/out, you may be required to provide your location. Do you want Team Dashboard to send location data?",(function(){s()}),(function(){u(!0)}))}else m&&m.locations&&m.locations.length>0&&lt(m.locations)&&""!==v&&(console.log("GeoLocationComponent: stopping watch position"),l(v),h(""))}),[n,m,m.locations,c.requestedGeoPermission,c.refusedGeoPermission]),r.a.createElement(r.a.Fragment,null,m&&m.locations&&m.locations.length>0&&lt(m.locations)&&r.a.createElement(Fn,null),p.dialogJsx,g.simpleToastJsx)},Vn=function(e){var t=e.onUpdate,n=e.refreshToggle,o=r.a.useContext(K).user,c=r.a.useContext(pe).auth,i=Object(a.useState)([]),l=Object(d.a)(i,2),u=l[0],f=l[1],E=Object(a.useState)(0),v=Object(d.a)(E,2),h=v[0],g=v[1],b=Object(a.useState)(!1),y=Object(d.a)(b,2),O=y[0],k=y[1],C=Object(a.useState)([]),j=Object(d.a)(C,2),I=j[0],S=j[1],T=Object(a.useState)(null),N=Object(d.a)(T,2),D=N[0],x=N[1],A=Object(a.useState)("START BREAK"),w=Object(d.a)(A,2),P=w[0],M=w[1],R=Object(a.useState)({}),U=Object(d.a)(R,2),L=U[0],F=U[1],B=Object(a.useState)(!1),z=Object(d.a)(B,2),V=z[0],q=z[1],W=Object(a.useState)(!1),G=Object(d.a)(W,2),_=G[0],Y=G[1],J=Object(a.useState)("Please wait..."),H=Object(d.a)(J,2),Q=H[0],$=H[1],X=Object(a.useState)({show:!1,header:"Alert",message:""}),Z=Object(d.a)(X,2),te=Z[0],ne=Z[1],ae=Object(a.useState)(null),re=Object(d.a)(ae,2),oe=re[0],ce=re[1],se=Object(a.useState)(!1),ue=Object(d.a)(se,2),de=ue[0],me=ue[1],fe=Object(a.useState)(!1),Ee=Object(d.a)(fe,2),ve=Ee[0],he=Ee[1],ge=Object(a.useState)(!1),ye=Object(d.a)(ge,2),Oe=ye[0],ke=ye[1],Ce=Ot();Object(s.W)((function(){ke(!0)})),Object(s.X)((function(){ke(!1)})),Object(a.useEffect)((function(){console.log("ClockPanel: useEffect, refreshtoggle",n,"refresh",ve,"lat",o.latitude,"lng",o.longitude),ve!==n&&he(n),je()}),[c,n]),Object(a.useEffect)((function(){if(oe&&c&&c.locations&&0!==c.locations.length&&oe.ShowTimeClock){var e,t=wt.unique(oe.PositionsToClockInto.map((function(e){return e.LocationId}))),n=wt.unique(oe.PositionsToClockInto.map((function(e){return e.DepartmentId})));e=t.length>1?oe.PositionsToClockInto.map((function(e){return{id:e.PositionId,name:e.PositionNameWithLocAndDeptAbbreviation}})):n.length>1?oe.PositionsToClockInto.map((function(e){return{id:e.PositionId,name:e.PositionNameWithDeptAbbreviation}})):oe.PositionsToClockInto.map((function(e){return{id:e.PositionId,name:e.PositionName}}));var a=h;0===a&&(oe.UserClockedIn?(a=oe.ClockedInScheduleEvent.PositionId,g(a)):oe.ScheduleEventsForClockIn&&oe.ScheduleEventsForClockIn.length>0?(a=oe.ScheduleEventsForClockIn[0].PositionId,g(a)):e.length>0?(a=e[0].id,g(a)):a=0);var r=oe.UserClockedIn?oe.ClockedInScheduleEvent.LocationId:0!==a?c.locations.filter((function(e){return e.departments.flatMap((function(e){return e.positions.flatMap((function(e){return e.id===a}))}))}))[0].id:c.locations[0].id,o=c.locations.filter((function(e){return e.id===r}))[0].settings;F(o),o.EnableEnhancedBreakManagement&&(o.UnscheduledBreakOptions!==ie.None||oe.ClockedInScheduleEvent.EventBreaks&&oe.ClockedInScheduleEvent.EventBreaks.length>0)?M(oe.UserClockedIn&&oe.CurrentEventBreak?"END BREAK":"START BREAK"):M("NONE"),f(e),Ie(a)}}),[c,oe]),Cn((function(){je()}),15e3);var je=function(e,t){Mn.getTimeClockSettings(o,e,t).then((function(e){ce(e)}))},Ie=function(e){if(!oe)return-1;var t=oe.UserClockedIn?oe.ClockedInScheduleEvent.LocationId:c.locations.filter((function(t){return t.departments.flatMap((function(t){return t.positions.flatMap((function(t){return t.id===e}))}))}))[0].id;if(!(c.locations.filter((function(e){return e.id===t}))[0].settings.ClockInWithDifferentTag&&oe.TagsPerPosition[e]&&oe.TagsPerPosition[e].length>1))return k(!1),-1;k(!0);var n=oe.TagsPerPosition[e].map((function(e){return{id:e.TagId,name:e.TagName}}));n.unshift({id:-1,name:"NONE"}),S(n);var a=-1;return oe.UserClockedIn?a=oe.ClockedInScheduleEvent.TagId?oe.ClockedInScheduleEvent.TagId:(oe.ClockedInScheduleEvent.TagId,-1):oe.TagsPerPosition[e]&&oe.TagsPerPosition[e].length>0&&(a=oe.ScheduleEventsForClockIn&&oe.ScheduleEventsForClockIn[0]&&oe.ScheduleEventsForClockIn[0].TagId?oe.ScheduleEventsForClockIn[0].TagId:-1),x(a),a},Se=function(e,t){ne({show:!0,header:e,message:t})},Te=function(e){de&&me(!1),$("Clocking Out..."),Y(!0),Mn.clockOut(o,e).then((function(e){Y(!1),0===e.ClockOutResponseCode?(Ce.showToast("Clocked out at "+Object(ee.a)(Object(be.a)(e.ClockOutEvent.EventEnd),"h:mmaaa")),t(),je()):Se("Could not Clock Out","Unable to Clock out, ".concat(e.Message))}))};return c&&oe?r.a.createElement(r.a.Fragment,null,Ce.simpleToastJsx,r.a.createElement(s.t,{isOpen:_,onDidDismiss:function(){return Y(!1)},spinner:"dots",message:Q}),r.a.createElement("div",{className:"clock-controls"},r.a.createElement(zn,{updateCallback:je,isShowing:Oe}),oe.PositionsToClockInto&&oe.PositionsToClockInto.length>1&&r.a.createElement(s.o,{className:"item-no-border"},r.a.createElement(s.p,null,"Position"),r.a.createElement(s.F,{interface:"action-sheet",onIonChange:function(e){return t=e.detail.value,g(t),void Ie(t);var t},disabled:!((oe.UserClockedIn&&oe.UserMayClockOut||!oe.UserClockedIn&&oe.UserMayClockIn)&&L.ClockInRequirement!==Dn.MatchingShift),value:h},u.map((function(e){return r.a.createElement(s.G,{key:e.id,value:e.id},e.name)})))),O&&r.a.createElement(s.o,{className:"item-no-border"},r.a.createElement(s.p,null,"~Tag"),r.a.createElement(s.F,{interface:"action-sheet",onIonChange:function(e){return t=e.detail.value,void x(t);var t},disabled:!((oe.UserClockedIn&&oe.UserMayClockOut||!oe.UserClockedIn&&oe.UserMayClockIn)&&L.ClockInRequirement!==Dn.MatchingShift),value:D},I.map((function(e){return r.a.createElement(s.G,{key:e.id,value:e.id},e.name)})))),r.a.createElement(Un,{tcData:oe,locSettings:L,selectedPosId:h,selectedTagId:D,onSwitch:function(){$("Switching..."),Y(!0),Mn.switchPositionOrTag(o,h,D).then((function(e){Y(!1),e.AllowedToSwitchPositions||e.AllowedToSwitchTags?(Ce.showToast("Switched"),t(),je()):Se("Could not switch","".concat(e.ClockInMessage," ").concat(e.ClockOutMessage))}))}}),!oe.UserClockedIn&&r.a.createElement("div",{className:"clockin-button-container"},r.a.createElement(s.d,{className:"clockin-button",onClick:function(){$("Clocking in..."),Y(!0),Mn.clockIn(o,h,D).then((function(e){Y(!1),0===e.ClockInResponseCode?(Ce.showToast("Clocked in at "+Object(ee.a)(Object(be.a)(e.ClockInEvent.EventStart),"h:mmaaa")),t(),je()):Se("Could not Clock In","Unable to Clock in, ".concat(e.Message))}))},disabled:!oe.UserMayClockIn},r.a.createElement(s.m,{mode:"md",style:{paddingRight:"5px"},icon:m.v})," ","CLOCK IN")),oe.UserClockedIn&&r.a.createElement("div",{className:"clockout-button-container"},r.a.createElement(s.d,{className:"clockout-button",disabled:!oe.UserMayClockOut,expand:"block",onClick:function(){L.ClockOutValueLabel?me(!0):Te()}},"CLOCK OUT"," ",r.a.createElement(s.m,{mode:"md",style:{paddingLeft:"5px"},icon:m.v})),"NONE"!==P&&r.a.createElement(s.d,{onClick:function(){if("NONE"!==P&&oe)return"END BREAK"===P?($("Ending Break..."),Y(!0),void Mn.endBreak(o,oe.ClockedInScheduleEvent,oe.ScheduleEventsForClockIn.length>0?oe.ScheduleEventsForClockIn[0]:null).then((function(e){Y(!1),e.EndBreakResponseCode===wn.Success?(Ce.showToast("Ended break at ".concat(Object(ee.a)(Object(be.a)(e.BreakEnd),"h:mmaaa"))),t(),je()):Se("Did not come off break",e.Message)}))):void(L.UnscheduledBreakOptions!==ie.None||oe.ClockedInScheduleEvent.EventBreaks&&oe.ClockedInScheduleEvent.EventBreaks.length>0?q(!0):Se("No implemented","Not implemented in ClockPanel.tsx for this scenario"))},expand:"block",className:"break-button",disabled:!oe.UserMayClockOut},r.a.createElement(s.m,{icon:m.h}),P))),r.a.createElement(s.x,{isOpen:V,cssClass:"break-selector-modal"},r.a.createElement(Pn,{auth:c,tcData:oe,onDismissModal:function(e){return n=e,void(oe&&(q(!1),"Cancel"!==n.key&&($("Starting Break..."),Y(!0),Mn.startBreak(o,oe.ClockedInScheduleEvent,oe.ScheduleEventsForClockIn[0],n.breakType,n.breakType===le.Scheduled?n.key:void 0).then((function(e){Y(!1),e.StartBreakResponseCode===An.Success?(Ce.showToast("Break started at "+Object(ee.a)(Object(be.a)(e.BreakStart),"h:mmaaa")),t(),je()):Se("Could not start break","Unable to start break, ".concat(e.Message))})))));var n}})),r.a.createElement(s.x,{cssClass:"clockout-modal",isOpen:de,onDidDismiss:function(){me(!1)}},r.a.createElement(Rn,{onCancel:function(){me(!1)},onOk:Te,locSettings:L})),r.a.createElement(s.b,{isOpen:te.show,onDidDismiss:function(){return ne(Object(p.a)({},te,{show:!1}))},header:te.header,message:te.message,buttons:["OK"]})):r.a.createElement("div",null,"Loading...")};var qn=function(e){var t,n,a=e.startDate,o=e.endDate,c=e.onNextPayPeriod,i=e.onPrevPayPeriod,l=null===a||null===o?"":(n=o,(t=a)&&n?t.getMonth()!==n.getMonth()?Object(ee.a)(t,"MMM d").toUpperCase()+" - "+Object(ee.a)(Object(Ce.a)(n,-1),"MMM d").toUpperCase():Object(ee.a)(t,"MMM d").toUpperCase()+" - "+Object(ee.a)(Object(Ce.a)(n,-1),"d"):" ");return r.a.createElement("div",{className:"chooser"},r.a.createElement("div",{className:"top"},r.a.createElement("button",{onClick:i,className:"arrow",key:-1},r.a.createElement(s.m,{mode:"ios",icon:m.b})),r.a.createElement("div",{className:"month-year-container"},r.a.createElement("div",{className:"datetime-picker-container"},r.a.createElement("div",{className:"datetime-picker"},l))),r.a.createElement("button",{onClick:c,className:"arrow",key:7},r.a.createElement(s.m,{mode:"ios",icon:m.e}))))},Wn={getPayPeriodDateForEmployee:function(){var e=Object(v.a)(E.a.mark((function e(t,n,a){var r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=we(a),e.next=3,V.get(t,"api/v2/payroll/get/"+n+"/"+r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}()};function Gn(e,t){return function(e,t){if("00:00:00"===t.ActualTime)return e.TimeFormat===re.HoursMinutes?"00:00":Pe(0,e.TimeFormatDigits,e.TimeFormatDecimals);if(e.TimeFormat===re.HoursMinutes){var n=t.ActualTime.split(":");if(3!==n.length)return t.ActualTime;if(n[0].includes(".")){var a=n[0].split("."),r=24*parseInt(a[0])+parseInt(a[1]);return"".concat(r,":").concat(n[1])}var o=parseInt(n[0]);return"".concat(o,":").concat(n[1])}return Pe(t.ActualHours,e.TimeFormatDigits,e.TimeFormatDecimals)}(e,t)}var _n=function(e){var t=e.time,n=e.locSettings,a=e.fontColor;if(null===t)return r.a.createElement("span",null," -- ");var o=0===t.ActualHours?"#ddd":a;return r.a.createElement("span",{style:{color:o}},Gn(n,t))};var Yn=function(e){var t=e.onClose,n=e.data,o=e.locSettings,c=Object(a.useContext)(pe).auth;return n?r.a.createElement(r.a.Fragment,null,r.a.createElement(s.h,null,r.a.createElement(s.l,{mode:"ios"},r.a.createElement(s.R,null,r.a.createElement(s.O,null,Ne(Object(be.a)(n.date))))),r.a.createElement(s.k,null,n.regular.ActualHours>0&&r.a.createElement(s.C,null,r.a.createElement(s.g,{size:"7"},"Regular"),r.a.createElement(s.g,{size:"5"},r.a.createElement(_n,{time:n.regular,locSettings:o,fontColor:"black"}))),n.dailyOvertime.ActualHours>0&&r.a.createElement(s.C,null,r.a.createElement(s.g,{size:"7"},"Daily Overtime"),r.a.createElement(s.g,{size:"5"},r.a.createElement(_n,{time:n.dailyOvertime,locSettings:o,fontColor:"red"}))),n.weeklyOvertime.ActualHours>0&&r.a.createElement(s.C,null,r.a.createElement(s.g,{size:"7"},"Weekly Overtime"),r.a.createElement(s.g,{size:"5"},r.a.createElement(_n,{time:n.weeklyOvertime,locSettings:o,fontColor:"red"}))),n.special.ActualHours>0&&r.a.createElement(s.C,null,r.a.createElement(s.g,{size:"7"},"Special Dates"),r.a.createElement(s.g,{size:"5"},r.a.createElement(_n,{time:n.special,locSettings:o,fontColor:"black"}))),n.timePerAbsent&&n.timePerAbsent.map((function(e){return r.a.createElement(s.C,{key:e.absentId},r.a.createElement(s.g,{size:"7"},function(e,t){return e.payrollEvents.filter((function(e){return e.id===t}))[0].name}(c,e.absentId)),r.a.createElement(s.g,{size:"5"},r.a.createElement(_n,{time:e.time,locSettings:o,fontColor:"#AD850C"})))})))),r.a.createElement(s.j,null,r.a.createElement(s.d,{expand:"block",onClick:t},"CLOSE"))):r.a.createElement("div",null,"loading")};var Jn,Hn=function(e){var t,n=e.payrollRow,o=e.colsToDisplay,c=e.colSize,i=Object(a.useContext)(pe).auth,l=Je(i,i.locations[0].id),u=Object(a.useState)(!1),m=Object(d.a)(u,2),p=m[0],f=m[1];return null===n?r.a.createElement(s.C,null,r.a.createElement(s.g,{size:"3"},r.a.createElement(yn.a,{width:50})),r.a.createElement(s.g,{size:"3"},r.a.createElement(yn.a,{width:50})),r.a.createElement(s.g,{size:"3"},r.a.createElement(yn.a,{width:50})),r.a.createElement(s.g,{size:"3"},r.a.createElement(yn.a,{width:50}))):r.a.createElement(r.a.Fragment,null,r.a.createElement(s.C,null,r.a.createElement(s.g,{size:c},r.a.createElement("button",{className:"payperiod-list-buttons",onClick:function(){return f(!0)}},(t=n.date,Object(ee.a)(Object(be.a)(t),"EEE d")))),r.a.createElement(s.g,{size:c,color:"secondary",hidden:(o&Jn.Regular)!==Jn.Regular},r.a.createElement(_n,{time:null===n||void 0===n?void 0:n.regular,locSettings:l,fontColor:"black"})),r.a.createElement(s.g,{size:c,hidden:(o&Jn.DailyOvertime)!==Jn.DailyOvertime},r.a.createElement(_n,{time:null===n||void 0===n?void 0:n.dailyOvertime,locSettings:l,fontColor:"red"})),r.a.createElement(s.g,{size:c,hidden:(o&Jn.WeeklyOvertime)!==Jn.WeeklyOvertime},r.a.createElement(_n,{time:null===n||void 0===n?void 0:n.weeklyOvertime,locSettings:l,fontColor:"red"})),r.a.createElement(s.g,{size:c,hidden:(o&Jn.Special)!==Jn.Special},r.a.createElement(_n,{time:null===n||void 0===n?void 0:n.special,locSettings:l,fontColor:"black"})),r.a.createElement(s.g,{size:c,hidden:(o&Jn.Absent)!==Jn.Absent},r.a.createElement(_n,{time:null===n||void 0===n?void 0:n.absent,locSettings:l,fontColor:"black"}))),r.a.createElement(s.x,{cssClass:"detail-modal",isOpen:p,onDidDismiss:function(){return f(!1)}},r.a.createElement(Yn,{onClose:function(){return f(!1)},locSettings:l,data:n})))};!function(e){e[e.None=0]="None",e[e.Regular=1]="Regular",e[e.DailyOvertime=2]="DailyOvertime",e[e.WeeklyOvertime=4]="WeeklyOvertime",e[e.Special=8]="Special",e[e.Absent=16]="Absent",e[e.All=31]="All"}(Jn||(Jn={}));var Kn=function(e){var t=e.payrollData,n=Object(a.useContext)(pe).auth,o=Je(n,n.locations[0].id),c=Object(a.useState)(Jn.None),i=Object(d.a)(c,2),l=i[0],u=i[1],m=Object(a.useState)("3"),p=Object(d.a)(m,2),f=p[0],E=p[1];return Object(a.useEffect)((function(){if(t){var e=function(e){var t=Jn.Regular,n=2;return e.totalDailyOvertime.ActualHours>0&&(t|=Jn.DailyOvertime,n++),e.totalWeeklyOvertime.ActualHours>0&&(t|=Jn.WeeklyOvertime,n++),e.totalSpecial.ActualHours>0&&(t|=Jn.Special,n++),e.totalAbsent.ActualHours>0&&(t|=Jn.Absent,n++),{cols:t,count:n}}(t),n=e.count,a=e.cols;u(a),E(n>=5?"2":"3")}}),[t]),null===t?r.a.createElement("div",{className:"grid-container"},r.a.createElement(s.k,{class:"ion-text-end"},r.a.createElement(s.C,{className:"list-header",class:"ion-text-center"},r.a.createElement(s.g,{size:"3"},r.a.createElement(yn.a,{width:60})),r.a.createElement(s.g,{size:"3"},r.a.createElement(yn.a,{width:60})),r.a.createElement(s.g,{size:"3"},r.a.createElement(yn.a,{width:60})),r.a.createElement(s.g,{size:"3"},r.a.createElement(yn.a,{width:60}))),[1,2,3,4,5,6,7,8,9,10].map((function(e){return r.a.createElement(Hn,{payrollRow:null,colSize:"3",colsToDisplay:Jn.None,key:e})})))):r.a.createElement("div",{className:"grid-container"},r.a.createElement(s.k,{class:"ion-text-end"},r.a.createElement(s.C,{className:"list-header",class:"ion-text-center"},r.a.createElement(s.g,{size:f},"DATE"),r.a.createElement(s.g,{size:f,hidden:(l&Jn.Regular)!==Jn.Regular},"REG"),r.a.createElement(s.g,{size:f,hidden:(l&Jn.DailyOvertime)!==Jn.DailyOvertime},"DAILY OT"),r.a.createElement(s.g,{size:f,hidden:(l&Jn.WeeklyOvertime)!==Jn.WeeklyOvertime},"WKLY OT"),r.a.createElement(s.g,{size:f,hidden:(l&Jn.Special)!==Jn.Special},"SPECIAL"),r.a.createElement(s.g,{size:f,hidden:(l&Jn.Absent)!==Jn.Absent},"ABSENT")),null===t||void 0===t?void 0:t.list.map((function(e){return r.a.createElement(Hn,{key:e.date,payrollRow:e,colsToDisplay:l,colSize:f})})),r.a.createElement(s.C,{className:"list-footer"},r.a.createElement(s.g,{size:f},"TOTAL"),r.a.createElement(s.g,{size:f,hidden:(l&Jn.Regular)!==Jn.Regular},r.a.createElement(_n,{time:null===t||void 0===t?void 0:t.totalRegular,locSettings:o,fontColor:"black"})),r.a.createElement(s.g,{size:f,hidden:(l&Jn.DailyOvertime)!==Jn.DailyOvertime},r.a.createElement(_n,{time:null===t||void 0===t?void 0:t.totalDailyOvertime,locSettings:o,fontColor:"red"})),r.a.createElement(s.g,{size:f,hidden:(l&Jn.WeeklyOvertime)!==Jn.WeeklyOvertime},r.a.createElement(_n,{time:null===t||void 0===t?void 0:t.totalWeeklyOvertime,locSettings:o,fontColor:"red"})),r.a.createElement(s.g,{size:f,hidden:(l&Jn.Special)!==Jn.Special},r.a.createElement(_n,{time:null===t||void 0===t?void 0:t.totalSpecial,locSettings:o,fontColor:"black"})),r.a.createElement(s.g,{size:f,hidden:(l&Jn.Absent)!==Jn.Absent},r.a.createElement(_n,{time:null===t||void 0===t?void 0:t.totalAbsent,locSettings:o,fontColor:"black"})))))},Qn=function(e){var t=e.date,n=r.a.useContext(K).user,o=r.a.useContext(pe).auth,c=Object(a.useState)(null),i=Object(d.a)(c,2),l=i[0],u=i[1],m=Object(a.useState)(null),p=Object(d.a)(m,2),f=p[0],E=p[1],v=Object(a.useState)(null),h=Object(d.a)(v,2),g=h[0],b=h[1],y=Object(a.useState)(null),O=Object(d.a)(y,2),k=O[0],C=O[1],j=$(),I=Mt((function(e){S(e)}));function S(e){Wn.getPayPeriodDateForEmployee(n,o.locations[0].id,l).then((function(t){t.error?j.showAlert("Error","Could not retrieve Payroll data: "+t.message,(function(){})):(E(Object(be.a)(t.start)),b(Object(be.a)(t.end)),C(t),e&&e.detail.complete())}))}Object(a.useEffect)((function(){var e=t;null===t&&(e=new Date),u(e)}),[t]),Object(a.useEffect)((function(){null!=l&&S()}),[l]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(qn,{startDate:f,endDate:g,onNextPayPeriod:function(){u(Object(Ce.a)(g,1))},onPrevPayPeriod:function(){u(Object(Ce.a)(f,-1))}}),r.a.createElement(s.h,null,I.ionicRefresherJsx,o&&o.locations&&o.locations.length>0&&r.a.createElement(Kn,{payrollData:k}),j.alertBoxJsx))},$n=function(e){var t=e.authItems,n=e.oneLine,a=e.dailyNote;return a?r.a.createElement("button",{className:"card daily-note"},r.a.createElement("div",{className:"event-color-col"}),r.a.createElement("div",{className:"card-second-col"},r.a.createElement("div",{className:"dept-position-row"},function(e,t){var n="";return t.locations.length>=1&&(n=t.locations.filter((function(t){return t.id===e.LocationId}))[0].abbr+"/"),-1===e.DepartmentId?n+"All Departments":n+e.DepartmentName}(a,t)),r.a.createElement("div",{className:n?"note-text-row-oneline":"note-text-row"},a.Notes))):r.a.createElement("div",null)},Xn={1:"#9CBA6A",2:"#BFBFBF",3:"#FFAD00",4:"#C41A26",6:"#677A46",7:"#FFAD00"},Zn={1:{color:"black"},2:{color:"#C41A26"},4:{color:"#BCBCBC"}};var ea=function(e){var t=e.event,n=e.locations,o=e.onEdit,c=Object(a.useContext)(pe).auth;if(!t||!c||!c.locations||0===c.locations.length)return r.a.createElement("div",null);var i,l=new Date(9e3,1,1),u=t.EventTypeId===We.Clock&&t.EventStatusId===_e.Approved&&t.IsClockedIn,d=t.EventTypeId===We.Clock&&t.EventStatusId===_e.Approved&&t.EventBreaks.filter((function(e){return!e.BreakEnd||e.BreakEnd>l})).length>0,p=Zn[t.EventStatusId],f=u&&d?m.h:m.v,E=u?r.a.createElement("div",{className:"time-row"},r.a.createElement(s.m,{icon:f}),r.a.createElement("span",{style:p},(i=t,Object(ee.a)(Object(be.a)(i.EventStart),"h:mmaaa").replace("M","")))," ",Te(t.EventTypeId===We.Absent?t.Time:t.EventDuration)," "):r.a.createElement("div",{className:"time-row"},r.a.createElement("span",{style:p},function(e){var t=Object(ee.a)(Object(be.a)(e.EventStart),"h:mmaaa").replace("M",""),n=Object(ee.a)(Object(be.a)(e.EventEnd),"h:mmaaa").replace("M","");return"".concat(t," - ").concat(n)}(t))," ",Te(t.EventDuration)," "),v=t.Tag?" ~"+t.Tag:"",h={borderLeft:"7px solid ".concat(Xn[t.EventTypeId]," ")};return r.a.createElement("button",{onClick:function(){var e=st(t.EventTypeId,t.EventStatusId,t.EmployeeId,t.EventStart,t.EventEnd,t.LocationId,t.DepartmentId,t.PositionId,t.IsConfirmed,c);null!==e&&o(t,e)},className:"card"},r.a.createElement("div",{className:"card-second-col",style:h},E,r.a.createElement("div",{className:"dept-position-row"},function(e,t){var n=e.filter((function(e){return e.id===t.LocationId}))[0],a=e.filter((function(e){return e.departments.filter((function(e){return e.positions.filter((function(e){return e.hasPosition}))}))})).length>1,r=!!a||n.departments.filter((function(e){return e.positions.filter((function(e){return e.hasPosition}))})).length>1,o="";return a&&(t.AbbreviatedLocationName?o=t.AbbreviatedLocationName+"/":t.LocationAbbreviation&&(o=t.LocationAbbreviation+"/")),r&&(t.AbbreviatedDepartmentName?o+=t.AbbreviatedDepartmentName+"/":t.DepartmentAbbreviation&&(o+=t.DepartmentAbbreviation+"/")),o+=t.PositionName}(n,t)," ",v),t.EventBreaks&&t.EventBreaks.map((function(e){return r.a.createElement("div",{key:e.BreakStart,className:"break-div"},"(B) ",De(e))}))))},ta=function(){return r.a.createElement("button",{className:"card"},r.a.createElement("div",{style:{paddingLeft:"20px",paddingRight:"2px"}},r.a.createElement(yn.a,{width:5,height:40})),r.a.createElement("div",{className:"card-second-col"},r.a.createElement(yn.a,{width:150}),r.a.createElement("div",{className:"dept-position-row"},r.a.createElement(yn.a,{width:150}))))},na=function(e){var t=e.refreshToggle,n=e.onUpdate,o=Object(a.useState)(ue),c=Object(d.a)(o,2),i=c[0],l=c[1],u=Mt((function(e){U(e)})),m=r.a.useContext(K).user,p=$(),f=Object(a.useState)(!1),E=Object(d.a)(f,2),v=E[0],h=E[1],g=Object(a.useState)(null),b=Object(d.a)(g,2),y=b[0],O=b[1],k=Object(a.useState)(null),C=Object(d.a)(k,2),j=C[0],I=C[1],S=Object(a.useState)(cn),T=Object(d.a)(S,2),N=T[0],D=T[1],x=Object(a.useState)(!1),A=Object(d.a)(x,2),w=A[0],P=A[1],M=Object(a.useContext)(pe).auth,R=function(e,t){O(e.ScheduleEventId),I(t),D(nn(M,e)),h(!0)};function U(e){try{ae.getHomePageData(m).then((function(t){console.log("ClockTodayTab.getData: got homepage data"),l(t),P(!1),e&&(e.detail.complete(),n())}))}catch(e){console.log("Error in ClockTodayTab.getData: "+e.message)}}Object(a.useEffect)((function(){m&&m.isLoggedin&&(P(!0),U(void 0))}),[t]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(s.h,{className:"outer-content"},u.ionicRefresherJsx,r.a.createElement(s.r,{className:"todaylist",lines:"none"},r.a.createElement(s.s,{className:"list-header",mode:"ios"},r.a.createElement(s.p,{className:"label-list-header",mode:"ios"},Ne(new Date))),w&&(i.dailyNotes&&i.dailyNotes.length>0||i.currentEvents&&i.currentEvents.length>0)&&r.a.createElement(s.H,{className:"center",name:"dots"}),w&&(!i.dailyNotes||0===i.dailyNotes.length||!i.currentEvents||0===i.currentEvents.length)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ta,null),r.a.createElement(ta,null)),i.dailyNotes&&i.dailyNotes.map((function(e){return r.a.createElement(s.o,{key:e.DailyNoteId},r.a.createElement($n,{authItems:i.auth,oneLine:!1,dailyNote:e}))})),i.currentEvents.map((function(e){return r.a.createElement(s.o,{key:e.ScheduleEventId},r.a.createElement(ea,{onEdit:R,locations:i.auth.locations,event:e}))})))),r.a.createElement(s.x,{isOpen:v,onDidDismiss:function(){return h(!1)}},r.a.createElement(gn,{isOpen:v,auth:i.auth,onCancelModal:function(){return h(!1)},onDismissModal:function(){return U(void 0),void h(!1)},scheduleEventId:y,eventEditAuth:j,initialEvent:N})),p.alertBoxJsx)},aa=function(){var e=Object(a.useState)("today"),t=Object(d.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)(!1),i=Object(d.a)(c,2),l=i[0],u=i[1],m=Object(a.useState)(!1),p=Object(d.a)(m,2),f=p[0],E=p[1],v=r.a.useContext(K).user,h=r.a.useContext(pe),g=h.auth,b=h.refreshAuth;Object(a.useEffect)((function(){g&&g.locations&&0!==g.locations.length||b(!1,v)}),[g]);return r.a.createElement(s.y,null,r.a.createElement(s.l,{className:"ion-no-border"},r.a.createElement(s.R,{mode:"md"},r.a.createElement(s.e,{slot:"start"},r.a.createElement(s.v,null)),r.a.createElement(s.O,{slot:"start"},"Clock"))),r.a.createElement(s.D,{mode:"md",onIonChange:function(e){return t=e.detail.value,void o(t);var t}},r.a.createElement(s.E,{mode:"md",value:"today"},"TODAY"),r.a.createElement(s.E,{mode:"md",value:"pay-periods"},"PAY PERIOD")),"today"===n&&r.a.createElement(na,{refreshToggle:l,onUpdate:function(){console.log("onTodayPanelUpdate"),E(!f)}}),"pay-periods"===n&&r.a.createElement(Qn,{date:null}),r.a.createElement(s.j,{className:"footer"},"today"===n&&r.a.createElement(Vn,{refreshToggle:f,onUpdate:function(){u(!l)}})))},ra=function(e){var t=e.message,n=e.onMessageClick;if(!t)return r.a.createElement("div",null);var a=t.isViewed?"normal":"bold";return r.a.createElement("button",{className:"message",onClick:n},r.a.createElement("div",{className:"top-line"},r.a.createElement("span",{className:"subject",style:{fontWeight:a}},t.isPinned&&r.a.createElement(s.m,{icon:m.g,style:{color:"gray"}}),t.subject),r.a.createElement("span",{className:"time"},function(e){var t=Object(be.a)(e),n=new Date;return Object(ye.a)(t)?Object(ee.a)(t,"h:mmaaa").replace("M",""):Object(Oe.a)(n,t)<7?Object(ee.a)(t,"EEE"):Object(ke.a)(t,n)?Object(ee.a)(t,"MMM d"):Object(ee.a)(t,"M/d/yyyy")}(t.deliveryDateTime)," ")),r.a.createElement("div",{className:"bottom-line"},t.previewLine))},oa=function(e){var t=e.onDismissModal,n=e.onCancelModal,o=e.filterData,c=Object(a.useState)({msgTypeIds:o.msgTypes?o.msgTypes.map((function(e){return e.messageTypeId})):[],employeeId:-1}),i=Object(d.a)(c,2),l=i[0],u=i[1],f=function(){n()};return r.a.createElement(r.a.Fragment,null,r.a.createElement(s.l,{className:"ion-no-border"},r.a.createElement(s.R,null,r.a.createElement(s.e,{slot:"start"},r.a.createElement(s.d,{onClick:f},r.a.createElement(s.m,{icon:m.c,mode:"md",slot:"icon-only"}))),r.a.createElement(s.O,null,"Filter"),r.a.createElement(s.e,{slot:"end"},r.a.createElement(s.d,{onClick:function(){u({msgTypeIds:o.msgTypes.map((function(e){return e.messageTypeId})),employeeId:-1})}},"RESET ALL")))),r.a.createElement(s.h,{class:"outer-content"},r.a.createElement(s.o,null,r.a.createElement(s.p,null,"From"),r.a.createElement(s.F,{value:l.employeeId,onIonChange:function(e){return u(Object(p.a)({},l,{employeeId:e.detail.value}))},interface:"action-sheet"},r.a.createElement(s.G,{key:-1,value:-1},"EVERYONE"),o&&o.employees&&o.employees.map((function(e){return r.a.createElement(s.G,{key:e.employeeId,value:e.employeeId},e.name)})))),r.a.createElement(s.o,null,r.a.createElement(s.p,null,"Message Types")),o.msgTypes&&r.a.createElement(X,{list:o.msgTypes.map((function(e){return{id:e.messageTypeId,name:e.name,description:""}})),selected:o.msgTypes.filter((function(e){return l.msgTypeIds.includes(e.messageTypeId)})).map((function(e){return{id:e.messageTypeId,name:e.name,description:""}})),selectionChanged:function(e){u(Object(p.a)({},l,{msgTypeIds:e.map((function(e){return e.id}))}))}})),r.a.createElement(s.j,{className:"outer-content footer"},r.a.createElement(s.d,{className:"apply-button",expand:"block",onClick:function(){t(l)}},"APPLY FILTER"),r.a.createElement(s.d,{className:"apply-button",expand:"block",onClick:f,color:"tertiary"},"BACK")))},ca=new A;[{id:1,typeName:"CoverRequestMessage",description:"Cover-Request"},{id:2,typeName:"CoverApprovedMessage",description:"Cover-Approved"},{id:3,typeName:"DirectCoverRequestMessage",description:"Direct Cover-Request"},{id:5,typeName:"ShiftRequestMessage",description:"Shift-Request"},{id:6,typeName:"ShiftRequestDeniedMessage",description:"Shift-Denied"},{id:10,typeName:"ShiftRequestReceivedMessage",description:"Shift-Request Received"},{id:20,typeName:"NoClockInAlertMessage",description:"No Clock In Alert"},{id:21,typeName:"NoClockOutAlertMessage",description:"No Clock Out Alert"},{id:22,typeName:"LateClockInMessage",description:"Late Clock In Alert"},{id:23,typeName:"EarlyClockOutAlertMessage",description:"Early Clock Out Alert"},{id:50,typeName:"ScheduleEventUpdatedMessage",description:"Schedule Event Updated"},{id:60,typeName:"PublishedScheduleUpdatedMessage",description:"Published Schedule Updated"},{id:80,typeName:"PasswordRecoveryMessage",description:"Password Recovery"},{id:81,typeName:"VerifyCellPhoneMessage",description:"Verify Cell Phone"},{id:82,typeName:"VerifyCellPhoneCompleteMessage",description:"Verify Cell Phone Completed"},{id:83,typeName:"VerifyEmailMessage",description:"Verify Email"},{id:100,typeName:"CustomMessage",description:"Custom Messages"},{id:101,typeName:"WeeklyScheduleForEmployeeMessage",description:"Employee Weekly Schedule"},{id:555,typeName:"WelcomeMessage",description:"Welcome"},{id:603,typeName:"UpdatePaymentInformationMessage",description:"Update Payment Information"},{id:700,typeName:"UpgradeSubscriptionMessage",description:"Upgrade Subscription (to Orbital)"},{id:701,typeName:"FailedSignupMessage",description:"Failed Signup"},{id:702,typeName:"GenericErrorMessage",description:"Error Message"},{id:704,typeName:"SignupMessage",description:"Signup Completed"},{id:705,typeName:"DatesOutOfSyncMessage",description:"Dates Out of Sync"},{id:708,typeName:"CancelSubscriptionMessage",description:"Canceled Subscription  "}].map((function(e){return ca.add(""+e.id,e)}));var ia={getUserMessage:function(){var e=Object(v.a)(E.a.mark((function e(t,n){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.get(t,"api/v2/employee/messages/"+n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),getUserMessages:function(){var e=Object(v.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.get(t,"api/v2/employee/messages");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getReadCount:function(){var e=Object(v.a)(E.a.mark((function e(t,n){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.get(t,"api/v1/employee/messages/"+n+"/readCount");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),setIsPinned:function(){var e=Object(v.a)(E.a.mark((function e(t,n,a){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.post(t,"api/v1/employee/messages/"+n+"/togglePin",{isPinned:a});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),setIsViewed:function(){var e=Object(v.a)(E.a.mark((function e(t,n,a){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.post(t,"api/v1/employee/messages/"+n+"/toggleView",{isViewed:a});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),deleteMessage:function(){var e=Object(v.a)(E.a.mark((function e(t,n){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.del(t,"api/v1/employee/messages/"+n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),getUnreadCount:function(){var e=Object(v.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isLoggedin){e.next=2;break}return e.abrupt("return",0);case 2:return e.next=4,V.get(t,"api/v2/employee/messages/unreadCount");case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),sendMessage:function(){var e=Object(v.a)(E.a.mark((function e(t,n,a,r,o){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.post(t,"api/v2/employee/messages/send",{locId:n,channel:a,empIds:r,text:o});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n,a,r,o){return e.apply(this,arguments)}}()},la=r.a.createContext({unreadMessagesCount:0,refreshCount:function(){}}),sa=function(e){var t=Object(a.useContext)(K).user,n=Object(a.useState)({unreadMessagesCount:0}),o=Object(d.a)(n,2),c=o[0],i=o[1];function l(){t.isLoggedin&&ia.getUnreadCount(t).then((function(e){e!==c.unreadMessagesCount&&i({unreadMessagesCount:e})}))}return Object(a.useEffect)((function(){t.isLoggedin&&l()}),[t.isLoggedin]),Cn((function(){l()}),L(t).checkUnreadMessageCountTimer),r.a.createElement(la.Provider,{value:{refreshCount:function(){l()},unreadMessagesCount:c.unreadMessagesCount}},e.children)},ua=function(e){var t=e.message,n=e.onCloseModal,o=e.updateMessages,c=$(),i=Bn(),l=r.a.useContext(K).user,u=r.a.useContext(pe).auth,p=Object(a.useState)(null),f=Object(d.a)(p,2),E=f[0],v=f[1],h=Object(a.useState)(null),g=Object(d.a)(h,2),b=g[0],y=g[1],O=Object(a.useState)(null),k=Object(d.a)(O,2),C=k[0],j=k[1],I=Object(a.useState)(null),S=Object(d.a)(I,2),T=S[0],N=S[1],D=Object(a.useState)(!1),x=Object(d.a)(D,2),A=x[0],w=x[1],P=Object(a.useContext)(la).refreshCount;Object(a.useEffect)((function(){t&&(t.scheduleEventId?Le.getScheduleEvent(l,t.scheduleEventId).then((function(e){if(e){v(e);var t=st(e.EventTypeId,e.EventStatusId,e.EmployeeId,e.EventStart,e.EventEnd,e.LocationId,e.DepartmentId,e.PositionId,null!==e.ConfirmedBy&&void 0!==e.ConfirmedBy&&e.ConfirmedBy,u);y(t)}})):E&&(v(null),N(null)),ia.getReadCount(l,t.messageId).then((function(e){j(e)})),t.isViewed||ia.setIsViewed(l,t.messageId,!0).then((function(){o({type:"UPDATE-VIEWED",msgId:t.messageId,isViewed:!0})})),w(t.isPinned))}),[null===t||void 0===t?void 0:t.messageId]);var M,R=function(e){(null===t||void 0===t?void 0:t.isViewed)||P(),n(e)};return t&&u&&u.locations&&0!==u.locations.length?r.a.createElement(r.a.Fragment,null,r.a.createElement(s.l,{className:"ion-no-border"},r.a.createElement(s.R,null,r.a.createElement(s.e,{slot:"start"},r.a.createElement(s.d,{onClick:function(){R(null)}},r.a.createElement(s.m,{icon:m.c,mode:"md",slot:"icon-only"}))),r.a.createElement(s.e,{slot:"end"},r.a.createElement(s.d,{onClick:function(){!function(){var e=!A;ia.setIsPinned(l,t.messageId,e).then((function(){w(e),o({type:"UPDATE-PINNED",msgId:t.messageId,isPinned:e})}))}()}},r.a.createElement(s.m,{icon:m.g,style:A?{color:"black"}:{color:"lightgray"}})),r.a.createElement(s.d,{onClick:function(){i.showDialog("Delete this message?",(function(){ia.deleteMessage(l,t.messageId).then((function(){o({type:"DELETE",msgId:t.messageId}),R("Message Deleted")}))}),(function(){}))}},r.a.createElement(s.m,{icon:m.x}))))),r.a.createElement(s.h,{class:"outer-contentMessage"},r.a.createElement(s.k,null,r.a.createElement(s.C,{class:"messageIonRow-header"},r.a.createElement(s.g,{class:"messageHeaderSubject",size:"12"},t.subject),r.a.createElement(s.g,{class:"messageHeaderDetails",size:"12"},"From: ",t.fromEmployeeFirstName," ",t.fromEmployeeLastName),r.a.createElement(s.g,{class:"messageHeaderDetails",size:"9"},(M=t.deliveryDateTime,Object(ee.a)(Object(be.a)(M),"M/d EEE h:mmaa").replace("M",""))),r.a.createElement(s.g,{class:"readCounter",size:"3"},null!==C&&r.a.createElement("span",null,C," Read"))),r.a.createElement("div",null),r.a.createElement(s.C,{class:"messageIonRow-content"},r.a.createElement(s.g,{class:"messageBlock",size:"12"},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:null===t||void 0===t?void 0:t.messageText}}))),null!==T&&r.a.createElement(s.C,null,r.a.createElement(s.g,{size:"12"},T))),c.alertBoxJsx,i.dialogJsx),r.a.createElement(s.j,{className:"outer-content footer"},null!==E&&r.a.createElement(pn,{auth:u,eventEnd:E.EventEnd,eventType:E.EventTypeId,eventStatus:E.EventStatusId,eventEmployeeId:E.EmployeeId,eventPositionId:E.PositionId,scheduleEventId:E.ScheduleEventId,locationId:E.LocationId,update:function(){},cancelEditModal:R,eventEditAuth:b,setUsageText:N}),r.a.createElement(s.d,{className:"apply-button",expand:"block",onClick:function(){R(null)},color:"tertiary"},"BACK"))):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,"Loading"),c.alertBoxJsx)};function da(e,t){var n=He(e,t);if(null===n)throw new Error("Can't find location");return{location:n,department:null,position:null}}var ma=function(e){var t,n=e.currentPosition,o=e.onPositionUpdate,c=Object(a.useContext)(pe).auth,i=Object(a.useState)(n),l=Object(d.a)(i,2),u=l[0],m=l[1],p=function(e){if(void 0!==e){var t=function(e,t,n){if(null===n)return da(e,t.location.id);var a=t.location.departments.filter((function(e){return e.id===n}))[0];return{location:t.location,department:a,position:null}}(c,u,e);m(t),o(t)}};return c&&c.locations&&0!==c.locations.length?r.a.createElement(r.a.Fragment,null,r.a.createElement(s.o,null,r.a.createElement(s.p,null,"Location"),r.a.createElement(s.F,{interface:"popover",style:{maxWidth:"100%"},value:u.location.id,onIonChange:function(e){return function(e){if(e){var t=da(c,e);m(t),o(t)}}(e.detail.value)}},c.locations.filter((function(e){return function(e,t){return e.role===te.LocationAdmin||e.role===te.BusinessAdmin||e.role!==te.Employee&&void 0!==t.departments.find((function(e){return e.isDeptAdmin}))}(c,e)})).map((function(e){return r.a.createElement(s.G,{key:e.id,value:e.id},e.name)})))),r.a.createElement(s.o,null,r.a.createElement(s.p,null,"Department"),r.a.createElement(s.F,{interface:"popover",style:{maxWidth:"100%"},value:null===u.department?null:u.department.id,onIonChange:function(e){return p(e.detail.value)}},r.a.createElement(s.G,{key:-1,value:null},"All Departments"),u.location.departments&&u.location.departments.filter((function(e){return nt(c,e.id)})).map((function(e){return r.a.createElement(s.G,{key:e.id,value:e.id},e.name)})))),r.a.createElement(s.o,null,r.a.createElement(s.p,null,"Position"),r.a.createElement(s.F,{interface:"popover",style:{maxWidth:"100%"},value:null===u.position?null:u.position.id,onIonChange:function(e){return function(e){if(void 0!==e){var t=function(e,t,n){if(null===n)return{location:t.location,department:t.department,position:null};var a=t.department.positions.filter((function(e){return e.id===n}))[0];return{location:t.location,department:t.department,position:a}}(0,u,e);m(t),o(t)}}(e.detail.value)}},r.a.createElement(s.G,{key:-1,value:null},"All Positions"),(t=u,null!==t.department?t.department.positions:t.location.departments.flatMap((function(e){return e.positions}))).map((function(e){return r.a.createElement(s.G,{key:e.id,value:e.id},null===u.department?Ke(c,e.id).abbr+"/"+e.name:e.name)}))))):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,"Loading"))},pa=r.a.createElement(s.m,{icon:m.q}),fa=r.a.createElement(s.m,{icon:m.s}),Ea=r.a.createElement(s.m,{icon:m.r});function va(e,t){switch(t){case-1:return e.hasEmail||e.hasText||e.hasPush;case 1:return e.hasEmail;case 2:return e.hasText;case 3:return e.hasPush;default:return!1}}var ha=function(e){var t=e.onOk,n=e.employeeList,o=e.selectedEmployeeList,c=e.channel,i=Object(a.useState)([]),l=Object(d.a)(i,2),u=l[0],m=l[1],f=Object(a.useState)(!1),E=Object(d.a)(f,2),v=E[0],h=E[1];return Object(a.useEffect)((function(){var e=n.map((function(e){return{id:e.id,name:e.name,hasEmail:e.hasEmail,hasText:e.hasText,hasPush:e.hasPush,isChecked:o.some((function(t){return t.id===e.id}))}}));m(e)}),[n,o]),r.a.createElement(r.a.Fragment,null,r.a.createElement(s.l,{mode:"ios"},r.a.createElement(s.R,null,r.a.createElement(s.O,null,"Employees"))),r.a.createElement(s.h,null,r.a.createElement(s.k,null,r.a.createElement(s.C,{key:-1},r.a.createElement(s.g,{size:"3"},r.a.createElement(s.f,{className:"checkbox",checked:v,onClick:function(){var e=!v,t=u.map((function(t){return va(t,c)?Object(p.a)({},t,{isChecked:e}):Object(p.a)({},t,{isChecked:!1})}));m(t),h(e)}})),r.a.createElement(s.g,{className:"label",size:"6"},"Select All"),r.a.createElement(s.g,{size:"1"},pa),r.a.createElement(s.g,{size:"1"},fa),r.a.createElement(s.g,{size:"1"},Ea)),u.map((function(e){return r.a.createElement(s.C,{key:e.id},r.a.createElement(s.g,{size:"3"},r.a.createElement(s.f,{className:"checkbox",checked:e.isChecked,disabled:!va(e,c),onClick:function(){!function(e){var t=0,a=u.map((function(n){return va(n,c)?n.isChecked?n.id===e?Object(p.a)({},n,{isChecked:!1}):(t++,Object(p.a)({},n,{isChecked:va(n,c)})):n.id===e?(t++,Object(p.a)({},n,{isChecked:va(n,c)})):Object(p.a)({},n,{isChecked:!1}):Object(p.a)({},n,{isChecked:!1})})),r=n.filter((function(e){return va(e,c)})).length;h(t===r),m(a)}(e.id)}})),r.a.createElement(s.g,{className:"label",size:"6"},e.name),r.a.createElement(s.g,{size:"1"},e.hasEmail&&pa),r.a.createElement(s.g,{size:"1"},e.hasText&&fa),r.a.createElement(s.g,{size:"1"},e.hasText&&Ea))})))),r.a.createElement(s.j,null,r.a.createElement(s.d,{expand:"block",color:"secondary",onClick:function(){t(u.filter((function(e){return e.isChecked})))}},"OK")))},ga=[{id:-1,text:"All Channels"},{id:1,text:"Email"},{id:2,text:"Text"},{id:3,text:"Push Notification"}];var ba=function(e){var t=e.onUpdate,n=Object(a.useContext)(K).user,o=Object(a.useContext)(pe).auth,c=Object(a.useState)("All"),i=Object(d.a)(c,2),l=i[0],u=i[1],m=Object(a.useState)(function(e){for(var t=0;t<e.locations.length;t++){var n=e.locations[t];if(n.adminAllDepts)return{location:n,department:null,position:null};for(var a=0;a<n.departments.length;a++){var r=n.departments[a];if(r.isDeptAdmin)return{location:n,department:r,position:null}}}throw new Error("Could not find a department where this user could send messages")}(o)),p=Object(d.a)(m,2),f=p[0],E=p[1],v=Object(a.useState)(-1),h=Object(d.a)(v,2),g=h[0],b=h[1],y=Object(a.useState)([]),O=Object(d.a)(y,2),k=O[0],C=O[1],j=Object(a.useState)([]),I=Object(d.a)(j,2),S=I[0],T=I[1],N=Object(a.useState)(!1),D=Object(d.a)(N,2),x=D[0],A=D[1],w=Ft("Retreiving employee list");function P(e,t,a,r,o){w.setShowLoading(!0),Lt.getEmployeeListForCommunication(n,e,t,a,r,o).then((function(e){T(e)})).finally((function(){w.setShowLoading(!1)}))}var M;return Object(a.useEffect)((function(){o.locations&&o.locations.length>0&&P(o.locations[0].id,-1,-1,0,"All")}),[o.locations]),o&&o.locations&&0!==o.locations.length?r.a.createElement(r.a.Fragment,null,r.a.createElement(s.o,null,r.a.createElement(s.p,null,"Role"),r.a.createElement(s.F,{interface:"popover",value:l,onIonChange:function(e){var t;(t=e.detail.value)!==l&&(u(t),C([]),P(f.location.id,null===f.department?-1:f.department.id,null===f.position?-1:f.position.id,g,t))}},r.a.createElement(s.G,{value:"All",key:-1},"All"),r.a.createElement(s.G,{value:te.BusinessAdmin,key:2},"Business Admin"),r.a.createElement(s.G,{value:te.LocationAdmin,key:3},"Location Admin"),r.a.createElement(s.G,{value:te.Admin,key:4},"Admin"),r.a.createElement(s.G,{value:te.Employee,key:5},"Employee"))),r.a.createElement(ma,{currentPosition:f,onPositionUpdate:function(e){E(e),C([]),P(e.location.id,null===e.department?-1:e.department.id,null===e.position?-1:e.position.id,g,l)}}),r.a.createElement(s.o,null,r.a.createElement(s.p,null,"Send To"),r.a.createElement(s.F,{interface:"popover",value:g,onIonChange:function(e){var t;null!==(t=e.detail.value)&&void 0!==t&&t!==g&&(C([]),b(t))}},ga.map((function(e){return r.a.createElement(s.G,{key:e.id,value:e.id},e.text)})))),r.a.createElement(s.o,null,r.a.createElement(s.p,null,"Employees (",S.filter((function(e){return va(e,g)})).length," ","/ ",S.length,")"),r.a.createElement(s.d,{onClick:function(){return A(!0)}},0===(M=k).length?"None Selected":1===M.length?M[0].name:"".concat(M.length," Selected"))),w.showLoadingJsx,r.a.createElement(s.x,{cssClass:"add-break-modal",onDidDismiss:function(){return A(!1)},isOpen:x},r.a.createElement(ha,{channel:g,onOk:function(e){C(e),A(!1),t(e,f.location.id,g)},employeeList:S,selectedEmployeeList:k}))):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,"Loading"))},ya=function(e){var t=e.onCloseModal,n=e.isOpen,o=Object(a.useContext)(K).user,c=Object(a.useContext)(pe).auth,i=Object(a.useState)(""),l=Object(d.a)(i,2),u=l[0],p=l[1],f=Object(a.useState)([]),E=Object(d.a)(f,2),v=E[0],h=E[1],g=Object(a.useState)(0),b=Object(d.a)(g,2),y=b[0],O=b[1],k=Object(a.useState)(0),C=Object(d.a)(k,2),j=C[0],I=C[1],S=Ft("Sending"),T=$();return n&&c&&c.locations&&0!==c.locations.length?r.a.createElement(r.a.Fragment,null,r.a.createElement(s.l,{className:"ion-no-border"},r.a.createElement(s.R,null,r.a.createElement(s.e,{slot:"start"},r.a.createElement(s.d,{onClick:function(){return t("")}},r.a.createElement(s.m,{icon:m.c,mode:"md",slot:"icon-only"}))),r.a.createElement(s.O,{className:"IonTitle--DailyNote"},"New Message"))),r.a.createElement(s.h,{class:"edit-daily-modal-content"},r.a.createElement(s.r,null,r.a.createElement(ba,{onUpdate:function(e,t,n){h(e.map((function(e){return e.id}))),t!==y&&O(t),n!==j&&I(n)}}),r.a.createElement(s.o,null,r.a.createElement(s.N,{value:u,placeholder:"Enter Message",rows:5,spellcheck:!0,wrap:"hard",debounce:250,onIonChange:function(e){var t;null!==(t=e.detail.value)&&void 0!==t&&t!==u&&p(t)}}))),S.showLoadingJsx),r.a.createElement(s.j,null,r.a.createElement(s.d,{className:"apply-button",expand:"block",onClick:function(){S.setShowLoading(!0),ia.sendMessage(o,y,j,v,u).then((function(e){S.setShowLoading(!1),e.error?T.showAlert("Could not send","Could not send message. "+e.message,(function(){})):1===v.length?t("Message sent"):t("Messages sent")}))},disabled:0===v.length||0===u.length||S.showLoading},"Send"))):r.a.createElement("div",null,"Loading")},Oa=[],ka=function(e,t){switch(console.log("REDUCER: ACTION =",t.type),t.type){case"LOADED-FROM-API":return t.data;case"CLEAR":return[];case"UPDATE-PINNED":return e.map((function(e){return e.messageId===t.msgId?Object(p.a)({},e,{isPinned:t.isPinned}):e}));case"UPDATE-VIEWED":return e.map((function(e){return e.messageId===t.msgId?Object(p.a)({},e,{isViewed:t.isViewed}):e}));case"DELETE":return e.filter((function(e){return e.messageId!==t.msgId}))}},Ca=function(e){var t=e.match,n=e.history,o=r.a.useContext(K).user,c=r.a.useContext(pe),i=c.auth,l=c.refreshAuth,u=r.a.useContext(la).unreadMessagesCount;Object(a.useEffect)((function(){i&&i.locations&&0!==i.locations.length||l(!1,o)}),[i]);var p=Mt((function(e){J(e)})),f=Object(a.useState)(!1),E=Object(d.a)(f,2),v=E[0],h=E[1],g=Object(a.useState)(!0),b=Object(d.a)(g,2),y=b[0],O=b[1],k=Object(a.useReducer)(ka,[]),C=Object(d.a)(k,2),j=C[0],I=C[1],S=Object(a.useState)(Oa),T=Object(d.a)(S,2),N=T[0],D=T[1],x=Object(a.useState)({}),A=Object(d.a)(x,2),w=A[0],P=A[1],M=Object(a.useState)({}),R=Object(d.a)(M,2),U=R[0],L=R[1],F=Object(a.useState)(null),B=Object(d.a)(F,2),z=B[0],V=B[1],q=Ot(),W=Object(a.useState)(!1),G=Object(d.a)(W,2),_=G[0],Y=G[1];Object(a.useEffect)((function(){if(o&&o.isLoggedin&&i&&i.locations&&i.locations.length>0)return J(void 0)}),[o.isLoggedin,u,i]),Object(a.useEffect)((function(){H(U,j)}),[j]),Object(a.useEffect)((function(){t.params.messageId&&null===z&&ia.getUserMessage(o,parseInt(t.params.messageId)).then((function(e){e||(q.showToast("The requested message has been removed"),n.push("/tabs/messages/")),V(e)}))}),[t.params.messageId]);var J=function(e){var t=!0;return 0===j.length&&!1===y&&O(!0),ia.getUserMessages(o).then((function(n){t&&(I({type:"LOADED-FROM-API",data:n}),H(U,n),O(!1),e&&e.detail.complete())})),function(){t=!1}},H=function(e,t){e&&e.msgTypeIds?-1!==e.employeeId?e.msgTypeIds.length>0?D(t.filter((function(t){return t.fromEmployeeId===e.employeeId&&wt.contains(e.msgTypeIds,t.messageTypeId)}))):D(t.filter((function(t){return t.fromEmployeeId===e.employeeId}))):e.msgTypeIds.length>0?(console.log(e.msgTypeIds),D(t.filter((function(t){return wt.contains(e.msgTypeIds,t.messageTypeId)})))):D(t):D(t)};return r.a.createElement(s.y,null,r.a.createElement(s.l,{className:"ion-no-border"},r.a.createElement(s.R,{mode:"md"},r.a.createElement(s.e,{slot:"start"},r.a.createElement(s.v,null)),r.a.createElement(s.O,{slot:"start"},"Messages"),r.a.createElement(s.e,{slot:"end"},r.a.createElement(s.d,{hidden:void 0===i.locations.find((function(e){return e.departments.find((function(e){return nt(i,e.id)}))})),onClick:function(){Y(!0)}},r.a.createElement(s.m,{icon:m.a,mode:"md",slot:"icon-only"})),r.a.createElement(s.d,{onClick:function(){var e=wt.uniqueObject(j.map((function(e){return{employeeId:e.fromEmployeeId,name:e.fromEmployeeFirstName+" "+e.fromEmployeeLastName}})),(function(e,t){return e.employeeId===t.employeeId})),t=wt.uniqueObject(j.map((function(e){return{messageTypeId:e.messageTypeId,name:ca.item(String(e.messageTypeId)).description}})),(function(e,t){return e.messageTypeId===t.messageTypeId}));P({msgTypes:t,employees:e}),h(!0)}},r.a.createElement(s.m,{icon:m.m,mode:"ios",slot:"icon-only"}))))),r.a.createElement(s.h,{className:"outer-content"},p.ionicRefresherJsx,y&&r.a.createElement(r.a.Fragment,null,[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21].map((function(e){return r.a.createElement("div",{key:e,style:{margin:"10px 8px"}},r.a.createElement(yn.a,{width:360,height:45}))}))),!y&&0===N.length&&r.a.createElement("div",{className:"no-messages-text"},"No messages to display."),r.a.createElement("div",{className:"message-list"},!y&&N.length>0&&N.filter((function(e){return e.isPinned})).map((function(e){return r.a.createElement(ra,{key:e.messageId,message:e,onMessageClick:function(){return V(e)}})}))),r.a.createElement("div",{className:"message-list"},!y&&N.length>0&&N.filter((function(e){return!e.isPinned})).map((function(e){return r.a.createElement(ra,{key:e.messageId,message:e,onMessageClick:function(){return V(e)}})})))),r.a.createElement(s.x,{isOpen:v},r.a.createElement(oa,{filterData:w,onDismissModal:function(e){L(e),H(e,j),h(!1)},onCancelModal:function(){return h(!1)}})),r.a.createElement(s.x,{isOpen:null!==z},r.a.createElement(ua,{message:z,updateMessages:I,onCloseModal:function(e){V(null),e&&q.showToast(e)}})),r.a.createElement(s.x,{isOpen:_},r.a.createElement(ya,{onCloseModal:function(e){Y(!1),null!==e&&e.length>0&&q.showToast(e),setTimeout((function(){J()}),4e3)},isOpen:_})),q.simpleToastJsx)},ja=function(){var e=Object(a.useContext)(la).unreadMessagesCount;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:e?"hasMessages":"noMessages"},e),r.a.createElement(s.m,{icon:m.l}),r.a.createElement(s.p,null,"Messages"))},Ia=function(){return r.a.createElement(s.L,null,r.a.createElement(s.B,null,r.a.createElement(i.b,{exact:!0,path:"/tabs",to:"/tabs/schedule"}),r.a.createElement(i.c,{path:"/tabs/schedule/:scheduleEventId",render:function(e){return r.a.createElement(xn,e)}}),r.a.createElement(i.c,{path:"/tabs/schedule",render:function(e){return r.a.createElement(xn,e)},exact:!0}),r.a.createElement(i.c,{path:"/tabs/messages/:messageId",render:function(e){return r.a.createElement(Ca,e)}}),r.a.createElement(i.c,{path:"/tabs/messages",render:function(e){return r.a.createElement(Ca,e)},exact:!0}),r.a.createElement(i.c,{path:"/tabs/clock",render:function(){return r.a.createElement(aa,null)},exact:!0})),r.a.createElement(s.J,{slot:"bottom"},r.a.createElement(s.K,{key:"1",tab:"schedule",href:"/tabs/schedule"},r.a.createElement(s.m,{icon:m.j}),r.a.createElement(s.p,null,"Schedule")),r.a.createElement(s.K,{key:"2",tab:"clock",href:"/tabs/clock"},r.a.createElement(s.m,{icon:m.w}),r.a.createElement(s.p,null,"Clock")),r.a.createElement(s.K,{key:"3",tab:"map",href:"/tabs/messages"},r.a.createElement(ja,null))))},Sa=function(){var e=r.a.useContext(K).user;return e.loading?r.a.createElement("div",null):e.isLoggedin?r.a.createElement(Ia,null):r.a.createElement(i.b,{to:"/login"})},Ta=function(e){var t=e.history,n=r.a.useContext(K),a=n.user,o=n.logout,c=r.a.useContext(pe).clearAuth;return Object(s.V)((function(){Promise.all([c(),o()]).then((function(){N("logout",{user:a.username}),console.log("logged out (".concat(a.username,")")),setTimeout((function(){t.push("/login",{direction:"none"}),t.goForward()}),500)}))})),r.a.createElement(s.y,{id:"logout-page"},r.a.createElement(s.h,{className:"logout-content"},r.a.createElement("div",{className:"login-logo"},r.a.createElement("img",{className:"logo",src:"assets/img/OS Logo - 4pt Rounded _ 2 Tone Orange.svg",alt:"Orbital Shift Logo"})),r.a.createElement("div",{className:"label"},"You were logged out")))},Na=n(72),Da=function(){return Object(a.useEffect)((function(){F.settings.hasCapacitor&&Na.a.lock(Na.a.ORIENTATIONS.PORTRAIT).then((function(){console.log("screen locked to portrait")})),console.log("firebase initialized"),S.initializeApp(T),N("app_render",{vers:F.settings.appVersionString,platform:F.settings.platform})}),[]),r.a.createElement(s.c,null,r.a.createElement(u.a,null,r.a.createElement(u.a,null,r.a.createElement(s.I,{contentId:"main"},r.a.createElement(ne,null),r.a.createElement(s.B,{id:"main"},r.a.createElement(i.c,{path:"/login",render:function(e){return r.a.createElement(ge,e)}}),r.a.createElement(i.c,{path:"/logout",render:function(e){return r.a.createElement(Ta,e)}}),r.a.createElement(i.c,{path:"/tabs",render:function(e){return r.a.createElement(Sa,e)}}),r.a.createElement(i.c,{path:"/",exact:!0},r.a.createElement(i.b,{to:"/tabs/schedule"})))))))},xa=function(){return r.a.createElement(l.a,null,r.a.createElement(Q,null,r.a.createElement(ve,null,r.a.createElement(sa,null,r.a.createElement(Da,null)))))};c.a.render(r.a.createElement(xa,null),document.getElementById("root"))},9:function(e,t,n){}},[[100,7,51]]]);
//# sourceMappingURL=main.0e7d223f.chunk.js.map