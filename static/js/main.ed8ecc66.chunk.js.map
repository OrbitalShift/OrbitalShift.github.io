{"version":3,"sources":["../node_modules/@ionic/core/dist/esm-es5 lazy /^/.*/.entry/.js$/ include: /.entry/.js$/ exclude: /.system/.entry/.js$/ groupOptions: {} namespace object","../node_modules/@ionic/react/node_modules/ionicons/dist/esm-es5 lazy /^/.*/.entry/.js$/ include: /.entry/.js$/ exclude: /.system/.entry/.js$/ groupOptions: {} namespace object","enums/AdminAuthorization.ts","enums/BreakType.ts","enums/ClockInRequirement.ts","enums/ClockInResponseCode.ts","enums/ClockOutResponseCode.ts","enums/ClockOutValueType.ts","enums/DeviceOperatingSystem.ts","enums/EmmployeeSort.ts","enums/EndBreakResponseCode.ts","enums/EventGroup.ts","enums/EventStatus.ts","data/dbStore.ts","enums/EventType.ts","enums/RecurrenceType.ts","enums/RecurrenceUpdateType.ts","enums/Role.ts","enums/StartBreakResponseCode.ts","enums/SubscriptionType.ts","enums/TimeFormat.ts","enums/UnscheduledBreakOptions.ts","util/KeyedCollection.ts","api/environment.ts","util/logger.ts","api/orbitalApiHelper.ts","api/pushNotificationsApi.ts","util/pushNotificationsController.ts","context/ApplicationUserContext.tsx","hooks/useDialogBox.tsx","components/ToggleListEx.tsx","components/NotificationSettingsModal.tsx","hooks/useSimpleToast.tsx","util/scheduleEventHelper.ts","util/timeHelper.ts","api/employeesApi.ts","hooks/useShowLoading.tsx","components/SubmitFeedbackModal.tsx","components/Menu.tsx","api/userApi.ts","util/authHelper.ts","context/AuthorizedItemsContext.tsx","pages/Login.tsx","api/scheduleEventsApi.ts","orbital-interfaces/EventFilter.ts","components/SchedulePageComponents/WeekChooser.tsx","components/SchedulePageComponents/EventCard.tsx","components/EditEvent/EditEventAuthorization.ts","hooks/useOrbitalDialogBox.tsx","components/SchedulePageComponents/DailyNoteDepartmentSelector.tsx","api/dailyNotesApi.ts","components/SchedulePageComponents/EditDailyNoteModal.tsx","components/SchedulePageComponents/DailyNoteCard.tsx","components/SchedulePageComponents/AddDailyNoteButton.tsx","components/SchedulePageComponents/NoEventsToShow.tsx","components/SchedulePageComponents/EventListSection.tsx","components/SchedulePageComponents/EventList.tsx","util/eventHelper.ts","util/arrayHelper.ts","data/filterStore.ts","components/SchedulePageComponents/ScheduleFilterModal.tsx","hooks/useIonicRefresher.tsx","components/EditEvent/editor/EventTypeStatusEditor.tsx","components/EditEvent/editor/EventPositionEditor.tsx","components/EditEvent/editor/EventEmployeeEditor.tsx","components/EditEvent/editor/EventStartEndEditor.tsx","components/EditEvent/editor/AddBreakModal.tsx","components/EditEvent/editor/EventBreakEditor.tsx","components/EditEvent/editor/EventTagEditor.tsx","components/EditEvent/editor/EventConfirmEditor.tsx","components/EditEvent/editor/EventIsClockedInEditor.tsx","components/EditEvent/EditEventModalState.ts","api/requestsApi.ts","components/EditEvent/editor/EventRequestEditorEx.tsx","components/EditEvent/editor/EventNotesEditor.tsx","components/EditEvent/editor/EventClockoutValueEditor.tsx","components/EditEvent/editor/WeekdayList.tsx","components/EditEvent/editor/RecurringEventSection.tsx","components/EditEvent/RecurrenceUpdateTypeSelector.tsx","components/EditEvent/editor/EventRequestModalEx.tsx","components/EditEvent/editor/EventTransferToEditor.tsx","components/EditEvent/EditEventModal.tsx","components/SchedulePageComponents/EventCardSkeleton.tsx","hooks/useInterval.ts","pages/SchedulePage.tsx","components/ClockPageComponents/BreakSelectorModal.tsx","api/timeClockApi.ts","components/ClockPageComponents/ClockoutModal.tsx","components/ClockPageComponents/SwitchPositionOrTagButton.tsx","components/ClockPageComponents/Map.tsx","hooks/useYesOrCancelDialogBox.tsx","components/ClockPageComponents/GeoLocationComponent.tsx","components/ClockPageComponents/ClockPanel.tsx","components/ClockPageComponents/PayrollPeriodChooser.tsx","api/payrollPeriodApi.ts","components/ClockPageComponents/PayrollOrbitalTimeItem.tsx","components/ClockPageComponents/PayrollDetailModal.tsx","components/ClockPageComponents/PayrollDetailRow.tsx","components/ClockPageComponents/PayrollDetailList.tsx","components/ClockPageComponents/PayrollPeriodsTab.tsx","components/ClockPageComponents/ClockTodayTab.tsx","pages/ClockPage.tsx","components/MessagesPageComponents/MessageItem.tsx","components/MessagesPageComponents/MessagesFilterModal.tsx","orbital-interfaces/MessageTypes.ts","api/messageApi.ts","context/MessagesContext.tsx","components/MessagesPageComponents/ViewMessageModal.tsx","components/MessagesPageComponents/create/PositionSelector.tsx","components/MessagesPageComponents/create/EmployeeSelectorModal.tsx","components/MessagesPageComponents/create/EmployeesSelector.tsx","components/MessagesPageComponents/create/CreateMessageModal.tsx","pages/MessagesPage.tsx","pages/MessagesTabButton.tsx","pages/MainTabs.tsx","components/AuthGate.tsx","pages/Logout.tsx","components/SplashComponent.tsx","App.tsx","index.tsx"],"names":["map","webpackAsyncContext","req","__webpack_require__","o","Promise","resolve","then","e","Error","code","ids","id","keys","Object","module","exports","AdminAuthorization","BreakType","ClockInRequirement","ClockInResponseCode","ClockOutResponseCode","ClockOutValueType","DeviceOperatingSystem","EmployeeSort","EndBreakResponseCode","EventGroup","EventStatus","getKeyStore","openDB","upgrade","db","createObjectStore","putUserState","state","a","put","getUserState","get","getAccessToken","access_token","undefined","putAuthItems","auth","getAuthItems","authItems","EventType","eventStatusIdList","name","getEventStatusIdName","eventStatus","idName","find","et","RecurrenceType","RecurrenceUpdateType","Role","StartBreakResponseCode","SubscriptionType","TimeFormat","UnscheduledBreakOptions","eventTypeIdList","getEventTypeIdName","eventType","getSubscriptionTypeName","subscripionType","None","Standard","Premium","Enterprise","KeyedCollection","items","_count","key","this","hasOwnProperty","value","val","keySet","prop","push","values","defaults","constants","checkUnreadMessageCountTimer","refreshScheduleTimer","refreshTimeclockSettingsTimer","maxStaleAuthItemsInMinutes","minimumFeetForGeolocationUpdate","url","envTypes","environments","add","settings","env","versionName","versionCode","revisionHash","buildDate","appVersionString","hasCapacitor","isPlatform","platform","getConstants","user","isLoggedin","item","environment","getApiUrl","endpoint","getUserAndEnvironmentFromInput","input","length","username","envKey","toLowerCase","substring","firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","log","eventName","eventParams","firebase","logEvent","setFirebaseUserProperties","setUserId","setUserProperties","userRole","role","subscriptionType","businessName","userName","version","post","baseUrl","data","console","fetch","method","body","JSON","stringify","headers","Authorization","AppVersion","response","contentType","indexOf","json","results","appVersion","error","putData","dataString","options","del","token","operatingSystem","iOS","Android","apiHelper","TokenId","OperatingSystem","typeIds","pushNotificationsApi","subscribe","unsubscribe","getTypesSelectedByUser","putTypes","listTypes","PushNotifications","Plugins","pushNotificationsController","pushEnabled","showMessage","history","createBrowserHistory","forceRefresh","register","addListener","notification","MessageId","title","goForward","messageId","INITIAL_APPLICATION_USER","darkMode","loading","isPushEnabled","INITIAL_APPLICATION_USER_CONTEXT","logout","userLoggedIn","u","at","ApplicationUserContext","React","createContext","ApplicationUserContextProvider","props","useState","userState","internalSetUserState","useEffect","mounted","all","newState","enabled","currentState","latitude","longitude","requestedGeoPermission","refusedGeoPermission","Provider","children","useDialogBox","isOpen","setIsOpen","header","message","onDismiss","alertData","setAlertData","showAlert","alertBoxJsx","onDidDismiss","buttons","ToggleListEx","list","selected","selectionChanged","isItemChecked","i","lines","mode","checked","onClick","slice","onAllChanged","toggle","n","includes","newList","newlist","filter","r","itemToggle","NotificationSettingsModal","onDismissModal","useContext","notifications","setNotifications","selectedNotifications","setSelectedNotifications","isSubscribed","responses","className","slot","icon","arrowBackOutline","class","newSelected","useSimpleToast","toastData","setToastData","showToast","simpleToastJsx","position","duration","onClockEventEnd","Date","isShiftTypeEvent","Shift","Approved","Cover","Request","RequestDenied","isAbsentExpenseEvent","Absent","isTimeClockEvent","Clock","isDontWorkEvent","Unavailable","Vacation","isExtendedClock","ev","locSettings","th","getDurationFromTimeSpan","Data","TotalValue","Time","ActualTime","ForgotToClockOutTime","scheduleEventHelper","eventMatchesFilter","eventTypeFilter","eventStatusFilter","DontWork","All","Scheduled","ClockAndSched","isClockedIn","EventTypeId","EventStatusId","isAfter","EventEnd","isPositionSpecificEvent","showFlagForExtendedClock","IsClockedIn","noEndTime","isScheduleEvent","BusinessId","timespan","hrs","min","tok","split","hrTok","parseInt","getPartOfTimeSpan","ts","partNum","formatDecimal","num","digits","decimals","Number","toFixed","toString","negative","s","substr","Math","max","padZeroes","digitCount","timeHelper","convertTimeWithoutTimeZoneToLocalTime","dtStr","localTimeZone","Intl","DateTimeFormat","resolvedOptions","timeZone","newDate","toDate","tzFormat","formatDateTimeAsMvcString","d","getFullYear","getMonth","getDate","getHours","getMinutes","getBreakStartEnd","brk","start","format","parseISO","BreakStart","replace","BreakEnd","end","getCurrentLocationDateTime","loc","utcDateStr","toISOString","addHours","TimeZoneOffset","getDateString","date","toUpperCase","getDuration","getDiff","startDate","endDate","differenceInMinutes","totalMinutes","EventStart","EventBreaks","b","getDurationString","minutes","str","floor","getDurationStringFromTimeSpan","getEventBreakStartEndString","getEventInformationStartEnd","getHoursFromTimeSpan","getMessageDeliveryTimeString","dateStr","getMinutesFromTimeSpan","getMinutesFromTimeString","HoursMinutes","test","round","parseFloat","getTimeStringFromMinutes","hours","TimeFormatDigits","TimeFormatDecimals","getTimeStringFromOrbitalTime","time","dayHourTok","ActualHours","getTodayStartForLocation","tmpDate","valueOf","dayStartMinutes","DayStartTime","setMinutes","getSeconds","getMilliseconds","needPreviousDate","isSameDay","setHours","getWeekStart","weekStartsOn","dayStart","counter","addDays","messageDateString","now","isToday","differenceInDays","isSameYear","locId","posId","sort","depId","channel","msg","os","employeesApi","getEmployeesByLocationIdPositionIdAndActiveDateRange","getEmployeeListForCommunication","submitFeedback","useShowLoading","showLoading","setShowLoading","showLoadingJsx","spinner","SubmitFeedbackModal","setMessage","placeholder","autoGrow","spellcheck","wrap","debounce","onIonChange","detail","expand","res","succeeded","disabled","Menu","disableMenu","dlg","showNotificationsModal","setShowNotificationsModal","showSubmitFeedbackModal","setShowSubmitFeedbackModal","toast","type","contentId","auto-hide","button","mail","routerLink","routerDirection","logOut","submitted","password","error_description","loggedIn","err","userApi","authenticateUser","getAuthorizedItems","getLocationFromLocationId","locationId","locations","l","getDepartmentFromPositionId","positionId","foundDepartment","flatMap","departments","positions","p","isAdminAuthorizedFor","departmentId","adminAuth","Employee","LocationAdmin","BusinessAdmin","location","adminAllDepts","authHelper","adminCan","getLocSettingsForLocationId","getLocationIdFromPositionid","curLoc","j","getPositionIdsForEmployee","hasPosition","canEditSchedules","CanEditSchedules","getAdminAuthorizationForDepartment","adminIsInDepartment","Admin","canEditNonPositionEvents","dept","isAuthItemsValid","isDeptAdmin","isAdminForAllDepts","isAdminForThisEvent","getSelectedDepartment","department","getSelectedPositionWithLocId","getSelectedPosition","locPosId","depPosId","posPosId","getAdminDetpartments","requiresGeolocation","RequireGeoLocation","INITIAL_AUTHORIZED_ITEMS","businessId","employeeId","firstOrNickName","firstName","nickName","middleName","lastName","fullName","timeClock","payrollEvents","tags","lastRefresh","INITIAL_AUTHITEMS_CONTEXT","refreshAuth","force","newUser","clearAuth","authLoading","AuthorizedItemsContext","empty","authFromStore","authFromApi","AuthorizedItemsContextProvider","internalSetAuth","setLoading","newAuth","validate","Login","setUsername","setPassword","usernameErrors","passwordErrors","loginEnabled","setLoginEnabled","login","envUser","direction","catch","useIonViewWillEnter","src","alt","onChange","newUsername","target","color","newPassword","scheduleEventId","result","filterToSend","fixIsoStringForMvc","ds","eventValues","recurrenceUpdateType","isConfirmed","employee","eventStart","eventEnd","tagId","tag","eventBreaks","breakStart","breakDuration","clockOutValue","clockoutValue","absentId","absentTime","absentTimeMinutes","notes","sendMessage","recurrenceId","recurrenceStart","recurrenceEnd","recurrenceType","repeatInterval","repeatWeekdays","sceduleEventId","confirm","EventFilterView","scheduleEventsApi","getScheduleEvent","getScheduleEventsByFilter","getDailyNotesByFilter","updateScheduleEvent","createScheduleEvent","deleteScheduleEvent","updateConfirmedScheduleEvent","initialEventFilter","settingsLocId","dnLocIds","filterByEmployee","positionIds","eventTypeId","eventStatusId","view","schedule","initialStoredEventFilter","WeekChooser","setStartDate","onWeekdayClick","dateRef","useRef","onDateChanged","current","arrowBack","displayFormat","pickerFormat","caretDown","arrowForward","thisDate","isTodayClass","style","outline","colorMap","1","2","3","4","6","7","statusTimeColor","EventCard","event","multiLocation","showEmployeeName","onEdit","displayNameStyle","display","LocationId","eventStartDate","multiDepartment","posDisplay","AbbreviatedLocationName","AbbreviatedDepartmentName","PositionName","eventTypeBorder","borderLeft","isOnBreak","timeColor","iconColor","onUserClick","eventEmployeeId","eventLocationId","eventDepartmentId","eventPositionId","eventConfirmed","endOfEvent","afterEnd","employeeEvent","CanEditOwnClockEvents","CanEditEmployeeClockEvents","getEventEditAuthorization","EmployeeId","DepartmentId","PositionId","IsConfirmed","cafe","flag","EventDuration","FirstName","LastName","checkmark","Tag","useOrbitalDialogBox","selection","dialogData","setDialogData","onButtonClick","showDialog","dialogOptions","dialogBoxJsx","cssClass","opt","size","text","DailyNoteDepartmentSelector","currentDepartment","onDepartmentUpdate","selectedDepartment","setSelectedDepartment","selectedDepartmentId","interface","newSelection","updateLocation","updateDepartment","dep","dailyNoteId","dailyNotesApi","getDailyNote","updateDailyNote","insertDailyNote","deleteDailyNote","EditDailyNoteModal","onCloseModal","note","initialDate","originalNote","setOriginalNote","dialog","selectedRole","setSelectedRole","curDep","getFirstAvailableDepartment","Notes","noteText","setNoteText","noteCharCountRef","selectedDate","setSelectedDate","isMounted","fetchDailyNote","DailyNoteId","right","left","newStart","updateBackend","isClosing","newRole","onDateSelected","maxlength","rows","newText","onForceRefresh","noteDate","deptName","DepartmentName","showEditModal","setShowEditModal","newNoteClicked","AddDailyNoteButton","canAddNote","toastMessage","NoEventsToShow","EventListSection","forwardRef","ref","events","showEmployeeNames","dailyNotesAddButtonDate","headerRef","createRef","useImperativeHandle","scrollIntoView","behavior","block","inline","setTimeout","focus","tabIndex","DailyNoteCard","ScheduleEventId","EventList","hoursPerDay","listType","weekStart","segments","getSegmentsForRequests","locationSettings","DayWeekStartsOn","notesStart","isBefore","weekEnd","h","reduce","prev","cur","getSegmentsForMy","todayStart","totalDuration","durationString","segmentDate","getSegmentsForToday","containsKey","thisDatesNotes","getSegmentsForAll","scrollToDate","dateName","segkeys","curSeg","segmentRef","references","dayOffset","segName","segRef","seg","refLookup","thisRef","showTotalDuration","eventHelper","getFilterByEventGroup","f","group","Custom","getEventTypeOptions","eventTypeOptions","unshift","ShowUnavailableEventType","ShowVacationEventType","ShowAbsentEventType","peTypes","p2l","pe","startsWith","some","p1","p2","concat","arrayHelper","areEqual","a1","a2","contains","arr","containsAny","arr1","arr2","unique","newArr","uniqueObject","filt","found","getDefaultFilter","tagIsEqual","tagId1","tagId2","filterStore","getFilter","localStorage","getItem","parse","putFilter","storedFilter","setItem","isFilterApplied","defaultFilter","clear","removeItem","ScheduleFilterModal","onCancelModal","locIds","depIds","posIds","newLocId","newDepId","getInitialPositionSelectionsByFilter","initialLocIds","initialDepIds","initialPosIds","getInitialEventGroupSelectionByFilter","eventGroup","setEventGroup","myFilter","setMyFilter","eventTypeList","setEventTypeList","locationIds","setLocationIds","departmentIds","setDepartmentIds","setPositionIds","isDirty","setIsDirty","multiple","deptIds","abbr","pos","selectedPositionIds","returnedFilter","filterApplied","useIonicRefresher","doRefresh","ionRefresherRef","retVal","ionicRefresherJsx","onIonRefresh","pullingIcon","pullingText","refreshingSpinner","refreshingText","getSelectedEventTypeId","getPayrollEventIdNames","getEventTypes","eventTypes","showClockEventType","getEventStatuses","EventTypeStatusEditor","editorValues","update","absentHoursPlaceholderText","setAbsentHoursPlaceholderText","setLocSettings","absentTimeString","setAbsentTimeString","isFromEventInfo","eventStatuses","es","newLocSettings","isReadonly","transferToEmployeeId","newEventType","newAbsentMinutes","onEventTypeChange","newEventStatus","onIonBlur","onAbsentTimeChange","EventPositionEditor","positionList","setPositionList","posIdRef","isMultiLoc","isMultiDep","createPositionList","selectedPosition","updatePosition","EventEmployeeEditor","employeeList","setEmployeeList","empIdRef","getEmployees","justEmployee","employees","emp","EventStartEndEditor","minuteValues","newEventStart","newEventEnd","hasOverlap","breaks","startA","endA","startB","addMinutes","endB","getDateWithTimeSpan","AddBreakModal","onCancel","onAdd","currentBreaks","spansDays","EnhancedBreakManagementDefaultStartTime","EnhancedBreakManagementDefaultEndTime","setEndDate","isRestricted","setIsRestricted","isPaid","setIsPaid","errorMessage","setErrorMessage","isValid","setIsValid","alert","close","newStartDate","onStartUpdate","newEnd","newEndDate","onEndUpdate","EventBreakEditor","breakList","setBreakList","showBreakModal","setShowBreakModal","IsPaidBreak","logoUsd","IsRestricted","lockClosed","showRestricted","newBreakList","onDeleteBreak","trash","borderBottom","width","EventTagEditor","selectedTagId","setSelectedTagId","tagList","setTagList","t","tagIds","onUpdateTag","EventConfirmEditor","onEmployeeUpdated","shouldShowConfirmed","shouldShowButton","EventIsClockedInEditor","setIsClockedIn","showIsClockedIn","setShowIsClockedIn","INITIAL_EDITOR_VAUES","isUpdating","valid","validEventStartEnd","validEmployee","validTag","validEventTypeStatus","validClockoutValue","validRecurrenceStartEnd","validRepeatInterval","validRepeatWeekdays","absentName","transferFromScheduleEventId","transferToScheduleEventId","getEditorValuesFromEventInformation","getEditorValuesFromScheduleEvent","getIsClockedIn","ConfirmedBy","getLocationById","getPositionById","TagId","AbsentName","AbsentId","AbsentTimeMinutes","ClockOutValue","EventRecurrenceId","EventRecurrenceStart","EventRecurrenceEnd","RepeatType","RepeatInterval","RepeatWeekdays","EventTransfer_ScheduleEventId_From","EventTransfer_ScheduleEventId_To","getValidStartEnd","startStr","endStr","isEqual","isClockoutValueValid","ClockOutValueLabel","isAllValid","v","editorValueReducer","action","NewEventDefaultStartTime","NewEventDefaultEndTime","createInitialEditorValuesForNewEvent","clockedInOnTypeStatusUpdate","newTypeStatusState","newClockoutValueState","newStartState","newEndState","newTagState","newConfirmState","newClockedInState","newTransferToState","newRepeatState","repeatWeekDays","Weekly","broadCastMessage","coverMessage","toEmployeeId","BroadcastCoverRequestMessage","CoverMessage","DirectToEmployeeId","recUpdateType","RecUpdateType","msgId","isDirectCoverList","directCoverList","coverRequestEventId","EventRequestEnum","requestsApi","approveShiftRequest","undoCoverRequest","createCoverRequest","makeShiftRequest","removeShiftRequest","deleteEvent","getCoverRequestListItems","transferCoverToEmployee","undoCoverApproved","EventNotesEditor","newNote","EventClockoutValueEditor","isVisible","setIsVisible","newValue","WeekdayList","checkList","setCheckList","dayOfWeek","getDay","newCheckState","onCheckboxChecked","RecurringEventSection","isChecked","setIsChecked","calendar","textAlign","refresh","MonthlyByDayOfMonth","MonthlyByDayOfWeek","RecurrenceUpdateTypeSelector","onSelect","updateType","choice","titleText","UpdateSingleEvent","UpdateEntireSeries","UpdateSeriesForward","EventRequestModalEx","onOk","eventRequestType","buttonText","setNotes","selectedEmployeeId","setSelectedEmployeeId","coverList","setCoverList","CreateCoverRequest","hidden","EnableDirectCoverRequest","cover","UndoCoverRequest","ApproveShiftRequest","CreateShiftRequest","DeleteRequest","EventRequestEditorEx","cancelEditModal","showRequestModal","setShowRequestModal","requestType","isAdmin","UndoCover","getEventRequestType","getButtonText","onComplete","EventTransferToEditor","cov","EditEventModal","initialEvent","useReducer","updateEditorValues","scheduleEvent","setScheduleEvent","setRecurrenceUpdateType","showRecurrenceUpdateTypeSelector","setShowRecurrenceUpdateTypeSelector","buttonClicked","setButtonClicked","isEditing","se","fixDatesForIPhone","createOrUpdate","apiCall","successMessage","skipPrompt","goDelete","onRecurrenceUpdateTypeSelect","confirmed","EventCardSkeleton","threeRows","height","padding","useInterval","callback","isRunning","delay","savedProps","setInterval","clearInterval","initialEvents","initialDailyNotes","eventPassesFilter","dailyNotePassesFilter","dn","pid","SchedulePage","match","eventListRef","refresher","getScheduleEvents","startOfDay","myScheduleEvents","setMyScheduleEvents","myDailyNotes","setMyDailyNotes","myFilteredScheduleEvents","setMyFilteredScheduleEvents","myFilteredDailyNotes","setMyFilteredDailyNotes","myTotalTime","setMyTotalTime","requestScheduleEvents","setRequestScheduleEvents","requestDailyNotes","setRequestDailyNotes","requestFilteredScheduleEvents","setRequestFilteredScheduleEvents","requestFilteredDailyNotes","setRequestFilteredDailyNotes","requestHoursPerDay","setRequestHoursPerDay","allScheduleEvents","setAllScheduleEvents","allDailyNotes","setAllDailyNotes","allFilteredScheduleEvents","setAllFilteredScheduleEvents","allFilteredDailyNotes","setAllFilteredDailyNotes","allHoursPerDay","setAllHoursPerDay","isShowing","setIsShowing","segment","setSegment","showFilterModal","setShowFilterModal","showEventModal","setShowEventModal","editEventId","setEditEventId","initialEditEvent","setInitialEditEvent","setFilter","useIonViewWillLeave","params","onEventClick","useCallback","apiFilter","complete","mySE","getMyScheduleEvents","dailyNotes","filteredDailyNotes","totalTimeForEmployee","requestSE","allSE","getAllScheduleEvents","onSegmentChange","segmentName","funnel","newFilter","marginTop","onEventUpdated","BreakSelectionModal","tcData","cancelOption","breakType","UnscheduledUnpaid","ClockedInScheduleEvent","ScheduleEventsForClockIn","Both","UnscheduledPaid","Paid","Unpaid","lat","lng","clockoutDataModel","TimeClockBreak","clockEvent","shiftEvent","breakStartOptions","clockEventId","shiftEventId","shiftBreakStart","timeClockApi","getTimeClockSettings","clockIn","clockOut","switchPositionOrTag","startBreak","endBreak","getGeoLocations","ClockoutModal","setClockoutValue","autoCorrect","clearInput","SwitchPositionOrTagButton","selectedPosId","onSwitch","setDisabled","hiddenJsx","UserClockedIn","curPosId","curTagId","ClockInWithDifferentTag","EnablePositionChangeForEmployeePosition","calculateNearestLocationMessage","google","maps","geometry","spherical","computeDistanceBetween","userPos","LatLng","closestLocation","minDistance","locPos","distance","proximity","locationName","miles","EPSILON","validPos","coords","Map","mapEle","userCircle","geoLocations","setGeoLocations","showMap","setShowMap","center","zoom","disableDefaultUI","fullscreenControl","Circle","strokeColor","strokeOpacity","strokeWeight","fillColor","fillOpacity","radius","clockLocations","forEach","markerData","infoWindow","InfoWindow","content","addr","marker","Marker","open","addMarkers","addListenerOnce","classList","setCenter","setMap","arrowDownCircle","arrowUpCircle","useYesOrCancelDialogBox","onYes","dialogJsx","handler","geoPositionOptions","enableHighAccuracy","maximumAge","GeoLocationComponent","updateCallback","watchPositionId","setWatchPositionId","currentPosition","setCurrentPosition","yesCancelDlg","watchId","watchPositionCallBack","positionChanged","loaded","isGoogleMapsLoaded","oldPos","newPos","errCallback","Capacitor","isPluginAvailable","Geolocation","watchPosition","getCurrentPosition","navigator","geolocation","startWatchPosition","clearWatch","ClockPanel","onUpdate","refreshToggle","posList","setPosList","setSelectedPosId","positionRef","tagSwitchingEnabled","setTagSwitchingEnabled","tagRef","breakSetting","setBreakSetting","showBreakSelectorModal","setShowBreakSelectorModal","loadingMessage","setLoadingMessage","show","showAlertData","setShowAlertData","setTCData","showClockoutModal","setShowClockoutModal","setRefresh","setLat","setLng","updateTimeClockData","ShowTimeClock","plist","uniqueLocationIds","PositionsToClockInto","uniqueDeptIds","PositionNameWithLocAndDeptAbbreviation","PositionNameWithDeptAbbreviation","curLocId","EnableEnhancedBreakManagement","CurrentEventBreak","setTags","curLat","curLng","currentPositionId","TagsPerPosition","TagName","clockout","ClockOutEvent","Message","newLat","newLng","newVal","UserMayClockOut","UserMayClockIn","MatchingShift","AllowedToSwitchPositions","AllowedToSwitchTags","ClockInMessage","ClockOutMessage","ClockInEvent","Success","BreakSelectorModal","PayrollPeriodChooser","onNextPayPeriod","onPrevPayPeriod","payPeriodDateText","payrollPeriodApi","getPayPeriodDateForEmployee","PayrollOrbitalTimeItem","fontColor","displayColor","locsettings","getHoursString","PayrollDetailModal","onClose","regular","dailyOvertime","weeklyOvertime","special","timePerAbsent","hpa","getAbsentName","ColumnEnum","PayrollDetailRow","payrollRow","colsToDisplay","colSize","showDetailModal","setShowDetailModal","Regular","DailyOvertime","WeeklyOvertime","Special","absent","PayrollDetailList","payrollData","setColsToDisplay","setColSize","cols","count","totalDailyOvertime","totalWeeklyOvertime","totalSpecial","totalAbsent","getColumnsToDisplay","x","row","totalRegular","PayrollPeriodsTab","currentDate","setCurrentDate","setPayrollData","getData","ClockTodayTab","scheduleEvents","setScheduleEvents","setDailyNotes","setHoursPerDay","isLoading","setIsLoading","clock","createTodayFilter","ClockPage","setRefreshToggle","refreshTimeClockToggle","setRefreshTimeClockToggle","MessageItem","onMessageClick","fontWeightForSubject","isViewed","fontWeight","isPinned","bookmark","subject","deliveryDateTime","previewLine","MessagesFilterModal","filterData","msgTypeIds","msgTypes","mt","messageTypeId","filterResult","setFilterResult","description","messageTypes","empIds","typeName","messageApi","getUserMessage","getUserMessages","getReadCount","setIsPinned","setIsViewed","deleteMessage","getUnreadCount","MessagesContext","unreadMessagesCount","unreadMessageCountWhenViewed","refreshCount","messagesViewed","hasNewMessages","putCountIntoStorage","cnt","MessagesContextProvider","messagesState","internalSetMessagesState","newUnreadCount","newUnreadMessageCountWhenViewed","fromStorageCount","getCountFromStorage","newViewCount","ViewMessagetModal","updateMessages","readCount","setReadCount","usageText","setUsageText","pinned","setPinned","newReadCount","newPinValue","onPinnedClick","fromEmployeeFirstName","fromEmployeeLastName","dangerouslySetInnerHTML","__html","messageText","setPositionForLocation","PositionSelector","sel","onPositionUpdate","setSelectedPosition","setPositionForDepartment","isAdminAtLocation","setPositionForPosition","emailIcon","textIcon","phonePortrait","pushIcon","isEmployeeEnabled","hasEmail","hasText","hasPush","EmployeeSelectorModal","selectedEmployeeList","setList","isAllChecked","setIsAllChecked","empId","checkCount","allCheckCount","onEmployeeChecked","messageChannels","EmployeesSelector","getFirstAvailablePosition","selectedChannel","setSelectedChannel","selectedEmployees","setSelectedEmployees","showEmployeeModal","setShowEmployeeModal","fetchEmployees","finally","selList","posEx","newChannelId","newEmployeeList","CreateMessageModal","setMessageText","employeeIds","setEmployeeIds","setLocationId","setChannel","sendingMessage","newEmpList","newChannel","initialMessages","messagesReducer","m","MessagesPage","useIonViewDidEnter","useIonViewDidLeave","refreshMessages","isLoadingMessages","setIsLoadingMessages","messages","filteredMessages","setFilteredMessages","setFilterData","viewMessage","setViewMessage","showCreateMessage","setShowCreateMessage","filterMessages","msgs","fromEmployeeId","y","String","margin","updatedFilter","MessagesTabButton","chatbubblesOutline","MainTabs","exact","path","to","render","routeProps","tab","href","calendarOutline","timeOutline","AuthGate","Logout","SplashComponent","showBackdrop","MyApp","authGate","ScreenOrientation","lock","ORIENTATIONS","PORTRAIT","vers","App","ReactDOM","document","getElementById"],"mappings":"6JAAA,IAAIA,EAAM,CACT,kCAAmC,CAClC,IACA,IAED,iCAAkC,CACjC,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,8BAA+B,CAC9B,IACA,GAED,6BAA8B,CAC7B,IACA,GAED,iCAAkC,CACjC,IACA,IAED,gCAAiC,CAChC,IACA,IAED,8BAA+B,CAC9B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,8BAA+B,CAC9B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,8BAA+B,CAC9B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,yBAA0B,CACzB,IACA,IAED,uBAAwB,CACvB,IACA,IAED,gCAAiC,CAChC,IACA,IAED,+BAAgC,CAC/B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,qBAAsB,CACrB,IACA,IAED,uCAAwC,CACvC,IACA,IAED,sCAAuC,CACtC,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,mCAAoC,CACnC,IACA,IAED,kCAAmC,CAClC,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,uBAAwB,CACvB,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,kCAAmC,CAClC,IACA,IAED,iCAAkC,CACjC,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,iCAAkC,CACjC,IACA,IAED,gCAAiC,CAChC,IACA,IAED,+BAAg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","file":"static/js/main.ed8ecc66.chunk.js","sourcesContent":["var map = {\n\t\"./ion-action-sheet-ios.entry.js\": [\n\t\t135,\n\t\t67\n\t],\n\t\"./ion-action-sheet-md.entry.js\": [\n\t\t136,\n\t\t68\n\t],\n\t\"./ion-alert-ios.entry.js\": [\n\t\t137,\n\t\t59\n\t],\n\t\"./ion-alert-md.entry.js\": [\n\t\t138,\n\t\t60\n\t],\n\t\"./ion-app_8-ios.entry.js\": [\n\t\t139,\n\t\t53\n\t],\n\t\"./ion-app_8-md.entry.js\": [\n\t\t140,\n\t\t54\n\t],\n\t\"./ion-avatar_3-ios.entry.js\": [\n\t\t141,\n\t\t8\n\t],\n\t\"./ion-avatar_3-md.entry.js\": [\n\t\t142,\n\t\t9\n\t],\n\t\"./ion-back-button-ios.entry.js\": [\n\t\t143,\n\t\t10\n\t],\n\t\"./ion-back-button-md.entry.js\": [\n\t\t144,\n\t\t11\n\t],\n\t\"./ion-backdrop-ios.entry.js\": [\n\t\t145,\n\t\t12\n\t],\n\t\"./ion-backdrop-md.entry.js\": [\n\t\t146,\n\t\t13\n\t],\n\t\"./ion-button_2-ios.entry.js\": [\n\t\t147,\n\t\t69\n\t],\n\t\"./ion-button_2-md.entry.js\": [\n\t\t148,\n\t\t70\n\t],\n\t\"./ion-card_5-ios.entry.js\": [\n\t\t149,\n\t\t14\n\t],\n\t\"./ion-card_5-md.entry.js\": [\n\t\t150,\n\t\t15\n\t],\n\t\"./ion-checkbox-ios.entry.js\": [\n\t\t151,\n\t\t16\n\t],\n\t\"./ion-checkbox-md.entry.js\": [\n\t\t152,\n\t\t17\n\t],\n\t\"./ion-chip-ios.entry.js\": [\n\t\t153,\n\t\t18\n\t],\n\t\"./ion-chip-md.entry.js\": [\n\t\t154,\n\t\t19\n\t],\n\t\"./ion-col_3.entry.js\": [\n\t\t155,\n\t\t20\n\t],\n\t\"./ion-datetime_3-ios.entry.js\": [\n\t\t156,\n\t\t57\n\t],\n\t\"./ion-datetime_3-md.entry.js\": [\n\t\t157,\n\t\t58\n\t],\n\t\"./ion-fab_3-ios.entry.js\": [\n\t\t158,\n\t\t21\n\t],\n\t\"./ion-fab_3-md.entry.js\": [\n\t\t159,\n\t\t22\n\t],\n\t\"./ion-img.entry.js\": [\n\t\t160,\n\t\t23\n\t],\n\t\"./ion-infinite-scroll_2-ios.entry.js\": [\n\t\t161,\n\t\t24\n\t],\n\t\"./ion-infinite-scroll_2-md.entry.js\": [\n\t\t162,\n\t\t25\n\t],\n\t\"./ion-input-ios.entry.js\": [\n\t\t163,\n\t\t26\n\t],\n\t\"./ion-input-md.entry.js\": [\n\t\t164,\n\t\t27\n\t],\n\t\"./ion-item-option_3-ios.entry.js\": [\n\t\t165,\n\t\t71\n\t],\n\t\"./ion-item-option_3-md.entry.js\": [\n\t\t166,\n\t\t72\n\t],\n\t\"./ion-item_8-ios.entry.js\": [\n\t\t167,\n\t\t73\n\t],\n\t\"./ion-item_8-md.entry.js\": [\n\t\t168,\n\t\t74\n\t],\n\t\"./ion-loading-ios.entry.js\": [\n\t\t169,\n\t\t28\n\t],\n\t\"./ion-loading-md.entry.js\": [\n\t\t170,\n\t\t29\n\t],\n\t\"./ion-menu_3-ios.entry.js\": [\n\t\t171,\n\t\t75\n\t],\n\t\"./ion-menu_3-md.entry.js\": [\n\t\t172,\n\t\t76\n\t],\n\t\"./ion-modal-ios.entry.js\": [\n\t\t173,\n\t\t55\n\t],\n\t\"./ion-modal-md.entry.js\": [\n\t\t174,\n\t\t56\n\t],\n\t\"./ion-nav_2.entry.js\": [\n\t\t175,\n\t\t66\n\t],\n\t\"./ion-popover-ios.entry.js\": [\n\t\t176,\n\t\t30\n\t],\n\t\"./ion-popover-md.entry.js\": [\n\t\t177,\n\t\t31\n\t],\n\t\"./ion-progress-bar-ios.entry.js\": [\n\t\t178,\n\t\t32\n\t],\n\t\"./ion-progress-bar-md.entry.js\": [\n\t\t179,\n\t\t33\n\t],\n\t\"./ion-radio_2-ios.entry.js\": [\n\t\t180,\n\t\t34\n\t],\n\t\"./ion-radio_2-md.entry.js\": [\n\t\t181,\n\t\t35\n\t],\n\t\"./ion-range-ios.entry.js\": [\n\t\t182,\n\t\t77\n\t],\n\t\"./ion-range-md.entry.js\": [\n\t\t183,\n\t\t78\n\t],\n\t\"./ion-refresher_2-ios.entry.js\": [\n\t\t184,\n\t\t61\n\t],\n\t\"./ion-refresher_2-md.entry.js\": [\n\t\t185,\n\t\t62\n\t],\n\t\"./ion-reorder_2-ios.entry.js\": [\n\t\t186,\n\t\t36\n\t],\n\t\"./ion-reorder_2-md.entry.js\": [\n\t\t187,\n\t\t37\n\t],\n\t\"./ion-ripple-effect.entry.js\": [\n\t\t188,\n\t\t38\n\t],\n\t\"./ion-route_4.entry.js\": [\n\t\t189,\n\t\t79\n\t],\n\t\"./ion-searchbar-ios.entry.js\": [\n\t\t190,\n\t\t80\n\t],\n\t\"./ion-searchbar-md.entry.js\": [\n\t\t191,\n\t\t81\n\t],\n\t\"./ion-segment_2-ios.entry.js\": [\n\t\t192,\n\t\t82\n\t],\n\t\"./ion-segment_2-md.entry.js\": [\n\t\t193,\n\t\t83\n\t],\n\t\"./ion-select_3-ios.entry.js\": [\n\t\t194,\n\t\t84\n\t],\n\t\"./ion-select_3-md.entry.js\": [\n\t\t195,\n\t\t85\n\t],\n\t\"./ion-slide_2-ios.entry.js\": [\n\t\t196,\n\t\t86\n\t],\n\t\"./ion-slide_2-md.entry.js\": [\n\t\t197,\n\t\t87\n\t],\n\t\"./ion-spinner.entry.js\": [\n\t\t198,\n\t\t39\n\t],\n\t\"./ion-split-pane-ios.entry.js\": [\n\t\t199,\n\t\t40\n\t],\n\t\"./ion-split-pane-md.entry.js\": [\n\t\t200,\n\t\t41\n\t],\n\t\"./ion-tab-bar_2-ios.entry.js\": [\n\t\t201,\n\t\t42\n\t],\n\t\"./ion-tab-bar_2-md.entry.js\": [\n\t\t202,\n\t\t43\n\t],\n\t\"./ion-tab_2.entry.js\": [\n\t\t203,\n\t\t44\n\t],\n\t\"./ion-text.entry.js\": [\n\t\t204,\n\t\t45\n\t],\n\t\"./ion-textarea-ios.entry.js\": [\n\t\t205,\n\t\t46\n\t],\n\t\"./ion-textarea-md.entry.js\": [\n\t\t206,\n\t\t47\n\t],\n\t\"./ion-toast-ios.entry.js\": [\n\t\t207,\n\t\t63\n\t],\n\t\"./ion-toast-md.entry.js\": [\n\t\t208,\n\t\t64\n\t],\n\t\"./ion-toggle-ios.entry.js\": [\n\t\t209,\n\t\t48\n\t],\n\t\"./ion-toggle-md.entry.js\": [\n\t\t210,\n\t\t49\n\t],\n\t\"./ion-virtual-scroll.entry.js\": [\n\t\t211,\n\t\t50\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 110;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./ion-icon.entry.js\": [\n\t\t215,\n\t\t90\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 112;\nmodule.exports = webpackAsyncContext;","export enum AdminAuthorization {\r\n  None = 0,\r\n  CanViewWages = 1,\r\n  CanEditPublishedTo = 2,\r\n  CanEditTemplates = 4,\r\n  CanEditSchedules = 8,\r\n  CanEditEmployeeClockEvents = 16,\r\n  CanEditOwnClockEvents = 32,\r\n  CanEditUserAccounts = 64,\r\n}\r\n","export enum BreakType {\r\n  UnscheduledUnpaid = 0,\r\n  UnscheduledPaid = 1,\r\n  Scheduled = 2,\r\n}\r\n","export enum ClockInRequirement {\r\n  MatchingShift = 1,\r\n  AnyShift = 2,\r\n  NoShift = 3,\r\n}\r\n","export enum ClockInResponseCode {\r\n  ClockInOk = 0,\r\n  UserNotAtSpecifiedLocation,\r\n  UserRoleMayNotClockIn,\r\n  UserIsAlreadyClockedIn,\r\n  NoScheduleEventsAndClockInRequiresMatchingShift,\r\n  NoPositionsAndClockInRequiresAnyShift,\r\n  NoScheduleEventsAtPositionsAndClockInRequiresAnyShift,\r\n  NoPositionsAndClockInRequiresNoShift,\r\n  NoScheduleEventForGivenPositionAndClockInRequiresMatchingShift,\r\n  NoPositionsToClockInAndRequiresAnyShift,\r\n  UserAlreadyClockedIntoADifferentEvent,\r\n  NoValidCookieFoundForClockByDevice,\r\n  CannotClockInFromGivenIpAddress,\r\n  BusinessNotEnabledForTimeClock,\r\n  NoGeoCoordinatesPassedButRequiredForMobile,\r\n  CouldNotDetermineGeoLocationRequiredToClockIn,\r\n  UserNotAtRequiredGeoLocations,\r\n  NoValidCookieOrIpAddressFound,\r\n  CouldNotFindRequiredClockLocationForClockIn,\r\n  CouldNotFindClockStationInfo,\r\n  CouldNotFindBusinessClockStationId,\r\n  CouldNotFindPositionForEmployee,\r\n  NoPunchClockLocationsAvailableForUser,\r\n  LocationSettingsForbidClockingInToShiftWithDifferentTag,\r\n  LocationSettingsForbidClockingInWithTagAndNoEvent,\r\n  LocationSettingsForbidSettingTagToNull,\r\n}\r\n","export enum ClockOutResponseCode {\r\n  ClockOutOk = 0,\r\n  UserNotAtSpecifiedLocation,\r\n  UserRoleMayNotClockIn,\r\n  UserNotClockedIn,\r\n  NoOpenTimeClockEventForUserAtLocation,\r\n  BreakStartComesBeforeStartOfClockedInTime,\r\n  BreakStartComesAfterClockedOutTime,\r\n  BreakTimeIsGreaterThanShiftTimeAfterBreakStart,\r\n  BreakTimeIsGreaterThanEntireShiftTime,\r\n  BusinessNotEnabledForTimeClock,\r\n  NoValidCookieFoundForClockByDevice,\r\n  CannotClockOutFromGivenIpAddress,\r\n  NoGeoCoordinatesPassedButRequiredForMobile,\r\n  CouldNotDetermineGeoLocationRequiredToClockOut,\r\n  UserNotAtRequiredGeoLocations,\r\n  NoValidCookieOrIpAddressFound,\r\n  CouldNotFindRequiredClockLocationForClockOut,\r\n  CouldNotFindClockStationInfo,\r\n  CouldNotFindBusinessClockStationId,\r\n  CouldNotFindPositionForEmployee,\r\n  NoPunchClockLocationsAvailableForUser,\r\n  ErrorUpdateEventBreaks,\r\n}\r\n","export enum ClockOutValueType {\r\n  Unit = 1,\r\n  Money = 2,\r\n}\r\n","export enum DeviceOperatingSystem {\r\n  iOS = 1,\r\n  Android = 2,\r\n}\r\n","export enum EmployeeSort {\r\n  FirstName = 1,\r\n  LastName = 2,\r\n  EmploymentStart = 3,\r\n  EarliestEventStart = 4,\r\n}\r\n","export enum EndBreakResponseCode {\r\n  Success,\r\n  CannotEndRestrictedBreakEarly,\r\n  ErrorUpdatingEventBreak,\r\n  UserNotAtSpecifiedLocation,\r\n  EventDoesNotMatchCurrentUser,\r\n  BreakNoLongerExists,\r\n}\r\n","export enum EventGroup {\r\n  All = -1,\r\n  Scheduled = -2,\r\n  DontWork = -3,\r\n  ClockAndSched = -6,\r\n  Custom = 0,\r\n}\r\n","import {IdName} from \"../orbital-interfaces/IdName\";\r\n\r\nexport enum EventStatus {\r\n  Approved = 1,\r\n  Request = 2,\r\n  RequestDenied = 4,\r\n}\r\n\r\nexport const eventStatusIdList = [\r\n  { id: 1, name: \"Approved\"},\r\n  { id: 2, name: \"Request\"},\r\n  { id: 4, name: \"Request Denied\"},\r\n] as IdName[];\r\n\r\n\r\nexport function getEventStatusIdName(eventStatus: EventStatus): IdName {\r\n  const idName =  eventStatusIdList.find(et => et.id === eventStatus);\r\n  if (idName === undefined) {\r\n    throw new Error(\"getEventStatusIdName: Unknown event status: \" + eventStatus);\r\n  }\r\n\r\n  return idName;\r\n}\r\n\r\n","import { ApplicationUser } from \"../context/ApplicationUserContext\";\r\nimport { AuthorizedItems } from \"../orbital-interfaces/AuthorizedItems\";\r\nimport { openDB, DBSchema, IDBPDatabase } from \"idb\";\r\n\r\nconst DB_NAME = \"osKeyStore\";\r\nconst DB_VERSION = 1;\r\n\r\ninterface OSKeyStore extends DBSchema {\r\n  userStore: {\r\n    key: \"user\";\r\n    value: ApplicationUser;\r\n  };\r\n  authItems: {\r\n    key: \"authItems\";\r\n    value: AuthorizedItems;\r\n  };\r\n}\r\n\r\n// -----------------------------------------------------------------------------------------\r\nconst getKeyStore = (): Promise<IDBPDatabase<OSKeyStore>> => {\r\n  return openDB<OSKeyStore>(DB_NAME, DB_VERSION, {\r\n    upgrade(db) {\r\n      db.createObjectStore(\"userStore\");\r\n      db.createObjectStore(\"authItems\");\r\n    },\r\n  });\r\n};\r\n\r\n// -----------------------------------------------------------------------------------------\r\nconst putUserState = async (state: ApplicationUser) => {\r\n  const db = await getKeyStore();\r\n  await db.put(\"userStore\", state, \"user\");\r\n};\r\n\r\n// -----------------------------------------------------------------------------------------\r\nconst getUserState = async (): Promise<ApplicationUser | undefined> => {\r\n  const db = await getKeyStore();\r\n  return await db.get(\"userStore\", \"user\");\r\n};\r\n\r\n// -----------------------------------------------------------------------------------------\r\nconst getAccessToken = async (): Promise<string | undefined> => {\r\n  const db = await getKeyStore();\r\n  return await db.get(\"userStore\", \"user\").then((state) => {\r\n    return state ? state.access_token : undefined;\r\n  });\r\n};\r\n\r\n// -----------------------------------------------------------------------------------------\r\nconst putAuthItems = async (auth: AuthorizedItems) => {\r\n  const db = await getKeyStore();\r\n  await db.put(\"authItems\", auth, \"authItems\");\r\n};\r\n\r\nconst getAuthItems = async () => {\r\n  const db = await getKeyStore();\r\n  const authItems = await db.get(\"authItems\", \"authItems\");\r\n  return authItems;\r\n};\r\n\r\nexport default {\r\n  getKeyStore,\r\n  putUserState,\r\n  getUserState,\r\n  getAccessToken,\r\n  putAuthItems,\r\n  getAuthItems,\r\n};\r\n","import {IdName} from \"../orbital-interfaces/IdName\";\r\n\r\nexport enum EventType {\r\n  Shift = 1,\r\n  Unavailable = 2,\r\n  Vacation = 3,\r\n  Cover = 4,\r\n  Clock = 6,\r\n  Absent = 7,\r\n}\r\n\r\nexport const eventTypeIdList = [\r\n  { id: 1, name: \"Shift\"},\r\n  { id: 2, name: \"Unavailable\"},\r\n  { id: 3, name: \"Vacation\"},\r\n  { id: 4, name: \"Cover\"},\r\n  { id: 6, name: \"Clock\"},\r\n  { id: 7, name: \"Absent\"}\r\n] as IdName[];\r\n\r\nexport function getEventTypeIdName(eventType: EventType): IdName {\r\n  const idName =  eventTypeIdList.find(et => et.id === eventType);\r\n  if (idName === undefined) {\r\n    throw new Error(\"getEventTypeIdList: Unknown event type: \" + eventType);\r\n  }\r\n\r\n  return idName;\r\n}\r\n\r\n","export enum RecurrenceType {\r\n  Daily = 0,\r\n  Weekly = 1,\r\n  MonthlyByDayOfMonth = 2,\r\n  MonthlyByDayOfWeek = 3,\r\n  Yearly = 4,\r\n}\r\n","export enum RecurrenceUpdateType {\r\n  UpdateSingleEvent,\r\n  UpdateEntireSeries,\r\n  UpdateSeriesForward,\r\n}\r\n","export enum Role {\r\n  Employee = \"Employee\",\r\n  Admin = \"Admin\",\r\n  LocationAdmin = \"Location Admin\",\r\n  BusinessAdmin = \"Business Admin\",\r\n  Orbital = \"Orbital\",\r\n}\r\n","export enum StartBreakResponseCode {\r\n  Success,\r\n  BreakAlreadyExists,\r\n  AlreadyOnBreak,\r\n  ErrorInsertingBreak,\r\n  UserNotAtSpecifiedLocation,\r\n  EventDoesNotMatchCurrentUser,\r\n  InvalidUnscheduledBreak,\r\n}\r\n","export enum SubscriptionType {\r\n  None = -1,\r\n  Standard = 0,\r\n  Premium = 1,\r\n  Enterprise = 2,\r\n}\r\n\r\nexport function getSubscriptionTypeName(subscripionType: SubscriptionType): string {\r\n  switch (subscripionType) {\r\n    case SubscriptionType.None:\r\n      return \"None\";\r\n    case SubscriptionType.Standard:\r\n      return \"Standard\";\r\n    case SubscriptionType.Premium:\r\n      return \"Premium\";\r\n    case SubscriptionType.Enterprise:\r\n      return \"Enterprise\";\r\n    default:\r\n      return \"Unknown\";\r\n  }\r\n}\r\n","export enum TimeFormat {\r\n  HoursMinutes = 0, // 05:59\r\n  HoursAndDecimals = 1, // 5.99\r\n}\r\n","export enum UnscheduledBreakOptions {\r\n  Both = 0,\r\n  Unpaid = 1,\r\n  Paid = 2,\r\n  None = 3,\r\n}\r\n","export interface IKeyedCollection<T> {\r\n  add(key: string, value: T): void;\r\n  containsKey(key: string): boolean;\r\n  count(): number;\r\n  item(key: string): T;\r\n  keys(): string[];\r\n  remove(key: string): T;\r\n  values(): T[];\r\n}\r\n\r\nexport class KeyedCollection<T> implements IKeyedCollection<T> {\r\n  private items: { [index: string]: T } = {};\r\n\r\n  private _count: number = 0;\r\n\r\n  public containsKey(key: string): boolean {\r\n    return this.items.hasOwnProperty(key);\r\n  }\r\n\r\n  public count(): number {\r\n    return this._count;\r\n  }\r\n\r\n  public add(key: string, value: T) {\r\n    if (!this.items.hasOwnProperty(key)) this._count++;\r\n\r\n    this.items[key] = value;\r\n  }\r\n\r\n  public remove(key: string): T {\r\n    const val = this.items[key];\r\n    delete this.items[key];\r\n    this._count--;\r\n    return val;\r\n  }\r\n\r\n  public item(key: string): T {\r\n    return this.items[key];\r\n  }\r\n\r\n  public keys(): string[] {\r\n    const keySet: string[] = [];\r\n\r\n    for (const prop in this.items) {\r\n      if (this.items.hasOwnProperty(prop)) {\r\n        keySet.push(prop);\r\n      }\r\n    }\r\n\r\n    return keySet;\r\n  }\r\n\r\n  public values(): T[] {\r\n    const values: T[] = [];\r\n\r\n    for (const prop in this.items) {\r\n      if (this.items.hasOwnProperty(prop)) {\r\n        values.push(this.items[prop]);\r\n      }\r\n    }\r\n\r\n    return values;\r\n  }\r\n}\r\n","import { KeyedCollection } from \"../util/KeyedCollection\";\r\nimport { ApplicationUser } from \"../context/ApplicationUserContext\";\r\nimport { isPlatform } from \"@ionic/react\";\r\n\r\nexport interface Constants {\r\n  checkUnreadMessageCountTimer: number;\r\n  refreshScheduleTimer: number;\r\n  refreshTimeclockSettingsTimer: number;\r\n  maxStaleAuthItemsInMinutes: number;\r\n  minimumFeetForGeolocationUpdate: number\r\n}\r\n\r\nexport interface EnvironmentType {\r\n  constants: Constants;\r\n  key: string;\r\n  name: string;\r\n  url: string;\r\n}\r\n\r\nconst defaults: EnvironmentType = {\r\n  constants: {\r\n    checkUnreadMessageCountTimer: 30 * 1000, // how often to get just the unread messages\r\n    refreshScheduleTimer: 60 * 1000, // how often to refresh events on Schedule/Clock Page\r\n    refreshTimeclockSettingsTimer: 15 * 1000, // how often to get timclock settings on clock panel\r\n    maxStaleAuthItemsInMinutes: 15, // minutes before we force auth items to refresh from api\r\n    minimumFeetForGeolocationUpdate: 15.0, // how many feet before we consider it a position update\r\n  },\r\n\r\n  key: \"prod\",\r\n  name: \"\",\r\n  url: \"\",\r\n};\r\n\r\nconst envTypes: EnvironmentType[] = [\r\n  {\r\n    ...defaults,\r\n    key: \"prod\",\r\n    name: \"Production\",\r\n    url: \"https://api.orbitalshift.com/\",\r\n  },\r\n  {\r\n    ...defaults,\r\n    key: \"sbx\",\r\n    name: \"Sandbox\",\r\n    url: \"https://sandboxapi.orbitalshift.com/\",\r\n  },\r\n  { ...defaults, key: \"loc\", name: \"Local\", url: \"http://localhost:54825/\" },\r\n  {\r\n    ...defaults,\r\n    key: \"emu\",\r\n    name: \"Local (Emu)\",\r\n    url: \"http://10.0.2.2:54825/\",\r\n  },\r\n  {\r\n    ...defaults,\r\n    key: \"tst\",\r\n    name: \"TestServer\",\r\n    url: \"http://TestServer:8000/\",\r\n  },\r\n];\r\n\r\nconst environments = new KeyedCollection<EnvironmentType>();\r\nenvTypes.map((et) => environments.add(et.key, et));\r\n\r\n// ------------------------------------------------------------------------------------------------\r\n// NOTE: versionName, versionCode, and revisionHash should be set to _REPLACE_XXXXX_XXX_ strings\r\n//       that get replaced when 'build' is run from the command line.\r\n//       See OSROOT/_buildenv/BuildModule/CommandLineFunctions.psm1\r\nconst settings = {\r\n  env: environments,\r\n  versionName: \"2.0.0\",\r\n  versionCode: \"6155\",\r\n  revisionHash: \"a27de2e\",\r\n  buildDate: \"Thu 05/21/2020 6:12P\",\r\n  // eslint-disable-next-line max-len\r\n  appVersionString: `2.0.0.6155 (a27de2e)`,\r\n  hasCapacitor: isPlatform(\"capacitor\"),\r\n  platform: isPlatform(\"ios\")\r\n    ? \"ios\"\r\n    : isPlatform(\"android\")\r\n    ? \"android\"\r\n    : \"other\",\r\n};\r\n\r\n// ------------------------------------------------------------------------------------------------\r\nconst getApiUrl = (user: ApplicationUser, endpoint: string): string => {\r\n  return settings.env.item(user.environment).url + endpoint;\r\n};\r\n\r\n// ------------------------------------------------------------------------------------------------\r\nconst getUserAndEnvironmentFromInput = (\r\n  input: string\r\n): { username: string; env: EnvironmentType } => {\r\n  if (input.length < 4) {\r\n    return { username: input, env: settings.env.item(\"prod\") };\r\n  }\r\n\r\n  const envKey = input.toLowerCase().substring(0, 4);\r\n  const username = input.substring(4);\r\n  switch (envKey) {\r\n    case \"sbx \":\r\n      return { username, env: settings.env.item(\"sbx\") };\r\n    case \"loc \":\r\n      return { username, env: settings.env.item(\"loc\") };\r\n    case \"emu \":\r\n      return { username, env: settings.env.item(\"emu\") };\r\n    case \"tst \":\r\n      return { username, env: settings.env.item(\"tst\") };\r\n    default:\r\n      return { username: input, env: settings.env.item(\"prod\") };\r\n  }\r\n};\r\n\r\n// ------------------------------------------------------------------------------------------------\r\nexport const getConstants = (user: ApplicationUser): Constants => {\r\n  if (!user.isLoggedin) {\r\n    return defaults.constants;\r\n  }\r\n\r\n  return settings.env.item(user.environment).constants;\r\n};\r\n\r\nexport default {\r\n  settings,\r\n  getApiUrl,\r\n  getUserAndEnvironmentFromInput,\r\n};\r\n","import * as firebase from \"firebase/app\";\r\nimport \"firebase/analytics\";\r\nimport {ApplicationUser} from \"../context/ApplicationUserContext\";\r\nimport {AuthorizedItems} from \"../orbital-interfaces/AuthorizedItems\";\r\nimport {getSubscriptionTypeName} from \"../enums\";\r\nimport env from \"../api/environment\";\r\n\r\nconst firebaseConfig = {\r\n  apiKey: \"AIzaSyAS526InuG-53VGKi5SA780Mh0YwHkhMDE\",\r\n  authDomain: \"orbital-shift-team-dashboard.firebaseapp.com\",\r\n  databaseURL: \"https://orbital-shift-team-dashboard.firebaseio.com\",\r\n  projectId: \"orbital-shift-team-dashboard\",\r\n  storageBucket: \"orbital-shift-team-dashboard.appspot.com\",\r\n  messagingSenderId: \"475985033328\",\r\n  appId: \"1:475985033328:web:77740655a89e28de035cb5\",\r\n  measurementId: \"G-TGE8788D28\",\r\n};\r\n\r\n// ------------------------------------------------------------------------------------------------\r\nexport function initialize() {\r\n  console.log(\"firebase initialized\");\r\n  firebase.initializeApp(firebaseConfig);\r\n}\r\n\r\n// ------------------------------------------------------------------------------------------------\r\nexport function log(eventName: string, eventParams?: any) {\r\n  firebase.analytics().logEvent(eventName, eventParams);\r\n}\r\n\r\n// ------------------------------------------------------------------------------------------------\r\nexport function setFirebaseUserProperties(user: ApplicationUser, auth: AuthorizedItems) {\r\n  if (user.isLoggedin) {\r\n    const environment = env.settings.env.item(user.environment);\r\n    if (user.username !== undefined) {\r\n      firebase.analytics().setUserId(user.username);\r\n    }\r\n\r\n    firebase.analytics().setUserProperties({\r\n      userRole: auth.role,\r\n      subscriptionType: getSubscriptionTypeName(auth.subscriptionType),\r\n      businessName: auth.businessName,\r\n      userName: user.username,\r\n      version: env.settings.appVersionString,\r\n      environment: environment.name\r\n    });\r\n  }\r\n}\r\n","import { ApplicationUser } from \"../context/ApplicationUserContext\";\r\nimport env from \"./environment\";\r\nimport { log } from \"../util/logger\";\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst post = async (user: ApplicationUser, baseUrl: string, data?: any) => {\r\n  const url = env.getApiUrl(user, baseUrl);\r\n  console.log(\"API: \" + baseUrl);\r\n\r\n  try {\r\n    const response = await fetch(url, {\r\n      method: \"POST\",\r\n      body: JSON.stringify(data),\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        Authorization: `Bearer ${user.access_token}`,\r\n        AppVersion: env.settings.appVersionString,\r\n      },\r\n    });\r\n\r\n    const contentType = response.headers.get(\"content-type\");\r\n    if (contentType && contentType.indexOf(\"application/json\") !== -1) {\r\n      const results = await response.json();\r\n      log(\"api_succeeded\", {\r\n        method: \"POST\",\r\n        baseUrl,\r\n        username: user.username,\r\n      });\r\n      return results;\r\n    }\r\n\r\n    log(\"api_succeeded\", { method: \"POST\", baseUrl, username: user.username });\r\n  } catch (err) {\r\n    log(\"api_err\", {\r\n      method: \"POST\",\r\n      baseUrl,\r\n      username: user?.username,\r\n      ...data,\r\n      appVersion: env.settings.appVersionString,\r\n    });\r\n    console.error(\"Error calling post against url, \" + baseUrl + \": \" + err);\r\n    throw err;\r\n  }\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst putData = async (user: ApplicationUser, baseUrl: string, data: any) => {\r\n  const url = env.getApiUrl(user, baseUrl);\r\n  console.log(\"API: \" + baseUrl);\r\n\r\n  try {\r\n    const dataString = JSON.stringify(data);\r\n\r\n    const response = await fetch(url, {\r\n      method: \"PUT\",\r\n      body: dataString,\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        Authorization: `Bearer ${user.access_token}`,\r\n        AppVersion: env.settings.appVersionString,\r\n      },\r\n    });\r\n\r\n    const results = await response.json();\r\n    log(\"api_succeeded\", { method: \"PUT\", baseUrl, username: user.username });\r\n    return results;\r\n  } catch (err) {\r\n    log(\"api_err\", {\r\n      method: \"PUT\",\r\n      baseUrl,\r\n      username: user?.username,\r\n      ...data,\r\n      appVersion: env.settings.appVersionString,\r\n    });\r\n    console.error(\"Error calling putData against url, \" + baseUrl + \": \" + err);\r\n    throw err;\r\n  }\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst get = async (user: ApplicationUser, baseUrl: string, data?: any) => {\r\n  const url = env.getApiUrl(user, baseUrl);\r\n  console.log(\"API: \" + baseUrl);\r\n\r\n  try {\r\n    const options = {\r\n      method: \"GET\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        Authorization: `Bearer ${user.access_token}`,\r\n        AppVersion: env.settings.appVersionString,\r\n      },\r\n      body: null as null | string,\r\n    };\r\n\r\n    if (data) {\r\n      options.body = JSON.stringify(data);\r\n    }\r\n\r\n    const response = await fetch(url, options);\r\n    const results = await response.json();\r\n    log(\"api_succeeded\", { method: \"GET\", baseUrl, username: user.username });\r\n    return results;\r\n  } catch (err) {\r\n    log(\"api_err\", {\r\n      method: \"GET\",\r\n      baseUrl,\r\n      username: user?.username,\r\n      appVersion: env.settings.appVersionString,\r\n    });\r\n    console.error(\"Error calling get against url, \" + baseUrl + \": \" + err);\r\n    throw err;\r\n  }\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst put = async (user: ApplicationUser, baseUrl: string, data?: any) => {\r\n  const url = env.getApiUrl(user, baseUrl);\r\n  console.log(\"API: \" + baseUrl);\r\n\r\n  const options = {\r\n    method: \"PUT\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      Authorization: `Bearer ${user.access_token}`,\r\n      AppVersion: env.settings.appVersionString,\r\n    },\r\n  } as any;\r\n\r\n  if (data) {\r\n    options.body = JSON.stringify(data!);\r\n  }\r\n\r\n  try {\r\n    const response = await fetch(url, options);\r\n    const contentType = response.headers.get(\"content-type\");\r\n    if (contentType && contentType.indexOf(\"application/json\") !== -1) {\r\n      const results = await response.json();\r\n      log(\"api_succeeded\", { method: \"PUT\", baseUrl, username: user.username });\r\n      return results;\r\n    }\r\n\r\n    log(\"api_succeeded\", { method: \"PUT\", baseUrl, username: user.username });\r\n  } catch (err) {\r\n    log(\"api_err\", {\r\n      method: \"PUT\",\r\n      baseUrl,\r\n      username: user?.username,\r\n      ...data,\r\n      appVersion: env.settings.appVersionString,\r\n    });\r\n    console.error(\"Error calling put against url, \" + baseUrl + \": \" + err);\r\n    throw err;\r\n  }\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nconst del = async (user: ApplicationUser, baseUrl: string, data?: any) => {\r\n  const url = env.getApiUrl(user, baseUrl);\r\n  console.log(\"API: \" + baseUrl);\r\n\r\n  const options = {\r\n    method: \"DELETE\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      Authorization: `Bearer ${user.access_token}`,\r\n      AppVersion: env.settings.appVersionString,\r\n    },\r\n  } as any;\r\n\r\n  if (data) {\r\n    options.body = JSON.stringify(data!);\r\n  }\r\n\r\n  try {\r\n    const response = await fetch(url, options);\r\n    const contentType = response.headers.get(\"content-type\");\r\n    if (contentType && contentType.indexOf(\"application/json\") !== -1) {\r\n      log(\"api_succeeded\", {\r\n        method: \"DELETE\",\r\n        baseUrl,\r\n        username: user.username,\r\n      });\r\n      return await response.json();\r\n    }\r\n\r\n    log(\"api_succeeded\", {\r\n      method: \"DELETE\",\r\n      baseUrl,\r\n      username: user.username,\r\n    });\r\n    return;\r\n  } catch (err) {\r\n    log(\"api_err\", {\r\n      method: \"DELETE\",\r\n      baseUrl,\r\n      username: user?.username,\r\n      ...data,\r\n      appVersion: env.settings.appVersionString,\r\n    });\r\n    console.error(\"Error calling delete against url, \" + baseUrl + \": \" + err);\r\n    throw err;\r\n  }\r\n};\r\n\r\nexport default {\r\n  get,\r\n  post,\r\n  put,\r\n  putData,\r\n  del,\r\n};\r\n","import { ApplicationUser } from \"../context/ApplicationUserContext\";\r\nimport apiHelper from \"./orbitalApiHelper\";\r\nimport {DeviceOperatingSystem} from \"../enums\";\r\nimport { NotificationTypeModel } from \"../orbital-interfaces/NotificationTypeModel\";\r\nimport env from \"./environment\";\r\nimport { log } from \"../util/logger\";\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function subscribe(user: ApplicationUser, token: string) {\r\n  const url = `api/v1/employee/notifications/subscribe`;\r\n  const operatingSystem =\r\n    env.settings.platform === \"ios\"\r\n      ? DeviceOperatingSystem.iOS\r\n      : DeviceOperatingSystem.Android;\r\n\r\n  log(\"pushNotifications_subscribeCalled\", {\r\n    token,\r\n    operatingSystem,\r\n    username: user.username,\r\n    access_token: user.access_token,\r\n  });\r\n\r\n  return await apiHelper.putData(user, url, {\r\n    TokenId: token,\r\n    OperatingSystem: operatingSystem,\r\n  });\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function unsubscribe(user: ApplicationUser, token: string) {\r\n  const url = `api/v1/employee/notifications/unsubscribe`;\r\n  const operatingSystem =\r\n    env.settings.platform === \"ios\"\r\n      ? DeviceOperatingSystem.iOS\r\n      : DeviceOperatingSystem.Android;\r\n\r\n  return await apiHelper.putData(user, url, {\r\n    TokenId: token,\r\n    OperatingSystem: operatingSystem,\r\n  });\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function getTypesSelectedByUser (user: ApplicationUser) {\r\n  const url = `api/v1/employee/notifications/types`;\r\n  return (await apiHelper.get(user, url)) as NotificationTypeModel[];\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function putTypes(user: ApplicationUser, typeIds: number[]) {\r\n  const url = `api/v1/employee/notifications/types`;\r\n  const data = {\r\n    ids: typeIds,\r\n  };\r\n\r\n  return (await apiHelper.put(user, url, data)) as void;\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function listTypes(user: ApplicationUser) {\r\n  const url = `api/v1/employee/notifications/list-types`;\r\n\r\n  // NOTE: the API no longer really uses passed-in data since the\r\n  // \"Communications rewrite\"\r\n\r\n  return (await apiHelper.get(user, url)) as NotificationTypeModel[];\r\n}\r\n\r\nexport const pushNotificationsApi = {\r\n  subscribe,\r\n  unsubscribe,\r\n  getTypesSelectedByUser,\r\n  putTypes,\r\n  listTypes,\r\n};\r\n","import {\r\n  Plugins,\r\n  PushNotification,\r\n  PushNotificationToken,\r\n  PushNotificationActionPerformed,\r\n} from \"@capacitor/core\";\r\nimport { log } from \"./logger\";\r\nimport env from \"../api/environment\";\r\nimport { ApplicationUser } from \"../context/ApplicationUserContext\";\r\nimport { createBrowserHistory } from \"history\";\r\nimport {pushNotificationsApi} from \"../api/pushNotificationsApi\";\r\n\r\nconst { PushNotifications } = Plugins;\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst register = (\r\n  user: ApplicationUser,\r\n  pushEnabled: (enabled: boolean) => void,\r\n  showMessage: (msg: string) => void\r\n) => {\r\n  const history = createBrowserHistory({ forceRefresh: true });\r\n\r\n  if (!env.settings.hasCapacitor) {\r\n    // TODO: web push instead of capacitor\r\n    return;\r\n  }\r\n\r\n  PushNotifications.register().then(() => {\r\n    console.log(\"PushNotificationController: register called and returned\");\r\n  });\r\n\r\n  // On succcess, we should be able to receive notifications\r\n  PushNotifications.addListener(\r\n    \"registration\",\r\n    (token: PushNotificationToken) => {\r\n      pushNotificationsApi.subscribe(user, token.value);\r\n      pushEnabled(true);\r\n      showMessage(\"Push registration success, token: \" + token.value);\r\n      log(\"pushNotifications_registered\", {\r\n        token: token.value,\r\n        platform: env.settings.platform,\r\n      });\r\n    }\r\n  );\r\n\r\n  // Some issue with your setup and push will not work\r\n  PushNotifications.addListener(\"registrationError\", (error: any) => {\r\n    showMessage(\"Error on registration: \" + JSON.stringify(error));\r\n    log(\"pushNotifications_registrationError\", {\r\n      error,\r\n      platform: env.settings.platform,\r\n    });\r\n  });\r\n\r\n  // Show us the notification payload if the app is open on our device\r\n  PushNotifications.addListener(\r\n    \"pushNotificationReceived\",\r\n    (notification: PushNotification) => {\r\n      if (notification) {\r\n        if (notification.data && notification.data.MessageId) {\r\n          showMessage(\r\n            \"NOTIFICATION: \" +\r\n              notification.title +\r\n              \": \" +\r\n              notification.body +\r\n              \" id:\" +\r\n              notification.data.MessageId\r\n          );\r\n          history.push(\"/tabs/messages/\" + notification.data.MessageId);\r\n          history.goForward();\r\n        } else {\r\n          showMessage(\r\n            \"NOTIFICATION: \" +\r\n              notification.title +\r\n              \": \" +\r\n              notification.body +\r\n              \" (no id)\"\r\n          );\r\n        }\r\n\r\n        log(\"pushNotifications_receivedWhenOpen\", {\r\n          title: notification.title,\r\n          body: notification.body,\r\n          messageId: notification.data.MessageId ?? -123,\r\n        });\r\n      }\r\n\r\n      /*\r\n      let notif = this.state.notifications;\r\n      notif.push({ id: notification.id, title: notification.title, body: notification.body })\r\n      this.setState({\r\n        notifications: notif\r\n      })\r\n      */\r\n    }\r\n  );\r\n\r\n  // Method called when tapping on a notification\r\n  PushNotifications.addListener(\r\n    \"pushNotificationActionPerformed\",\r\n    (notification: PushNotificationActionPerformed) => {\r\n      if (\r\n        notification.notification.data &&\r\n        notification.notification.data.MessageId\r\n      ) {\r\n        showMessage(\r\n          \"TAPPED ON NOTIFICATION: \" +\r\n            notification.notification.title +\r\n            \": \" +\r\n            notification.notification.body +\r\n            \" id:\" +\r\n            notification.notification.data.MessageId\r\n        );\r\n        history.push(\r\n          \"/tabs/messages/\" + notification.notification.data.MessageId\r\n        );\r\n        history.goForward();\r\n      } else {\r\n        showMessage(\r\n          \"TAPPED ON NOTIFICATION: \" +\r\n            notification.notification.title +\r\n            \": \" +\r\n            notification.notification.body +\r\n            \" (no id)\"\r\n        );\r\n      }\r\n\r\n      log(\"pushNotifications_actionPerformed\", {\r\n        title: notification.notification.title,\r\n        body: notification.notification.body,\r\n        messageId: notification.notification.data.MessageId ?? -123,\r\n      });\r\n    }\r\n  );\r\n};\r\n\r\nexport const pushNotificationsController = {\r\n  register,\r\n};\r\n","/* eslint-disable */\r\nimport React, { useState, useEffect } from \"react\";\r\nimport db from \"../data/dbStore\";\r\nimport {pushNotificationsController} from \"../util/pushNotificationsController\";\r\nimport env from \"../api/environment\";\r\n\r\nexport interface ApplicationUser {\r\n  isLoggedin: boolean;\r\n  access_token?: string;\r\n  username: string;\r\n  darkMode: boolean;\r\n  loading: boolean;\r\n  environment: string;\r\n  isPushEnabled: boolean;\r\n}\r\n\r\nexport interface IApplicationUserContext {\r\n  user: ApplicationUser;\r\n  logout: () => Promise<void>;\r\n  userLoggedIn: (\r\n    username: string,\r\n    access_token: string,\r\n    environment: string\r\n  ) => Promise<ApplicationUser>;\r\n  pushEnabled: (enabled: boolean) => void;\r\n}\r\n\r\nconst INITIAL_APPLICATION_USER: ApplicationUser = {\r\n  isLoggedin: false,\r\n  access_token: undefined,\r\n  username: \"\",\r\n  darkMode: false,\r\n  loading: true,\r\n  environment: \"prod\",\r\n  isPushEnabled: false,\r\n};\r\n\r\nconst INITIAL_APPLICATION_USER_CONTEXT = {\r\n  user: INITIAL_APPLICATION_USER,\r\n  logout: async () => {},\r\n  userLoggedIn: (u: string, at: string, e: string) => {\r\n    return new Promise<ApplicationUser>(() => {\r\n      return INITIAL_APPLICATION_USER;\r\n    });\r\n  },\r\n  pushEnabled: (e: boolean) => {},\r\n};\r\n\r\nexport const ApplicationUserContext = React.createContext<\r\n  IApplicationUserContext\r\n>(INITIAL_APPLICATION_USER_CONTEXT);\r\n\r\nexport const ApplicationUserContextProvider = (props: any) => {\r\n  const [userState, internalSetUserState] = useState({\r\n    ...INITIAL_APPLICATION_USER,\r\n  });\r\n\r\n  // ----------------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    let mounted = true;\r\n\r\n    Promise.all([db.getUserState()]).then((response) => {\r\n      if (mounted) {\r\n        const newState = response[0];\r\n        if (newState) {\r\n          internalSetUserState({ ...newState, loading: false });\r\n        } else {\r\n          internalSetUserState({ ...userState, loading: false });\r\n        }\r\n      }\r\n    });\r\n    return () => {\r\n      mounted = false;\r\n    };\r\n\r\n    // eslint-disable-next-line\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (\r\n      userState &&\r\n      !userState.isPushEnabled &&\r\n      userState.access_token &&\r\n      userState.access_token.length > 0 &&\r\n      env.settings.platform !== \"other\"\r\n    ) {\r\n      pushNotificationsController.register(userState, pushEnabled, () => {});\r\n    }\r\n\r\n    // eslint-disable-next-line\r\n  }, [userState.isPushEnabled, userState.access_token]);\r\n\r\n  // ----------------------------------------------------------------------------------------------\r\n  const pushEnabled = (enabled: boolean) => {\r\n    internalSetUserState({ ...userState, isPushEnabled: enabled });\r\n  };\r\n\r\n  // ----------------------------------------------------------------------------------------------\r\n  const userLoggedIn = async (\r\n    username: string,\r\n    access_token: string,\r\n    environment: string\r\n  ): Promise<ApplicationUser> => {\r\n    const currentState = await db.getUserState();\r\n    const newState = {\r\n      username,\r\n      access_token,\r\n      environment,\r\n      isLoggedin: true,\r\n      darkMode: currentState\r\n        ? currentState.darkMode\r\n        : INITIAL_APPLICATION_USER.darkMode,\r\n      loading: false,\r\n      isPushEnabled: false,\r\n    };\r\n\r\n    await db.putUserState(newState);\r\n    internalSetUserState(newState);\r\n    return newState;\r\n  };\r\n\r\n  // ----------------------------------------------------------------------------------------------\r\n  const logout = async () => {\r\n    const newState = {\r\n      ...userState,\r\n      isLoggedin: false,\r\n      access_token: undefined,\r\n      latitude: undefined,\r\n      longitude: undefined,\r\n      isPushEnabled: false,\r\n      requestedGeoPermission: false,\r\n      refusedGeoPermission: false,\r\n    };\r\n    internalSetUserState(newState);\r\n    await db.putUserState(newState);\r\n  };\r\n\r\n  return (\r\n    <ApplicationUserContext.Provider\r\n      value={{\r\n        user: userState,\r\n        userLoggedIn,\r\n        logout,\r\n        pushEnabled,\r\n      }}\r\n    >\r\n      {props.children}\r\n    </ApplicationUserContext.Provider>\r\n  );\r\n};\r\n","import { IonAlert } from \"@ionic/react\";\r\nimport React, { useState } from \"react\";\r\n\r\nfunction useDialogBox() {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [alertData, setAlertData] = useState({\r\n    header: \"\",\r\n    message: \"\",\r\n    onDismiss: () => {},\r\n  });\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const showAlert = (\r\n    header: string,\r\n    message: string,\r\n    onDismiss: () => void\r\n  ) => {\r\n    setAlertData({\r\n      header,\r\n      message,\r\n      onDismiss,\r\n    });\r\n\r\n    setIsOpen(true);\r\n  };\r\n\r\n  const alertBoxJsx = (\r\n    <IonAlert\r\n      isOpen={isOpen}\r\n      onDidDismiss={() => {\r\n        setIsOpen(false);\r\n        alertData.onDismiss();\r\n      }}\r\n      header={alertData.header}\r\n      message={alertData.message}\r\n      buttons={[\"OK\"]}\r\n    />\r\n  );\r\n\r\n  return {\r\n    showAlert,\r\n    alertBoxJsx,\r\n  };\r\n}\r\n\r\nexport default useDialogBox;\r\n","import React from \"react\";\r\nimport { IonItem, IonToggle, IonList, IonLabel } from \"@ionic/react\";\r\nimport { NotificationTypeModel } from \"../orbital-interfaces/NotificationTypeModel\";\r\n\r\ninterface ToggleListExProps {\r\n  list: NotificationTypeModel[] | null;\r\n  selected: NotificationTypeModel[] | null;\r\n  selectionChanged(newSelected: NotificationTypeModel[] | null): void;\r\n}\r\n\r\nconst ToggleListEx: React.FC<ToggleListExProps> = ({\r\n  list,\r\n  selected,\r\n  selectionChanged,\r\n}: ToggleListExProps) => {\r\n  // ----------------------------------------------------------------------------------------------\r\n  const isItemChecked = (id: number) => {\r\n    if (!selected || selected.length === 0) {\r\n      return false;\r\n    }\r\n\r\n    for (let i = 0; i < selected.length; i++) {\r\n      if (selected[i].id === id) {\r\n        return true;\r\n      }\r\n    }\r\n\r\n    return false;\r\n  };\r\n\r\n  // ----------------------------------------------------------------------------------------------\r\n  const onAllChanged = () => {\r\n    const checked = list?.length !== selected?.length;\r\n\r\n    if (list?.length === selected?.length) {\r\n      if (checked) {\r\n        return;\r\n      }\r\n\r\n      const newSelected = [] as NotificationTypeModel[];\r\n      selectionChanged(newSelected);\r\n    } else {\r\n      if (!checked) {\r\n        return;\r\n      }\r\n\r\n      selectionChanged(list ? list.slice() : null);\r\n    }\r\n  };\r\n\r\n  // ----------------------------------------------------------------------------------------------\r\n  const itemToggle = (item: NotificationTypeModel) => {\r\n    if (selected === null) {\r\n      return;\r\n    }\r\n\r\n    const checked = !selected.map((n) => n.id).includes(item.id);\r\n\r\n    if (checked) {\r\n      const newList = selected.slice();\r\n      newList.push(item);\r\n      selectionChanged(newList);\r\n    } else {\r\n      const newlist = selected.filter((r) => r.id !== item.id);\r\n      selectionChanged(newlist);\r\n    }\r\n  };\r\n\r\n  if (!list) {\r\n    return <div>Loading...</div>;\r\n  }\r\n\r\n  return (\r\n    <IonItem lines=\"none\">\r\n      <IonList>\r\n        <IonItem lines=\"none\" key={-1}>\r\n          <IonToggle\r\n            mode=\"md\"\r\n            key={-1}\r\n            checked={list?.length === selected?.length}\r\n            onClick={() => onAllChanged()}\r\n          />\r\n          <IonLabel>SELECT ALL</IonLabel>\r\n        </IonItem>\r\n        {list &&\r\n          list.map((toggle) => (\r\n            <IonItem lines=\"none\" key={toggle.id}>\r\n              <IonToggle\r\n                mode=\"md\"\r\n                key={toggle.id}\r\n                onClick={() => {\r\n                  itemToggle(toggle);\r\n                }}\r\n                checked={isItemChecked(toggle.id)}\r\n              />\r\n              <IonLabel>{toggle.name}</IonLabel>\r\n            </IonItem>\r\n          ))}\r\n      </IonList>\r\n    </IonItem>\r\n  );\r\n};\r\n\r\nexport default ToggleListEx;\r\n","import React, { useContext, useEffect, useState } from \"react\";\r\nimport {\r\n  IonButton,\r\n  IonButtons,\r\n  IonIcon,\r\n  IonContent,\r\n  IonFooter,\r\n  IonHeader,\r\n  IonTitle,\r\n  IonToolbar,\r\n} from \"@ionic/react\";\r\nimport { arrowBackOutline } from \"ionicons/icons\";\r\nimport ToggleListEx from \"../components/ToggleListEx\";\r\nimport {pushNotificationsApi} from \"../api/pushNotificationsApi\";\r\nimport { ApplicationUserContext } from \"../context/ApplicationUserContext\";\r\nimport { NotificationTypeModel } from \"../orbital-interfaces/NotificationTypeModel\";\r\n\r\ninterface NotificationSettingsModalProps {\r\n  onDismissModal: () => void;\r\n  isOpen: boolean;\r\n}\r\n\r\nconst NotificationSettingsModal: React.FC<NotificationSettingsModalProps> = ({\r\n  onDismissModal,\r\n  isOpen,\r\n}: NotificationSettingsModalProps) => {\r\n  const { user } = useContext(ApplicationUserContext);\r\n  const [notifications, setNotifications] = useState(\r\n    null as NotificationTypeModel[] | null\r\n  );\r\n  const [selectedNotifications, setSelectedNotifications] = useState(\r\n    null as NotificationTypeModel[] | null\r\n  );\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (!isOpen) {\r\n      setSelectedNotifications(null);\r\n      setNotifications(null);\r\n      return;\r\n    }\r\n\r\n    let isSubscribed = true;\r\n\r\n    Promise.all([\r\n      pushNotificationsApi.getTypesSelectedByUser(user),\r\n      pushNotificationsApi.listTypes(user),\r\n    ]).then((responses) => {\r\n      if (!isSubscribed) {\r\n        return;\r\n      }\r\n\r\n      setSelectedNotifications(responses[0]);\r\n      setNotifications(responses[1]);\r\n    });\r\n\r\n    return () => {\r\n      isSubscribed = false;\r\n    };\r\n  }, [isOpen, user]);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onCancel = () => {\r\n    onDismissModal();\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onSelectionChanged = (newSelected: NotificationTypeModel[]) => {\r\n    const ids = newSelected.map((n) => n.id);\r\n    pushNotificationsApi.putTypes(user, ids).then(() => {\r\n      setSelectedNotifications(newSelected);\r\n    });\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <IonHeader className=\"ion-no-border\">\r\n        <IonToolbar>\r\n          <IonButtons slot=\"start\">\r\n            <IonButton onClick={onCancel}>\r\n              <IonIcon icon={arrowBackOutline} mode=\"md\" slot=\"icon-only\" />\r\n            </IonButton>\r\n          </IonButtons>\r\n          <IonTitle>Notifications</IonTitle>\r\n        </IonToolbar>\r\n      </IonHeader>\r\n\r\n      <IonContent class=\"outer-content\">\r\n        <ToggleListEx\r\n          list={notifications}\r\n          selected={selectedNotifications}\r\n          selectionChanged={onSelectionChanged}\r\n        />\r\n      </IonContent>\r\n\r\n      <IonFooter>\r\n        <IonToolbar />\r\n      </IonFooter>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default NotificationSettingsModal;\r\n","import { IonToast } from \"@ionic/react\";\nimport React, { useState } from \"react\";\n\nfunction useSimpleToast() {\n  const [isOpen, setIsOpen] = useState(false);\n  const [toastData, setToastData] = useState({ message: \"\" });\n\n  const showToast = (message: string) => {\n    setToastData({\n      message,\n    });\n\n    setIsOpen(true);\n  };\n\n  const simpleToastJsx = (\n    <IonToast\n      isOpen={isOpen}\n      onDidDismiss={() => setIsOpen(false)}\n      position=\"top\"\n      message={toastData.message}\n      duration={1500}\n    />\n  );\n\n  return {\n    showToast,\n    simpleToastJsx,\n  };\n}\n\nexport default useSimpleToast;\n","import {EventGroup, EventType, EventStatus, } from \"../enums\";\r\nimport {ScheduleEvent} from \"../orbital-interfaces/ScheduleEvent\";\r\nimport {isAfter} from \"date-fns\";\r\nimport {EventInformation} from \"../orbital-interfaces/TEC\";\r\nimport {LocationSettings} from \"../orbital-interfaces/LocationSettings\";\r\nimport {timeHelper as th} from \"./timeHelper\";\r\n\r\nconst onClockEventEnd = new Date(9000, 1, 1);\r\n\r\n// ---------------------------------------------------------------------------------\r\nfunction isClockedIn(ev: ScheduleEvent) {\r\n  return (\r\n    ev.EventTypeId === EventType.Clock &&\r\n    ev.EventStatusId === EventStatus.Approved &&\r\n    isAfter(ev.EventEnd, onClockEventEnd)\r\n  );\r\n}\r\n\r\n\r\n/*\r\n * Code below in this file was based on ScheduleEventHelper.cs in OrbitalShift.BLL.dll\r\n */\r\n\r\n// --------------------------------------------------------------------------------------\r\n// Returns true if the event type is a type that is associated to a position (e.g.,\r\n// not an unavailable)\r\nfunction isPositionSpecificEvent(eventType: EventType) {\r\n  return (\r\n    eventType === EventType.Shift ||\r\n    eventType === EventType.Cover ||\r\n    eventType === EventType.Clock ||\r\n    eventType === EventType.Absent\r\n  );\r\n}\r\n\r\n// ---------------------------------------------------------------------------------\r\nfunction isShiftTypeEvent(\r\n  eventType: EventType,\r\n  eventStatus: EventStatus\r\n): boolean {\r\n  return (\r\n    (eventType === EventType.Shift && eventStatus === EventStatus.Approved) ||\r\n    (eventType === EventType.Cover && eventStatus === EventStatus.Request) ||\r\n    (eventType === EventType.Cover && eventStatus === EventStatus.RequestDenied)\r\n  );\r\n}\r\n\r\n// ---------------------------------------------------------------------------------\r\nfunction isAbsentExpenseEvent(\r\n  eventType: EventType,\r\n  eventStatus: EventStatus\r\n): boolean {\r\n  return eventType === EventType.Absent && eventStatus === EventStatus.Approved;\r\n}\r\n\r\n// ---------------------------------------------------------------------------------\r\nfunction isTimeClockEvent(\r\n  eventType: EventType,\r\n  eventStatus: EventStatus\r\n): boolean {\r\n  return (\r\n    isShiftTypeEvent(eventType, eventStatus) ||\r\n    (eventType === EventType.Clock && eventStatus === EventStatus.Approved)\r\n  );\r\n}\r\n\r\n// ---------------------------------------------------------------------------------\r\nfunction isDontWorkEvent(eventType: EventType, eventStatus: EventStatus): boolean {\r\n  return (\r\n    (eventType === EventType.Unavailable && eventStatus === EventStatus.Approved) ||\r\n    (eventType === EventType.Vacation && eventStatus === EventStatus.Approved) ||\r\n    (eventType === EventType.Absent && eventStatus === EventStatus.Approved) ||\r\n    (eventType === EventType.Cover && eventStatus === EventStatus.Approved)\r\n  );\r\n}\r\n\r\n// ---------------------------------------------------------------------------------\r\nfunction eventMatchesFilter(\r\n  eventTypeFilter: EventType | EventGroup,\r\n  eventStatusFilter: EventStatus | EventGroup,\r\n  eventType: EventType,\r\n  eventStatus: EventStatus\r\n): boolean {\r\n  if (eventTypeFilter === EventGroup.DontWork && eventStatusFilter === EventGroup.DontWork) {\r\n    return isDontWorkEvent(eventType, eventStatus);\r\n  }\r\n\r\n\r\n  if (eventTypeFilter > 0 && eventStatusFilter > 0) {\r\n    if (eventTypeFilter === eventType && eventStatusFilter === eventStatus) {\r\n      return true;\r\n    }\r\n  } else if (eventTypeFilter > 0 && eventStatusFilter === EventGroup.All) {\r\n    return eventTypeFilter === eventType;\r\n  } else if (eventTypeFilter === EventGroup.All && eventStatusFilter > 0) {\r\n    return eventStatusFilter === eventStatus;\r\n  } else if (\r\n    eventTypeFilter === EventGroup.Scheduled &&\r\n    eventStatusFilter === EventGroup.Scheduled\r\n  ) {\r\n    return (\r\n      isShiftTypeEvent(eventType, eventStatus) ||\r\n      isAbsentExpenseEvent(eventType, eventStatus)\r\n    );\r\n  } else if (\r\n    eventTypeFilter === EventGroup.ClockAndSched &&\r\n    eventStatusFilter === EventGroup.ClockAndSched\r\n  ) {\r\n    return (\r\n      isTimeClockEvent(eventType, eventStatus) ||\r\n      isAbsentExpenseEvent(eventType, eventStatus)\r\n    );\r\n  } else {\r\n    return true;\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\n// ---------------------------------------------------------------------------------\r\nfunction showFlagForExtendedClock(ev: EventInformation, locSettings: LocationSettings | null) {\r\n  if (locSettings === null) {\r\n    return false;\r\n  }\r\n\r\n  if (ev.EventTypeId !== EventType.Clock || ev.IsClockedIn) {\r\n    return false;\r\n  }\r\n\r\n  return isExtendedClock(ev, locSettings);\r\n}\r\n\r\n// ---------------------------------------------------------------------------------\r\nfunction isExtendedClock(ev: EventInformation, locSettings: LocationSettings | null) {\r\n  if (locSettings === null) {\r\n    return false;\r\n  }\r\n\r\n  const clockTime = th.getDurationFromTimeSpan(ev.Data?.TotalValue.Time.ActualTime);\r\n  const forgotToClockOutTime = th.getDurationFromTimeSpan(locSettings.ForgotToClockOutTime)\r\n  return clockTime > forgotToClockOutTime;\r\n}\r\n\r\nexport const scheduleEventHelper = {\r\n  eventMatchesFilter,\r\n  isAbsentExpenseEvent,\r\n  isClockedIn,\r\n  isDontWorkEvent,\r\n  isExtendedClock,\r\n  isPositionSpecificEvent,\r\n  isShiftTypeEvent,\r\n  isTimeClockEvent,\r\n  showFlagForExtendedClock,\r\n}\r\n","import { EventBreak } from \"../orbital-interfaces/EventBreak\";\r\nimport { EventInformation } from \"../orbital-interfaces/TEC\";\r\nimport { ScheduleEvent } from \"../orbital-interfaces/ScheduleEvent\";\r\nimport {\r\n  addDays, addHours,\r\n  differenceInDays,\r\n  differenceInMinutes,\r\n  format,\r\n  isSameDay,\r\n  isSameYear,\r\n  isToday,\r\n  parseISO,\r\n} from \"date-fns\";\r\nimport {LocationSettings} from \"../orbital-interfaces/LocationSettings\";\r\nimport {TimeFormat} from \"../enums\";\r\nimport { OrbitalTime } from \"../orbital-interfaces/OrbitalTime\";\r\nimport {scheduleEventHelper} from \"./scheduleEventHelper\";\r\nimport {toDate, format as tzFormat} from \"date-fns-tz\";\r\n\r\nconst noEndTime = new Date(9000, 1, 1);\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nfunction isScheduleEvent(ev: EventInformation | ScheduleEvent): ev is ScheduleEvent {\r\n  return (ev as ScheduleEvent).BusinessId !== undefined;\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nfunction convertTimeWithoutTimeZoneToLocalTime(dtStr: string): string {\r\n  // eslint-disable-next-line\r\n  const localTimeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;\r\n  const newDate = toDate(dtStr, { timeZone: localTimeZone});\r\n  const dateOnlyStr = tzFormat(newDate,'yyyy-MM-dd', { timeZone: localTimeZone});\r\n  const timeOnlyStr = tzFormat(newDate,'HH:mm:ssXXX', { timeZone: localTimeZone});\r\n  return dateOnlyStr + \"T\" + timeOnlyStr;\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nfunction getCurrentLocationDateTime(loc: LocationSettings): Date {\r\n  const now = new Date();\r\n  const utcDateStr = now.toISOString().replace(\"Z\", \"\");\r\n  return addHours(parseISO(utcDateStr), loc.TimeZoneOffset);\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nfunction getDurationFromTimeSpan(timespan: string) {\r\n  if (!timespan) {\r\n    return 0;\r\n  }\r\n\r\n  const tok = timespan.split(\":\");\r\n  let hrs: number;\r\n  let min: number;\r\n  if (tok[0].indexOf(\".\") >= 0) {\r\n    const hrTok = tok[0].split(\".\");\r\n    hrs = 24 * parseInt(hrTok[0]) + parseInt(hrTok[1]);\r\n    min = parseInt(tok[1]);\r\n  } else {\r\n    hrs = parseInt(tok[0]);\r\n    min = parseInt(tok[1]);\r\n  }\r\n\r\n  return hrs * 60 + min;\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nfunction messageDateString(time: string) {\r\n  const date = parseISO(time);\r\n  const now = new Date();\r\n\r\n  if (isToday(date)) {\r\n    return format(date, \"h:mmaaa\").replace(\"M\", \"\");\r\n  } else if (differenceInDays(now, date) < 7) {\r\n    return format(date, \"EEE\");\r\n  } else if (isSameYear(date, now)) {\r\n    return format(date, \"MMM d\");\r\n  } else {\r\n    return format(date, \"M/d/yyyy\");\r\n  }\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nfunction getTimeStringFromMinutes(\r\n  locSettings: LocationSettings,\r\n  min: number | null\r\n) {\r\n  if (locSettings.TimeFormat === TimeFormat.HoursMinutes) {\r\n    if (min === null) {\r\n      return \"00:00\";\r\n    }\r\n\r\n    const hours = Math.floor(min / 60);\r\n    const minutes = min % 60;\r\n\r\n    return `${padZeroes(hours, 2)}:${padZeroes(minutes, 2)}`;\r\n  } else {\r\n    if (min === null) {\r\n      return \"0\";\r\n    }\r\n\r\n    return formatDecimal(\r\n      min / 60,\r\n      locSettings.TimeFormatDigits,\r\n      locSettings.TimeFormatDecimals\r\n    );\r\n  }\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nfunction getTimeStringFromOrbitalTime(\r\n  locSettings: LocationSettings,\r\n  time: OrbitalTime\r\n) {\r\n  if (time.ActualTime === \"00:00:00\") {\r\n    return locSettings.TimeFormat === TimeFormat.HoursMinutes\r\n      ? \"00:00\"\r\n      : formatDecimal(\r\n          0,\r\n          locSettings.TimeFormatDigits,\r\n          locSettings.TimeFormatDecimals\r\n        );\r\n  }\r\n\r\n  if (locSettings.TimeFormat === TimeFormat.HoursMinutes) {\r\n    const tok = time.ActualTime.split(\":\");\r\n    if (tok.length !== 3) {\r\n      return time.ActualTime;\r\n    }\r\n\r\n    if (tok[0].includes(\".\")) {\r\n      const dayHourTok = tok[0].split(\".\");\r\n      const hours = 24 * parseInt(dayHourTok[0]) + parseInt(dayHourTok[1]);\r\n      return `${hours}:${tok[1]}`;\r\n    } else {\r\n      const hours = parseInt(tok[0]);\r\n      return `${hours}:${tok[1]}`;\r\n    }\r\n  } else {\r\n    return formatDecimal(\r\n      time.ActualHours,\r\n      locSettings.TimeFormatDigits,\r\n      locSettings.TimeFormatDecimals\r\n    );\r\n  }\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\n// Note that this gets it from an OrbitalTime type of string from the API.  If passed something\r\n// like \"01:30:00\" then it will return 90 minutes, not 30 minutes.  For something that gets\r\n// 30 minutes from a >> TimeSpan <<, then see getMinutesFromTimeSpan below\r\nfunction getMinutesFromTimeString(\r\n  locSettings: LocationSettings,\r\n  str: string\r\n) {\r\n  if (!str || str.length === 0) {\r\n    return 0;\r\n  }\r\n\r\n  if (locSettings.TimeFormat === TimeFormat.HoursMinutes) {\r\n    const hourMinRegEx = /^\\d*(:\\d{2})?$/;\r\n    if (!hourMinRegEx.test(str)) {\r\n      return 0;\r\n    }\r\n\r\n    if (str[0] === \":\") {\r\n      return parseInt(str.substring(1));\r\n    }\r\n\r\n    const tok = str.split(\":\");\r\n    if (tok.length === 1) {\r\n      return parseInt(str) * 60;\r\n    }\r\n\r\n    return parseInt(tok[0]) * 60 + parseInt(tok[1]);\r\n  } else {\r\n    const decimalRegex = /^\\d+(.\\d*)?$/;\r\n    if (!decimalRegex.test(str)) {\r\n      return 0;\r\n    }\r\n\r\n    return Math.round(parseFloat(str) * 60.0);\r\n  }\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\n// internal function, only used by getMinutesFromTimeSpan and getHoursFromTimeSpan\r\nfunction getPartOfTimeSpan(ts: string, partNum: number): number {\r\n  if (ts.length === 0) {\r\n    return 0;\r\n  }\r\n\r\n  const tok = ts.split(\":\");\r\n  if (tok.length !== 3) {\r\n    return 0;  // don't mess with messy strings that aren't TimeSpan objects from the API\r\n  }\r\n\r\n  return parseInt(tok[partNum]);\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\n// Note that, if given something like \"01:30:00\" this will return 30 minutes, not 90 minutes.\r\nfunction getMinutesFromTimeSpan(ts: string): number {\r\n  return getPartOfTimeSpan(ts, 1);\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\n// Similiar to getMinutesFromTimeSpan, this will return >> 1 << hour form \"01:30:00\" and not\r\n// 1.5.\r\nfunction getHoursFromTimeSpan(ts: string): number {\r\n  return getPartOfTimeSpan(ts, 0);\r\n}\r\n\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nfunction getDurationStringFromTimeSpan(timespan: string) {\r\n  if (!timespan) {\r\n    return \"(0m)\";\r\n  }\r\n  const tok = timespan.split(\":\");\r\n  let hrs: number;\r\n  let min: number;\r\n  if (tok[0].indexOf(\".\") >= 0) {\r\n    const hrTok = tok[0].split(\".\");\r\n    hrs = 24 * parseInt(hrTok[0]) + parseInt(hrTok[1]);\r\n    min = parseInt(tok[1]);\r\n  } else {\r\n    hrs = parseInt(tok[0]);\r\n    min = parseInt(tok[1]);\r\n  }\r\n\r\n  return hrs > 0 ? `(${hrs}h ${min}m)` : `(${min}m)`;\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nfunction getDurationString(minutes: number): string {\r\n  if (minutes < 60) {\r\n    return `(${minutes}m)`;\r\n  }\r\n\r\n  const str = `(${Math.floor(minutes / 60)}h`;\r\n  return minutes % 60 === 0 ? str + \")\" : str + ` ${minutes % 60}m)`;\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nfunction getDuration(ev: EventInformation): number {\r\n  const getDiff = (start: string, end?: string) => {\r\n    const startDate = parseISO(start);\r\n    let endDate = end ? parseISO(end) : new Date();\r\n    if (endDate > noEndTime) {\r\n      endDate = new Date();\r\n    }\r\n    return differenceInMinutes(endDate, startDate);\r\n  };\r\n\r\n  let totalMinutes = getDiff(ev.EventStart, ev.EventEnd);\r\n  if (ev.EventBreaks) {\r\n    ev.EventBreaks.map(\r\n      (b) => (totalMinutes -= getDiff(b.BreakStart, b.BreakEnd))\r\n    );\r\n  }\r\n\r\n  return totalMinutes;\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nfunction getDateString(date: Date): string {\r\n  return format(date, \"EEE MMM d, yyyy\").toUpperCase();\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nfunction getMessageDeliveryTimeString(dateStr: string) {\r\n  return format(parseISO(dateStr), \"M/d EEE h:mmaa\").replace(\"M\", \"\");\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nfunction getBreakStartEnd(brk: EventBreak) {\r\n  const start = format(parseISO(brk.BreakStart), \"h:mmaaa\").replace(\"M\", \"\");\r\n\r\n  if (!brk.BreakEnd || brk.BreakEnd > noEndTime) {\r\n    return start;\r\n  }\r\n\r\n  const end = format(parseISO(brk.BreakEnd), \"h:mmaaa\").replace(\"M\", \"\");\r\n  return `${start} - ${end}`;\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nfunction getEventInformationStartEnd(ev: EventInformation | ScheduleEvent) {\r\n  const start = format(parseISO(ev.EventStart), \"h:mmaaa\").replace(\"M\", \"\");\r\n  let end: string;\r\n\r\n  if (!isScheduleEvent(ev) && ev.IsClockedIn) {\r\n    end = format(new Date(),\"h:mmaaa\").replace(\"M\", \"\");\r\n  } else  if (isScheduleEvent(ev) && scheduleEventHelper.isClockedIn(ev)) {\r\n    end = format(new Date(), \"h:mmaaa\").replace(\"M\", \"\");\r\n  } else {\r\n    end = format(parseISO(ev.EventEnd), \"h:mmaaa\").replace(\"M\", \"\");\r\n  }\r\n\r\n  return `${start} - ${end}`;\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nfunction getEventBreakStartEndString(brk: EventBreak): string {\r\n  const start = format(parseISO(brk.BreakStart), \"h:mmaa\").replace(\"M\", \"\");\r\n  const end = brk.BreakEnd\r\n    ? format(parseISO(brk.BreakEnd), \"h:mmaa\").replace(\"M\", \"\")\r\n    : format(new Date(), \"h:mmaa\").replace(\"M\", \"\");\r\n\r\n  return `${start} - ${end}`;\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nfunction getWeekStart(\r\n  date: Date,\r\n  weekStartsOn: string,\r\n  dayStart: string\r\n): Date {\r\n  const dayStartMinutes =\r\n    !dayStart || dayStart.indexOf(\"T\") < 0\r\n      ? 0\r\n      : getDurationFromTimeSpan(dayStart.split(\"T\")[1]);\r\n\r\n  let newDate = date;\r\n  newDate.setHours(0, dayStartMinutes, 0, 0);\r\n\r\n  let counter = 0;\r\n  while (format(newDate, \"EEEE\") !== weekStartsOn && counter < 20) {\r\n    newDate = addDays(newDate, -1);\r\n    counter++;\r\n  }\r\n\r\n  if (counter > 15) {\r\n    console.error(\r\n      `Could not calculate week start based on date ${date}` +\r\n        `and weekStartsOn \"${weekStartsOn}\"`\r\n    );\r\n  }\r\n\r\n  return newDate;\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nfunction getDayStartMinutes(dayStartLocSetting: string) {\r\n  const tok = dayStartLocSetting.split(\"T\");\r\n  return getDurationFromTimeSpan(tok[1]);\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\n// For the date/time passed in (usually new Date() to get \"now\"), this function returns the\r\n// start of the time as specified by the DayStartTime in location settings.  If, for example,\r\n// it is 2 am on January 5th, and loc settings has DayStartTime set to 4:00am, then\r\n// this function would return January 4th at 4:00am, instead of January 5th.\r\nfunction getTodayStartForLocation(date: Date, locSettings: LocationSettings): Date {\r\n  const tmpDate = new Date(date.valueOf());\r\n  const dayStartMinutes = getDayStartMinutes(locSettings.DayStartTime);\r\n  tmpDate.setMinutes(-1*dayStartMinutes, tmpDate.getSeconds(), tmpDate.getMilliseconds());\r\n  const needPreviousDate = !isSameDay(tmpDate, date);\r\n\r\n  const startDate = new Date(date.valueOf());\r\n  if (needPreviousDate) {\r\n    startDate.setHours(-24, dayStartMinutes, 0, 0);\r\n  } else {\r\n    startDate.setHours(0, dayStartMinutes, 0, 0);\r\n  }\r\n\r\n  return startDate;\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nfunction formatDateTimeAsMvcString(d: Date) {\r\n  return (\r\n    \"\" +\r\n    d.getFullYear() +\r\n    \"-\" +\r\n    padZeroes(d.getMonth() + 1, 2) +\r\n    \"-\" +\r\n    padZeroes(d.getDate(), 2) +\r\n    \"T\" +\r\n    padZeroes(d.getHours(), 2) +\r\n    \":\" +\r\n    padZeroes(d.getMinutes(), 2) +\r\n    \":00\"\r\n  );\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nfunction formatDecimal(num: number, digits: number, decimals: number) {\r\n  let val = Number(num).toFixed(decimals).toString();\r\n\r\n  let negative = \"\";\r\n  if (val.indexOf(\"-\") === 0) {\r\n    val = val.substring(1);\r\n    negative = \"-\";\r\n  }\r\n\r\n  const s = \"0000000000\" + val;\r\n  const decPos = val.indexOf(\".\");\r\n  if (decPos === -1) {\r\n    return negative + s.substr(s.length - Math.max(val.length, digits));\r\n  } else {\r\n    return (\r\n      negative +\r\n      s.substr(s.length - Math.max(val.length, digits + decimals + 1))\r\n    );\r\n  }\r\n}\r\n\r\n// ---------------------------------------------------------------------------------------------\r\nfunction padZeroes(val: any, digitCount: number) {\r\n  const s = \"0000000000\" + val;\r\n  return s.substr(s.length - digitCount);\r\n}\r\n\r\nexport const timeHelper = {\r\n  convertTimeWithoutTimeZoneToLocalTime,\r\n  formatDateTimeAsMvcString,\r\n  getBreakStartEnd,\r\n  getCurrentLocationDateTime,\r\n  getDateString,\r\n  getDuration,\r\n  getDurationFromTimeSpan,\r\n  getDurationString,\r\n  getDurationStringFromTimeSpan,\r\n  getEventBreakStartEndString,\r\n  getEventInformationStartEnd,\r\n  getHoursFromTimeSpan,\r\n  getMessageDeliveryTimeString,\r\n  getMinutesFromTimeSpan,\r\n  getMinutesFromTimeString,\r\n  getTimeStringFromMinutes,\r\n  getTimeStringFromOrbitalTime,\r\n  getTodayStartForLocation,\r\n  getWeekStart,\r\n  messageDateString,\r\n}\r\n","import { ApplicationUser } from \"../context/ApplicationUserContext\";\r\nimport {EmployeeSort} from \"../enums\";\r\nimport { timeHelper as th } from \"../util/timeHelper\";\r\nimport apiHelper from \"./orbitalApiHelper\";\r\nimport { IdName } from \"../orbital-interfaces/IdName\";\r\nimport env from \"./environment\";\r\nimport {ApiErrorResult} from \"../orbital-interfaces/ApiErrorResult\";\r\nimport {EmployeeCommunication} from \"../orbital-interfaces/EmployeeCommunication\";\r\n\r\n// -----------------------------------------------------------------------------\r\nasync function getEmployeesByLocationIdPositionIdAndActiveDateRange(\r\n  user: ApplicationUser,\r\n  locId: number,\r\n  posId: number,\r\n  start: Date,\r\n  end: Date,\r\n  sort: EmployeeSort\r\n) {\r\n  const data = {\r\n    locId,\r\n    posId,\r\n    start: th.formatDateTimeAsMvcString(start),\r\n    end: th.formatDateTimeAsMvcString(end),\r\n    sort,\r\n  };\r\n\r\n  return (await apiHelper.post(\r\n    user,\r\n    \"api/v2/employees/at-position\",\r\n    data\r\n  )) as IdName[];\r\n}\r\n\r\n// -----------------------------------------------------------------------------\r\nasync function getEmployeeListForCommunication(\r\n  user: ApplicationUser,\r\n  locId: number,\r\n  depId: number,\r\n  posId: number,\r\n  channel: number,\r\n  role: string\r\n) {\r\n  return (await apiHelper.post(\r\n    user,\r\n    \"api/v2/employees/get-communication-list\",\r\n    {\r\n      locId,\r\n      depId,\r\n      posId,\r\n      channel,\r\n      role,\r\n    }\r\n  )) as EmployeeCommunication[];\r\n}\r\n\r\n// -----------------------------------------------------------------------------\r\nasync function submitFeedback(user: ApplicationUser, msg: string) {\r\n  const data = {\r\n    version: env.settings.appVersionString,\r\n    buildDate: env.settings.buildDate,\r\n    environment: env.settings.env.item(user.environment).name,\r\n    os: env.settings.platform,\r\n    msg\r\n  }\r\n\r\n  return (await apiHelper.post(\r\n    user,\r\n    \"/api/v2/employees/submit-feedback\",\r\n    data)) as ApiErrorResult;\r\n}\r\n\r\nexport const employeesApi = {\r\n  getEmployeesByLocationIdPositionIdAndActiveDateRange,\r\n  getEmployeeListForCommunication,\r\n  submitFeedback,\r\n};\r\n","import { IonLoading } from \"@ionic/react\";\r\nimport React, { useState } from \"react\";\r\n\r\nexport function useShowLoading(message: string) {\r\n  const [showLoading, setShowLoading] = useState(false);\r\n  const showLoadingJsx = (\r\n    <IonLoading\r\n      isOpen={showLoading}\r\n      onDidDismiss={() => setShowLoading(false)}\r\n      spinner=\"dots\"\r\n      message={message}\r\n      duration={10000}\r\n    />\r\n  );\r\n\r\n  return {\r\n    showLoading,\r\n    setShowLoading,\r\n    showLoadingJsx,\r\n  };\r\n}\r\n","import React, { useContext, useState } from \"react\";\r\nimport {\r\n  IonButton,\r\n  IonButtons,\r\n  IonIcon,\r\n  IonContent,\r\n  IonFooter,\r\n  IonHeader,\r\n  IonTitle,\r\n  IonToolbar, IonList, IonItem, IonTextarea,\r\n} from \"@ionic/react\";\r\nimport \"../global-styles.scss\";\r\nimport { arrowBackOutline } from \"ionicons/icons\";\r\nimport { ApplicationUserContext } from \"../context/ApplicationUserContext\";\r\nimport {employeesApi} from \"../api/employeesApi\";\r\nimport {log} from \"../util/logger\";\r\nimport {useShowLoading} from \"../hooks/useShowLoading\";\r\n\r\ninterface SubmitFeedbackModalProps {\r\n  onDismissModal: (submitted: boolean) => void;\r\n  isOpen: boolean;\r\n}\r\n\r\n// -------------------------------------------------------------------------------------------\r\n//\r\n// -------------------------------------------------------------------------------------------\r\nconst SubmitFeedbackModal: React.FC<SubmitFeedbackModalProps> = ({\r\n  onDismissModal,\r\n}: SubmitFeedbackModalProps) => {\r\n\r\n  const { user } = useContext(ApplicationUserContext);\r\n  const [message, setMessage] = useState(\"\" as string | null | undefined);\r\n  const loading = useShowLoading(\"Submitting your message...\");\r\n\r\n  // -------------------------------------------------------------------------------------------\r\n  function onSubmitClick() {\r\n    if (message !== null && message !== undefined) {\r\n      loading.setShowLoading(true);\r\n      employeesApi.submitFeedback(user, message).then(res => {\r\n        log(\"submit-feedback\", { succeeded: !res.error});\r\n        loading.setShowLoading(false);\r\n        onDismissModal(true);\r\n      });\r\n    }\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <IonHeader className=\"ion-no-border\">\r\n        <IonToolbar>\r\n          <IonButtons slot=\"start\">\r\n            <IonButton onClick={() => {onDismissModal(false)}}>\r\n              <IonIcon icon={arrowBackOutline} slot=\"icon-only\" />\r\n            </IonButton>\r\n          </IonButtons>\r\n          <IonTitle>Ticket Details</IonTitle>\r\n        </IonToolbar>\r\n      </IonHeader>\r\n\r\n      <IonContent class=\"outer-content\">\r\n        <IonList>\r\n          <IonItem lines=\"none\">\r\n            <IonTextarea\r\n              value={message}\r\n              placeholder={\"Enter message\"}\r\n              autoGrow={true}\r\n              spellcheck={true}\r\n              wrap=\"hard\"\r\n              debounce={50}\r\n              onIonChange={(e) => {\r\n                setMessage(e.detail.value);\r\n              }}\r\n\r\n            />\r\n          </IonItem>\r\n\r\n        </IonList>\r\n        {loading.showLoadingJsx}\r\n\r\n      </IonContent>\r\n\r\n      <IonFooter>\r\n        <IonButton\r\n          className=\"apply-button\"\r\n          expand=\"block\"\r\n          onClick={onSubmitClick}\r\n          disabled={\r\n            message === null || message === undefined || message.length === 0\r\n          }\r\n        >\r\n          Submit\r\n        </IonButton>\r\n      </IonFooter>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default SubmitFeedbackModal;\r\n","import {\r\n  IonContent,\r\n  IonHeader,\r\n  IonIcon,\r\n  IonItem,\r\n  IonLabel,\r\n  IonList,\r\n  IonMenu,\r\n  IonModal,\r\n  IonMenuToggle,\r\n  IonTitle,\r\n  IonToolbar,\r\n  IonFooter,\r\n} from \"@ionic/react\";\r\nimport { notifications, mail, logOut } from \"ionicons/icons\";\r\nimport React, { useState } from \"react\";\r\nimport \"../global-styles.scss\";\r\nimport { ApplicationUserContext } from \"../context/ApplicationUserContext\";\r\nimport env from \"../api/environment\";\r\nimport useDialogBox from \"../hooks/useDialogBox\";\r\nimport NotificationSettingsModal from \"./NotificationSettingsModal\";\r\nimport useSimpleToast from \"../hooks/useSimpleToast\";\r\nimport SubmitFeedbackModal from \"./SubmitFeedbackModal\";\r\n\r\nconst Menu: React.FC = () => {\r\n  const [disableMenu] = useState(false);\r\n  const { user } = React.useContext(ApplicationUserContext);\r\n  const environment = env.settings.env.item(user.environment);\r\n  const userName =\r\n    environment.key !== \"prod\" ? user.username!.substr(4) : user.username!;\r\n  const dlg = useDialogBox();\r\n  const [showNotificationsModal, setShowNotificationsModal] = useState(false);\r\n  const [showSubmitFeedbackModal, setShowSubmitFeedbackModal] = useState(false);\r\n  const toast = useSimpleToast();\r\n\r\n  function onCloseSubmitFeedbackModal(submitted: boolean) {\r\n    setShowSubmitFeedbackModal(false);\r\n    if (submitted) {\r\n      toast.showToast(\"Submitted, thank you!\");\r\n    }\r\n  }\r\n\r\n  /* tslint:disable:jsx-no-lambda */\r\n  return (\r\n    <IonMenu type=\"overlay\" disabled={disableMenu} contentId=\"main\">\r\n      <IonHeader className=\"ion-no-border\">\r\n        <IonToolbar>\r\n          <IonTitle>Menu</IonTitle>\r\n        </IonToolbar>\r\n      </IonHeader>\r\n      <IonContent className=\"outer-content\">\r\n        {environment.key !== \"prod\" && (\r\n          <div className=\"username-header\">\r\n            {userName.toUpperCase()} ({environment.name.toUpperCase()})\r\n          </div>\r\n        )}\r\n        {environment.key === \"prod\" && <div className=\"username-header\">User {userName}</div>}\r\n        <IonList>\r\n          {/* <IonMenuToggle auto-hide=\"false\">\r\n            <IonItem button={true} >\r\n              <IonLabel>Settings</IonLabel>\r\n              <IonIcon slot=\"end\" icon={settings} />\r\n            </IonItem>\r\n          </IonMenuToggle> */}\r\n\r\n          <IonMenuToggle auto-hide=\"false\">\r\n            <IonItem\r\n              button={true}\r\n              onClick={() => {\r\n                setShowNotificationsModal(true);\r\n              }}\r\n            >\r\n              <IonLabel>Notifications</IonLabel>\r\n              <IonIcon slot=\"end\" icon={notifications} />\r\n            </IonItem>\r\n          </IonMenuToggle>\r\n          <IonMenuToggle auto-hide=\"false\">\r\n            <IonItem button={true} onClick={() => {setShowSubmitFeedbackModal(true)}}>\r\n              <IonLabel>Submit a Ticket</IonLabel>\r\n              <IonIcon slot=\"end\" icon={mail} />\r\n            </IonItem>\r\n          </IonMenuToggle>\r\n          <IonMenuToggle auto-hide=\"false\">\r\n            <IonItem button={true} routerLink=\"/logout\" routerDirection=\"none\">\r\n              <IonIcon slot=\"end\" icon={logOut} />\r\n              <IonLabel>Logout</IonLabel>\r\n            </IonItem>\r\n          </IonMenuToggle>\r\n        </IonList>\r\n        {dlg.alertBoxJsx}\r\n        {toast.simpleToastJsx}\r\n      </IonContent>\r\n      <IonFooter>\r\n        <div className=\"debug-info\">\r\n          Capacitor: {env.settings.hasCapacitor ? \"Yes\" : \"No\"}\r\n          <br />\r\n          Build Date: {env.settings.buildDate}\r\n          <br />\r\n          Version: {env.settings.appVersionString}\r\n        </div>\r\n      </IonFooter>\r\n\r\n      <IonModal isOpen={showNotificationsModal}>\r\n        <NotificationSettingsModal\r\n          onDismissModal={() => {\r\n            setShowNotificationsModal(false);\r\n          }}\r\n          isOpen={showNotificationsModal}\r\n        />\r\n      </IonModal>\r\n\r\n      <IonModal isOpen={showSubmitFeedbackModal}>\r\n        <SubmitFeedbackModal\r\n          onDismissModal={onCloseSubmitFeedbackModal}\r\n          isOpen={showSubmitFeedbackModal}\r\n        />\r\n      </IonModal>\r\n    </IonMenu>\r\n  );\r\n};\r\n\r\nexport default Menu;\r\n","/* eslint camelcase: 0 */\r\nimport {AuthorizedItems} from \"../orbital-interfaces/AuthorizedItems\";\r\nimport { ApplicationUser } from \"../context/ApplicationUserContext\";\r\nimport env from \"./environment\";\r\nimport apiHelper from \"./orbitalApiHelper\";\r\n\r\ninterface AccessTokenResponse {\r\n  access_token: string;\r\n  token_type: string;\r\n  expires_in: number;\r\n  error?: string;\r\n  error_description?: string;\r\n  [\".issued\"]: string;\r\n  [\".expires\"]: string;\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function authenticateUser(\r\n  username: string,\r\n  password: string,\r\n  environment: string\r\n) {\r\n  console.log(\r\n    `Authenticating against ${env.settings.env.item(environment).name} (${\r\n      env.settings.env.item(environment).url\r\n    })`\r\n  );\r\n  const url = env.settings.env.item(environment).url + \"token\";\r\n  const body = `grant_type=password&username=${username}&password=${password}`;\r\n  try {\r\n    const response = await fetch(url, {\r\n      method: \"POST\",\r\n      body: body,\r\n    });\r\n\r\n    const json = (await response.json()) as AccessTokenResponse;\r\n    if (json.error || json.error_description) {\r\n      return {\r\n        loggedIn: false,\r\n        error: json.error_description,\r\n        access_token: \"\",\r\n      };\r\n    }\r\n\r\n    return { loggedIn: true, access_token: json.access_token };\r\n  } catch (err) {\r\n    console.error(\"Error returned from authentication request: \" + err);\r\n    return {\r\n      loggedIn: false,\r\n      err,\r\n      error: \"Error attempting to log in\",\r\n      access_token: \"\",\r\n    };\r\n  }\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function getAuthorizedItems(user: ApplicationUser) {\r\n  return await apiHelper.get(\r\n    user,\r\n    \"api/v3/home/get-auth\"\r\n  ) as AuthorizedItems;\r\n}\r\n\r\nexport const userApi = {\r\n  authenticateUser,\r\n  getAuthorizedItems,\r\n};\r\n","import {\r\n  AuthorizedDepartment,\r\n  AuthorizedItems,\r\n  AuthorizedLocation,\r\n  AuthorizedPosition,\r\n} from \"../orbital-interfaces/AuthorizedItems\";\r\nimport {AdminAuthorization, Role} from \"../enums\";\r\nimport {EditorValues} from \"../components/EditEvent/EditEventModalState\";\r\n\r\nexport interface PositionEx {\r\n  location: AuthorizedLocation;\r\n  department: AuthorizedDepartment | null;\r\n  position: AuthorizedPosition | null;\r\n}\r\n\r\nexport interface SelectedPosition {\r\n  location: AuthorizedLocation;\r\n  position: AuthorizedPosition;\r\n}\r\n\r\nexport interface SelectedDepartment {\r\n  location: AuthorizedLocation;\r\n  department: AuthorizedDepartment | null;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction getLocSettingsForLocationId(auth: AuthorizedItems, locationId: number) {\r\n  if (!auth || !auth.locations || auth.locations.length === 0) {\r\n    throw new Error(\r\n      \"getLocSettingsForLocationId: called with invalid auth parameter\"\r\n    );\r\n  }\r\n\r\n  if (locationId === 0) {\r\n    return auth.locations[0].settings;\r\n  }\r\n\r\n  return auth.locations.filter((loc) => loc.id === locationId)[0].settings;\r\n}\r\n\r\nconst getLocationIdFromPositionid = (auth: AuthorizedItems, posId: number): number => {\r\n  for (let i = 0; i < auth.locations.length; i++) {\r\n    const curLoc = auth.locations[i];\r\n    for (let j = 0; j < curLoc.departments.length; j++) {\r\n      const pos = curLoc.departments[j].positions.find(p => p.id === posId);\r\n      if (pos !== undefined) {\r\n        return curLoc.id;\r\n      }\r\n    }\r\n  }\r\n\r\n  throw new Error(\"getLocationIdFromPositionId: Could not find a location that had positionid \" + posId);\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction getLocationFromLocationId(auth: AuthorizedItems, locationId: number) {\r\n  if (!auth || !auth.locations || auth.locations.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  if (locationId <= 0) {\r\n    return null;\r\n  }\r\n\r\n  return auth.locations.filter((l) => l.id === locationId)[0];\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\n// Returns true if the user can edit their own events (they have a position within one of\r\n// the admin's editable departments)\r\nfunction canEditNonPositionEvents(auth: AuthorizedItems, departmentId: number): boolean {\r\n  const dept = auth.locations.flatMap((l) =>\r\n    l.departments.filter((d) => d.id === departmentId)\r\n  )[0];\r\n  if (\r\n    (dept.adminAuth & AdminAuthorization.CanEditSchedules) !==\r\n    AdminAuthorization.CanEditSchedules\r\n  ) {\r\n    return false;\r\n  }\r\n\r\n  return dept.positions.filter((p) => p.hasPosition).length > 0;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction getPositionIdsForEmployee(auth: AuthorizedItems): number[] {\r\n  return auth.locations.flatMap((l) =>\r\n    l.departments.flatMap((d) =>\r\n      d.positions.filter((p) => p.hasPosition).map((p) => p.id)\r\n    )\r\n  );\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction getDepartmentFromPositionId(auth: AuthorizedItems, positionId: number)  {\r\n  if (!auth || !auth.locations || auth.locations.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  if (positionId <= 0) {\r\n    return null;\r\n  }\r\n\r\n  let foundDepartment = null as AuthorizedDepartment | null;\r\n  auth.locations.flatMap((l) =>\r\n    l.departments.map((d) => {\r\n      const foundPosition = d.positions.filter((p) => p.id === positionId);\r\n      if (foundPosition.length === 1) {\r\n        foundDepartment = d;\r\n        return d;\r\n      }\r\n\r\n      return null;\r\n    })\r\n  );\r\n\r\n  return foundDepartment;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\n// Returns true if the Admin can edit schedules for the passed-in department\r\nfunction canEditSchedules(auth: AuthorizedItems, locationId: number, departmentId: number) {\r\n  return (\r\n    (auth.locations\r\n      .filter((l) => l.id === locationId)[0]\r\n      .departments.filter((d) => d.id === departmentId)[0].adminAuth &\r\n      AdminAuthorization.CanEditSchedules) ===\r\n    AdminAuthorization.CanEditSchedules\r\n  );\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\n// Returns true if 1) the user is an Admin and 2) they have a position in the passed-in department\r\nfunction adminIsInDepartment(auth: AuthorizedItems, departmentId: number) {\r\n  if (auth.role !== Role.Admin) {\r\n    return false;\r\n  }\r\n\r\n  const dept = auth.locations.flatMap((l) =>\r\n    l.departments.filter((d) => d.id === departmentId)\r\n  )[0];\r\n  return dept.positions.filter((p) => p.hasPosition).length > 0;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction getAdminAuthorizationForDepartment(auth: AuthorizedItems, departmentId: number) {\r\n  return auth.locations.flatMap((l) =>\r\n    l.departments.filter((d) => d.id === departmentId)\r\n  )[0].adminAuth;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction hasPosition(auth: AuthorizedItems, positionId: number) {\r\n  return (\r\n    auth.locations.flatMap((l) =>\r\n      l.departments.flatMap((d) =>\r\n        d.positions.filter((p) => p.hasPosition && p.id === positionId)\r\n      )\r\n    ).length > 0\r\n  );\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction getSelectedDepartment(auth: AuthorizedItems, locId: number, depId: number): SelectedDepartment {\r\n  const location = getLocationFromLocationId(auth, locId);\r\n  if (location === null) {\r\n    throw new Error(\r\n      `getSelectedDepartment: Could not find locationId \"${locId}\"`\r\n    );\r\n  }\r\n\r\n  if (depId === -1) {\r\n    return {\r\n      location,\r\n      department: null,\r\n    } as SelectedDepartment;\r\n  }\r\n\r\n  const department = location.departments.filter((d) => d.id === depId)[0];\r\n  return { location, department } as SelectedDepartment;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction getSelectedPositionWithLocId(loc: AuthorizedLocation[], locId: number, posId: number) {\r\n  const location = loc.filter((l) => l.id === locId)[0];\r\n  const position = location.departments.flatMap((d) =>\r\n    d.positions.filter((p) => p.id === posId)\r\n  )[0];\r\n  return { location, position };\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction getSelectedPosition(loc: AuthorizedLocation[], posId: number) {\r\n  for (let locPosId = 0; locPosId < loc.length; locPosId++) {\r\n    for (\r\n      let depPosId = 0;\r\n      depPosId < loc[locPosId].departments.length;\r\n      depPosId++\r\n    ) {\r\n      for (\r\n        let posPosId = 0;\r\n        posPosId < loc[locPosId].departments[depPosId].positions.length;\r\n        posPosId++\r\n      ) {\r\n        if (\r\n          loc[locPosId].departments[depPosId].positions[posPosId].id === posId\r\n        ) {\r\n          return {\r\n            location: loc[locPosId],\r\n            position: loc[locPosId].departments[depPosId].positions[posPosId],\r\n          };\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  return {\r\n    location: {} as AuthorizedLocation,\r\n    position: {} as AuthorizedPosition,\r\n  };\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction requiresGeolocation(locations: AuthorizedLocation[]): boolean {\r\n  for (let i = 0; i < locations.length; i++) {\r\n    if (locations[i].settings.RequireGeoLocation) {\r\n      return true;\r\n    }\r\n  }\r\n  return false;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction isAdminForAllDepts(auth: AuthorizedItems, locationId: number) {\r\n  if (auth.role === Role.BusinessAdmin || auth.role === Role.LocationAdmin) {\r\n    return true;\r\n  }\r\n\r\n  if (auth.role === Role.Employee) {\r\n    return false;\r\n  }\r\n\r\n  const location = getLocationFromLocationId(auth, locationId);\r\n  return location?.adminAllDepts === true;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction isDeptAdmin(auth: AuthorizedItems, departmentId: number): boolean {\r\n  if (!auth || !auth.locations || auth.locations.length === 0) {\r\n    return false;\r\n  }\r\n\r\n  if (auth.role === Role.Employee) {\r\n    return false;\r\n  }\r\n\r\n  if (auth.role === Role.BusinessAdmin || auth.role === Role.LocationAdmin) {\r\n    return true;\r\n  }\r\n\r\n  const dept = auth.locations.flatMap((l) =>\r\n    l.departments.filter((d) => d.id === departmentId)\r\n  )[0];\r\n\r\n  return dept.isDeptAdmin;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction adminCan(adminAuth: AdminAuthorization, value: AdminAuthorization) {\r\n  return (adminAuth & value) === value;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction isAdminAuthorizedFor(\r\n  auth: AuthorizedItems,\r\n  locationId: number,\r\n  departmentId: number,\r\n  adminAuth: AdminAuthorization\r\n): boolean {\r\n  if (!auth || !auth.locations || auth.locations.length === 0) {\r\n    return false;\r\n  }\r\n\r\n  if (auth.role === Role.Employee) {\r\n    return false;\r\n  }\r\n\r\n  if (auth.role === Role.LocationAdmin || auth.role === Role.BusinessAdmin) {\r\n    return true;\r\n  }\r\n\r\n  if (departmentId === -1) {\r\n    const location = getLocationFromLocationId(auth, locationId);\r\n    return location?.adminAllDepts === true;\r\n  }\r\n\r\n  const dept = auth.locations.flatMap((l) =>\r\n    l.departments.filter((d) => d.id === departmentId)\r\n  )[0];\r\n\r\n  return (dept.adminAuth & adminAuth) === adminAuth;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction getAdminDetpartments(auth: AuthorizedItems): AuthorizedDepartment[] {\r\n  if (!auth || !auth.locations || auth.locations.length > 0) {\r\n    return [];\r\n  }\r\n\r\n  if (auth.role === Role.Employee) {\r\n    return [];\r\n  }\r\n\r\n  if (auth.role === Role.BusinessAdmin || auth.role === Role.LocationAdmin) {\r\n    return auth.locations.flatMap((l) => l.departments);\r\n  }\r\n\r\n  if (auth.role === Role.Admin) {\r\n    return auth.locations\r\n      .flatMap((l) => l.departments)\r\n      .filter((d) => d.isDeptAdmin);\r\n  }\r\n\r\n  return [];\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction isAdminForThisEvent(ev: EditorValues, auth: AuthorizedItems): boolean {\r\n  if (auth.role === Role.Employee) {\r\n    return false;\r\n  }\r\n\r\n  if (auth.role === Role.BusinessAdmin || auth.role === Role.LocationAdmin) {\r\n    return true;\r\n  }\r\n\r\n  if (auth.role === Role.Admin) {\r\n    const dept = getDepartmentFromPositionId(auth, ev.position.position.id);\r\n    if (dept === null) {\r\n      return false;\r\n    }\r\n\r\n    return (isAdminAuthorizedFor(\r\n      auth,\r\n      ev.locationId,\r\n      dept.id,\r\n      AdminAuthorization.CanEditSchedules\r\n    ));\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction isAuthItemsValid(auth: AuthorizedItems | null | undefined): boolean {\r\n  return auth !== null &&\r\n    auth !== undefined &&\r\n    auth!.locations !== undefined &&\r\n    auth!.locations !== null &&\r\n    auth!.locations.length > 0;\r\n}\r\n\r\nexport const authHelper = {\r\n  adminCan,\r\n  getLocSettingsForLocationId,\r\n  getLocationFromLocationId,\r\n  getLocationIdFromPositionid,\r\n  getDepartmentFromPositionId,\r\n  getPositionIdsForEmployee,\r\n  canEditSchedules,\r\n  getAdminAuthorizationForDepartment,\r\n  adminIsInDepartment,\r\n  canEditNonPositionEvents,\r\n  hasPosition,\r\n  isAuthItemsValid,\r\n  isDeptAdmin,\r\n  isAdminForAllDepts,\r\n  isAdminForThisEvent,\r\n  isAdminAuthorizedFor,\r\n  getSelectedDepartment,\r\n  getSelectedPositionWithLocId,\r\n  getSelectedPosition,\r\n  getAdminDetpartments,\r\n  requiresGeolocation,\r\n};\r\n","/* eslint-disable */\r\nimport React, {useState} from \"react\";\r\nimport {AuthorizedItems} from \"../orbital-interfaces/AuthorizedItems\";\r\nimport {SubscriptionType, Role} from \"../enums\";\r\nimport db from \"../data/dbStore\";\r\nimport {userApi} from \"../api/userApi\";\r\nimport {ApplicationUser,} from \"./ApplicationUserContext\";\r\nimport {log, setFirebaseUserProperties} from \"../util/logger\";\r\nimport {differenceInMinutes} from \"date-fns\";\r\nimport {getConstants} from \"../api/environment\";\r\nimport {authHelper} from \"../util/authHelper\";\r\n\r\nexport interface IAuthorizedItemsContext {\r\n  auth: AuthorizedItems;\r\n  refreshAuth: (\r\n    force: boolean,\r\n    newUser: ApplicationUser\r\n  ) => Promise<AuthorizedItems | null>;\r\n  clearAuth: () => Promise<void>;\r\n  authLoading: boolean;\r\n}\r\n\r\nconst INITIAL_AUTHORIZED_ITEMS: AuthorizedItems = {\r\n  subscriptionType: SubscriptionType.None,\r\n  businessId: 0,\r\n  businessName: \"\",\r\n  employeeId: 0,\r\n  firstOrNickName: \"\",\r\n  firstName:  \"\",\r\n  nickName: \"\",\r\n  middleName: \"\",\r\n  lastName: \"\",\r\n  fullName: \"\",\r\n  timeClock: false,\r\n  role: Role.Employee,\r\n  locations: [],\r\n  loading: false,\r\n  payrollEvents: [],\r\n  tags: [],\r\n  lastRefresh: undefined,\r\n};\r\n\r\nconst INITIAL_AUTHITEMS_CONTEXT = {\r\n  auth: INITIAL_AUTHORIZED_ITEMS,\r\n  refreshAuth: (force: boolean, newUser: ApplicationUser) => {\r\n    return new Promise<AuthorizedItems | null>(() => {});\r\n  },\r\n  clearAuth: async () => {},\r\n  authLoading: false,\r\n};\r\n\r\nexport const AuthorizedItemsContext = React.createContext<\r\n  IAuthorizedItemsContext\r\n>(INITIAL_AUTHITEMS_CONTEXT);\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function getAuthItems(user: ApplicationUser, force: boolean): Promise<AuthorizedItems | null> {\r\n  if (!user.isLoggedin) {\r\n    const empty = { ...INITIAL_AUTHORIZED_ITEMS };\r\n    await db.putAuthItems(empty).then(() => {\r\n      log(\"indexdb_authitems_cleared\");\r\n    });\r\n\r\n    return empty;\r\n  }\r\n\r\n  if (!force) {\r\n    const authFromStore = await db.getAuthItems();\r\n\r\n    // if the auth in the IndexDB store had valid locations/data and\r\n    // the data wasn't 'stale' (older than our max number of minutes it can be old),\r\n    // then just return what was in the IndexDB\r\n    if (\r\n      authHelper.isAuthItemsValid(authFromStore) &&\r\n      authFromStore!.lastRefresh !== undefined &&\r\n      differenceInMinutes(new Date(), authFromStore!.lastRefresh) <\r\n        getConstants(user).maxStaleAuthItemsInMinutes\r\n    ) {\r\n      setFirebaseUserProperties(user, authFromStore!);\r\n      return authFromStore!;\r\n    }\r\n  }\r\n\r\n  const authFromApi = await userApi.getAuthorizedItems(user);\r\n  if (\r\n    authFromApi &&\r\n    authFromApi.locations &&\r\n    authFromApi.locations.length > 0\r\n  ) {\r\n    await db.putAuthItems({ ...authFromApi, lastRefresh: new Date() });\r\n    log(\"indexdb_authitems_put\", { employeeId: authFromApi.employeeId });\r\n    setFirebaseUserProperties(user, authFromApi);\r\n    return authFromApi;\r\n  } else {\r\n    return null;\r\n  }\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\n//\r\n// ----------------------------------------------------------------------------------------------\r\nexport const AuthorizedItemsContextProvider = (props: any) => {\r\n  const [auth, internalSetAuth] = useState({ ...INITIAL_AUTHORIZED_ITEMS });\r\n  const [authLoading, setLoading] = useState(false);\r\n\r\n  // ----------------------------------------------------------------------------------------------\r\n  const refreshAuth = async (force: boolean, newUser: ApplicationUser) => {\r\n    setLoading(true);\r\n\r\n    if (!newUser.isLoggedin) {\r\n      const empty = { ...INITIAL_AUTHORIZED_ITEMS };\r\n      internalSetAuth(empty);\r\n      db.putAuthItems(empty).then(() => {\r\n        log(\"indexdb_authitems_cleared\");\r\n      });\r\n\r\n      setLoading(false);\r\n    }\r\n\r\n    // If we're not being asked to force a refresh from the API, and we already have\r\n    // auth data, and the the last refresh was less than the max time we're allowed to\r\n    // have 'stale' auth items, just return what we have\r\n    if (\r\n      !force &&\r\n      auth.employeeId > 0 &&\r\n      auth.lastRefresh !== undefined &&\r\n      differenceInMinutes(new Date(), auth.lastRefresh) <\r\n        getConstants(newUser).maxStaleAuthItemsInMinutes\r\n    ) {\r\n      return auth;\r\n    }\r\n\r\n    const newAuth = await getAuthItems(newUser, force);\r\n    setLoading(false);\r\n    if (newAuth) {\r\n      internalSetAuth(newAuth);\r\n    }\r\n\r\n    return newAuth;\r\n  };\r\n\r\n  // ----------------------------------------------------------------------------------------------\r\n  const clearAuth = async (): Promise<void> => {\r\n    internalSetAuth(INITIAL_AUTHORIZED_ITEMS);\r\n    return await db.putAuthItems(INITIAL_AUTHORIZED_ITEMS);\r\n  };\r\n\r\n  return (\r\n    <AuthorizedItemsContext.Provider\r\n      value={{\r\n        auth,\r\n        refreshAuth,\r\n        clearAuth,\r\n        authLoading,\r\n      }}\r\n    >\r\n      {props.children}\r\n    </AuthorizedItemsContext.Provider>\r\n  );\r\n};\r\n","import React, { useState} from \"react\";\r\nimport {\r\n  IonContent,\r\n  IonPage,\r\n  IonRow,\r\n  IonCol,\r\n  IonButton,\r\n  IonList,\r\n  IonText,\r\n  IonLoading,\r\n  useIonViewWillEnter,\r\n} from \"@ionic/react\";\r\n// import \"./Login.scss\";\r\nimport \"../global-styles.scss\";\r\nimport {userApi} from \"../api/userApi\";\r\nimport { RouteComponentProps } from \"react-router\";\r\nimport useDialogBox from \"../hooks/useDialogBox\";\r\nimport { ApplicationUserContext } from \"../context/ApplicationUserContext\";\r\nimport env from \"../api/environment\";\r\nimport { log } from \"../util/logger\";\r\nimport { AuthorizedItemsContext } from \"../context/AuthorizedItemsContext\";\r\n\r\ninterface LoginProps extends RouteComponentProps {}\r\n\r\nfunction validate(username: string, password: string): boolean {\r\n  return username.length > 0 && password.length > 5;\r\n}\r\n\r\nconst Login: React.FC<LoginProps> = ({ history }: LoginProps) => {\r\n  const { alertBoxJsx, showAlert } = useDialogBox();\r\n  const { user, userLoggedIn, logout } = React.useContext(ApplicationUserContext);\r\n  const { refreshAuth } = React.useContext(AuthorizedItemsContext);\r\n  const [showLoading, setShowLoading] = useState(false);\r\n  const [username, setUsername] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [usernameErrors] = useState(\"\");\r\n  const [passwordErrors] = useState(\"\");\r\n  const [loginEnabled, setLoginEnabled] = useState(false);\r\n\r\n  // ----------------------------------------------------------------------------------------------\r\n  const onUsernameChange = (newUsername: string) => {\r\n    setUsername(newUsername);\r\n    setLoginEnabled(validate(newUsername, password));\r\n  };\r\n\r\n  // ----------------------------------------------------------------------------------------------\r\n  const onPasswordChange = (newPassword: string) => {\r\n    setPassword(newPassword);\r\n    setLoginEnabled(validate(username, newPassword));\r\n  };\r\n\r\n  // ----------------------------------------------------------------------------------------------\r\n  const login = async () => {\r\n    if (!username || !password) {\r\n      return;\r\n    }\r\n\r\n    const envUser = env.getUserAndEnvironmentFromInput(username);\r\n    setShowLoading(true);\r\n    userApi.authenticateUser(\r\n      envUser.username,\r\n      password,\r\n      envUser.env.key\r\n    ).then(response => {\r\n      if (!response.loggedIn) {\r\n        setShowLoading(false);\r\n        log(\"login_failure\", {\r\n          username: envUser.username,\r\n          appVersion: env.settings.appVersionString,\r\n          environment: envUser.env.name,\r\n        });\r\n        const msg = response.error ? response.error : \"Could not log in\";\r\n        showAlert(\"Failed to log in\", msg, () => {\r\n          setPassword(\"\");\r\n          setLoginEnabled(false);\r\n        });\r\n\r\n        return;\r\n      }\r\n\r\n      // user is logged in, get auth-item data;\r\n      userLoggedIn(username, response.access_token, envUser.env.key).then(newUser => {\r\n        refreshAuth(true, newUser).then(() => {\r\n          log(\"login\", {\r\n            username: envUser.username,\r\n            appVersion: env.settings.appVersionString,\r\n            environment: envUser.env.name,\r\n          });\r\n\r\n          console.log(`logged in to ${envUser.env.name}: ${envUser.username}`);\r\n          history.push(\"/tabs/schedule\", { direction: \"none\" });\r\n          history.goForward();\r\n          setShowLoading(false);\r\n        }).catch(() => {\r\n          setShowLoading(false);\r\n          showAlert(\"Failed to log in\", \"Could not retreive user data\", () => {\r\n            logout();\r\n          })\r\n        });\r\n      }).catch(() => {\r\n        setShowLoading(false);\r\n        showAlert(\"Failed to log in\", \"Could not set access token\", () => {\r\n          logout();\r\n        });\r\n      });\r\n    });\r\n  }\r\n\r\n\r\n  // ----------------------------------------------------------------------------------------------\r\n/*\r\n\r\n  const oldlogin = async () => {\r\n    if (username && password) {\r\n      const envUser = env.getUserAndEnvironmentFromInput(username);\r\n      setShowLoading(true);\r\n      const response = await UserAPI.authenticateUser(\r\n        envUser.username,\r\n        password,\r\n        envUser.env.key\r\n      );\r\n      if (response.loggedIn) {\r\n        const newUser = await userLoggedIn(\r\n          username,\r\n          response.access_token,\r\n          envUser.env.key\r\n        );\r\n        await refreshAuth(true, newUser);\r\n        log(\"login\", {\r\n          username: envUser.username,\r\n          appVersion: env.settings.appVersionString,\r\n          environment: envUser.env.name,\r\n        });\r\n        console.log(`logged in to ${envUser.env.name}: ${envUser.username}`);\r\n        history.push(\"/tabs/schedule\", { direction: \"none\" });\r\n        history.goForward();\r\n        setShowLoading(false);\r\n      } else {\r\n        setShowLoading(false);\r\n        log(\"login_failure\", {\r\n          username: envUser.username,\r\n          appVersion: env.settings.appVersionString,\r\n          environment: envUser.env.name,\r\n        });\r\n        const msg = response.error ? response.error : \"Could not log in\";\r\n        showAlert(\"Failed to log in\", msg, () => {\r\n          setPassword(\"\");\r\n          setLoginEnabled(false);\r\n        });\r\n      }\r\n    }\r\n  };\r\n*/\r\n\r\n  // ----------------------------------------------------------------------------------------------\r\n  useIonViewWillEnter(() => {\r\n    if (user.isLoggedin) {\r\n      history.push(\"/tabs/schedule\", { direction: \"forward\" });\r\n      history.goForward();\r\n    }\r\n  });\r\n\r\n  return (\r\n    <IonPage id=\"login-page\">\r\n      <IonContent className=\"login-content\">\r\n        <div className=\"login-logo\">\r\n          <img\r\n            className=\"logo\"\r\n            src=\"assets/img/OS Logo - 4pt Rounded _ 2 Tone Orange.svg\"\r\n            alt=\"Orbital Shift Logo\"\r\n          />\r\n        </div>\r\n\r\n        <IonLoading\r\n          isOpen={showLoading}\r\n          onDidDismiss={() => setShowLoading(false)}\r\n          spinner=\"dots\"\r\n          message={\"Logging in...\"}\r\n          duration={0}\r\n        />\r\n\r\n        {alertBoxJsx}\r\n\r\n        <IonList className=\"form-list\">\r\n          <div className=\"item\">\r\n            <div className=\"label\">User</div>\r\n            <div className=\"field-container\">\r\n              <input\r\n                className=\"input\"\r\n                id=\"username\"\r\n                name=\"username\"\r\n                type=\"text\"\r\n                value={username}\r\n                onChange={(e) => {\r\n                  onUsernameChange(e.target.value);\r\n                }}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          {usernameErrors.length > 0 && (\r\n            <IonText color=\"light\">\r\n              <p className=\"ion-padding-start\">{usernameErrors}</p>\r\n            </IonText>\r\n          )}\r\n\r\n          <div className=\"item\">\r\n            <div className=\"label\">Password</div>\r\n            <div className=\"field-container\">\r\n              <input\r\n                className=\"input\"\r\n                id=\"password\"\r\n                name=\"password\"\r\n                type=\"password\"\r\n                value={password}\r\n                onChange={(e) => {\r\n                  onPasswordChange(e.target.value);\r\n                }}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          {passwordErrors.length > 0 && (\r\n            <IonText color=\"light\">\r\n              <p className=\"ion-padding-start\">{passwordErrors}</p>\r\n            </IonText>\r\n          )}\r\n        </IonList>\r\n\r\n        <IonRow>\r\n          <IonCol>\r\n            <IonButton\r\n              className=\"login-button\"\r\n              type=\"submit\"\r\n              onClick={login}\r\n              expand=\"block\"\r\n              disabled={!loginEnabled}\r\n            >\r\n              LOG IN\r\n            </IonButton>\r\n          </IonCol>\r\n        </IonRow>\r\n      </IonContent>\r\n    </IonPage>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n","/* eslint camelcase: 0 */\r\nimport { ScheduleEvent } from \"../orbital-interfaces/ScheduleEvent\";\r\nimport { EditorValues } from \"../components/EditEvent/EditEventModalState\";\r\nimport { TECGetData } from \"../orbital-interfaces/TEC\";\r\nimport { EventFilter } from \"../orbital-interfaces/EventFilter\";\r\nimport { DailyNotes } from \"../orbital-interfaces/DailyNotes\";\r\nimport { DailyNotesFilter } from \"../orbital-interfaces/DailyNotesFilter\";\r\nimport { timeHelper as th } from \"../util/timeHelper\";\r\nimport { ApplicationUser } from \"../context/ApplicationUserContext\";\r\nimport apiHelper from \"./orbitalApiHelper\";\r\nimport { RecurrenceUpdateType } from \"../enums\";\r\nimport {ApiErrorResult} from \"../orbital-interfaces/ApiErrorResult\";\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function getScheduleEvent(\r\n  user: ApplicationUser,\r\n  scheduleEventId: number\r\n): Promise<ScheduleEvent | null> {\r\n  const result = await apiHelper.get(\r\n    user,\r\n    \"api/v2/employee/schedule-events/get/\" + scheduleEventId\r\n  );\r\n\r\n  if (result.error) {\r\n    return null;\r\n  }\r\n\r\n  return result as ScheduleEvent;\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function getScheduleEventsByFilter(\r\n  user: ApplicationUser,\r\n  filter: EventFilter\r\n) {\r\n  const filterToSend = {\r\n    ...filter,\r\n    start: th.formatDateTimeAsMvcString(filter.start),\r\n    end: th.formatDateTimeAsMvcString(filter.end),\r\n  };\r\n\r\n  return (await apiHelper.post(\r\n    user,\r\n    \"api/v2/employee/schedule-events/filter\",\r\n    filterToSend\r\n  )) as TECGetData;\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function getDailyNotesByFilter(user: ApplicationUser, filter: DailyNotesFilter) {\r\n  const filterToSend = {\r\n    start: th.formatDateTimeAsMvcString(filter.start),\r\n    end: th.formatDateTimeAsMvcString(filter.end),\r\n    ...filter,\r\n  };\r\n\r\n  return (await apiHelper.post(\r\n    user,\r\n    \"api/v2/daily-notes/filter\",\r\n    filterToSend\r\n  )) as DailyNotes[];\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nfunction fixIsoStringForMvc(ds: string): string {\r\n  if (ds.length > 19) {\r\n    return ds.slice(0, 19);\r\n  }\r\n\r\n  return ds;\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function updateScheduleEvent(\r\n  user: ApplicationUser,\r\n  eventValues: EditorValues,\r\n  recurrenceUpdateType: RecurrenceUpdateType | null\r\n) {\r\n  const data = {\r\n    scheduleEventId: eventValues.scheduleEventId,\r\n    eventType: eventValues.eventType,\r\n    eventStatus: eventValues.eventStatus,\r\n    isConfirmed: eventValues.isConfirmed,\r\n    positionId: eventValues.position.position.id,\r\n    employeeId: eventValues.employee.id,\r\n    eventStart: fixIsoStringForMvc(eventValues.eventStart),\r\n    eventEnd: fixIsoStringForMvc(eventValues.eventEnd),\r\n    tagId: eventValues.tag?.id,\r\n    eventBreaks: eventValues.eventBreaks,\r\n    isClockedIn: eventValues.isClockedIn,\r\n    breakStart: null,\r\n    breakDuration: null,\r\n    clockOutValue: eventValues.clockoutValue,\r\n    absentId: eventValues.absentId,\r\n    absentTime: eventValues.absentTimeMinutes,\r\n    notes: eventValues.notes,\r\n    sendMessage: false,\r\n    recurrenceId: eventValues.recurrenceId,\r\n    recurrenceStart: eventValues.recurrenceStart,\r\n    recurrenceEnd: eventValues.recurrenceEnd,\r\n    recurrenceType: eventValues.recurrenceType,\r\n    repeatInterval: eventValues.repeatInterval,\r\n    repeatWeekdays: eventValues.repeatWeekdays,\r\n    recurrenceUpdateType,\r\n  };\r\n\r\n  return (await apiHelper.post(\r\n    user,\r\n    \"api/v2/employee/schedule-events/update\",\r\n    data\r\n  )) as ApiErrorResult;\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function createScheduleEvent(\r\n  user: ApplicationUser,\r\n  eventValues: EditorValues,\r\n  recurrenceUpdateType: RecurrenceUpdateType | null\r\n) {\r\n  const data = {\r\n    sceduleEventId: 0,\r\n    eventType: eventValues.eventType,\r\n    eventStatus: eventValues.eventStatus,\r\n    isConfirmed: eventValues.isConfirmed,\r\n    positionId: eventValues.position.position.id,\r\n    employeeId: eventValues.employee.id,\r\n    eventStart: fixIsoStringForMvc(eventValues.eventStart),\r\n    eventEnd: fixIsoStringForMvc(eventValues.eventEnd),\r\n    tagId: eventValues.tag?.id,\r\n    eventBreaks: eventValues.eventBreaks,\r\n    isClockedIn: eventValues.isClockedIn,\r\n    breakStart: null,\r\n    breakDuration: null,\r\n    clockOutValue: eventValues.clockoutValue,\r\n    absentId: eventValues.absentId,\r\n    absentTime: eventValues.absentTimeMinutes,\r\n    notes: eventValues.notes,\r\n    sendMessage: false,\r\n    recurrenceId: eventValues.recurrenceId,\r\n    recurrenceStart: eventValues.recurrenceStart,\r\n    recurrenceEnd: eventValues.recurrenceEnd,\r\n    recurrenceType: eventValues.recurrenceType,\r\n    repeatInterval: eventValues.repeatInterval,\r\n    repeatWeekdays: eventValues.repeatWeekdays,\r\n    recurrenceUpdateType,\r\n  };\r\n\r\n  return (await apiHelper.post(\r\n    user,\r\n    \"api/v2/employee/schedule-events/create\",\r\n    data\r\n  )) as ApiErrorResult;\r\n};\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function deleteScheduleEvent(\r\n  user: ApplicationUser,\r\n  scheduleEventId: number,\r\n  recurrenceUpdateType: RecurrenceUpdateType | null\r\n) {\r\n  const data = {\r\n    scheduleEventId,\r\n    recurrenceUpdateType,\r\n    sendMessage: false,\r\n  };\r\n\r\n  return (await apiHelper.post(\r\n    user,\r\n    \"api/v2/employee/schedule-events/delete\",\r\n    data\r\n  )) as ApiErrorResult;\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function updateConfirmedScheduleEvent(\r\n  user: ApplicationUser,\r\n  id: number,\r\n  confirm: boolean\r\n) {\r\n  const data = {id, confirm};\r\n  return (await apiHelper.post(\r\n    user,\r\n    \"api/v2/employee/schedule-events/confirm\",\r\n    data)) as ApiErrorResult;\r\n}\r\n\r\nexport const scheduleEventsApi = {\r\n  getScheduleEvent,\r\n  getScheduleEventsByFilter,\r\n  getDailyNotesByFilter,\r\n  updateScheduleEvent,\r\n  createScheduleEvent,\r\n  deleteScheduleEvent,\r\n  updateConfirmedScheduleEvent,\r\n};\r\n","import {EventGroup} from \"../enums\";\r\n\r\nexport enum EventFilterView {\r\n  schedule = 0,\r\n  clock = 1\r\n}\r\n\r\nexport interface EventFilter {\r\n  settingsLocId: number;\r\n  dnLocIds: number[];\r\n  start: Date;\r\n  end: Date;\r\n  filterByEmployee: boolean;\r\n  positionIds: number[];\r\n  eventTypeId: number;\r\n  eventStatusId: number;\r\n  tagId?: number;\r\n  view: EventFilterView;\r\n}\r\n\r\nexport const initialEventFilter: EventFilter = {\r\n  settingsLocId: 0,\r\n  dnLocIds: [],\r\n  start: new Date(),\r\n  end: new Date(),\r\n  filterByEmployee: false,\r\n  positionIds: [],\r\n  eventTypeId: EventGroup.ClockAndSched,\r\n  eventStatusId: EventGroup.ClockAndSched,\r\n  tagId: undefined,\r\n  view: EventFilterView.schedule\r\n};\r\n\r\nexport interface StoredEventFilter {\r\n  settingsLocId: number;\r\n  dnLocIds: number[];\r\n  positionIds: number[];\r\n  tagId?: number;\r\n  eventTypeId: number;\r\n  eventStatusId: number;\r\n}\r\n\r\nexport const initialStoredEventFilter: StoredEventFilter = {\r\n  settingsLocId: 0,\r\n  dnLocIds: [] as number[],\r\n  positionIds: [] as number[],\r\n  tagId: undefined as number | undefined,\r\n  eventTypeId: EventGroup.ClockAndSched,\r\n  eventStatusId: EventGroup.ClockAndSched\r\n};\r\n\r\n","import React, { useRef } from \"react\";\r\nimport \"../../global-styles.scss\";\r\nimport { IonIcon, IonDatetime } from \"@ionic/react\";\r\nimport { arrowBack, arrowForward, caretDown } from \"ionicons/icons\";\r\nimport { addDays, format, isSameDay, isToday, parseISO } from \"date-fns\";\r\n\r\ninterface WeekChooserProps {\r\n  startDate: Date;\r\n  setStartDate: (date: Date) => void;\r\n  onWeekdayClick: (date: Date) => void;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\n//\r\n// --------------------------------------------------------------------------------------\r\nconst WeekChooser: React.FC<WeekChooserProps> = ({\r\n  startDate,\r\n  setStartDate,\r\n  onWeekdayClick,\r\n}: WeekChooserProps) => {\r\n  const dateRef = useRef(startDate);\r\n\r\n  const onDateChanged = (newDate: Date) => {\r\n    if (!isSameDay(newDate, dateRef.current)) {\r\n      dateRef.current = newDate;\r\n      setStartDate(newDate);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"chooser\">\r\n      <div className=\"top\">\r\n        <button\r\n          onClick={() => onDateChanged(addDays(startDate, -7))}\r\n          className=\"arrow\"\r\n          key={-1}\r\n        >\r\n          <IonIcon mode=\"ios\" icon={arrowBack} />\r\n        </button>\r\n\r\n        <div className=\"month-year-container\">\r\n          <div className=\"datetime-picker-container\">\r\n            <IonDatetime\r\n              mode=\"ios\"\r\n              className=\"datetime-picker\"\r\n              displayFormat=\"MMM YYYY\"\r\n              pickerFormat=\"MMM D YYYY\"\r\n              min=\"2005-01-01\"\r\n              max=\"2030-01-01\"\r\n              value={startDate.toISOString()}\r\n              onIonChange={(e) => {\r\n                onDateChanged(parseISO(e.detail.value!));\r\n              }}\r\n            />\r\n            <IonIcon mode=\"md\" icon={caretDown} />\r\n          </div>\r\n        </div>\r\n\r\n        <button\r\n          onClick={() => onDateChanged(addDays(startDate, 7))}\r\n          className=\"arrow\"\r\n          key={7}\r\n        >\r\n          <IonIcon mode=\"ios\" icon={arrowForward} />\r\n        </button>\r\n      </div>\r\n      <div className=\"weekday-list\">\r\n        {[0, 1, 2, 3, 4, 5, 6].map((num: number) => {\r\n          const thisDate = addDays(startDate, num);\r\n          const isTodayClass = isToday(thisDate) ? \"today\" : \"not-today\";\r\n          return (\r\n            <button\r\n              key={num}\r\n              className=\"weekday-button\"\r\n              style={{ outline: \"none\" }}\r\n              onClick={() => {\r\n                onWeekdayClick(thisDate);\r\n              }}\r\n            >\r\n              <div>\r\n                <div className=\"weekday-abbr\">{format(thisDate, \"EEE\")}</div>\r\n                <div className={isTodayClass} />\r\n                <div className=\"weekday-num\">{format(thisDate, \"d\")}</div>\r\n              </div>\r\n            </button>\r\n          );\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default WeekChooser;\r\n","import React, { CSSProperties, useContext } from \"react\";\r\nimport { timeHelper as th} from \"../../util/timeHelper\";\r\nimport \"../../global-styles.scss\";\r\nimport { AuthorizedLocation } from \"../../orbital-interfaces/AuthorizedItems\";\r\nimport { format, parseISO } from \"date-fns\";\r\nimport { EventInformation } from \"../../orbital-interfaces/TEC\";\r\nimport {time, cafe, checkmark, flag} from \"ionicons/icons\";\r\nimport { IonIcon } from \"@ionic/react\";\r\nimport { getEventEditAuthorization } from \"../EditEvent/EditEventAuthorization\";\r\nimport { AuthorizedItemsContext } from \"../../context/AuthorizedItemsContext\";\r\nimport {EventType} from \"../../enums\";\r\nimport {scheduleEventHelper} from \"../../util/scheduleEventHelper\";\r\nimport {authHelper} from \"../../util/authHelper\";\r\n\r\ninterface EventCardProps {\r\n  event: EventInformation;\r\n  location: AuthorizedLocation;\r\n  multiLocation: boolean;\r\n  showEmployeeName: boolean;\r\n  onEdit: (ev: EventInformation) => void;\r\n}\r\n\r\nconst colorMap: any = {\r\n  1: \"#9CBA6A\",\r\n  2: \"#BFBFBF\",\r\n  3: \"#FFAD00\",\r\n  4: \"#C41A26\",\r\n  6: \"#677A46\",\r\n  7: \"#FFAD00\",\r\n};\r\n\r\nconst statusTimeColor: any = {\r\n  1: { color: \"black\" },\r\n  2: { color: \"#C41A26\" },\r\n  4: { color: \"#BCBCBC\" },\r\n};\r\n\r\nconst extendedIconColor = \"orange\";\r\nconst regularIconColor = \"black\";\r\n\r\n// --------------------------------------------------------------------------------------\r\n//\r\n// --------------------------------------------------------------------------------------\r\nconst EventCard: React.FC<EventCardProps> = ({\r\n  location,\r\n  event,\r\n  multiLocation,\r\n  showEmployeeName,\r\n  onEdit,\r\n}: EventCardProps) => {\r\n  const { auth } = useContext(AuthorizedItemsContext);\r\n  const displayNameStyle: CSSProperties = showEmployeeName\r\n    ? { display: \"inline-block\" }\r\n    : { display: \"none\" };\r\n\r\n  const locSettings = authHelper.getLocSettingsForLocationId(auth, event.LocationId);\r\n  const eventStartDate = parseISO(event.EventStart);\r\n  const multiDepartment = multiLocation\r\n    ? true\r\n    : location.departments.filter((d) =>\r\n        d.positions.filter((p) => p.hasPosition)\r\n      ).length > 1;\r\n\r\n  let posDisplay = \"\";\r\n  if (multiLocation && event.AbbreviatedLocationName) {\r\n    posDisplay = event.AbbreviatedLocationName + \"/\";\r\n  }\r\n\r\n  if (multiDepartment && event.AbbreviatedDepartmentName) {\r\n    posDisplay += event.AbbreviatedDepartmentName + \"/\";\r\n  }\r\n\r\n  posDisplay += event.PositionName;\r\n\r\n  const eventTypeBorder = {\r\n    borderLeft: `7px solid ${colorMap[event.EventTypeId]} `,\r\n  };\r\n\r\n  const isOnBreak = event.EventBreaks?.find(b => b.BreakEnd === null) !== undefined;\r\n\r\n  const timeColor: CSSProperties = statusTimeColor[event.EventStatusId];\r\n\r\n  const iconColor = scheduleEventHelper.isExtendedClock(event, locSettings)\r\n    ? extendedIconColor\r\n    : regularIconColor;\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onUserClick = () => {\r\n    if (!getEventEditAuthorization(\r\n      event.EventTypeId,\r\n      event.EventStatusId,\r\n      event.EmployeeId,\r\n      event.EventStart,\r\n      event.EventEnd,\r\n      event.LocationId,\r\n      event.DepartmentId!,\r\n      event.PositionId,\r\n      event.IsConfirmed,\r\n      auth\r\n    )) {\r\n      return;\r\n    }\r\n\r\n    onEdit(event);\r\n  };\r\n\r\n  return (\r\n    <button\r\n      className=\"card\"\r\n      onClick={() => {\r\n        onUserClick();\r\n      }}\r\n    >\r\n      <div className=\"card-first-col\">\r\n        <div className=\"day-name\">{format(eventStartDate, \"EEE\")} </div>\r\n        <div className=\"day-number\">{format(eventStartDate, \"d\")}</div>\r\n      </div>\r\n      <div className=\"card-second-col\" style={eventTypeBorder}>\r\n        <div className=\"time-row\">\r\n          {isOnBreak && <IonIcon icon={cafe} style={{color: iconColor}} />}\r\n          {event.IsClockedIn && !isOnBreak && (\r\n            <IonIcon icon={time} style={{color: iconColor}} />\r\n          )}\r\n          {scheduleEventHelper.showFlagForExtendedClock(event, locSettings) && (\r\n            <IonIcon icon={flag} style={{color: extendedIconColor}} />\r\n          )}\r\n          <span style={timeColor}>\r\n            {th.getEventInformationStartEnd(event)}&nbsp;&nbsp;\r\n          </span>\r\n          {th.getDurationStringFromTimeSpan(\r\n            event.EventTypeId === EventType.Absent\r\n              ? event.Time\r\n              : event.EventDuration\r\n          )}\r\n        </div>\r\n        <div className=\"name-row\" style={displayNameStyle}>\r\n          {event.FirstName} {event.LastName}\r\n        </div>\r\n        <div className=\"dept-position-row\">\r\n          {event.IsConfirmed && <IonIcon icon={checkmark} />}\r\n          {posDisplay}&nbsp;&nbsp;\r\n          {event.Tag && `~${event.Tag}`}\r\n        </div>\r\n      </div>\r\n    </button>\r\n  );\r\n};\r\n\r\nexport default EventCard;\r\n","import {EventType, EventStatus, AdminAuthorization, Role} from \"../../enums\";\r\nimport {AuthorizedItems} from \"../../orbital-interfaces/AuthorizedItems\";\r\nimport {isAfter, parseISO} from \"date-fns\";\r\nimport {authHelper} from \"../../util/authHelper\";\r\nimport {scheduleEventHelper} from \"../../util/scheduleEventHelper\";\r\n\r\n// --------------------------------------------------------------------------------------\r\nexport function getEventEditAuthorization(\r\n  eventType: EventType,\r\n  eventStatus: EventStatus,\r\n  eventEmployeeId: number,\r\n  eventStart: string,\r\n  eventEnd: string,\r\n  eventLocationId: number,\r\n  eventDepartmentId: number,\r\n  eventPositionId: number,\r\n  eventConfirmed: boolean,\r\n  auth: AuthorizedItems\r\n): boolean  {\r\n\r\n\r\n  if (auth.role === Role.BusinessAdmin) {\r\n    return true;\r\n  }\r\n\r\n  if (auth.role === Role.LocationAdmin) {\r\n    if (scheduleEventHelper.isPositionSpecificEvent(eventType)) {\r\n      if (auth.locations.filter((l) => l.id === eventLocationId).length === 0) {\r\n        return false;\r\n      }\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  const endOfEvent = parseISO(eventEnd);\r\n  const now = new Date();\r\n  const afterEnd = isAfter(now, endOfEvent);\r\n  let employeeEvent = false;\r\n  const adminAuth = authHelper.getAdminAuthorizationForDepartment(\r\n    auth,\r\n    eventDepartmentId\r\n  );\r\n\r\n  // If the user is in the Admin role\r\n  if (auth.role === Role.Admin) {\r\n    if (eventEmployeeId === auth.employeeId) {\r\n      if (eventType === EventType.Clock) {\r\n        return (\r\n          (adminAuth & AdminAuthorization.CanEditOwnClockEvents) ===\r\n          AdminAuthorization.CanEditOwnClockEvents\r\n        );\r\n      }\r\n\r\n      if ((adminAuth & AdminAuthorization.CanEditSchedules) ===\r\n        AdminAuthorization.CanEditSchedules) {\r\n        return true;\r\n      }\r\n\r\n      employeeEvent = true;\r\n    } else {\r\n      // Not the user's event, someone else's\r\n\r\n      if (eventType === EventType.Clock) {\r\n        return ((adminAuth & AdminAuthorization.CanEditEmployeeClockEvents) ===\r\n          AdminAuthorization.CanEditEmployeeClockEvents\r\n        );\r\n      }\r\n\r\n      if (authHelper.canEditSchedules(auth, eventLocationId, eventDepartmentId)) {\r\n        return true;\r\n      } else {\r\n        // If the admin has a position in the selected department\r\n        if (authHelper.adminIsInDepartment(auth, eventDepartmentId)) {\r\n          // Treat the admin as an employee for event editing\r\n          employeeEvent = true;\r\n        } else {\r\n          // disable editing\r\n          return false;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  if (auth.role === Role.Employee || employeeEvent) {\r\n    if (eventEmployeeId === auth.employeeId) {\r\n      if (afterEnd) {\r\n        return false;\r\n      }\r\n\r\n      if (eventType === EventType.Clock) {\r\n        return false;\r\n      }\r\n\r\n      if (eventType === EventType.Shift) {\r\n        if (eventStatus === EventStatus.Approved) {\r\n          return true;\r\n        }\r\n\r\n        if (eventStatus === EventStatus.Request) {\r\n          return true;\r\n        }\r\n\r\n        // else Shift Request-Denied\r\n        return false;\r\n      }\r\n\r\n      if (eventType === EventType.Cover) {\r\n        return eventStatus === EventStatus.Request;\r\n      }\r\n\r\n      if (!scheduleEventHelper.isPositionSpecificEvent(eventType) &&\r\n           authHelper.canEditNonPositionEvents(auth, eventDepartmentId)) {\r\n        return true;\r\n      }\r\n\r\n      return eventStatus === EventStatus.Request;\r\n    }\r\n\r\n    // This is someone else's event being viewed by an Employee\r\n    return eventType === EventType.Cover && eventStatus === EventStatus.Request;\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\n","import {\r\n  IonButton,\r\n  IonCol,\r\n  IonContent,\r\n  IonGrid,\r\n  IonHeader,\r\n  IonModal,\r\n  IonRow,\r\n  IonTitle,\r\n  IonToolbar,\r\n} from \"@ionic/react\";\r\nimport React, { useState } from \"react\";\r\n// import \"./useOrbitalDialogBox.scss\";\r\nimport \"../global-styles.scss\";\r\n\r\nexport interface DialogOptions {\r\n  value: number;\r\n  text: string;\r\n  color: string;\r\n}\r\n\r\nfunction useOrbitalDialogBox() {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [dialogData, setDialogData] = useState({\r\n    header: \"\",\r\n    message: \"\",\r\n    options: [] as DialogOptions[],\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    onDismiss: (selection: number | null) => {},\r\n  });\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const showDialog = (\r\n    header: string,\r\n    message: string,\r\n    dialogOptions: DialogOptions[],\r\n    onDismiss: (selection: number | null) => void\r\n  ) => {\r\n    setDialogData({\r\n      header,\r\n      message,\r\n      options: dialogOptions,\r\n      onDismiss,\r\n    });\r\n\r\n    setIsOpen(true);\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onButtonClick = (selection: number | null) => {\r\n    setIsOpen(false);\r\n    dialogData.onDismiss(selection);\r\n  };\r\n\r\n  const dialogBoxJsx = (\r\n    <IonModal\r\n      isOpen={isOpen}\r\n      cssClass=\"mini-modal orbital-dialog-modal\"\r\n      onDidDismiss={() => onButtonClick(null)}\r\n    >\r\n      <IonContent className=\"modal-content\">\r\n        <IonHeader mode=\"ios\">\r\n          <IonToolbar>\r\n            <IonTitle>{dialogData.header}</IonTitle>\r\n          </IonToolbar>\r\n        </IonHeader>\r\n        <IonGrid>\r\n          {dialogData.options.map((opt) => (\r\n            <IonRow key={opt.value}>\r\n              <IonCol size=\"12\">\r\n                <IonButton\r\n                  expand=\"block\"\r\n                  color={opt.color}\r\n                  className=\"apply-button\"\r\n                  onClick={() => onButtonClick(opt.value)}\r\n                >\r\n                  {opt.text}\r\n                </IonButton>\r\n              </IonCol>\r\n            </IonRow>\r\n          ))}\r\n          <IonRow>\r\n            <IonCol size=\"12\">\r\n              <IonButton\r\n                expand=\"block\"\r\n                className=\"cancel-button\"\r\n                onClick={() => onButtonClick(null)}\r\n              >\r\n                Cancel\r\n              </IonButton>\r\n            </IonCol>\r\n          </IonRow>\r\n        </IonGrid>\r\n      </IonContent>\r\n    </IonModal>\r\n  );\r\n\r\n  return {\r\n    showDialog,\r\n    dialogBoxJsx,\r\n  };\r\n}\r\n\r\nexport default useOrbitalDialogBox;\r\n","import React, { useContext, useState } from \"react\";\r\nimport { IonItem, IonLabel, IonSelect, IonSelectOption } from \"@ionic/react\";\r\nimport { AuthorizedItemsContext } from \"../../context/AuthorizedItemsContext\";\r\nimport { authHelper, SelectedDepartment } from \"../../util/authHelper\";\r\nimport {AdminAuthorization} from \"../../enums\";\r\n\r\ninterface DailyNoteDepartmentSelectorProps {\r\n  currentDepartment: SelectedDepartment;\r\n  onDepartmentUpdate: (dep: SelectedDepartment) => void;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\n//\r\n// --------------------------------------------------------------------------------------\r\nconst DailyNoteDepartmentSelector: React.FC<DailyNoteDepartmentSelectorProps> = ({\r\n  currentDepartment,\r\n  onDepartmentUpdate,\r\n}) => {\r\n  const { auth } = useContext(AuthorizedItemsContext);\r\n  const [selectedDepartment, setSelectedDepartment] = useState(\r\n    currentDepartment\r\n  );\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const updateLocation = (locId: number | undefined | null) => {\r\n    if (!locId) {\r\n      return;\r\n    }\r\n\r\n    const newSelection = {\r\n      location: auth.locations.filter((l) => l.id === locId)[0],\r\n      department: null,\r\n    };\r\n\r\n    setSelectedDepartment(newSelection);\r\n    onDepartmentUpdate(newSelection);\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const updateDepartment = (depId: number | undefined | null) => {\r\n    if (depId === undefined) {\r\n      return;\r\n    }\r\n\r\n    const newSelection = {\r\n      location: selectedDepartment.location,\r\n      department:\r\n        depId === null\r\n          ? null\r\n          : selectedDepartment.location.departments.filter(\r\n              (d) => d.id === depId\r\n            )[0],\r\n    };\r\n\r\n    setSelectedDepartment(newSelection);\r\n    onDepartmentUpdate(newSelection);\r\n  };\r\n\r\n  if (!auth || !auth.locations || auth.locations.length === 0) {\r\n    return (\r\n      <>\r\n        <div>Loading</div>\r\n      </>\r\n    );\r\n  } else {\r\n    const selectedDepartmentId =\r\n      selectedDepartment.department !== null\r\n        ? selectedDepartment.department.id\r\n        : null;\r\n\r\n    return (\r\n      <>\r\n        <IonItem>\r\n          <IonLabel>Location</IonLabel>\r\n          <IonSelect\r\n            mode=\"ios\"\r\n            interface=\"action-sheet\"\r\n            value={selectedDepartment.location.id}\r\n            onIonChange={(e) => updateLocation(e.detail.value)}\r\n          >\r\n            {auth.locations.map((loc) => (\r\n              <IonSelectOption key={loc.id} value={loc.id}>\r\n                {loc.name}\r\n              </IonSelectOption>\r\n            ))}\r\n          </IonSelect>\r\n        </IonItem>\r\n        <IonItem>\r\n          <IonLabel>Department</IonLabel>\r\n          <IonSelect\r\n            mode=\"ios\"\r\n            interface=\"action-sheet\"\r\n            value={selectedDepartmentId}\r\n            onIonChange={(e) => updateDepartment(e.detail.value)}\r\n          >\r\n            {authHelper.isAdminForAllDepts(\r\n              auth,\r\n              selectedDepartment.location.id\r\n            ) && (\r\n              <IonSelectOption key={-1} value={null}>\r\n                All Departments\r\n              </IonSelectOption>\r\n            )}\r\n            {selectedDepartment.location.departments\r\n              .filter((dep) =>\r\n                authHelper.isAdminAuthorizedFor(\r\n                  auth,\r\n                  selectedDepartment.location.id,\r\n                  dep.id,\r\n                  AdminAuthorization.CanEditSchedules\r\n                )\r\n              )\r\n              .map((dep) => (\r\n                <IonSelectOption key={dep.id} value={dep.id}>\r\n                  {dep.name}\r\n                </IonSelectOption>\r\n              ))}\r\n          </IonSelect>\r\n        </IonItem>\r\n      </>\r\n    );\r\n  }\r\n};\r\n\r\nexport default DailyNoteDepartmentSelector;\r\n","import { ApplicationUser } from \"../context/ApplicationUserContext\";\r\nimport apiHelper from \"./orbitalApiHelper\";\r\nimport { timeHelper as th } from \"../util/timeHelper\";\r\nimport { DailyNotes } from \"../orbital-interfaces/DailyNotes\";\r\nimport {ApiErrorResult} from \"../orbital-interfaces/ApiErrorResult\";\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function updateDailyNote(\r\n  user: ApplicationUser,\r\n  dailyNoteId: number,\r\n  text: string,\r\n  role: number,\r\n  date: Date\r\n) {\r\n  return (await apiHelper.post(user, \"api/v2/daily-notes/update\", {\r\n    dailyNoteId,\r\n    date: th.formatDateTimeAsMvcString(date),\r\n    text,\r\n    role,\r\n  })) as ApiErrorResult;\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function insertDailyNote(\r\n  user: ApplicationUser,\r\n  locId: number,\r\n  depId: number,\r\n  role: number,\r\n  date: Date,\r\n  text: string\r\n) {\r\n  return (await apiHelper.post(user, \"api/v2/daily-notes/insert\", {\r\n    locId,\r\n    depId,\r\n    role,\r\n    date,\r\n    text,\r\n  })) as ApiErrorResult;\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function deleteDailyNote(user: ApplicationUser, dailyNoteId: number) {\r\n  return (await apiHelper.post(\r\n    user,\r\n    \"api/v2/daily-notes/delete/\" + dailyNoteId\r\n  )) as ApiErrorResult;\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function getDailyNote(\r\n  user: ApplicationUser,\r\n  locId: number,\r\n  depId: number,\r\n  role: number,\r\n  date: Date\r\n): Promise<ApiErrorResult | DailyNotes> {\r\n  return (await apiHelper.post(user, \"api/v2/daily-notes/get\", {\r\n    locId,\r\n    depId,\r\n    role,\r\n    date,\r\n  })) as ApiErrorResult | DailyNotes;\r\n}\r\n\r\nexport const dailyNotesApi = {\r\n  getDailyNote,\r\n  updateDailyNote,\r\n  insertDailyNote,\r\n  deleteDailyNote,\r\n};\r\n","import React, { useContext, useEffect, useRef, useState } from \"react\";\r\nimport {\r\n  IonButton,\r\n  IonButtons,\r\n  IonIcon,\r\n  IonContent,\r\n  IonHeader,\r\n  IonTitle,\r\n  IonToolbar,\r\n  IonList,\r\n  IonItem,\r\n  IonTextarea,\r\n  IonLabel,\r\n  IonSelect,\r\n  IonSelectOption,\r\n  IonDatetime,\r\n} from \"@ionic/react\";\r\nimport { arrowBackOutline } from \"ionicons/icons\";\r\nimport useDialogBox from \"../../hooks/useDialogBox\";\r\nimport useOrbitalDialogBox from \"../../hooks/useOrbitalDialogBox\";\r\nimport { AuthorizedItemsContext } from \"../../context/AuthorizedItemsContext\";\r\nimport { DailyNotes } from \"../../orbital-interfaces/DailyNotes\";\r\nimport { isSameDay, parseISO } from \"date-fns\";\r\nimport { authHelper, SelectedDepartment } from \"../../util/authHelper\";\r\nimport DailyNoteDepartmentSelector from \"./DailyNoteDepartmentSelector\";\r\nimport \"../../global-styles.scss\";\r\nimport { ApplicationUserContext } from \"../../context/ApplicationUserContext\";\r\nimport useSimpleToast from \"../../hooks/useSimpleToast\";\r\nimport {AuthorizedItems} from \"../../orbital-interfaces/AuthorizedItems\";\r\nimport {Role} from \"../../enums\";\r\nimport {ApiErrorResult} from \"../../orbital-interfaces/ApiErrorResult\";\r\nimport {dailyNotesApi} from \"../../api/dailyNotesApi\";\r\n\r\ninterface EditDailyNoteModalProps {\r\n  onCloseModal: (toastMessage: string) => void;\r\n  isOpen: boolean;\r\n  note: DailyNotes | null;\r\n  initialDate: Date;\r\n  newNoteClicked: boolean;\r\n}\r\n\r\nfunction isDifferentNote(left: DailyNotes | null, right: DailyNotes | null) {\r\n  if (left === null && right !== null) {\r\n    return true;\r\n  }\r\n\r\n  if (left !== null && right === null) {\r\n    return true;\r\n  }\r\n\r\n  if (left === null && right === null) {\r\n    return false;\r\n  }\r\n\r\n  if (left?.Role !== right?.Role) {\r\n    return true;\r\n  }\r\n\r\n  if (left?.DailyNoteId !== right?.DailyNoteId) {\r\n    return true;\r\n  }\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction getFirstAvailableDepartment(\r\n  auth: AuthorizedItems\r\n): SelectedDepartment {\r\n  for (let i = 0; i < auth.locations.length; i++) {\r\n    const curLoc = auth.locations[i];\r\n\r\n    if (curLoc.adminAllDepts) {\r\n      return {\r\n        location: curLoc,\r\n        department: null,\r\n      };\r\n    }\r\n\r\n    for (let j = 0; j < curLoc.departments.length; j++) {\r\n      const curDep = curLoc.departments[j];\r\n\r\n      if (\r\n        auth.role === Role.LocationAdmin ||\r\n        auth.role === Role.BusinessAdmin\r\n      ) {\r\n        return {\r\n          location: curLoc,\r\n          department: curDep,\r\n        };\r\n      }\r\n\r\n      if (curDep.isDeptAdmin) {\r\n        return {\r\n          location: curLoc,\r\n          department: curDep,\r\n        };\r\n      }\r\n    }\r\n  }\r\n\r\n  throw new Error(\"Could not find a department for this user to add a note\");\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst EditDailyNoteModal: React.FC<EditDailyNoteModalProps> = ({\r\n  onCloseModal,\r\n  isOpen,\r\n  note,\r\n  initialDate,\r\n}) => {\r\n  const [originalNote, setOriginalNote] = useState(note);\r\n  const toast = useSimpleToast();\r\n  const dlg = useDialogBox();\r\n  const { user } = useContext(ApplicationUserContext);\r\n  const { auth } = useContext(AuthorizedItemsContext);\r\n  const dialog = useOrbitalDialogBox();\r\n  const [selectedRole, setSelectedRole] = useState(\r\n    note !== null ? note.Role : 1\r\n  );\r\n\r\n  const [selectedDepartment, setSelectedDepartment] = useState(\r\n    note !== null\r\n      ? authHelper.getSelectedDepartment(\r\n          auth,\r\n          note.LocationId,\r\n          note.DepartmentId\r\n        )\r\n      : getFirstAvailableDepartment(auth)\r\n  );\r\n\r\n  const [noteText, setNoteText] = useState(note !== null ? note.Notes : \"\");\r\n  const noteCharCountRef = useRef(note !== null ? note.Notes.length : 0);\r\n  const [selectedDate, setSelectedDate] = useState(\r\n    note !== null ? parseISO(note.EventStart) : initialDate\r\n  );\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    let isMounted = true;\r\n    if (isOpen) {\r\n      if (originalNote === null && isMounted) {\r\n        fetchDailyNote(selectedDepartment, selectedRole, selectedDate);\r\n      }\r\n    }\r\n\r\n    return () => {\r\n      isMounted = false;\r\n    };\r\n\r\n    // eslint-disable-next-line\r\n  }, [isOpen, originalNote]);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const fetchDailyNote = (\r\n    dep: SelectedDepartment,\r\n    role: number,\r\n    date: Date\r\n  ) => {\r\n    dailyNotesApi\r\n      .getDailyNote(\r\n        user,\r\n        dep.location.id,\r\n        dep.department === null ? -1 : dep.department.id,\r\n        role,\r\n        date\r\n      )\r\n      .then((res: DailyNotes | ApiErrorResult) => {\r\n        if (\"message\" in res) {\r\n          if (res.error) {\r\n          } else {\r\n            setOriginalNote(null);\r\n          }\r\n        } else {\r\n          if (\r\n            originalNote !== null &&\r\n            originalNote.DailyNoteId === res.DailyNoteId\r\n          ) {\r\n            return;\r\n          }\r\n\r\n          if (isDifferentNote(res, originalNote)) {\r\n            setOriginalNote(res);\r\n          }\r\n\r\n          const newStart = parseISO(res.EventStart);\r\n          if (!isSameDay(newStart, selectedDate)) {\r\n            setSelectedDate(newStart);\r\n          }\r\n\r\n          if (\r\n            res.LocationId !== selectedDepartment.location.id ||\r\n            (res.DepartmentId === -1 &&\r\n              selectedDepartment.department !== null) ||\r\n            (res.DepartmentId !== -1 &&\r\n              selectedDepartment.department === null) ||\r\n            (selectedDepartment.department !== null &&\r\n              res.DepartmentId !== selectedDepartment.department.id)\r\n          ) {\r\n            setSelectedDepartment(\r\n              authHelper.getSelectedDepartment(\r\n                auth,\r\n                res.LocationId,\r\n                res.DepartmentId\r\n              )\r\n            );\r\n          }\r\n\r\n          if (res.Role !== selectedRole) {\r\n            setSelectedRole(res.Role);\r\n          }\r\n\r\n          if (res.Notes !== noteText) {\r\n            setNoteText(res.Notes);\r\n            noteCharCountRef.current = res.Notes.length;\r\n          }\r\n        }\r\n      });\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onCancel = () => {\r\n    if (\r\n      (originalNote === null && noteText != null) ||\r\n      (originalNote !== null && originalNote.Notes !== noteText)\r\n    ) {\r\n      updateBackend(\r\n        selectedDepartment,\r\n        selectedRole,\r\n        selectedDate,\r\n        noteText,\r\n        true\r\n      );\r\n    } else {\r\n      onCloseModal(\"\");\r\n    }\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const updateBackend = (\r\n    dep: SelectedDepartment,\r\n    role: number,\r\n    date: Date,\r\n    text: string,\r\n    isClosing: boolean\r\n  ) => {\r\n    if (\r\n      (originalNote === null && noteText.length === 0) ||\r\n      (originalNote !== null && originalNote.Notes === noteText)\r\n    ) {\r\n      if (isClosing) {\r\n        onCloseModal(\"\");\r\n      }\r\n      return;\r\n    }\r\n\r\n    if (originalNote !== null) {\r\n      if (text.length === 0) {\r\n        dailyNotesApi.deleteDailyNote(user, originalNote.DailyNoteId).then((res) => {\r\n          if (res.error) {\r\n            dlg.showAlert(\"Can't Delete Note\", res.message, () => {});\r\n          } else {\r\n            if (isClosing) {\r\n              onCloseModal(\"Note Deleted\");\r\n            } else {\r\n              toast.showToast(\"Note Deleted\");\r\n            }\r\n          }\r\n        });\r\n      }\r\n\r\n      dailyNotesApi\r\n        .updateDailyNote(user, originalNote.DailyNoteId, text, role, date)\r\n        .then((res) => {\r\n          if (res.error) {\r\n            dlg.showAlert(\"Can't Update Note\", res.message, () => {});\r\n          } else {\r\n            if (isClosing) {\r\n              onCloseModal(\"Note Updated\");\r\n            } else {\r\n              toast.showToast(\"Note Updated\");\r\n            }\r\n          }\r\n        });\r\n    } else {\r\n      dailyNotesApi\r\n        .insertDailyNote(\r\n          user,\r\n          dep.location.id,\r\n          dep.department === null ? -1 : dep.department.id,\r\n          role,\r\n          date,\r\n          text\r\n        )\r\n        .then((res) => {\r\n          if (res.error) {\r\n            dlg.showAlert(\"Can't Add Daily Note\", res.message, () => {});\r\n          } else {\r\n            if (isClosing) {\r\n              onCloseModal(\"Note Added\");\r\n            } else {\r\n              toast.showToast(\"Note Added\");\r\n            }\r\n          }\r\n        });\r\n    }\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onDepartmentUpdate = (dep: SelectedDepartment) => {\r\n    if (\r\n      dep.location.id !== selectedDepartment.location.id ||\r\n      dep.department !== selectedDepartment.department\r\n    ) {\r\n      setSelectedDepartment(dep);\r\n      updateBackend(\r\n        selectedDepartment,\r\n        selectedRole,\r\n        selectedDate,\r\n        noteText,\r\n        false\r\n      );\r\n      fetchDailyNote(dep, selectedRole, selectedDate);\r\n    }\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onRoleUpdate = (newRole: number) => {\r\n    if (newRole !== selectedRole) {\r\n      setSelectedRole(newRole);\r\n      updateBackend(\r\n        selectedDepartment,\r\n        selectedRole,\r\n        selectedDate,\r\n        noteText,\r\n        false\r\n      );\r\n      fetchDailyNote(selectedDepartment, newRole, selectedDate);\r\n    }\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onDateSelected = (dateStr: string | null | undefined) => {\r\n    if (dateStr === null || dateStr === undefined) {\r\n      return;\r\n    }\r\n\r\n    const date = parseISO(dateStr);\r\n    if (date !== selectedDate) {\r\n      setSelectedDate(date);\r\n      updateBackend(\r\n        selectedDepartment,\r\n        selectedRole,\r\n        selectedDate,\r\n        noteText,\r\n        false\r\n      );\r\n      fetchDailyNote(selectedDepartment, selectedRole, date);\r\n    }\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onTextChanged = (newText: string | null | undefined) => {\r\n    if (newText === null || newText === undefined) {\r\n      return;\r\n    }\r\n\r\n    if (newText.length !== noteCharCountRef.current) {\r\n      noteCharCountRef.current = newText.length;\r\n    }\r\n\r\n    if (newText !== noteText) {\r\n      setNoteText(newText);\r\n    }\r\n  };\r\n\r\n  if (!isOpen || !auth || !auth.locations || auth.locations.length === 0) {\r\n    return (\r\n      <>\r\n        <div>Loading</div>\r\n        {dlg.alertBoxJsx}\r\n      </>\r\n    );\r\n  } else {\r\n    return (\r\n      <>\r\n        <IonHeader className=\"ion-no-border\">\r\n          <IonToolbar>\r\n            <IonButtons slot=\"start\">\r\n              <IonButton onClick={onCancel}>\r\n                <IonIcon icon={arrowBackOutline} slot=\"icon-only\" />\r\n              </IonButton>\r\n            </IonButtons>\r\n            <IonTitle>Daily Notes</IonTitle>\r\n          </IonToolbar>\r\n        </IonHeader>\r\n\r\n        <IonContent class=\"edit-daily-modal-content\">\r\n          <IonList>\r\n            <DailyNoteDepartmentSelector\r\n              currentDepartment={selectedDepartment}\r\n              onDepartmentUpdate={onDepartmentUpdate}\r\n            />\r\n\r\n            <IonItem>\r\n              <IonLabel>Viewable By</IonLabel>\r\n              <IonSelect\r\n                mode=\"ios\"\r\n                interface=\"action-sheet\"\r\n                value={selectedRole}\r\n                onIonChange={(e) => {\r\n                  onRoleUpdate(e.detail.value);\r\n                }}\r\n              >\r\n                <IonSelectOption value={1} key={1}>\r\n                  Employees\r\n                </IonSelectOption>\r\n                <IonSelectOption value={2} key={2}>\r\n                  Admins\r\n                </IonSelectOption>\r\n              </IonSelect>\r\n            </IonItem>\r\n            <IonItem>\r\n              <IonLabel>Date</IonLabel>\r\n              <IonDatetime\r\n                mode=\"ios\"\r\n                displayFormat=\"DDD, M/DD/YY\"\r\n                pickerFormat=\"MMM D YYYY\"\r\n                min=\"2005-01-01\"\r\n                max=\"2030-01-01\"\r\n                value={selectedDate.toISOString()}\r\n                onIonChange={(e) => {\r\n                  onDateSelected(e.detail.value);\r\n                }}\r\n              />\r\n            </IonItem>\r\n            <IonItem>\r\n              <IonTextarea\r\n                value={noteText}\r\n                placeholder={\"Enter daily note\"}\r\n                maxlength={180}\r\n                rows={4}\r\n                spellcheck={true}\r\n                wrap=\"hard\"\r\n                debounce={50}\r\n                onIonChange={(e) => {\r\n                  onTextChanged(e.detail.value);\r\n                }}\r\n              />\r\n            </IonItem>\r\n            <div className=\"character-counter\">\r\n              {noteText?.length ?? 0}/180\r\n            </div>\r\n          </IonList>\r\n        </IonContent>\r\n\r\n        {dlg.alertBoxJsx}\r\n        {dialog.dialogBoxJsx}\r\n        {toast.simpleToastJsx}\r\n      </>\r\n    );\r\n  }\r\n};\r\n\r\nexport default EditDailyNoteModal;\r\n","import React, { useContext, useState } from \"react\";\r\nimport \"../../global-styles.scss\";\r\nimport {AuthorizedLocation} from \"../../orbital-interfaces/AuthorizedItems\";\r\nimport {AdminAuthorization, Role} from \"../../enums\";\r\nimport { format, parseISO } from \"date-fns\";\r\nimport { DailyNotes } from \"../../orbital-interfaces/DailyNotes\";\r\nimport { IonModal } from \"@ionic/react\";\r\nimport EditDailyNoteModal from \"./EditDailyNoteModal\";\r\nimport { AuthorizedItemsContext } from \"../../context/AuthorizedItemsContext\";\r\nimport {authHelper} from \"../../util/authHelper\";\r\n\r\ninterface EventCardProps {\r\n  note: DailyNotes;\r\n  location: AuthorizedLocation;\r\n  onForceRefresh: (toastMessage: string) => void;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\n//\r\n// --------------------------------------------------------------------------------------\r\nconst EventCard: React.FC<EventCardProps> = ({\r\n  note,\r\n  onForceRefresh,\r\n}: EventCardProps) => {\r\n  const noteDate = parseISO(note.EventStart);\r\n  const deptName = note.DepartmentId === -1 ? \"All Depts\" : note.DepartmentName;\r\n  const [showEditModal, setShowEditModal] = useState(false);\r\n  const { auth } = useContext(AuthorizedItemsContext);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  function onClose(toastMessage: string) {\r\n    onForceRefresh(toastMessage);\r\n    setShowEditModal(false);\r\n  }\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  function onClick() {\r\n    if (auth.role === Role.Employee) {\r\n      return;\r\n    }\r\n\r\n    if (\r\n      !authHelper.isAdminAuthorizedFor(\r\n        auth,\r\n        note.LocationId,\r\n        note.DepartmentId,\r\n        AdminAuthorization.CanEditSchedules\r\n      )\r\n    ) {\r\n      return false;\r\n    }\r\n\r\n    setShowEditModal(true);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <button className=\"card daily-note\" onClick={onClick}>\r\n        <div className=\"card-first-col\">\r\n          <div className=\"day-name\">{format(noteDate, \"EEE\")} </div>\r\n          <div className=\"day-number\">{format(noteDate, \"d\")}</div>\r\n        </div>\r\n        <div className=\"card-second-col\">\r\n          <div className=\"first-row\">\r\n            {deptName}: {note.Role === 1 ? \"Employees\" : \"Admins\"}\r\n            <br />\r\n            {note.Notes}\r\n          </div>\r\n        </div>\r\n      </button>\r\n\r\n      <IonModal\r\n        isOpen={showEditModal}\r\n        onDidDismiss={() => setShowEditModal(false)}\r\n      >\r\n        <EditDailyNoteModal\r\n          isOpen={showEditModal}\r\n          note={note}\r\n          onCloseModal={(toast) => onClose(toast)}\r\n          initialDate={new Date()}\r\n          newNoteClicked={true}\r\n        />\r\n      </IonModal>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default EventCard;\r\n","import React, { useContext, useState } from \"react\";\r\nimport { IonModal, IonButton } from \"@ionic/react\";\r\nimport EditDailyNoteModal from \"./EditDailyNoteModal\";\r\nimport { AuthorizedItemsContext } from \"../../context/AuthorizedItemsContext\";\r\nimport {AuthorizedItems} from \"../../orbital-interfaces/AuthorizedItems\";\r\nimport {Role} from \"../../enums\";\r\n\r\ninterface AddDailyNoteButtonProps {\r\n  date: Date;\r\n  onForceRefresh: (toastMessage: string) => void;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction canAddNote(auth: AuthorizedItems) {\r\n  if (auth.role === Role.Employee) {\r\n    return false;\r\n  }\r\n\r\n  if (auth.role === Role.BusinessAdmin || auth.role === Role.LocationAdmin) {\r\n    return true;\r\n  }\r\n\r\n  for (let i = 0; i < auth.locations.length; i++) {\r\n    const curLoc = auth.locations[i];\r\n    if (curLoc.adminAllDepts) {\r\n      return true;\r\n    }\r\n\r\n    for (let j = 0; j < curLoc.departments.length; j++) {\r\n      if (curLoc.departments[j].isDeptAdmin) {\r\n        return true;\r\n      }\r\n    }\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\n//\r\n// --------------------------------------------------------------------------------------\r\nconst AddDailyNoteButton: React.FC<AddDailyNoteButtonProps> = ({\r\n  date,\r\n  onForceRefresh,\r\n}) => {\r\n  const [showEditModal, setShowEditModal] = useState(false);\r\n  const { auth } = useContext(AuthorizedItemsContext);\r\n\r\n  if (!canAddNote(auth)) {\r\n    return <span />;\r\n  }\r\n\r\n  const onClose = (toastMessage: string) => {\r\n    setShowEditModal(false);\r\n    onForceRefresh(toastMessage);\r\n  };\r\n\r\n  return (\r\n    <>\r\n        <IonButton\r\n          mode=\"md\"\r\n          className=\"add-dailynote-button\"\r\n          onClick={() => {\r\n            setShowEditModal(true);\r\n          }}\r\n        >\r\n          + Daily Note\r\n        </IonButton>\r\n\r\n      <IonModal\r\n        isOpen={showEditModal}\r\n        onDidDismiss={() => setShowEditModal(false)}\r\n      >\r\n        <EditDailyNoteModal\r\n          isOpen={showEditModal}\r\n          note={null}\r\n          initialDate={date}\r\n          onCloseModal={(toast) => {\r\n            onClose(toast);\r\n          }}\r\n          newNoteClicked={true}\r\n        />\r\n      </IonModal>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default AddDailyNoteButton;\r\n","import React from \"react\";\r\n// import \"./NoEventsToShow.scss\";\r\nimport \"../../global-styles.scss\";\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst NoEventsToShow: React.FC = () => {\r\n  return (\r\n    <div>\r\n      <span className=\"no-messagesOrEvents-text\">No Events</span>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NoEventsToShow;\r\n","import React, {forwardRef, Ref, useImperativeHandle} from \"react\";\r\nimport EventCard from \"./EventCard\";\r\nimport DailyNoteCard from \"./DailyNoteCard\";\r\nimport { AuthorizedLocation } from \"../../orbital-interfaces/AuthorizedItems\";\r\nimport \"../../global-styles.scss\";\r\nimport { EventInformation } from \"../../orbital-interfaces/TEC\";\r\nimport { DailyNotes } from \"../../orbital-interfaces/DailyNotes\";\r\nimport AddDailyNoteButton from \"./AddDailyNoteButton\";\r\nimport NoEventsToShow from \"./NoEventsToShow\";\r\n\r\ninterface EventListSectionProps {\r\n  locations: AuthorizedLocation[];\r\n  events: EventInformation[];\r\n  notes: DailyNotes[];\r\n  header: string;\r\n  showEmployeeNames: boolean;\r\n  showTotalDuration: boolean;\r\n  onEdit: (ev: EventInformation) => void;\r\n  dailyNotesAddButtonDate: Date | null;\r\n  onForceRefresh: (toastMessage: string) => void;\r\n}\r\n\r\nexport interface EventListSectionRef {\r\n  scrollIntoView: () => void;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\n//\r\n// --------------------------------------------------------------------------------------\r\n// eslint-disable-next-line react/display-name\r\nconst EventListSection = forwardRef((props: EventListSectionProps, ref: Ref<EventListSectionRef>) => {\r\n  const {\r\n    locations,\r\n    header,\r\n    events,\r\n    notes,\r\n    showEmployeeNames,\r\n    onEdit,\r\n    dailyNotesAddButtonDate,\r\n    onForceRefresh,\r\n  } = props;\r\n\r\n  const headerRef = React.createRef<HTMLDivElement>();\r\n\r\n  const multiLocation =\r\n    locations.filter((l) =>\r\n      l.departments.filter((d) => d.positions.filter((p) => p.hasPosition))\r\n    ).length > 1;\r\n\r\n  // --------------------------------------------------------------------------\r\n  useImperativeHandle(ref, () => ({\r\n\r\n    scrollIntoView() {\r\n      if (headerRef.current !== null) {\r\n        headerRef.current.scrollIntoView({\r\n          behavior: \"smooth\",\r\n          block: \"start\",\r\n          inline: \"start\"\r\n        });\r\n\r\n        setTimeout(() => {\r\n          if (headerRef.current !== null) {\r\n            headerRef.current!.focus();\r\n          }\r\n        }, 1000);\r\n      }\r\n    }\r\n  }));\r\n\r\n  return (\r\n    <>\r\n      <div tabIndex={0} ref={headerRef}  className=\"event-list-header\">\r\n        {header}\r\n        {dailyNotesAddButtonDate !== null && (\r\n          <AddDailyNoteButton\r\n            onForceRefresh={onForceRefresh}\r\n            date={dailyNotesAddButtonDate!}\r\n          />\r\n        )}\r\n      </div>\r\n      {notes.length === 0 && events.length === 0 && (\r\n        <NoEventsToShow />\r\n      )}\r\n      <div>\r\n        {notes.map((note) => (\r\n          <DailyNoteCard\r\n            onForceRefresh={onForceRefresh}\r\n            key={note.DailyNoteId}\r\n            note={note}\r\n            location={locations.filter((l) => l.id === note.LocationId)[0]}\r\n          />\r\n        ))}\r\n      </div>\r\n      <div>\r\n        {events.map((ev) => (\r\n          <EventCard\r\n            onEdit={onEdit}\r\n            key={ev.ScheduleEventId}\r\n            event={ev}\r\n            location={locations.filter((l) => l.id === ev.LocationId)[0]}\r\n            multiLocation={multiLocation}\r\n            showEmployeeName={showEmployeeNames}\r\n          />\r\n        ))}\r\n      </div>\r\n    </>\r\n  );\r\n});\r\n\r\nexport default EventListSection;\r\n","import React, {forwardRef, MutableRefObject, Ref, useImperativeHandle, useRef} from \"react\";\r\nimport \"../../global-styles.scss\";\r\nimport {AuthorizedItems} from \"../../orbital-interfaces/AuthorizedItems\";\r\nimport {LocationSettings} from \"../../orbital-interfaces/LocationSettings\";\r\nimport {addDays, format, isBefore, parseISO} from \"date-fns\";\r\nimport { KeyedCollection } from \"../../util/KeyedCollection\";\r\nimport EventListSection, {EventListSectionRef} from \"./EventListSection\";\r\nimport { timeHelper as th} from \"../../util/timeHelper\";\r\nimport { EventInformation, HoursList } from \"../../orbital-interfaces/TEC\";\r\nimport { DailyNotes } from \"../../orbital-interfaces/DailyNotes\";\r\n\r\ninterface EventListProps {\r\n  events: EventInformation[];\r\n  notes: DailyNotes[];\r\n  hoursPerDay: HoursList[];\r\n  listType: \"my\" | \"requests\" | \"all\" | \"today\";\r\n  auth: AuthorizedItems;\r\n  onEdit: (ev: EventInformation) => void;\r\n  onForceRefresh: (toastMessage: string) => void;\r\n  weekStart: Date;\r\n}\r\n\r\ninterface SegmentItemList {\r\n  events: EventInformation[];\r\n  notes: DailyNotes[];\r\n  date: Date | null;\r\n  segmentRef?: MutableRefObject<EventListSectionRef | null>;\r\n}\r\n\r\nexport interface EventListRef {\r\n  scrollToDate: (d: Date) => void;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst getSegmentsForToday = (\r\n  events: EventInformation[],\r\n  notes: DailyNotes[],\r\n  locationSettings: LocationSettings,\r\n  hoursPerDay: HoursList[],\r\n) => {\r\n  const todayStart = th.getTodayStartForLocation(new Date(), locationSettings);\r\n\r\n  let totalDuration = 0.0;\r\n  for(let i = 0; i < hoursPerDay.length; i++) {\r\n    totalDuration += th.getDurationFromTimeSpan(hoursPerDay[i].time);\r\n  }\r\n\r\n  const durationString = (totalDuration > 0.0)\r\n    ? th.getDurationString(totalDuration)\r\n    : \"\";\r\n\r\n  const header =\r\n    format(todayStart, \"h:mmaaa\").replace(\"M\", \"\") + \" \" +\r\n    format(todayStart, \"MMM d, yyyy\").toUpperCase() + \" \" +\r\n    durationString;\r\n\r\n  const segmentDate = new Date(todayStart.valueOf());\r\n  segmentDate.setHours(0,0,0,0);\r\n\r\n  const segments = new KeyedCollection<SegmentItemList>();\r\n  segments.add(header, { events, notes, date: segmentDate });\r\n  return segments;\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst getSegmentsForMy = (\r\n  events: EventInformation[],\r\n  notes: DailyNotes[],\r\n  locationSettings: LocationSettings,\r\n  hoursPerDay: HoursList[]\r\n) => {\r\n  const segments = new KeyedCollection<SegmentItemList>();\r\n  if (events.length === 0 && notes.length === 0) {\r\n    return segments;\r\n  }\r\n\r\n  let weekStart = new Date(2199, 1, 1);\r\n  if (events.length > 0) {\r\n    weekStart = th.getWeekStart(\r\n      parseISO(events[0].EventStart),\r\n      locationSettings.DayWeekStartsOn,\r\n      locationSettings.DayStartTime\r\n    );\r\n  }\r\n\r\n  if (notes.length > 0) {\r\n    const notesStart = th.getWeekStart(\r\n      parseISO(notes[0].EventStart),\r\n      locationSettings.DayWeekStartsOn,\r\n      locationSettings.DayStartTime\r\n    );\r\n    if (isBefore(notesStart, weekStart)) {\r\n      weekStart = notesStart;\r\n    }\r\n  }\r\n\r\n  const weekEnd = addDays(weekStart, 7);\r\n  const header =\r\n    `${format(weekStart, \"MMM d\")} - ${format(\r\n      weekEnd,\r\n      \"MMM d\"\r\n    )}`.toUpperCase() +\r\n    \" \" +\r\n    th.getDurationString(\r\n      hoursPerDay\r\n        .map((h) => th.getDurationFromTimeSpan(h.time))\r\n        .reduce((prev, cur) => prev + cur, 0)\r\n    );\r\n\r\n  segments.add(header, { events, notes, date: weekStart });\r\n  return segments;\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst getSegmentsForRequests = (\r\n  events: EventInformation[],\r\n  notes: DailyNotes[],\r\n  employeeId: number\r\n) => {\r\n  const segments = new KeyedCollection<SegmentItemList>();\r\n  segments.add(\"MY REQUESTS\", {\r\n    events: events.filter((ev) => ev.EmployeeId === employeeId),\r\n    notes: [],\r\n    date: null,\r\n  });\r\n  segments.add(\"CO-WORKERS\", {\r\n    events: events.filter((ev) => ev.EmployeeId !== employeeId),\r\n    notes: [],\r\n    date: null,\r\n  });\r\n  return segments;\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst getSegmentsForAll = (events: EventInformation[], notes: DailyNotes[]) => {\r\n  const segments = new KeyedCollection<SegmentItemList>();\r\n  events.map((ev) => {\r\n    const thisDate = format(\r\n      parseISO(ev.EventStart).setHours(0, 0, 0, 0),\r\n      \"MMM d, yyyy\"\r\n    ).toUpperCase();\r\n    if (!segments.containsKey(thisDate)) {\r\n      const thisDatesNotes = notes.filter(\r\n        (n) =>\r\n          format(\r\n            parseISO(n.EventStart).setHours(0, 0, 0, 0),\r\n            \"MMM d, yyyy\"\r\n          ).toUpperCase() === thisDate\r\n      );\r\n      segments.add(thisDate, {\r\n        notes: thisDatesNotes,\r\n        events: [],\r\n        date: parseISO(ev.EventStart),\r\n      });\r\n    }\r\n\r\n    segments.item(thisDate).events.push(ev);\r\n    return thisDate;\r\n  });\r\n\r\n  return segments;\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\n//\r\n// --------------------------------------------------------------------------------------\r\n// eslint-disable-next-line react/display-name\r\nconst EventList = forwardRef((props: EventListProps, ref: Ref<EventListRef>) => {\r\n  const {\r\n    events,\r\n    notes,\r\n    hoursPerDay,\r\n    listType,\r\n    auth,\r\n    onEdit,\r\n    onForceRefresh,\r\n    weekStart\r\n  } = props;\r\n\r\n  let segments: KeyedCollection<SegmentItemList> = new KeyedCollection<\r\n    SegmentItemList\r\n    >();\r\n\r\n  switch (listType) {\r\n    case \"requests\":\r\n      segments = getSegmentsForRequests(events, notes, auth.employeeId);\r\n      break;\r\n    case \"my\":\r\n      segments = getSegmentsForMy(\r\n        events,\r\n        notes,\r\n        auth.locations[0].settings,\r\n        hoursPerDay\r\n      );\r\n      break;\r\n    case \"today\":\r\n      segments = getSegmentsForToday(events, notes, auth.locations[0].settings, hoursPerDay);\r\n      break;\r\n    default:\r\n      segments = getSegmentsForAll(events, notes);\r\n      break;\r\n  }\r\n\r\n  // ----------------------------------------------------------------------------\r\n  useImperativeHandle(ref, () => ({\r\n\r\n    scrollToDate(date: Date) {\r\n      const dateName = format(date, \"MMM d, yyyy\").toUpperCase();\r\n      const segkeys = segments.keys();\r\n      for (let i = 0; i < segkeys.length; i++) {\r\n        if (segkeys[i] === dateName) {\r\n          const curSeg = segments.item(segkeys[i]);\r\n          if (curSeg.segmentRef !== undefined &&\r\n            curSeg.segmentRef.current !== null) {\r\n            curSeg.segmentRef.current.scrollIntoView();\r\n\r\n            break;\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n  }));\r\n\r\n  // We create a bunch of references, more than we need, so that they can\r\n  // be used if need be with the same number of useRef calls... which is\r\n  // a React requirement\r\n  const references = [-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10].map(dayOffset => {\r\n    const segName = format(\r\n      addDays(weekStart, dayOffset).setHours(0, 0, 0, 0),\r\n      \"MMM d, yyyy\"\r\n    ).toUpperCase();\r\n\r\n    const segRef = useRef(null as EventListSectionRef | null);\r\n\r\n    return { segName, segRef};\r\n  });\r\n\r\n\r\n  return (\r\n    <>\r\n      {segments.keys().map((seg) => {\r\n        const refLookup = references.find(r => seg === r.segName)\r\n        const thisRef = refLookup !== undefined\r\n          ? refLookup.segRef\r\n          : references[0].segRef;\r\n        segments.item(seg).segmentRef = thisRef;\r\n        return (\r\n          <EventListSection\r\n            ref={thisRef}\r\n            onEdit={onEdit}\r\n            key={seg}\r\n            header={seg}\r\n            locations={auth.locations}\r\n            events={segments.item(seg).events}\r\n            notes={segments.item(seg).notes}\r\n            showEmployeeNames={listType === \"all\" || seg === \"CO-WORKERS\"}\r\n            showTotalDuration={listType !== \"requests\"}\r\n            dailyNotesAddButtonDate={segments.item(seg).date}\r\n            onForceRefresh={onForceRefresh}\r\n          />\r\n        );\r\n      })}\r\n    </>\r\n  );\r\n\r\n\r\n\r\n});\r\n\r\nexport default EventList;\r\n","import { EventFilter } from \"../orbital-interfaces/EventFilter\";\r\nimport { AuthorizedItems } from \"../orbital-interfaces/AuthorizedItems\";\r\nimport {EventGroup, EventType} from \"../enums\";\r\n\r\nexport interface EventTypeOption {\r\n  value: number;\r\n  text: string;\r\n  color: string;\r\n}\r\n\r\n// ---------------------------------------------------------------------------------\r\nfunction getFilterByEventGroup(f: EventFilter, group: EventGroup): EventFilter {\r\n  return group === EventGroup.Custom\r\n    ? { ...f, eventTypeId: f.eventTypeId, eventStatusId: f.eventStatusId }\r\n    : { ...f, eventTypeId: group, eventStatusId: group };\r\n}\r\n\r\n// ---------------------------------------------------------------------------------\r\nfunction getEventTypeOptions(auth: AuthorizedItems, filter?: EventFilter): EventTypeOption[] {\r\n  if (!auth || !auth.locations || auth.locations.length === 0) {\r\n    return [];\r\n  }\r\n\r\n  const locSettings = auth.locations[0].settings;\r\n\r\n  const eventTypeOptions: EventTypeOption[] = [\r\n    {\r\n      value: EventType.Shift,\r\n      text: \"SHIFT\",\r\n      color: \"green\",\r\n    },\r\n    {\r\n      value: EventType.Cover,\r\n      text: \"COVER\",\r\n      color: \"red\",\r\n    },\r\n  ];\r\n\r\n  if (filter) {\r\n    eventTypeOptions.unshift({ value: -1, text: \"ALL\", color: \"black\" });\r\n  }\r\n\r\n  eventTypeOptions.push({\r\n    value: EventType.Clock,\r\n    text: \"CLOCK\",\r\n    color: \"green\",\r\n  });\r\n\r\n  if (locSettings.ShowUnavailableEventType) {\r\n    eventTypeOptions.push({\r\n      value: EventType.Unavailable,\r\n      text: \"UNAVAILABLE\",\r\n      color: \"yellow\",\r\n    });\r\n  }\r\n\r\n  if (locSettings.ShowVacationEventType) {\r\n    eventTypeOptions.push({\r\n      value: EventType.Vacation,\r\n      text: \"VACATION\",\r\n      color: \"yellow\",\r\n    });\r\n  }\r\n\r\n  if (locSettings.ShowAbsentEventType) {\r\n    const peTypes: EventTypeOption[] = [];\r\n    const p2l: any = {};\r\n    auth.locations.flatMap((l) =>\r\n      l.departments.flatMap((d) => d.positions.map((p) => (p2l[p.id] = l)))\r\n    );\r\n\r\n    auth.payrollEvents.map((pe) => {\r\n      if (!pe.name.startsWith(\"--\")) {\r\n        if (filter) {\r\n          if (\r\n            pe.positionIds.some((id) => filter.positionIds.indexOf(id) >= 0)\r\n          ) {\r\n            peTypes.push({\r\n              value: pe.id,\r\n              text: `${pe.name} (${p2l[pe.positionIds[0]].name})`,\r\n              color: \"yellow\",\r\n            });\r\n          }\r\n        } else {\r\n          peTypes.push({\r\n            value: pe.id,\r\n            text: `${pe.name} (${p2l[pe.positionIds[0]].name})`,\r\n            color: \"yellow\",\r\n          });\r\n        }\r\n\r\n        return pe;\r\n      } else {\r\n        return null;\r\n      }\r\n    });\r\n    peTypes.sort((p1, p2) => {\r\n      return p1.text > p2.text ? 1 : -1;\r\n    });\r\n    return eventTypeOptions.concat(peTypes);\r\n  }\r\n\r\n  return eventTypeOptions;\r\n}\r\n\r\nexport const eventHelper = {\r\n  getFilterByEventGroup,\r\n  getEventTypeOptions\r\n}\r\n","export const arrayHelper = {\r\n  // ------------------------------------------------------------------------------------\r\n  areEqual: <T extends {}>(a1: T[], a2: T[]): boolean => {\r\n    if ((!a1 && a2) || (a1 && !a2)) {\r\n      return false;\r\n    }\r\n\r\n    if (!a1 && !a2) {\r\n      return true;\r\n    }\r\n\r\n    if (a1.length !== a2.length) {\r\n      return false;\r\n    }\r\n\r\n    for (let i = 0; i < a1.length; i++) {\r\n      if (!arrayHelper.contains(a2, a1[i])) {\r\n        return false;\r\n      }\r\n    }\r\n\r\n    return true;\r\n  },\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  contains: <T extends {}>(arr: T[], val: T): boolean => {\r\n    for (let i = 0; i < arr.length; i++) {\r\n      if (arr[i] === val) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  },\r\n\r\n  containsAny: <T extends {}>(arr1: T[], arr2: T[]): boolean => {\r\n    for (let i = 0; i < arr1.length; i++) {\r\n      if (arr2.includes(arr1[i])) {\r\n        return true;\r\n      }\r\n    }\r\n\r\n    return false;\r\n  },\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  unique: <T extends {}>(arr: T[]): T[] => {\r\n    const newArr: T[] = [];\r\n    // eslint-disable-next-line\r\n    arr.map((item) => {\r\n      if (!arrayHelper.contains(newArr, item)) {\r\n        newArr.push(item);\r\n      }\r\n    });\r\n\r\n    return newArr;\r\n  },\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  uniqueObject: <T extends {}>(\r\n    arr: T[],\r\n    filt: (o: T, n: T) => boolean\r\n  ): T[] => {\r\n    const newArr: T[] = [];\r\n    // eslint-disable-next-line\r\n    arr.map((item) => {\r\n      let found = false;\r\n      for (let i = 0; i < newArr.length; i++) {\r\n        if (filt(newArr[i], item)) {\r\n          found = true;\r\n          break;\r\n        }\r\n      }\r\n\r\n      if (!found) {\r\n        newArr.push(item);\r\n      }\r\n    });\r\n\r\n    return newArr;\r\n  },\r\n};\r\n\r\n\r\n","import {\r\n  EventFilter,\r\n  StoredEventFilter,\r\n  initialStoredEventFilter,\r\n  initialEventFilter\r\n} from \"../orbital-interfaces/EventFilter\";\r\nimport {AuthorizedItems} from \"../orbital-interfaces/AuthorizedItems\";\r\nimport {authHelper} from \"../util/authHelper\";\r\nimport {arrayHelper} from \"../util/arrayHelper\";\r\n\r\nconst FILTER_STORAGE_KEY = \"scheduleEventFilter\";\r\n\r\n// ------------------------------------------------------------------------------------\r\nfunction getFilter(auth: AuthorizedItems): StoredEventFilter {\r\n  let filter = {...initialStoredEventFilter};\r\n\r\n  const str = localStorage.getItem(FILTER_STORAGE_KEY);\r\n  if (str !== null) {\r\n    filter = JSON.parse(str) as StoredEventFilter;\r\n  }\r\n\r\n  if (authHelper.isAuthItemsValid(auth)) {\r\n    if (filter.positionIds === undefined || filter.positionIds.length === 0) {\r\n      filter.positionIds = auth.locations.flatMap((l) =>\r\n        l.departments.flatMap((d) =>\r\n          d.positions.map((p) => p.id)));\r\n    }\r\n\r\n    if (filter.dnLocIds === undefined || filter.dnLocIds.length === 0) {\r\n      filter.dnLocIds = auth.locations.map(l => l.id);\r\n    }\r\n\r\n    if (filter.settingsLocId === undefined || filter.settingsLocId === 0) {\r\n      filter.settingsLocId = auth.locations[0].id;\r\n    }\r\n  }\r\n\r\n  return filter;\r\n}\r\n\r\n// ------------------------------------------------------------------------------------\r\nfunction putFilter(filter: EventFilter) {\r\n  const storedFilter: StoredEventFilter= {\r\n    settingsLocId: filter.settingsLocId,\r\n    dnLocIds: filter.dnLocIds,\r\n    positionIds: filter.positionIds,\r\n    tagId: filter.tagId,\r\n    eventStatusId: filter.eventStatusId,\r\n    eventTypeId: filter.eventTypeId\r\n  };\r\n\r\n  localStorage.setItem(FILTER_STORAGE_KEY, JSON.stringify(storedFilter));\r\n}\r\n\r\n// ------------------------------------------------------------------------------------\r\nfunction clear() {\r\n  localStorage.removeItem(FILTER_STORAGE_KEY);\r\n}\r\n\r\n// ------------------------------------------------------------------------------------\r\nfunction getDefaultFilter(auth: AuthorizedItems, filter: EventFilter): EventFilter {\r\n  return {\r\n    ...initialEventFilter,\r\n    start: filter.start,\r\n    end: filter.end,\r\n    tagId: -1,\r\n    positionIds: auth.locations.flatMap((l) =>\r\n      l.departments.flatMap((d) => d.positions.map((p) => p.id))\r\n    ),\r\n    dnLocIds: auth.locations.map((l) => l.id),\r\n    settingsLocId: auth.locations[0].id,\r\n  };\r\n}\r\n\r\n// ------------------------------------------------------------------------------------\r\nfunction tagIsEqual(tagId1: number | undefined, tagId2: number | undefined) {\r\n  return (\r\n    (tagId1 === undefined && tagId2 === -1) ||\r\n    (tagId1 === -1 && tagId2 === undefined) ||\r\n    (tagId1 === tagId2)\r\n  );\r\n}\r\n\r\n// ------------------------------------------------------------------------------------\r\nfunction isFilterApplied(auth: AuthorizedItems, filter: EventFilter): boolean {\r\n  const defaultFilter = getDefaultFilter(auth, filter);\r\n\r\n  const filterApplied = !(\r\n    defaultFilter.eventTypeId === filter.eventTypeId &&\r\n    defaultFilter.eventStatusId === filter.eventStatusId &&\r\n    tagIsEqual(defaultFilter.tagId, filter.tagId) &&\r\n    arrayHelper.areEqual(\r\n      defaultFilter.positionIds,\r\n      filter.positionIds\r\n    )\r\n  );\r\n\r\n  return filterApplied;\r\n}\r\n\r\nexport const filterStore = {\r\n  getFilter,\r\n  putFilter,\r\n  isFilterApplied,\r\n  getDefaultFilter,\r\n  clear,\r\n  tagIsEqual\r\n}\r\n","import React, { useState, useEffect } from \"react\";\r\nimport {\r\n  IonButton,\r\n  IonButtons,\r\n  IonIcon,\r\n  IonContent,\r\n  IonFooter,\r\n  IonHeader,\r\n  IonItem,\r\n  IonLabel,\r\n  IonSelect,\r\n  IonSelectOption,\r\n  IonTitle,\r\n  IonToolbar,\r\n} from \"@ionic/react\";\r\nimport { EventFilter } from \"../../orbital-interfaces/EventFilter\";\r\nimport { arrowBackOutline } from \"ionicons/icons\";\r\nimport \"../../global-styles.scss\";\r\nimport {eventHelper} from \"../../util/eventHelper\";\r\nimport { AuthorizedItems } from \"../../orbital-interfaces/AuthorizedItems\";\r\nimport { filterStore } from \"../../data/filterStore\";\r\nimport {authHelper} from \"../../util/authHelper\";\r\nimport {EventType, EventGroup} from \"../../enums\";\r\n\r\ninterface ScheduleFilterModalProps {\r\n  filter: EventFilter;\r\n  auth: AuthorizedItems;\r\n  onDismissModal: (f: EventFilter, filterApplied: boolean) => void;\r\n  onCancelModal: () => void;\r\n  isOpen: boolean;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction getInitialPositionSelectionsByFilter(\r\n  auth: AuthorizedItems,\r\n  filter: EventFilter\r\n) {\r\n  const locIds = [] as string[];\r\n  const depIds = [] as string[];\r\n  const posIds = [] as string[];\r\n\r\n  if (!authHelper.isAuthItemsValid(auth)) {\r\n    return [[] as string[], [] as string[], [] as string[]];\r\n  }\r\n\r\n  auth.locations.map((l) =>\r\n    l.departments.map((d) =>\r\n      d.positions.map((p) => {\r\n        if (filter.positionIds.includes(p.id)) {\r\n          const newLocId = l.id.toString();\r\n          const newDepId = d.id.toString();\r\n          if (!locIds.includes(newLocId)) {\r\n            locIds.push(newLocId);\r\n          }\r\n\r\n          if (!depIds.includes(newDepId)) {\r\n            depIds.push(newDepId);\r\n          }\r\n\r\n          posIds.push(p.id.toString());\r\n        }\r\n\r\n\r\n        return p.id;\r\n      })\r\n    )\r\n  );\r\n\r\n  return [locIds, depIds, posIds];\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction getInitialEventGroupSelectionByFilter(\r\n  auth: AuthorizedItems,\r\n  filter: EventFilter\r\n): EventType | EventGroup {\r\n  if (filter.eventTypeId === EventGroup.All && filter.eventStatusId === EventGroup.All) {\r\n    return EventGroup.All;\r\n  }\r\n\r\n  if (filter.eventTypeId === EventGroup.ClockAndSched && filter.eventStatusId === EventGroup.ClockAndSched) {\r\n    return EventGroup.ClockAndSched;\r\n  }\r\n\r\n  if (filter.eventTypeId === EventGroup.DontWork && filter.eventStatusId === EventGroup.DontWork) {\r\n    return EventGroup.DontWork;\r\n  }\r\n\r\n  if (filter.eventTypeId === EventGroup.Scheduled && filter.eventStatusId === EventGroup.Scheduled) {\r\n    return EventGroup.Scheduled;\r\n  }\r\n\r\n  return EventGroup.Custom;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\n//\r\n// --------------------------------------------------------------------------------------\r\nconst ScheduleFilterModal: React.FC<ScheduleFilterModalProps> = ({\r\n  auth,\r\n  filter,\r\n  onDismissModal,\r\n  onCancelModal,\r\n  isOpen,\r\n}: ScheduleFilterModalProps) => {\r\n  const [\r\n    initialLocIds,\r\n    initialDepIds,\r\n    initialPosIds,\r\n  ] = getInitialPositionSelectionsByFilter(auth, filter);\r\n  const [eventGroup, setEventGroup] = useState(getInitialEventGroupSelectionByFilter(auth, filter));\r\n  const [myFilter, setMyFilter] = useState(filter);\r\n  const [eventTypeList, setEventTypeList] = useState(eventHelper.getEventTypeOptions(auth, filter));\r\n  const [locationIds, setLocationIds] = useState(initialLocIds);\r\n  const [departmentIds, setDepartmentIds] = useState(initialDepIds);\r\n  const [positionIds, setPositionIds] = useState(initialPosIds);\r\n  const [isDirty, setIsDirty] = useState(false);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    setMyFilter(filter);\r\n  }, [filter]);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      setIsDirty(false);\r\n    }\r\n  }, [isOpen]);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onReset = () => {\r\n    setEventGroup(EventGroup.ClockAndSched);\r\n    setEventTypeList(eventHelper.getEventTypeOptions(auth, filter));\r\n    setLocationIds(auth.locations.map((l) => \"\" + l.id));\r\n    setDepartmentIds(\r\n      auth.locations.flatMap((l) => l.departments).map((d) => \"\" + d.id)\r\n    );\r\n\r\n    setPositionIds(\r\n      auth.locations\r\n        .flatMap((l) => l.departments)\r\n        .flatMap((d) => d.positions)\r\n        .map((p) => \"\" + p.id)\r\n    );\r\n\r\n    setMyFilter(filterStore.getDefaultFilter(auth, filter));\r\n    setIsDirty(false);\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onEventGroupSelect = (val: EventGroup) => {\r\n    setEventGroup(val);\r\n    setIsDirty(true);\r\n    setMyFilter(eventHelper.getFilterByEventGroup(myFilter, val));\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onSetLocations = (locIds: string[]) => {\r\n    setLocationIds(locIds);\r\n    setIsDirty(true);\r\n    setDepartmentIds(\r\n      auth.locations\r\n        .filter((l) => locIds.indexOf(l.id.toString()) >= 0)\r\n        .flatMap((l) => l.departments)\r\n        .map((d) => \"\" + d.id)\r\n    );\r\n    setEventTypeList(eventHelper.getEventTypeOptions(auth, myFilter));\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onSetDepartmentIds = (deptIds: string[]) => {\r\n    setDepartmentIds(deptIds);\r\n    setIsDirty(true);\r\n    setPositionIds(\r\n      auth.locations\r\n        .filter((l) => locationIds.indexOf(l.id.toString()) >= 0)\r\n        .flatMap((l) => l.departments)\r\n        .filter((d) => deptIds.includes(d.id.toString()))\r\n        .flatMap((d) => d.positions)\r\n        .map((p) => \"\" + p.id)\r\n    );\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onSetPositionIds = (posIds: string[]) => {\r\n    setPositionIds(posIds);\r\n    setIsDirty(true);\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onCloseModal = () => {\r\n    const selectedPositionIds = positionIds.map((p) => parseInt(p));\r\n    const returnedFilter = { ...myFilter, positionIds: selectedPositionIds };\r\n    const filterApplied = filterStore.isFilterApplied(auth, returnedFilter);\r\n    onDismissModal(returnedFilter, filterApplied);\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onCancel = () => {\r\n    onCancelModal();\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <IonHeader className=\"ion-no-border\">\r\n        <IonToolbar>\r\n          <IonButtons slot=\"start\">\r\n            <IonButton onClick={onCancel}>\r\n              <IonIcon icon={arrowBackOutline} mode=\"md\" slot=\"icon-only\" />\r\n            </IonButton>\r\n          </IonButtons>\r\n          <IonTitle>Filter</IonTitle>\r\n          <IonButtons slot=\"end\">\r\n            <IonButton onClick={onReset}>RESET</IonButton>\r\n          </IonButtons>\r\n        </IonToolbar>\r\n      </IonHeader>\r\n\r\n      <IonContent class=\"outer-content\">\r\n        <IonItem>\r\n          <IonLabel>Events</IonLabel>\r\n          <IonSelect\r\n            mode=\"ios\"\r\n            interface=\"action-sheet\"\r\n            value={eventGroup}\r\n            onIonChange={(e) => onEventGroupSelect(e.detail.value)}\r\n          >\r\n            <IonSelectOption value={EventGroup.ClockAndSched}>\r\n              Clock + Sched\r\n            </IonSelectOption>\r\n            <IonSelectOption value={EventGroup.Scheduled}>\r\n              Scheduled\r\n            </IonSelectOption>\r\n            <IonSelectOption value={EventGroup.DontWork}>\r\n              Don&apos;t Work\r\n            </IonSelectOption>\r\n            <IonSelectOption value={EventGroup.Custom}>Custom</IonSelectOption>\r\n            <IonSelectOption value={EventGroup.All}>ALL</IonSelectOption>\r\n          </IonSelect>\r\n        </IonItem>\r\n\r\n        {eventGroup === EventGroup.Custom && (\r\n          <IonItem>\r\n            <IonLabel>Type</IonLabel>\r\n            <IonSelect\r\n              mode=\"ios\"\r\n              interface=\"action-sheet\"\r\n              value={myFilter.eventTypeId}\r\n              onIonChange={(e) => {\r\n                setMyFilter({ ...myFilter, eventTypeId: e.detail.value });\r\n                setIsDirty(true);\r\n              }}\r\n            >\r\n              {eventTypeList.map((et) => (\r\n                <IonSelectOption key={et.value} value={et.value}>\r\n                  {et.text}\r\n                </IonSelectOption>\r\n              ))}\r\n            </IonSelect>\r\n          </IonItem>\r\n        )}\r\n\r\n        {eventGroup === EventGroup.Custom && (\r\n          <IonItem>\r\n            <IonLabel>Status</IonLabel>\r\n            <IonSelect\r\n              mode=\"ios\"\r\n              interface=\"action-sheet\"\r\n              value={myFilter.eventStatusId}\r\n              onIonChange={(e) => {\r\n                setMyFilter({...myFilter, eventStatusId: e.detail.value});\r\n                setIsDirty(true);\r\n              }}\r\n            >\r\n              <IonSelectOption value={-1}>ALL</IonSelectOption>\r\n              <IonSelectOption value={1}>Approved</IonSelectOption>\r\n              <IonSelectOption value={2}>Request</IonSelectOption>\r\n              <IonSelectOption value={4}>Request Denied</IonSelectOption>\r\n            </IonSelect>\r\n          </IonItem>\r\n        )}\r\n\r\n        <IonItem>\r\n          <IonLabel>Tags</IonLabel>\r\n          <IonSelect\r\n            mode=\"ios\"\r\n            interface=\"action-sheet\"\r\n            value={myFilter.tagId || -1}\r\n            onIonChange={(e) => {\r\n              setMyFilter({ ...myFilter, tagId: e.detail.value });\r\n              setIsDirty(true);\r\n            }}\r\n          >\r\n            <IonSelectOption key={-1} value={-1}>\r\n              ALL\r\n            </IonSelectOption>\r\n            {auth.tags.map((tag) => (\r\n              <IonSelectOption key={tag.id} value={tag.id}>\r\n                ~{tag.name}\r\n              </IonSelectOption>\r\n            ))}\r\n          </IonSelect>\r\n        </IonItem>\r\n\r\n        {auth.locations.length > 1 && (\r\n          <IonItem>\r\n            <IonLabel>Locations</IonLabel>\r\n            <IonSelect\r\n              mode=\"ios\"\r\n              multiple={true}\r\n              onIonChange={(e) => onSetLocations(e.detail.value)}\r\n              value={locationIds}\r\n            >\r\n              {auth.locations.map((loc) => (\r\n                <IonSelectOption key={loc.id} value={loc.id.toString()}>\r\n                  {loc.name}\r\n                </IonSelectOption>\r\n              ))}\r\n            </IonSelect>\r\n          </IonItem>\r\n        )}\r\n\r\n        {auth.locations.flatMap((l) => l.departments).length > 1 && (\r\n          <IonItem>\r\n            <IonLabel>Departments</IonLabel>\r\n            <IonSelect\r\n              mode=\"ios\"\r\n              multiple={true}\r\n              onIonChange={(e) => onSetDepartmentIds(e.detail.value)}\r\n              value={departmentIds}\r\n            >\r\n              {auth.locations\r\n                .filter((l) => locationIds.indexOf(l.id.toString()) >= 0)\r\n                .map((loc) =>\r\n                  loc.departments.map((dept) => (\r\n                    <IonSelectOption key={dept.id} value={dept.id.toString()}>\r\n                      {loc.abbr}/{dept.name}\r\n                    </IonSelectOption>\r\n                  ))\r\n                )}\r\n            </IonSelect>\r\n          </IonItem>\r\n        )}\r\n\r\n        {auth.locations\r\n          .flatMap((l) => l.departments)\r\n          .flatMap((d) => d.positions).length > 1 && (\r\n          <IonItem>\r\n            <IonLabel>Positions</IonLabel>\r\n            <IonSelect\r\n              mode=\"ios\"\r\n              multiple={true}\r\n              onIonChange={(e) => onSetPositionIds(e.detail.value)}\r\n              value={positionIds}\r\n            >\r\n              {auth.locations\r\n                .filter((l) => locationIds.indexOf(l.id.toString()) >= 0)\r\n                .flatMap((l) => l.departments)\r\n                .filter((d) => departmentIds.indexOf(d.id.toString()) >= 0)\r\n                .map((dept) =>\r\n                  dept.positions.map((pos) => (\r\n                    <IonSelectOption key={pos.id} value={pos.id.toString()}>\r\n                      {pos.name}\r\n                    </IonSelectOption>\r\n                  ))\r\n                )}\r\n            </IonSelect>\r\n          </IonItem>\r\n        )}\r\n      </IonContent>\r\n\r\n      <IonFooter>\r\n        <IonButton\r\n          className=\"apply-button\"\r\n          expand=\"block\"\r\n          onClick={onCloseModal}\r\n          disabled={!isDirty}\r\n        >\r\n          APPLY FILTER\r\n        </IonButton>\r\n      </IonFooter>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ScheduleFilterModal;\r\n","import { IonRefresher, IonRefresherContent } from \"@ionic/react\";\r\nimport React, { useRef } from \"react\";\r\nimport { RefresherEventDetail } from \"@ionic/core\";\r\n\r\nfunction useIonicRefresher(\r\n  doRefresh: (event: CustomEvent<RefresherEventDetail>) => void\r\n) {\r\n  const ionRefresherRef = useRef<HTMLIonRefresherElement>(null);\r\n\r\n  // ----------------------------------------------------------------------------------------------\r\n  const ionicRefresherJsx = (\r\n    <IonRefresher slot=\"fixed\" ref={ionRefresherRef} onIonRefresh={doRefresh}>\r\n      <IonRefresherContent\r\n        pullingIcon=\"arrow-dropdown\"\r\n        pullingText=\"Pull down to refresh\"\r\n        refreshingSpinner=\"dots\"\r\n        refreshingText=\"Refreshing...\"\r\n      />\r\n    </IonRefresher>\r\n  );\r\n\r\n  const retVal = { ionicRefresherJsx };\r\n\r\n  return { ...retVal };\r\n}\r\n\r\nexport default useIonicRefresher;\r\n","import React, {useEffect, useState} from \"react\";\r\nimport {IonCol, IonInput, IonLabel, IonRow, IonSelect, IonSelectOption,} from \"@ionic/react\";\r\nimport \"../../../global-styles.scss\";\r\nimport {AuthorizedItems} from \"../../../orbital-interfaces/AuthorizedItems\";\r\nimport {LocationSettings} from \"../../../orbital-interfaces/LocationSettings\";\r\nimport {\r\n  AdminAuthorization, TimeFormat, Role, EventType, EventStatus,\r\n  getEventStatusIdName, getEventTypeIdName, eventStatusIdList\r\n} from \"../../../enums\";\r\nimport {EditorReducerAction, EditorValues} from \"../EditEventModalState\";\r\nimport {timeHelper as th} from \"../../../util/timeHelper\";\r\nimport {authHelper} from \"../../../util/authHelper\";\r\nimport {IdName} from \"../../../orbital-interfaces/IdName\";\r\n\r\ninterface EventTypeStatusEditorProps {\r\n  auth: AuthorizedItems;\r\n  editorValues: EditorValues;\r\n  update: React.Dispatch<EditorReducerAction>;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction getSelectedEventTypeId(ev: EditorValues) {\r\n  if (ev.eventType !== EventType.Absent) {\r\n    return ev.eventType;\r\n  }\r\n\r\n  return ev.absentId;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction showClockEventType(\r\n  auth: AuthorizedItems,\r\n  ev: EditorValues,\r\n  adminAuth: AdminAuthorization\r\n) {\r\n  if (auth.role === Role.BusinessAdmin || auth.role === Role.LocationAdmin) {\r\n    return true;\r\n  }\r\n\r\n  if (auth.role === Role.Employee) {\r\n    return false;\r\n  }\r\n\r\n  if (ev.employee.id === auth.employeeId) {\r\n    return authHelper.adminCan(\r\n      adminAuth,\r\n      AdminAuthorization.CanEditOwnClockEvents\r\n    );\r\n  }\r\n\r\n  return authHelper.adminCan(\r\n    adminAuth,\r\n    AdminAuthorization.CanEditEmployeeClockEvents\r\n  );\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction getPayrollEventIdNames(auth: AuthorizedItems, posId: number) {\r\n  return auth.payrollEvents\r\n    .filter((pe) => pe.positionIds.includes(posId) && !pe.name.startsWith(\"--\"))\r\n    .map((pe) => {\r\n      return { id: pe.id, name: pe.name };\r\n    })\r\n    .sort((a, b) => (a.name > b.name ? 1 : b.name > a.name ? -1 : 0));\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction getEventTypes(auth: AuthorizedItems, ev: EditorValues): IdName[] {\r\n  if (!authHelper.isAuthItemsValid(auth)) {\r\n    return [] as IdName[];\r\n  }\r\n\r\n  let payrollEvents: IdName[] = [];\r\n  const eventTypes: EventType[] = [];\r\n  const locSettings = ev.position.location.settings;\r\n  const dept = authHelper.getDepartmentFromPositionId(\r\n    auth,\r\n    ev.position.position.id\r\n  );\r\n  if (dept === null) {\r\n    return [] as IdName[];\r\n  }\r\n\r\n  const adminAuth = authHelper.getAdminAuthorizationForDepartment(\r\n    auth,\r\n    dept!.id\r\n  );\r\n\r\n  if (showClockEventType(auth, ev, adminAuth)) {\r\n    eventTypes.push(EventType.Clock);\r\n  }\r\n\r\n  eventTypes.push(EventType.Shift);\r\n\r\n  if (\r\n    auth.role === Role.BusinessAdmin ||\r\n    auth.role === Role.LocationAdmin ||\r\n    (auth.role === Role.Admin &&\r\n      dept !== undefined &&\r\n      authHelper.isAdminAuthorizedFor(\r\n        auth,\r\n        ev.locationId,\r\n        dept.id,\r\n        AdminAuthorization.CanEditSchedules\r\n      ))\r\n  ) {\r\n    eventTypes.push(EventType.Cover);\r\n\r\n    if (locSettings.ShowVacationEventType) {\r\n      eventTypes.push(EventType.Vacation);\r\n    }\r\n\r\n    if (locSettings.ShowUnavailableEventType) {\r\n      eventTypes.push(EventType.Unavailable);\r\n    }\r\n\r\n    if (locSettings.ShowAbsentEventType) {\r\n      payrollEvents = getPayrollEventIdNames(auth, ev.position.position.id);\r\n    }\r\n  } else if (auth.role === Role.Admin && dept !== undefined) {\r\n    if (locSettings.ShowVacationEventType) {\r\n      eventTypes.push(EventType.Vacation);\r\n    }\r\n\r\n    if (locSettings.ShowUnavailableEventType) {\r\n      eventTypes.push(EventType.Unavailable);\r\n    }\r\n\r\n    if (locSettings.ShowAbsentEventType) {\r\n      payrollEvents = getPayrollEventIdNames(auth, ev.position.position.id);\r\n    }\r\n  } else {\r\n    if (ev.scheduleEventId > 0 && ev.eventType === EventType.Cover) {\r\n      return [getEventTypeIdName(ev.eventType)];\r\n    }\r\n\r\n    if (locSettings.ShowVacationEventType) {\r\n      eventTypes.push(EventType.Vacation);\r\n    }\r\n\r\n    if (locSettings.ShowUnavailableEventType) {\r\n      eventTypes.push(EventType.Unavailable);\r\n    }\r\n\r\n    if (locSettings.ShowAbsentEventType) {\r\n      payrollEvents = getPayrollEventIdNames(auth, ev.position.position.id);\r\n    }\r\n  }\r\n\r\n  const idNames = eventTypes.map((et) => {\r\n    return getEventTypeIdName(et);\r\n  }) as IdName[];\r\n  return idNames.concat(payrollEvents);\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction getEventStatuses(auth: AuthorizedItems, ev: EditorValues): IdName[] {\r\n  if (!authHelper.isAuthItemsValid(auth)) {\r\n    return [] as IdName[];\r\n  }\r\n\r\n  if (auth.role === Role.Employee) {\r\n    if (ev.scheduleEventId === 0) {\r\n      return [getEventStatusIdName(EventStatus.Request)];\r\n    } else {\r\n      return [getEventStatusIdName(ev.eventStatus)];\r\n    }\r\n  }\r\n\r\n  if (auth.role === Role.LocationAdmin || auth.role === Role.BusinessAdmin) {\r\n    return eventStatusIdList;\r\n  }\r\n\r\n  const dept = authHelper.getDepartmentFromPositionId(\r\n    auth,\r\n    ev.position.position.id\r\n  );\r\n  if (dept === null) {\r\n    return [] as IdName[];\r\n  }\r\n\r\n  if (\r\n    authHelper.isAdminAuthorizedFor(\r\n      auth,\r\n      ev.locationId,\r\n      dept!.id,\r\n      AdminAuthorization.CanEditSchedules\r\n    )\r\n  ) {\r\n    return eventStatusIdList;\r\n  }\r\n\r\n  if (ev.scheduleEventId === 0) {\r\n    return [getEventStatusIdName(EventStatus.Request)];\r\n  } else {\r\n    return [getEventStatusIdName(ev.eventStatus)];\r\n  }\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\n//\r\n// --------------------------------------------------------------------------------------\r\nconst EventTypeStatusEditor: React.FC<EventTypeStatusEditorProps> = ({\r\n  auth,\r\n  editorValues,\r\n  update,\r\n}: EventTypeStatusEditorProps) => {\r\n  const [absentHoursPlaceholderText, setAbsentHoursPlaceholderText] = useState(\r\n    \"Ex: 00:00\"\r\n  );\r\n  const [locSettings, setLocSettings] = useState(\r\n    null as LocationSettings | null\r\n  );\r\n  const [absentTimeString, setAbsentTimeString] = useState(\r\n    null as string | null\r\n  );\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (editorValues.scheduleEventId === -1) {\r\n      return;\r\n    }\r\n    // If this is an employee and we're creating an event\r\n    if (\r\n      auth.role === Role.Employee &&\r\n      editorValues.scheduleEventId <= 0 &&\r\n      editorValues.eventStatus !== EventStatus.Request\r\n    ) {\r\n      update({\r\n        type: \"TYPESTATUS-UPDATED\",\r\n        eventType: editorValues.eventType,\r\n        eventStatus: EventStatus.Request,\r\n        absentId: editorValues.absentId,\r\n        absentTimeMinutes: editorValues.absentTimeMinutes,\r\n      });\r\n    }\r\n\r\n    // eslint-disable-next-line\r\n  }, [\r\n    auth,\r\n    editorValues.eventType,\r\n    editorValues.eventStatus,\r\n    editorValues.position,\r\n    editorValues.absentId,\r\n    editorValues.scheduleEventId,\r\n  ]);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (editorValues.isFromEventInfo) {\r\n      return; // won't have accurrate data for absents yet\r\n    }\r\n\r\n    const eventTypes = getEventTypes(auth, editorValues);\r\n    if (eventTypes.length === 0) {\r\n      return;\r\n    }\r\n\r\n    const curEventType = eventTypes.find(\r\n      (et) => et.id === getSelectedEventTypeId(editorValues)\r\n    );\r\n    if (curEventType === undefined) {\r\n      update({\r\n        type: \"TYPESTATUS-UPDATED\",\r\n        eventType: eventTypes[0].id > 100 ? EventType.Absent : eventTypes[0].id,\r\n        eventStatus: editorValues.eventStatus,\r\n        absentId: eventTypes[0].id > 100 ? eventTypes[0].id : undefined,\r\n        absentTimeMinutes: editorValues.absentTimeMinutes,\r\n      });\r\n    }\r\n\r\n    // eslint-disable-next-line\r\n  }, [editorValues.employee, editorValues.isFromEventInfo]);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    const eventStatuses = getEventStatuses(auth, editorValues);\r\n    const curEventStatus = eventStatuses.find(\r\n      (es) => es.id === editorValues.eventStatus\r\n    );\r\n    if (curEventStatus === undefined) {\r\n      update({\r\n        type: \"TYPESTATUS-UPDATED\",\r\n        eventType: editorValues.eventType,\r\n        eventStatus: eventStatuses[0].id,\r\n        absentId: editorValues.absentId,\r\n        absentTimeMinutes: editorValues.absentTimeMinutes,\r\n      });\r\n    }\r\n\r\n    // eslint-disable-next-line\r\n  }, [editorValues.position]);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (editorValues.scheduleEventId === -1) {\r\n      return;\r\n    }\r\n\r\n    if (locSettings) {\r\n      setAbsentTimeString(\r\n        editorValues.absentTimeMinutes === null\r\n          ? null\r\n          : th.getTimeStringFromMinutes(\r\n              locSettings,\r\n              editorValues.absentTimeMinutes\r\n            )\r\n      );\r\n    }\r\n  }, [\r\n    locSettings,\r\n    editorValues.absentTimeMinutes,\r\n    editorValues.scheduleEventId,\r\n  ]);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (editorValues.scheduleEventId === -1) {\r\n      return;\r\n    }\r\n\r\n    if (locSettings && editorValues.locationId === locSettings.LocationId) {\r\n      return;\r\n    }\r\n\r\n    if (!auth || !auth.locations || auth.locations.length === 0) {\r\n      return;\r\n    }\r\n\r\n    const newLocSettings = authHelper.getLocSettingsForLocationId(\r\n      auth,\r\n      editorValues.locationId\r\n    );\r\n    setLocSettings(newLocSettings);\r\n    setAbsentHoursPlaceholderText(\r\n      newLocSettings.TimeFormat === TimeFormat.HoursMinutes\r\n        ? \"Ex: 00:00\"\r\n        : \"Ex: 0.0\"\r\n    );\r\n    // eslint-disable-next-line\r\n  }, [editorValues.locationId, editorValues.scheduleEventId]);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onEventTypeChange = (newEventType: EventType) => {\r\n    if (newEventType === editorValues.eventType) {\r\n      return;\r\n    }\r\n\r\n    const newAbsentMinutes =\r\n      newEventType !== EventType.Absent && newEventType < 100\r\n        ? null\r\n        : editorValues.absentTimeMinutes;\r\n\r\n    update({\r\n      type: \"TYPESTATUS-UPDATED\",\r\n      eventType: newEventType >= 100 ? EventType.Absent : newEventType,\r\n      eventStatus: editorValues.eventStatus,\r\n      absentId: newEventType >= 100 ? newEventType : undefined,\r\n      absentTimeMinutes: newAbsentMinutes,\r\n    });\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onEventStatusChange = (newEventStatus: EventStatus) => {\r\n    if (newEventStatus === editorValues.eventStatus) {\r\n      return;\r\n    }\r\n\r\n    update({\r\n      type: \"TYPESTATUS-UPDATED\",\r\n      eventType: editorValues.eventType,\r\n      eventStatus: newEventStatus,\r\n      absentId: editorValues.absentId,\r\n      absentTimeMinutes: editorValues.absentTimeMinutes,\r\n    });\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onAbsentTimeChange = (input?: string | null) => {\r\n    if (input === undefined) {\r\n      input = null;\r\n    }\r\n\r\n    if (input == null) {\r\n      update({\r\n        type: \"TYPESTATUS-UPDATED\",\r\n        eventType: editorValues.eventType,\r\n        eventStatus: editorValues.eventStatus,\r\n        absentId: editorValues.absentId,\r\n        absentTimeMinutes: null,\r\n      });\r\n\r\n      return;\r\n    }\r\n\r\n    const min = th.getMinutesFromTimeString(locSettings!, input!);\r\n    if (min === editorValues.absentTimeMinutes) {\r\n      return;\r\n    }\r\n\r\n    update({\r\n      type: \"TYPESTATUS-UPDATED\",\r\n      eventType: editorValues.eventType,\r\n      eventStatus: editorValues.eventStatus,\r\n      absentId: editorValues.absentId,\r\n      absentTimeMinutes: min,\r\n    });\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <IonRow>\r\n        <IonCol size=\"3\">\r\n          <IonLabel className=\"label\">Type</IonLabel>\r\n        </IonCol>\r\n        <IonCol size=\"9\">\r\n          <IonSelect\r\n            mode=\"ios\"\r\n            className=\"select\"\r\n            interface=\"action-sheet\"\r\n            disabled={editorValues.isReadonly ||\r\n                      editorValues.isConfirmed ||\r\n                      editorValues.transferToEmployeeId !== null}\r\n            value={getSelectedEventTypeId(editorValues)}\r\n            onIonChange={(e) => {\r\n              onEventTypeChange(e.detail.value);\r\n            }}\r\n          >\r\n            {getEventTypes(auth, editorValues).map((et) => (\r\n              <IonSelectOption key={et.id} value={et.id}>\r\n                {et.name}\r\n              </IonSelectOption>\r\n            ))}\r\n          </IonSelect>\r\n        </IonCol>\r\n      </IonRow>\r\n\r\n      <IonRow>\r\n        <IonCol size=\"3\">\r\n          <IonLabel className=\"label\">Status</IonLabel>\r\n        </IonCol>\r\n        <IonCol size=\"9\">\r\n          <IonSelect\r\n            mode=\"ios\"\r\n            className=\"select\"\r\n            interface=\"action-sheet\"\r\n            disabled={\r\n              editorValues.isReadonly ||\r\n              editorValues.isConfirmed ||\r\n              editorValues.transferToEmployeeId !== null ||\r\n              (auth.role === Role.Employee && editorValues.scheduleEventId <= 0)\r\n            }\r\n            value={editorValues.eventStatus}\r\n            onIonChange={(e) => {\r\n              onEventStatusChange(e.detail.value);\r\n            }}\r\n          >\r\n            {getEventStatuses(auth, editorValues).map((es) => (\r\n              <IonSelectOption key={es.id} value={es.id}>\r\n                {es.name}\r\n              </IonSelectOption>\r\n            ))}\r\n          </IonSelect>\r\n        </IonCol>\r\n      </IonRow>\r\n\r\n      <IonRow\r\n        className={\r\n          editorValues.eventType === EventType.Absent\r\n            ? \"visible edit-row\"\r\n            : \"invisible\"\r\n        }\r\n      >\r\n        <IonCol size=\"3\">\r\n          <IonLabel className=\"label\">Hours</IonLabel>\r\n        </IonCol>\r\n        <IonCol size=\"9\">\r\n          <IonInput\r\n            className=\"input-textbox\"\r\n            placeholder={absentHoursPlaceholderText}\r\n            disabled={editorValues.isReadonly || editorValues.isConfirmed}\r\n            value={absentTimeString}\r\n            onIonChange={(e) => {\r\n              if (e.detail.value) {\r\n                setAbsentTimeString(e.detail.value);\r\n              }\r\n            }}\r\n            onIonBlur={() => {\r\n              onAbsentTimeChange(absentTimeString);\r\n            }}\r\n          />\r\n        </IonCol>\r\n      </IonRow>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default EventTypeStatusEditor;\r\n","import React, {useState, useEffect, useRef} from \"react\";\r\nimport {\r\n  IonLabel,\r\n  IonSelect,\r\n  IonRow,\r\n  IonCol,\r\n  IonSelectOption,\r\n} from \"@ionic/react\";\r\nimport \"../../../global-styles.scss\";\r\nimport \"./EventPositionEditor\";\r\nimport {\r\n  AuthorizedItems,\r\n  AuthorizedLocation,\r\n} from \"../../../orbital-interfaces/AuthorizedItems\";\r\nimport { EditorValues, EditorReducerAction } from \"../EditEventModalState\";\r\nimport {authHelper} from \"../../../util/authHelper\";\r\n\r\ninterface EventPositionEditorProps {\r\n  auth: AuthorizedItems;\r\n  editorValues: EditorValues;\r\n  update: React.Dispatch<EditorReducerAction>;\r\n}\r\n\r\ninterface Option {\r\n  id: number;\r\n  name: string;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst createPositionList = (loc: AuthorizedLocation[]): Option[] => {\r\n  const isMultiLoc = loc.length > 1;\r\n  return loc.flatMap((l) =>\r\n    l.departments.flatMap((d) =>\r\n      d.positions.map((p) => {\r\n        const isMultiDep = l.departments.length > 1;\r\n        let name = \"\";\r\n        if (isMultiLoc) {\r\n          name += (l.abbr ? l.abbr : l.name) + \"/\";\r\n        }\r\n\r\n        if (isMultiDep) {\r\n          name += (d.abbr ? d.abbr : d.name) + \"/\";\r\n        }\r\n\r\n        name += p.name;\r\n        return { id: p.id, name: name };\r\n      })\r\n    )\r\n  ).sort((a,b) => (a.name > b.name)\r\n    ? 1\r\n    : (b.name > a.name)\r\n      ? -1 : 0);\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst EventPositionEditor: React.FC<EventPositionEditorProps> = ({\r\n  auth,\r\n  editorValues,\r\n  update,\r\n}: EventPositionEditorProps) => {\r\n  const [positionList, setPositionList] = useState([] as Option[]);\r\n  const posIdRef = useRef(null as number | null);\r\n\r\n  useEffect(() => {\r\n    if (editorValues.scheduleEventId === -1) {\r\n      return;\r\n    }\r\n\r\n    if (auth && auth.locations && auth.locations.length > 0) {\r\n      setPositionList(createPositionList(auth.locations));\r\n    }\r\n  }, [auth, editorValues.scheduleEventId]);\r\n\r\n  const updatePosition = (posId: number) => {\r\n    if (posId === posIdRef.current) {\r\n      return;\r\n    }\r\n\r\n    if (posId === editorValues.position.position.id) {\r\n      return;\r\n    }\r\n\r\n    const selected = authHelper.getSelectedPosition(auth.locations, posId);\r\n    update({ type: \"POSITION-UPDATED\", selectedPosition: selected });\r\n  };\r\n\r\n  return (\r\n    <IonRow>\r\n      <IonCol size=\"3\">\r\n        <IonLabel className=\"label\">Position</IonLabel>\r\n      </IonCol>\r\n      <IonCol size=\"9\">\r\n        <IonSelect\r\n          mode=\"ios\"\r\n          className=\"select\"\r\n          interface=\"action-sheet\"\r\n          disabled={editorValues.isReadonly ||\r\n                    editorValues.isConfirmed ||\r\n                    editorValues.transferToEmployeeId !== null}\r\n          value={editorValues.position.position.id}\r\n          onIonChange={(e) => updatePosition(e.detail.value)}\r\n        >\r\n          {positionList.map((p) => (\r\n            <IonSelectOption key={p.id} value={p.id}>\r\n              {p.name}\r\n            </IonSelectOption>\r\n          ))}\r\n        </IonSelect>\r\n      </IonCol>\r\n    </IonRow>\r\n  );\r\n};\r\n\r\nexport default EventPositionEditor;\r\n","import React, {useContext, useEffect, useRef, useState} from \"react\";\r\nimport {IonCol, IonLabel, IonRow, IonSelect, IonSelectOption,} from \"@ionic/react\";\r\nimport \"../../../global-styles.scss\";\r\nimport \"./EventEmployeeEditor\";\r\nimport {AuthorizedItems} from \"../../../orbital-interfaces/AuthorizedItems\";\r\nimport {AdminAuthorization, Role} from \"../../../enums\";\r\nimport {employeesApi} from \"../../../api/employeesApi\";\r\nimport {ApplicationUserContext} from \"../../../context/ApplicationUserContext\";\r\nimport {parseISO} from \"date-fns\";\r\nimport {EditorReducerAction, EditorValues} from \"../EditEventModalState\";\r\nimport {IdName} from \"../../../orbital-interfaces/IdName\";\r\nimport {useShowLoading} from \"../../../hooks/useShowLoading\";\r\nimport {log} from \"../../../util/logger\";\r\nimport {authHelper} from \"../../../util/authHelper\";\r\n\r\ninterface EventEmployeeEditorProps {\r\n  auth: AuthorizedItems;\r\n  editorValues: EditorValues;\r\n  update: React.Dispatch<EditorReducerAction>;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst EventEmployeeEditor: React.FC<EventEmployeeEditorProps> = ({\r\n  auth,\r\n  editorValues,\r\n  update,\r\n}: EventEmployeeEditorProps) => {\r\n  const [employeeList, setEmployeeList] = useState([] as IdName[]);\r\n  const loading = useShowLoading(\"Please wait...\");\r\n  const { user } = useContext(ApplicationUserContext);\r\n  const empIdRef = useRef(null as number | null);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (user && user.isLoggedin && editorValues.scheduleEventId !== -1) {\r\n      log(\"edit_event_get_employeeList\", { user: user.username});\r\n      loading.setShowLoading(true);\r\n      getEmployees(editorValues);\r\n    }\r\n    // eslint-disable-next-line\r\n  }, [user, editorValues.position.position.id, editorValues.scheduleEventId, editorValues.employee.id]);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onChange = (employeeId: number) => {\r\n    if (employeeId === -5 || employeeId === editorValues.employee.id) {\r\n      return;\r\n    }\r\n\r\n    if (employeeId === empIdRef.current) {\r\n      return;\r\n    }\r\n\r\n    empIdRef.current = employeeId;\r\n    const emp = employeeList.filter((e) => e.id === employeeId)[0];\r\n    if (employeeId === -1) {\r\n      update({\r\n        type: \"EMPLOYEE-UPDATED\",\r\n        employee: { id: -1, name: \"SELECT EMPLOYEE\" },\r\n      });\r\n    } else {\r\n      update({\r\n        type: \"EMPLOYEE-UPDATED\",\r\n        employee: { id: employeeId, name: emp.name },\r\n      });\r\n    }\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const getEmployees = (ev: EditorValues) => {\r\n    const justEmployee = [{ id: auth.employeeId, name: auth.fullName}];\r\n\r\n    if (auth.role === Role.Employee) {\r\n      setEmployeeList(justEmployee);\r\n      loading.setShowLoading(false);\r\n      return;\r\n    }\r\n\r\n    if (auth.role === Role.Admin) {\r\n      const dept = authHelper.getDepartmentFromPositionId(auth, ev.position.position.id);\r\n      if (dept === null) {\r\n        loading.setShowLoading(false);\r\n        setEmployeeList(justEmployee);\r\n        return;\r\n      }\r\n\r\n      if (!authHelper.isAdminAuthorizedFor(\r\n        auth,\r\n        ev.locationId,\r\n        dept.id,\r\n        AdminAuthorization.CanEditSchedules)) {\r\n        setEmployeeList(justEmployee);\r\n        loading.setShowLoading(false);\r\n        return;\r\n      }\r\n\r\n    }\r\n\r\n    employeesApi\r\n      .getEmployeesByLocationIdPositionIdAndActiveDateRange(\r\n        user,\r\n        ev.position.location.id,\r\n        ev.position.position.id,\r\n        parseISO(ev.eventStart),\r\n        parseISO(ev.eventEnd),\r\n        ev.position.location.settings.EmployeeSort\r\n      )\r\n      .then((employees) => {\r\n        setEmployeeList(employees);\r\n        const empIds = employees.map((e) => e.id);\r\n\r\n        if (!empIds.includes(ev.employee.id))\r\n        {\r\n          update({\r\n            type: \"EMPLOYEE-UPDATED\",\r\n            employee: { id: -1, name: \"SELECT EMPLOYEE\" }\r\n          });\r\n        }\r\n\r\n        loading.setShowLoading(false);\r\n      });\r\n  };\r\n\r\n  if (employeeList.length === 0) {\r\n    return (\r\n      <>\r\n        <IonRow>\r\n          <IonCol size=\"3\">\r\n            <IonLabel className=\"label\">Employee</IonLabel>\r\n          </IonCol>\r\n          <IonCol size=\"9\">\r\n            <IonSelect\r\n            mode=\"ios\"\r\n            className=\"select\"\r\n            interface=\"action-sheet\"\r\n            value={-5}\r\n            >\r\n              <IonSelectOption key=\"-5\" value=\"-5\">\r\n                {editorValues.employee.name}\r\n              </IonSelectOption>\r\n            </IonSelect>\r\n          </IonCol>\r\n        </IonRow>\r\n        {loading.showLoadingJsx}\r\n      </>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <IonRow>\r\n        <IonCol size=\"3\">\r\n          <IonLabel className=\"label\">Employee</IonLabel>\r\n        </IonCol>\r\n        <IonCol size=\"9\">\r\n          <IonSelect\r\n            mode=\"ios\"\r\n            className=\"select\"\r\n            interface=\"action-sheet\"\r\n            disabled={editorValues.isReadonly ||\r\n                      auth.role === Role.Employee  ||\r\n                      editorValues.isConfirmed ||\r\n                      editorValues.transferToEmployeeId !== null}\r\n            value={editorValues.employee.id}\r\n            onIonChange={(e) => {\r\n              onChange(e.detail.value);\r\n            }}\r\n          >\r\n            {employeeList.length > 1 && (\r\n                <IonSelectOption key={-1} value={-1}>\r\n                  Select Employee\r\n                </IonSelectOption>\r\n            )}\r\n            {employeeList.map((emp) => (\r\n              <IonSelectOption key={emp.id} value={emp.id}>\r\n                {emp.name}\r\n              </IonSelectOption>\r\n            ))}\r\n          </IonSelect>\r\n        </IonCol>\r\n      </IonRow>\r\n      {loading.showLoadingJsx}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default EventEmployeeEditor;\r\n","import React from \"react\";\r\nimport { IonLabel, IonRow, IonCol, IonDatetime } from \"@ionic/react\";\r\nimport \"../../../global-styles.scss\";\r\nimport \"./EventStartEndEditor\";\r\nimport { AuthorizedItems } from \"../../../orbital-interfaces/AuthorizedItems\";\r\nimport { parseISO } from \"date-fns\";\r\nimport { EditorValues, EditorReducerAction } from \"../EditEventModalState\";\r\n\r\ninterface EventStartEndEditorProps {\r\n  auth: AuthorizedItems;\r\n  editorValues: EditorValues;\r\n  update: React.Dispatch<EditorReducerAction>;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst EventStartEndEditor: React.FC<EventStartEndEditorProps> = ({\r\n  editorValues,\r\n  update,\r\n}: EventStartEndEditorProps) => {\r\n  const onStartChange = (newEventStart?: string | null) => {\r\n    if (!newEventStart) {\r\n      return;\r\n    }\r\n\r\n    if (parseISO(newEventStart) === parseISO(editorValues.eventStart)) {\r\n      return;\r\n    }\r\n\r\n    update({\r\n      type: \"START-UPDATED\",\r\n      eventStart: newEventStart,\r\n    });\r\n  };\r\n\r\n  const onEndChange = (newEventEnd?: string | null) => {\r\n    if (!newEventEnd) {\r\n      return;\r\n    }\r\n\r\n    if (parseISO(newEventEnd) === parseISO(editorValues.eventEnd)) {\r\n      return;\r\n    }\r\n\r\n    update({\r\n      type: \"END-UPDATED\",\r\n      eventEnd: newEventEnd,\r\n    });\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <IonRow>\r\n        <IonCol size=\"3\">\r\n          <IonLabel className=\"label\">Start</IonLabel>\r\n        </IonCol>\r\n        <IonCol size=\"9\">\r\n          <IonDatetime\r\n            mode=\"ios\"\r\n            className=\"select\"\r\n            displayFormat=\"h:mm A, M/D DDD\"\r\n            disabled={editorValues.isReadonly || editorValues.isConfirmed}\r\n            pickerFormat=\"h:mm A MMM D\"\r\n            minuteValues=\"0,5,10,15,20,25,30,35,40,45,50,55\"\r\n            value={editorValues.eventStart}\r\n            onIonChange={(e) => {\r\n              onStartChange(e.detail.value);\r\n            }}\r\n          />\r\n        </IonCol>\r\n      </IonRow>\r\n\r\n      <IonRow>\r\n        <IonCol size=\"3\">\r\n          <IonLabel className=\"label\">End</IonLabel>\r\n        </IonCol>\r\n        <IonCol size=\"9\">\r\n          <IonDatetime\r\n            mode=\"ios\"\r\n            className=\"select\"\r\n            displayFormat=\"h:mm A, M/D DDD\"\r\n            disabled={editorValues.isReadonly || editorValues.isClockedIn || editorValues.isConfirmed}\r\n            pickerFormat=\"h:mm A MMM D\"\r\n            minuteValues=\"0,5,10,15,20,25,30,35,40,45,50,55\"\r\n            value={editorValues.eventEnd}\r\n            onIonChange={(e) => {\r\n              onEndChange(e.detail.value);\r\n            }}\r\n          />\r\n        </IonCol>\r\n      </IonRow>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default EventStartEndEditor;\r\n","import React, {useState} from \"react\";\r\nimport {\r\n  IonCheckbox,\r\n  IonDatetime,\r\n  IonContent,\r\n  IonRow,\r\n  IonCol,\r\n  IonButtons,\r\n  IonButton,\r\n  IonIcon,\r\n  IonFooter,\r\n  IonGrid,\r\n  IonHeader,\r\n  IonTitle,\r\n  IonToolbar,\r\n} from \"@ionic/react\";\r\nimport { close } from \"ionicons/icons\";\r\nimport \"../../../global-styles.scss\";\r\nimport {\r\n  setHours,\r\n  setMinutes,\r\n  parseISO,\r\n  isAfter,\r\n  isBefore,\r\n  addMinutes,\r\n  isSameDay,\r\n} from \"date-fns\";\r\nimport useDialogBox from \"../../../hooks/useDialogBox\";\r\nimport { EventBreak } from \"../../../orbital-interfaces/EventBreak\";\r\nimport {LocationSettings} from \"../../../orbital-interfaces/LocationSettings\";\r\nimport {timeHelper as th} from \"../../../util/timeHelper\";\r\n\r\ninterface AddBreakModalProps {\r\n  onCancel: () => void;\r\n  onAdd: (\r\n    startDate: Date,\r\n    endDate: Date,\r\n    isRestricted: boolean,\r\n    isPaid: boolean\r\n  ) => void;\r\n  currentBreaks: EventBreak[];\r\n  eventStart: string;\r\n  eventEnd: string;\r\n  locSettings: LocationSettings;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst hasOverlap = (start: Date, end: Date, breaks: EventBreak[]) => {\r\n  const startA = start;\r\n  const endA = end;\r\n  let found = false;\r\n  breaks.map((brk) => {\r\n    const startB = addMinutes(parseISO(brk.BreakStart), 3);\r\n    const endB = brk.BreakEnd\r\n      ? addMinutes(parseISO(brk.BreakEnd!), -3)\r\n      : new Date(2200, 1, 1);\r\n    if (startA < endB && endA > startB) {\r\n      found = true;\r\n    }\r\n\r\n    return found;\r\n  });\r\n  return found;\r\n};\r\n\r\n// --------------------------------------------------------------------------------------\r\n// Used to set the inital start and end time for the break\r\nfunction getDateWithTimeSpan(dateStr: string, ts: string): Date {\r\n  const date = parseISO(dateStr);\r\n  const hours = th.getHoursFromTimeSpan(ts);\r\n  const minutes = th.getMinutesFromTimeSpan(ts);\r\n  return setMinutes(setHours(date, hours), minutes);\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\n//\r\n// --------------------------------------------------------------------------------------\r\nconst AddBreakModal: React.FC<AddBreakModalProps> = ({\r\n  onCancel,\r\n  onAdd,\r\n  currentBreaks,\r\n  eventStart,\r\n  eventEnd,\r\n  locSettings\r\n}: AddBreakModalProps) => {\r\n  const spansDays = !isSameDay(parseISO(eventStart), parseISO(eventEnd));\r\n  const [startDate, setStartDate] = useState(\r\n    getDateWithTimeSpan(eventStart, locSettings.EnhancedBreakManagementDefaultStartTime));\r\n  const [endDate, setEndDate] = useState(getDateWithTimeSpan(eventEnd, locSettings.EnhancedBreakManagementDefaultEndTime));\r\n  const [isRestricted, setIsRestricted] = useState(false);\r\n  const [isPaid, setIsPaid] = useState(false);\r\n  const [errorMessage, setErrorMessage] = useState(\"\");\r\n  const [isValid, setIsValid] = useState(true);\r\n  const alert = useDialogBox();\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onAddClick = () => {\r\n    if (startDate > endDate) {\r\n      alert.showAlert(\r\n        \"Invalid Start / End\",\r\n        \"Break Start cannot come after Break End.\",\r\n        () => {}\r\n      );\r\n    } else if (parseISO(eventStart) > startDate) {\r\n      setIsValid(false);\r\n      setErrorMessage(\"Break Start must be after Event Start\");\r\n    } else if (parseISO(eventEnd) < endDate) {\r\n      setIsValid(false);\r\n      setErrorMessage(\"Break End must be before Event End\");\r\n    } else if (hasOverlap(startDate, endDate, currentBreaks)) {\r\n      setIsValid(false);\r\n      setErrorMessage(\"Pre-existing break overlaps\");\r\n    } else {\r\n      onAdd(startDate, endDate, isRestricted, isPaid);\r\n    }\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onStartUpdate = (newStart: string) => {\r\n    const newStartDate = parseISO(newStart);\r\n    setStartDate(newStartDate);\r\n    if (!isBefore(newStartDate, endDate)) {\r\n      setIsValid(false);\r\n      setErrorMessage(\"Start must be before End\");\r\n    } else if (parseISO(eventStart) > newStartDate) {\r\n      setIsValid(false);\r\n      setErrorMessage(\"Start before Event begins\");\r\n    } else if (hasOverlap(newStartDate, endDate, currentBreaks)) {\r\n      setIsValid(false);\r\n      setErrorMessage(\"Pre-existing break overlaps\");\r\n    } else {\r\n      setIsValid(true);\r\n      setErrorMessage(\"\");\r\n    }\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onEndUpdate = (newEnd: string) => {\r\n    const newEndDate = parseISO(newEnd);\r\n    setEndDate(newEndDate);\r\n\r\n    if (!isAfter(newEndDate, startDate)) {\r\n      setIsValid(false);\r\n      setErrorMessage(\"End must be after Start\");\r\n    } else if (newEndDate > parseISO(eventEnd)) {\r\n      setIsValid(false);\r\n      setErrorMessage(\"End after Event ends\");\r\n    } else if (hasOverlap(startDate, newEndDate, currentBreaks)) {\r\n      setIsValid(false);\r\n      setErrorMessage(\"Pre-existing break overlaps\");\r\n    } else {\r\n      setIsValid(true);\r\n      setErrorMessage(\"\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <IonHeader mode=\"ios\">\r\n        <IonToolbar>\r\n          <IonTitle>Add Break</IonTitle>\r\n          <IonButtons slot=\"end\">\r\n            <IonButton onClick={onCancel}>\r\n              <IonIcon icon={close} mode=\"ios\" slot=\"icon-only\" />\r\n            </IonButton>\r\n          </IonButtons>\r\n        </IonToolbar>\r\n      </IonHeader>\r\n      <IonContent>\r\n        <IonGrid>\r\n          <IonRow>\r\n            <IonCol className=\"label\" size=\"3\">\r\n              Start\r\n            </IonCol>\r\n            <IonCol size=\"9\">\r\n              <IonDatetime\r\n                className=\"select\"\r\n                displayFormat={spansDays ? \"h:mm A, M/D DDD\" : \"h:mm a\"}\r\n                pickerFormat={spansDays ? \"h:mm A MMM D\" : \"h:mm A\"}\r\n                min=\"2005-01-01\"\r\n                max=\"2030-01-01\"\r\n                minuteValues=\"0,5,10,15,20,25,30,35,40,45,50,55\"\r\n                value={startDate.toISOString()}\r\n                onIonChange={(e) => onStartUpdate(e.detail.value!)}\r\n              />\r\n            </IonCol>\r\n          </IonRow>\r\n\r\n          <IonRow>\r\n            <IonCol className=\"label\" size=\"3\">\r\n              End\r\n            </IonCol>\r\n            <IonCol size=\"9\">\r\n              <IonDatetime\r\n                className=\"select\"\r\n                displayFormat={spansDays ? \"h:mm A, M/D DDD\" : \"h:mm a\"}\r\n                pickerFormat={spansDays ? \"h:mm A MMM D\" : \"h:mm A\"}\r\n                min=\"2005-01-01\"\r\n                max=\"2030-01-01\"\r\n                minuteValues=\"0,5,10,15,20,25,30,35,40,45,50,55\"\r\n                value={endDate.toISOString()}\r\n                onIonChange={(e) => onEndUpdate(e.detail.value!)}\r\n              />\r\n            </IonCol>\r\n          </IonRow>\r\n\r\n          <IonRow>\r\n            <IonCol size=\"3\">\r\n              <IonCheckbox\r\n                className=\"checkbox\"\r\n                checked={isRestricted}\r\n                onIonChange={(e) => {\r\n                  setIsRestricted(e.detail.checked);\r\n                }}\r\n              />\r\n            </IonCol>\r\n            <IonCol className=\"label\" size=\"9\">\r\n              Restricted Break\r\n            </IonCol>\r\n          </IonRow>\r\n\r\n          <IonRow>\r\n            <IonCol size=\"3\">\r\n              <IonCheckbox\r\n                className=\"checkbox\"\r\n                onIonChange={(e) => {\r\n                  setIsPaid(e.detail.checked);\r\n                }}\r\n              />\r\n            </IonCol>\r\n            <IonCol className=\"label\" size=\"9\">\r\n              Paid Break\r\n            </IonCol>\r\n          </IonRow>\r\n\r\n          <IonRow>\r\n            <IonCol size=\"12\" className=\"error-message\">\r\n              {errorMessage}\r\n            </IonCol>\r\n          </IonRow>\r\n        </IonGrid>\r\n      </IonContent>\r\n      <IonFooter>\r\n        <IonButton\r\n          expand=\"block\"\r\n          color=\"secondary\"\r\n          onClick={onAddClick}\r\n          disabled={!isValid}\r\n        >\r\n          ADD\r\n        </IonButton>\r\n      </IonFooter>\r\n      {alert.alertBoxJsx}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default AddBreakModal;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport { IonModal, IonRow, IonCol, IonButton, IonIcon, IonLabel, } from \"@ionic/react\";\r\nimport \"../../../global-styles.scss\";\r\nimport { add, trash, lockClosed, logoUsd } from \"ionicons/icons\";\r\nimport { AuthorizedItems } from \"../../../orbital-interfaces/AuthorizedItems\";\r\nimport { EventBreak } from \"../../../orbital-interfaces/EventBreak\";\r\nimport {timeHelper as th} from \"../../../util/timeHelper\";\r\nimport AddBreakModal from \"./AddBreakModal\";\r\nimport { EditorValues, EditorReducerAction } from \"../EditEventModalState\";\r\nimport {EventType} from \"../../../enums\";\r\nimport {authHelper} from \"../../../util/authHelper\";\r\nimport {scheduleEventHelper} from \"../../../util/scheduleEventHelper\";\r\n\r\ninterface EventBreakEditorProps {\r\n  auth: AuthorizedItems;\r\n  editorValues: EditorValues;\r\n  update: React.Dispatch<EditorReducerAction>;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst EventBreakEditor: React.FC<EventBreakEditorProps> = ({\r\n  auth,\r\n  editorValues,\r\n  update,\r\n}: EventBreakEditorProps) => {\r\n  const [breakList, setBreakList] = useState([] as EventBreak[]);\r\n  const [showBreakModal, setShowBreakModal] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (editorValues.scheduleEventId === -1) {\r\n      return;\r\n    }\r\n\r\n    setBreakList(editorValues.eventBreaks);\r\n  }, [editorValues.eventBreaks, editorValues.scheduleEventId]);\r\n\r\n  const showRestricted = (b: EventBreak) => {\r\n    return b.IsRestricted ? (\r\n      <IonIcon className=\"restricted-icon\" icon={lockClosed} />\r\n    ) : (\r\n        <span />\r\n      );\r\n  };\r\n\r\n  const showPaid = (b: EventBreak) => {\r\n    return b.IsPaidBreak ? (\r\n      <IonIcon className=\"paid-icon\" icon={logoUsd} />\r\n    ) : (\r\n        <span />\r\n      );\r\n  };\r\n\r\n  const onAddBreakModalCancel = () => {\r\n    setShowBreakModal(false);\r\n  };\r\n\r\n  const onAddBreakModalApply = (\r\n    startDate: Date,\r\n    endDate: Date,\r\n    isRestricted: boolean,\r\n    isPaid: boolean\r\n  ) => {\r\n    setShowBreakModal(false);\r\n    const brk: EventBreak = {\r\n      BreakStart: th.formatDateTimeAsMvcString(startDate),\r\n      BreakEnd: th.formatDateTimeAsMvcString(endDate),\r\n      IsRestricted: isRestricted,\r\n      IsPaidBreak: isPaid,\r\n      ScheduleEventId: editorValues.scheduleEventId,\r\n    };\r\n\r\n    const newBreakList = [...breakList, brk];\r\n    setBreakList(newBreakList);\r\n    update({ type: \"EVENTBREAKS-UPDATED\", breaks: newBreakList });\r\n  };\r\n\r\n  const onDeleteBreak = (breakStart: string) => {\r\n    const newBreakList = breakList.filter((b) => b.BreakStart !== breakStart);\r\n    setBreakList(newBreakList);\r\n    update({ type: \"EVENTBREAKS-UPDATED\", breaks: newBreakList });\r\n  };\r\n\r\n  if (\r\n    editorValues.eventType !== EventType.Clock &&\r\n    !scheduleEventHelper.isShiftTypeEvent(\r\n      editorValues.eventType,\r\n      editorValues.eventStatus) &&\r\n    editorValues.transferToEmployeeId === null\r\n  ) {\r\n    return <div />;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <IonRow>\r\n        <IonCol size=\"3\">\r\n          <IonLabel className=\"label\">(B)reaks</IonLabel>\r\n        </IonCol>\r\n\r\n        <IonCol size=\"2\">\r\n          <IonButton\r\n            size=\"small\"\r\n            color=\"light\"\r\n            disabled={editorValues.isReadonly || editorValues.isConfirmed}\r\n            onClick={() => {\r\n              setShowBreakModal(true);\r\n            }}\r\n          >\r\n            <IonIcon slot=\"icon-only\" icon={add} color=\"dark\" />\r\n          </IonButton>\r\n        </IonCol>\r\n      </IonRow>\r\n\r\n      <IonRow>\r\n        <IonCol size=\"3\">\r\n        </IonCol>\r\n        <IonCol size=\"9\">\r\n          {/* {(!breakList || breakList.length === 0) && (\r\n            <div className=\"break-div\">(B) NONE</div>\r\n          )} */}\r\n\r\n          {breakList &&\r\n            breakList.map((brk) => (\r\n              <div key={brk.BreakStart} className=\"break-div\">\r\n                (B) {th.getBreakStartEnd(brk)}\r\n                {showPaid(brk)}\r\n                {showRestricted(brk)}\r\n                <button\r\n                  disabled={editorValues.isReadonly || editorValues.isConfirmed}\r\n                  onClick={() => {\r\n                    onDeleteBreak(brk.BreakStart);\r\n                  }}\r\n                >\r\n                  <IonIcon\r\n                    slot=\"icon-only\"\r\n                    mode=\"ios\"\r\n                    icon={trash}\r\n                    color=\"gray\"\r\n                  />\r\n                </button>\r\n              </div>\r\n            ))}\r\n        </IonCol>\r\n      </IonRow>\r\n\r\n      <IonRow>\r\n        <IonCol size=\"12\">\r\n          <div style={{ borderBottom: \"1px solid #ddd\", width: \"100%\" }} />\r\n        </IonCol>\r\n      </IonRow>\r\n\r\n      <IonModal\r\n        mode=\"ios\"\r\n        isOpen={showBreakModal}\r\n        cssClass=\"mini-modal add-break-modal\"\r\n        onDidDismiss={() => setShowBreakModal(false)}\r\n      >\r\n        <AddBreakModal\r\n          onCancel={onAddBreakModalCancel}\r\n          onAdd={onAddBreakModalApply}\r\n          currentBreaks={breakList}\r\n          eventStart={editorValues.eventStart}\r\n          eventEnd={editorValues.eventEnd}\r\n          locSettings={authHelper.getLocSettingsForLocationId(auth, editorValues.locationId)}\r\n        />\r\n      </IonModal>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default EventBreakEditor;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport {\r\n  IonLabel,\r\n  IonSelect,\r\n  IonRow,\r\n  IonCol,\r\n  IonSelectOption,\r\n} from \"@ionic/react\";\r\nimport \"../../../global-styles.scss\";\r\nimport \"./EventTagEditor\";\r\nimport { AuthorizedItems } from \"../../../orbital-interfaces/AuthorizedItems\";\r\nimport { EditorValues, EditorReducerAction } from \"../EditEventModalState\";\r\n\r\ninterface EventTagEditorProps {\r\n  auth: AuthorizedItems;\r\n  editorValues: EditorValues;\r\n  update: React.Dispatch<EditorReducerAction>;\r\n}\r\n\r\ninterface TagList {\r\n  id: number;\r\n  name: string;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst EventTagEditor: React.FC<EventTagEditorProps> = ({\r\n  auth,\r\n  editorValues,\r\n  update,\r\n}: EventTagEditorProps) => {\r\n  const [selectedTagId, setSelectedTagId] = useState(-1);\r\n  const [tagList, setTagList] = useState([] as TagList[]);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (editorValues.scheduleEventId === -1) {\r\n      return;\r\n    }\r\n\r\n    if (auth && auth.locations && auth.locations.length > 0) {\r\n      const tags = auth.tags\r\n        .filter((t) =>\r\n          t.positionIds.includes(editorValues.position.position.id)\r\n        )\r\n        .map((t) => {\r\n          return { id: t.id, name: t.name };\r\n        });\r\n      setTagList(tags);\r\n\r\n      const tagIds = tags.map((t) => t.id);\r\n      if (!tagIds.includes(selectedTagId)) {\r\n        if (\r\n          editorValues.tag &&\r\n          editorValues.tag.id &&\r\n          tagIds.includes(editorValues.tag.id)\r\n        ) {\r\n          setSelectedTagId(editorValues.tag.id);\r\n        } else {\r\n          setSelectedTagId(-1);\r\n        }\r\n      }\r\n    }\r\n\r\n    // eslint-disable-next-line\r\n  }, [auth, editorValues.position, editorValues.scheduleEventId]);\r\n\r\n  const onUpdateTag = (tagId: number) => {\r\n    setSelectedTagId(tagId);\r\n\r\n    if (tagId === editorValues.tag.id) {\r\n      return;\r\n    }\r\n\r\n    if (tagId === -1) {\r\n      update({ type: \"TAG-UPDATED\", tag: { id: -1, name: \"NONE\" } });\r\n    } else {\r\n      const tag = tagList.filter((t) => t.id === tagId)[0];\r\n      update({ type: \"TAG-UPDATED\", tag });\r\n    }\r\n  };\r\n\r\n  if (tagList.length === 0) {\r\n    return <></>;\r\n  }\r\n\r\n  return (\r\n    <IonRow>\r\n      <IonCol size=\"3\">\r\n        <IonLabel className=\"label\">~Tag</IonLabel>\r\n      </IonCol>\r\n      <IonCol size=\"9\">\r\n        <IonSelect\r\n          mode=\"ios\"\r\n          className=\"select\"\r\n          interface=\"action-sheet\"\r\n          disabled={editorValues.isReadonly || editorValues.isConfirmed}\r\n          value={selectedTagId}\r\n          onIonChange={(e) => {\r\n            onUpdateTag(e.detail.value);\r\n          }}\r\n        >\r\n          <IonSelectOption value={-1}>None</IonSelectOption>\r\n\r\n          {tagList.map((tag) => (\r\n            <IonSelectOption key={tag.id} value={tag.id}>\r\n              {tag.name}\r\n            </IonSelectOption>\r\n          ))}\r\n        </IonSelect>\r\n      </IonCol>\r\n    </IonRow>\r\n  );\r\n};\r\n\r\nexport default EventTagEditor;\r\n","import React from \"react\";\r\nimport {IonButton, IonCheckbox, IonCol, IonIcon, IonLabel} from \"@ionic/react\";\r\nimport \"./EventStartEndEditor\";\r\nimport {AuthorizedItems} from \"../../../orbital-interfaces/AuthorizedItems\";\r\nimport {AdminAuthorization, Role, EventType, EventStatus} from \"../../../enums\";\r\nimport {EditorReducerAction, EditorValues} from \"../EditEventModalState\";\r\nimport {checkmark} from \"ionicons/icons\";\r\nimport {authHelper} from \"../../../util/authHelper\";\r\n\r\ninterface EventConfirmEditorProps {\r\n  auth: AuthorizedItems;\r\n  editorValues: EditorValues;\r\n  update: React.Dispatch<EditorReducerAction>;\r\n  onEmployeeUpdated: () => void;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction shouldShowButton(auth: AuthorizedItems, ev:EditorValues): boolean  {\r\n  if (!authHelper.isAuthItemsValid(auth)) {\r\n    return false;\r\n  }\r\n\r\n  if (auth.role === Role.Employee) {\r\n    return true;\r\n  }\r\n\r\n  if (auth.role === Role.LocationAdmin || auth.role === Role.BusinessAdmin) {\r\n    return false;\r\n  }\r\n\r\n  const dept = authHelper.getDepartmentFromPositionId(auth, ev.position.position.id);\r\n  if (dept === null) {\r\n    return false;\r\n  }\r\n\r\n  return !authHelper.isAdminAuthorizedFor(\r\n    auth,\r\n    ev.locationId,\r\n    dept!.id,\r\n    AdminAuthorization.CanEditSchedules);\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction shouldShowConfirmed(auth: AuthorizedItems, ev: EditorValues) {\r\n  if (!authHelper.isAuthItemsValid(auth)) {\r\n    return false;\r\n  }\r\n\r\n  if (ev.scheduleEventId === -1) {\r\n    return false;\r\n  }\r\n\r\n  if (ev.scheduleEventId <= 0 ) {\r\n    if (auth.role === Role.Employee) {\r\n      return false;\r\n    }\r\n\r\n    if (auth.role === Role.Admin) {\r\n      const dept = authHelper.getDepartmentFromPositionId(auth, ev.position.position.id);\r\n      if (dept === null) {\r\n        return false;\r\n      }\r\n\r\n      if (!authHelper.isAdminAuthorizedFor(\r\n        auth,\r\n        ev.locationId,\r\n        dept!.id,\r\n        AdminAuthorization.CanEditSchedules)) {\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n\r\n  return (ev.eventType === EventType.Shift && ev.eventStatus === EventStatus.Approved) ||\r\n    (ev.eventType === EventType.Cover &&\r\n        (ev.eventStatus === EventStatus.Request ||\r\n        ev.eventStatus === EventStatus.RequestDenied));\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\n//\r\n// --------------------------------------------------------------------------------------\r\nconst EventConfirmEditor: React.FC<EventConfirmEditorProps> = ({\r\n  auth,\r\n  editorValues,\r\n  update,\r\n  onEmployeeUpdated\r\n}: EventConfirmEditorProps) => {\r\n\r\n\r\n  // ---------------------------------------------------------------------------------\r\n  function onCheckChange() {\r\n    update({\r\n      type: \"CONFIRM-UPDATED\",\r\n      isConfirmed: !editorValues.isConfirmed,\r\n    });\r\n  }\r\n\r\n  // ---------------------------------------------------------------------------------\r\n  function onButtonClick() {\r\n    onEmployeeUpdated();\r\n  }\r\n\r\n  if (!shouldShowConfirmed(auth, editorValues)) {\r\n    return (\r\n      <>\r\n      </>\r\n    );\r\n  }\r\n\r\n  if (shouldShowButton(auth, editorValues)) {\r\n    return (\r\n      <>\r\n        <IonCol size=\"3\">\r\n          <IonLabel className=\"label\">\r\n            Confirm\r\n          </IonLabel>\r\n        </IonCol>\r\n        <IonCol size=\"3\">\r\n          <IonButton\r\n            onClick={onButtonClick}\r\n          >\r\n            {editorValues.isConfirmed ? \"Unconfirm\" : \"Confirm\"}\r\n            <IonIcon\r\n              className=\"icon-right-of-checkbox\"\r\n              icon={checkmark}\r\n            />\r\n          </IonButton>\r\n        </IonCol>\r\n      </>\r\n    );\r\n  } else {\r\n    return (\r\n      <>\r\n        <IonCol size=\"3\">\r\n          <IonLabel className=\"label\">\r\n\r\n            Confirm</IonLabel>\r\n        </IonCol>\r\n        <IonCol size=\"3\">\r\n          <IonCheckbox\r\n            checked={editorValues.isConfirmed}\r\n            onClick={() => onCheckChange()}\r\n          />\r\n          <IonIcon\r\n            className=\"icon-right-of-checkbox\"\r\n            icon={checkmark}\r\n          />\r\n        </IonCol>\r\n      </>\r\n    );\r\n  }\r\n\r\n};\r\n\r\nexport default EventConfirmEditor;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { IonLabel, IonCheckbox, IonCol, IonIcon } from \"@ionic/react\";\r\nimport \"./EventStartEndEditor\";\r\nimport { AuthorizedItems } from \"../../../orbital-interfaces/AuthorizedItems\";\r\nimport { EditorValues, EditorReducerAction } from \"../EditEventModalState\";\r\nimport {EventType} from \"../../../enums\";\r\nimport { time } from \"ionicons/icons\";\r\n\r\ninterface EventIsClockedInEditorProps {\r\n  auth: AuthorizedItems;\r\n  editorValues: EditorValues;\r\n  update: React.Dispatch<EditorReducerAction>;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\n//\r\n// --------------------------------------------------------------------------------------\r\nconst EventIsClockedInEditor: React.FC<EventIsClockedInEditorProps> = ({\r\n  auth,\r\n  editorValues,\r\n  update,\r\n}: EventIsClockedInEditorProps) => {\r\n  const [isClockedIn, setIsClockedIn] = useState(false);\r\n  const [showIsClockedIn, setShowIsClockedIn] = useState(false);\r\n\r\n  // -----------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (editorValues.scheduleEventId === -1) {\r\n      return;\r\n    }\r\n\r\n    if (auth && auth.locations && auth.locations.length > 0) {\r\n      setIsClockedIn(editorValues.isClockedIn);\r\n    }\r\n\r\n    // eslint-disable-next-line\r\n  }, [\r\n    auth,\r\n    editorValues.eventStart,\r\n    editorValues.eventEnd,\r\n    editorValues.isClockedIn,\r\n    editorValues.scheduleEventId,\r\n  ]);\r\n\r\n  // -----------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (editorValues.scheduleEventId === -1) {\r\n      return;\r\n    }\r\n\r\n    setShowIsClockedIn(editorValues.eventType === EventType.Clock);\r\n  }, [\r\n    editorValues.eventType,\r\n    editorValues.eventStatus,\r\n    editorValues.scheduleEventId,\r\n  ]);\r\n\r\n  // -----------------------------------------------------------------------------------\r\n  const onCheckChange = (checked: boolean) => {\r\n    if (checked === isClockedIn || !showIsClockedIn) {\r\n      return;\r\n    }\r\n\r\n    setIsClockedIn(checked);\r\n    update({\r\n      type: \"ISCLOCKEDIN-UPDATED\",\r\n      isClockedIn: checked,\r\n    });\r\n  };\r\n\r\n  if (!showIsClockedIn) {\r\n    return <></>;\r\n  }\r\n\r\n  return (\r\n    <>\r\n\r\n      <IonCol size=\"3\">\r\n        <IonLabel className=\"label\">\r\n\r\n          Clocked In\r\n        </IonLabel>\r\n      </IonCol>\r\n\r\n      <IonCol size=\"3\" >\r\n        <IonCheckbox\r\n          checked={isClockedIn}\r\n          onIonChange={(e) => {\r\n            onCheckChange(e.detail.checked);\r\n          }}\r\n        />\r\n        <IonIcon\r\n          className=\"icon-right-of-checkbox\"\r\n          icon={time}\r\n        />\r\n      </IonCol>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default EventIsClockedInEditor;\r\n","import {ScheduleEvent} from \"../../orbital-interfaces/ScheduleEvent\";\r\nimport {authHelper, SelectedPosition} from \"../../util/authHelper\";\r\nimport {EventBreak} from \"../../orbital-interfaces/EventBreak\";\r\nimport {isAfter, isBefore, isEqual, parseISO, setHours, setMinutes,} from \"date-fns\";\r\nimport {timeHelper as th} from \"../../util/timeHelper\";\r\nimport {EventType, EventStatus, Role, RecurrenceType, AdminAuthorization, } from \"../../enums\";\r\nimport {AuthorizedItems, AuthorizedLocation, AuthorizedPosition,} from \"../../orbital-interfaces/AuthorizedItems\";\r\nimport {LocationSettings} from \"../../orbital-interfaces/LocationSettings\";\r\nimport {EventInformation} from \"../../orbital-interfaces/TEC\";\r\nimport {IdName} from \"../../orbital-interfaces/IdName\";\r\n\r\nexport interface EditorValues {\r\n  isFromEventInfo: boolean;\r\n  scheduleEventId: number;\r\n  locationId: number;\r\n  isUpdating: boolean;\r\n  eventType: EventType;\r\n  eventStatus: EventStatus;\r\n  isConfirmed: boolean;\r\n  position: SelectedPosition;\r\n  employee: IdName;\r\n  eventStart: string;\r\n  eventEnd: string;\r\n  tag: IdName;\r\n  eventBreaks: EventBreak[];\r\n  isClockedIn: boolean;\r\n  valid: boolean;\r\n  validEventStartEnd: boolean;\r\n  validEmployee: boolean;\r\n  validTag: boolean;\r\n  validEventTypeStatus: boolean;\r\n  validClockoutValue: boolean;\r\n  validRecurrenceStartEnd: boolean;\r\n  validRepeatInterval: boolean;\r\n  validRepeatWeekdays: boolean;\r\n  absentId?: number;\r\n  absentName?: string;\r\n  absentTimeMinutes: number | null;\r\n  notes: string;\r\n  clockoutValue?: string;\r\n  isReadonly: boolean;\r\n  recurrenceId?: number;\r\n  recurrenceStart?: string;\r\n  recurrenceEnd?: string;\r\n  recurrenceType?: RecurrenceType;\r\n  repeatInterval?: number;\r\n  repeatWeekdays?: string;\r\n  transferToEmployeeId: number | null;\r\n  transferToScheduleEventId: number | null;\r\n  transferFromScheduleEventId: number | null;\r\n}\r\n\r\nexport const INITIAL_EDITOR_VAUES: EditorValues = {\r\n  isFromEventInfo: false,\r\n  scheduleEventId: -1,\r\n  locationId: 0,\r\n  isUpdating: false,\r\n  eventType: EventType.Shift,\r\n  eventStatus: EventStatus.Approved,\r\n  isConfirmed: false,\r\n  position: {\r\n    location: {} as AuthorizedLocation,\r\n    position: {} as AuthorizedPosition,\r\n  },\r\n  employee: { id: -1, name: \"SELECT EMPLOYEE\" },\r\n  eventStart: th.convertTimeWithoutTimeZoneToLocalTime(th.formatDateTimeAsMvcString(setHours(setMinutes(new Date(), 0), 8))),\r\n  eventEnd: th.convertTimeWithoutTimeZoneToLocalTime(th.formatDateTimeAsMvcString(setHours(setMinutes(new Date(), 0), 17))),\r\n  tag: { id: -1, name: \"SELECT TAG\" },\r\n  eventBreaks: [] as EventBreak[],\r\n  isClockedIn: false,\r\n  valid: true,\r\n  validEventStartEnd: true,\r\n  validEmployee: true,\r\n  validTag: true,\r\n  validEventTypeStatus: true,\r\n  validClockoutValue: true,\r\n  validRecurrenceStartEnd: true,\r\n  validRepeatInterval: true,\r\n  validRepeatWeekdays: true,\r\n  absentId: undefined,\r\n  absentName: undefined,\r\n  absentTimeMinutes: null,\r\n  notes: \"\",\r\n  clockoutValue: undefined,\r\n  isReadonly: false,\r\n  transferToEmployeeId: null,\r\n  transferFromScheduleEventId: null,\r\n  transferToScheduleEventId: null\r\n};\r\n\r\nexport type EditorReducerAction =\r\n  | { type: \"LOADING\"; data: \"we're loading \" }\r\n  | {\r\n  type: \"BEGIN-UPDATE\";\r\n  auth: AuthorizedItems;\r\n  ev: ScheduleEvent;\r\n}\r\n  | { type: \"CANCEL\" }\r\n  | { type: \"CREATE-EVENT\"; auth: AuthorizedItems }\r\n  | {\r\n  type: \"TYPESTATUS-UPDATED\";\r\n  eventType: EventType;\r\n  eventStatus: EventStatus;\r\n  absentId?: number;\r\n  absentTimeMinutes: number | null;\r\n}\r\n  | { type: \"POSITION-UPDATED\"; selectedPosition: SelectedPosition }\r\n  | { type: \"EMPLOYEE-UPDATED\"; employee: IdName }\r\n  | { type: \"START-UPDATED\"; eventStart: string }\r\n  | { type: \"END-UPDATED\"; eventEnd: string }\r\n  | { type: \"EVENTBREAKS-UPDATED\"; breaks: EventBreak[] }\r\n  | { type: \"TAG-UPDATED\"; tag: IdName }\r\n  | { type: \"CONFIRM-UPDATED\"; isConfirmed: boolean }\r\n  | { type: \"ISCLOCKEDIN-UPDATED\"; isClockedIn: boolean }\r\n  | { type: \"NOTES-UPDATED\"; notes: string }\r\n  | {\r\n  type: \"CLOCKOUTVALUE-UPDATED\";\r\n  clockoutValue?: string;\r\n  locSettings: LocationSettings;\r\n}\r\n  | { type: \"TRANSFERTO-EMPLOYEE-UPDATED\"; transferToEmployeeId: number | null}\r\n  | { type: \"SET-READONLY\"; isReadonly: boolean }\r\n  | {\r\n  type: \"REPEATING-UPDATED\";\r\n  recurrenceStart?: string;\r\n  recurrenceEnd?: string;\r\n  recurrenceType?: RecurrenceType;\r\n  repeatInterval?: number;\r\n  repeatWeekDays?: string;\r\n};\r\n\r\n// ------------------------------------------------------------------------------------------\r\nexport function getEditorValuesFromEventInformation(\r\n  auth: AuthorizedItems,\r\n  ev: EventInformation\r\n): EditorValues {\r\n  return {\r\n    ...INITIAL_EDITOR_VAUES,\r\n    isFromEventInfo: true,\r\n    eventStatus: ev.EventStatusId,\r\n    eventType: ev.EventTypeId,\r\n    eventStart: ev.EventStart,\r\n    eventEnd: ev.EventEnd,\r\n    notes: ev.Notes,\r\n    isClockedIn: ev.IsClockedIn,\r\n    isConfirmed: ev.IsConfirmed,\r\n    scheduleEventId: ev.ScheduleEventId,\r\n    position: authHelper.getSelectedPositionWithLocId(\r\n      auth.locations,\r\n      ev.LocationId,\r\n      ev.PositionId\r\n    ),\r\n    employee: { id: ev.EmployeeId, name: ev.FirstName + \" \" + ev.LastName },\r\n    eventBreaks: ev.EventBreaks,\r\n  };\r\n}\r\n\r\n// ------------------------------------------------------------------------------------------\r\nexport function getEditorValuesFromScheduleEvent(\r\n  auth: AuthorizedItems,\r\n  ev: ScheduleEvent) {\r\n  const isClockedIn = getIsClockedIn(ev);\r\n\r\n  const editorValues = {\r\n    isFromEventInfo: false,\r\n    scheduleEventId: ev.ScheduleEventId,\r\n    locationId: ev.LocationId,\r\n    isUpdating: false,\r\n    eventType: ev.EventTypeId,\r\n    eventStatus: ev.EventStatusId,\r\n    isConfirmed: ev.ConfirmedBy !== undefined && ev.ConfirmedBy !== null,\r\n    position: {\r\n      location: getLocationById(auth, ev.LocationId),\r\n      position: getPositionById(auth, ev.PositionId),\r\n    },\r\n    employee: { id: ev.EmployeeId, name: ev.FirstName + \" \" + ev.LastName },\r\n    eventStart: ev.EventStart,\r\n    eventEnd: isClockedIn\r\n      ? th.formatDateTimeAsMvcString(new Date())\r\n      : ev.EventEnd,\r\n    tag: { id: ev.TagId ? ev!.TagId : -1, name: \"\" },\r\n    eventBreaks: ev.EventBreaks,\r\n    isClockedIn: isClockedIn,\r\n    valid: true,\r\n    validEventStartEnd: true,\r\n    validEmployee: true,\r\n    validTag: true,\r\n    validEventTypeStatus: true,\r\n    validClockoutValue: true,\r\n    absentName: ev.AbsentName,\r\n    absentId: ev.AbsentId,\r\n    absentTimeMinutes: ev.AbsentTimeMinutes !== null && ev.AbsentTimeMinutes !== undefined\r\n      ? ev!.AbsentTimeMinutes\r\n      : null,\r\n    notes: ev.Notes,\r\n    clockoutValue: ev.ClockOutValue,\r\n    isReadonly: isReadonly(auth, ev),\r\n    recurrenceId: ev.EventRecurrenceId,\r\n    recurrenceStart: ev.EventRecurrenceStart,\r\n    recurrenceEnd: ev.EventRecurrenceEnd,\r\n    recurrenceType: ev.RepeatType,\r\n    repeatInterval: ev.RepeatInterval,\r\n    repeatWeekdays: ev.RepeatWeekdays,\r\n    validRecurrenceStartEnd: true,\r\n    validRepeatInterval: true,\r\n    validRepeatWeekdays: true,\r\n    transferToEmployeeId: null,\r\n    transferFromScheduleEventId: ev.EventTransfer_ScheduleEventId_From,\r\n    transferToScheduleEventId: ev.EventTransfer_ScheduleEventId_To\r\n  };\r\n\r\n  // If this is a Cover-Approved or Shift-Approved that was transferred from a\r\n  // cover-request, and the person viewing it is an admin, then set the view of it to\r\n  // read-only which will allow them to undo the cover before changing it.\r\n  if ((editorValues.transferFromScheduleEventId !== null || editorValues.transferToScheduleEventId !== null) &&\r\n      editorValues.eventStatus === EventStatus.Approved &&\r\n      (editorValues.eventType === EventType.Shift || editorValues.eventType === EventType.Cover) &&\r\n      authHelper.isAdminForThisEvent(editorValues, auth)) {\r\n    editorValues.isReadonly = true;\r\n  }\r\n\r\n  return editorValues;\r\n}\r\n\r\n// ------------------------------------------------------------------------------------------\r\nfunction getLocationById(auth: AuthorizedItems, locId: number) {\r\n  return auth.locations.filter((l) => l.id === locId)[0];\r\n}\r\n\r\n// ------------------------------------------------------------------------------------------\r\nfunction getPositionById(auth: AuthorizedItems, posId: number) {\r\n  return auth.locations.flatMap((l) =>\r\n    l.departments.flatMap((d) => d.positions.filter((p) => p.id === posId))\r\n  )[0];\r\n}\r\n\r\n// ------------------------------------------------------------------------------------------\r\nfunction getValidStartEnd(startStr: string, endStr: string) {\r\n  const start = parseISO(startStr);\r\n  const end = parseISO(endStr);\r\n\r\n  if (isEqual(start, end)) {\r\n    return true;\r\n  }\r\n\r\n  return isAfter(end, start);\r\n}\r\n\r\n// ------------------------------------------------------------------------------------------\r\nfunction isReadonly(auth: AuthorizedItems, ev: ScheduleEvent) {\r\n  if (ev.ScheduleEventId <= 0) {\r\n    return false;\r\n  }\r\n\r\n  if (auth.role === Role.Employee) {\r\n    if (ev.EmployeeId !== auth.employeeId) {\r\n      return true;\r\n    }\r\n\r\n    if (ev.EventStatusId === EventStatus.Request) {\r\n      return (ev.EventTypeId === EventType.Cover);\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  if (auth.role === Role.BusinessAdmin || auth.role === Role.LocationAdmin) {\r\n    return false;\r\n  }\r\n\r\n  return !authHelper.isAdminAuthorizedFor(\r\n    auth,\r\n    ev.LocationId,\r\n    ev.DepartmentId,\r\n    AdminAuthorization.CanEditSchedules);\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\n// Used to set the inital start and end time when creating a new event\r\nfunction getDateWithTimeSpan(date: Date, ts: string): Date {\r\n  const hours = th.getHoursFromTimeSpan(ts);\r\n  const minutes = th.getMinutesFromTimeSpan(ts);\r\n  return setMinutes(setHours(date, hours), minutes);\r\n}\r\n\r\n// ------------------------------------------------------------------------------------------------\r\n// Generates EditorValues when creating a new event (clicking the plus button on Schedule page)\r\nfunction createInitialEditorValuesForNewEvent(auth: AuthorizedItems): EditorValues {\r\n  const loc = auth.locations[0];\r\n  const locSettings = loc.settings;\r\n  const now = new Date();\r\n  const eventStart = th.convertTimeWithoutTimeZoneToLocalTime(\r\n    (th.formatDateTimeAsMvcString(getDateWithTimeSpan(now, locSettings.NewEventDefaultStartTime))));\r\n  const eventEnd = th.convertTimeWithoutTimeZoneToLocalTime(\r\n    (th.formatDateTimeAsMvcString(getDateWithTimeSpan(now, locSettings.NewEventDefaultEndTime))));\r\n\r\n  return {\r\n    ...INITIAL_EDITOR_VAUES,\r\n    eventStart,\r\n    eventEnd,\r\n    employee: { id: auth.employeeId, name: auth.fullName},\r\n    position: {\r\n      location: loc,\r\n      position: loc.departments[0].positions[0],\r\n    },\r\n    scheduleEventId: 0,\r\n  };\r\n}\r\n\r\n// ------------------------------------------------------------------------------------------------\r\nfunction isClockoutValueValid(state: EditorValues, locSettings: LocationSettings,  val?: string) {\r\n  if (!val) {\r\n    return true;\r\n  }\r\n\r\n  // clockout values are not enabled\r\n  if (\r\n    !locSettings.ClockOutValueLabel ||\r\n    locSettings.ClockOutValueLabel.length === 0\r\n  ) {\r\n    return false;\r\n  }\r\n\r\n  const regEx = /^\\d*(\\.\\d{0,2})?$/;\r\n  return regEx.test(val);\r\n}\r\n\r\n// ------------------------------------------------------------------------------------------------\r\nfunction isAllValid(v: EditorValues): boolean {\r\n  return (\r\n    v.validEventStartEnd &&\r\n    v.validEmployee &&\r\n    v.validTag &&\r\n    v.validEventTypeStatus &&\r\n    v.validClockoutValue &&\r\n    v.validRecurrenceStartEnd &&\r\n    v.validRepeatInterval &&\r\n    v.validRepeatWeekdays\r\n  );\r\n}\r\n\r\n// ------------------------------------------------------------------------------------------------\r\nfunction getIsClockedIn(ev: ScheduleEvent) {\r\n  const end = parseISO(ev.EventEnd);\r\n  return end > new Date(2199, 1, 1);\r\n}\r\n\r\n// ------------------------------------------------------------------------------------------------\r\n//\r\n// ------------------------------------------------------------------------------------------------\r\nexport const editorValueReducer = (\r\n  currentState: EditorValues,\r\n  action: EditorReducerAction\r\n): EditorValues => {\r\n  console.log(\"EDITEVENT REDUCER: ACTION =\", action.type,);\r\n  switch (action.type) {\r\n    // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n    case \"BEGIN-UPDATE\":\r\n      const { ev, auth } = action;\r\n      return getEditorValuesFromScheduleEvent(auth, ev);\r\n\r\n    // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n    case \"CANCEL\":\r\n      return INITIAL_EDITOR_VAUES;\r\n\r\n    // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n    case \"POSITION-UPDATED\":\r\n      const { selectedPosition } = action;\r\n      return {\r\n        ...currentState,\r\n        position: selectedPosition,\r\n      };\r\n\r\n    // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n    case \"CREATE-EVENT\":\r\n      return createInitialEditorValuesForNewEvent(action.auth);\r\n\r\n    // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n    case \"SET-READONLY\":\r\n      return {\r\n        ...currentState,\r\n        isReadonly: action.isReadonly,\r\n      };\r\n\r\n    // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n    case \"TYPESTATUS-UPDATED\":\r\n      const clockedInOnTypeStatusUpdate = currentState.isClockedIn &&\r\n        action.eventType === EventType.Clock &&\r\n        action.eventStatus === EventStatus.Approved;\r\n\r\n      const newTypeStatusState = {\r\n        ...currentState,\r\n        eventType: action.eventType,\r\n        eventStatus: action.eventStatus,\r\n        absentId: action.absentId,\r\n        absentTimeMinutes: action.absentTimeMinutes,\r\n        isClockedIn: clockedInOnTypeStatusUpdate,\r\n        validEventTypeStatus: !(\r\n          action.absentId && action.absentTimeMinutes === null\r\n        ),\r\n      };\r\n\r\n      newTypeStatusState.valid = isAllValid(newTypeStatusState);\r\n      return newTypeStatusState;\r\n\r\n    // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n    case \"CLOCKOUTVALUE-UPDATED\":\r\n      const newClockoutValueState = {\r\n        ...currentState,\r\n        clockoutValue: action.clockoutValue,\r\n        validClockoutValue: isClockoutValueValid(\r\n          currentState,\r\n          action.locSettings,\r\n          action.clockoutValue\r\n        ),\r\n      };\r\n\r\n      newClockoutValueState.valid = isAllValid(newClockoutValueState);\r\n      return newClockoutValueState;\r\n\r\n    // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n    case \"EMPLOYEE-UPDATED\":\r\n      const newState = {\r\n        ...currentState,\r\n        employee: action.employee,\r\n        validEmployee: action.employee.id > 0,\r\n      };\r\n\r\n      newState.valid = isAllValid(newState);\r\n      return newState;\r\n\r\n    // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n    case \"START-UPDATED\":\r\n      const newStartState = {\r\n        ...currentState,\r\n        eventStart: action.eventStart,\r\n        validEventStartEnd: getValidStartEnd(\r\n          action.eventStart,\r\n          currentState.eventEnd\r\n        ),\r\n      };\r\n\r\n      newStartState.valid = isAllValid(newStartState);\r\n      return newStartState;\r\n\r\n    // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n    case \"END-UPDATED\":\r\n      const newEndState = {\r\n        ...currentState,\r\n        eventEnd: action.eventEnd,\r\n        validEventStartEnd: getValidStartEnd(\r\n          currentState.eventStart,\r\n          action.eventEnd\r\n        ),\r\n      };\r\n\r\n      newEndState.valid = isAllValid(newEndState);\r\n      return newEndState;\r\n\r\n    // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n    case \"EVENTBREAKS-UPDATED\":\r\n      return {\r\n        ...currentState,\r\n        eventBreaks: action.breaks,\r\n      };\r\n\r\n    // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n    case \"TAG-UPDATED\":\r\n      const newTagState = {\r\n        ...currentState,\r\n        tag: action.tag,\r\n        validTag: true,\r\n      };\r\n\r\n      newTagState.valid = isAllValid(newTagState);\r\n      return newTagState;\r\n\r\n    case \"CONFIRM-UPDATED\":\r\n      const newConfirmState = {\r\n        ...currentState,\r\n        isConfirmed: action.isConfirmed,\r\n      };\r\n\r\n      newConfirmState.valid = isAllValid(newConfirmState);\r\n      return newConfirmState;\r\n\r\n    case \"NOTES-UPDATED\":\r\n      return {\r\n        ...currentState,\r\n        notes: action.notes,\r\n      };\r\n\r\n    case \"ISCLOCKEDIN-UPDATED\":\r\n      const newClockedInState = {\r\n        ...currentState,\r\n        isClockedIn: action.isClockedIn,\r\n      };\r\n\r\n      if (action.isClockedIn) {\r\n        newClockedInState.eventEnd =\r\n          th.convertTimeWithoutTimeZoneToLocalTime(th.formatDateTimeAsMvcString(new Date()));\r\n      }\r\n\r\n      newClockedInState.valid = isAllValid(newClockedInState);\r\n      return newClockedInState;\r\n\r\n    case \"TRANSFERTO-EMPLOYEE-UPDATED\":\r\n      const newTransferToState = {\r\n        ...currentState,\r\n        transferToEmployeeId: action.transferToEmployeeId,\r\n      }\r\n\r\n      if (action.transferToEmployeeId !== null) {\r\n        newTransferToState.eventStatus = EventStatus.Approved;\r\n      }\r\n\r\n      newTransferToState.valid = isAllValid(newTransferToState);\r\n      return newTransferToState;\r\n\r\n    case \"REPEATING-UPDATED\":\r\n      const newRepeatState = {\r\n        ...currentState,\r\n        recurrenceStart: action.recurrenceStart,\r\n        recurrenceEnd: action.recurrenceEnd,\r\n        recurrenceType: action.recurrenceType,\r\n        repeatInterval: action.repeatInterval,\r\n        repeatWeekdays: action.repeatWeekDays,\r\n      };\r\n\r\n      if (newRepeatState.recurrenceStart) {\r\n        if (newRepeatState.repeatInterval === RecurrenceType.Weekly) {\r\n          newRepeatState.validRepeatWeekdays =\r\n            newRepeatState.repeatWeekdays !== null &&\r\n            newRepeatState.repeatWeekdays !== undefined &&\r\n            newRepeatState.repeatWeekdays.length > 0;\r\n        } else {\r\n          newRepeatState.repeatWeekdays = undefined;\r\n          newRepeatState.validRepeatWeekdays = true;\r\n        }\r\n\r\n        if (!newRepeatState.recurrenceEnd) {\r\n          newRepeatState.validRecurrenceStartEnd = false;\r\n        } else {\r\n          newRepeatState.validRecurrenceStartEnd = isBefore(\r\n            parseISO(newRepeatState.recurrenceStart),\r\n            parseISO(newRepeatState.recurrenceEnd)\r\n          );\r\n        }\r\n\r\n        newRepeatState.validRepeatInterval =\r\n          newRepeatState.repeatInterval !== null &&\r\n          newRepeatState.repeatInterval !== undefined &&\r\n          newRepeatState.repeatInterval > 0;\r\n      }\r\n\r\n      newRepeatState.valid = isAllValid(newRepeatState);\r\n      return newRepeatState;\r\n\r\n    // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n    default:\r\n      console.error(\r\n        \"ERROR in editorValueReducer, could not find action for \" + action.type\r\n      );\r\n      return currentState;\r\n  }\r\n};\r\n","import { ApplicationUser } from \"../context/ApplicationUserContext\";\r\nimport apiHelper from \"./orbitalApiHelper\";\r\nimport {EventType, EventStatus, RecurrenceUpdateType} from \"../enums\";\r\nimport {ApiErrorResult} from \"../orbital-interfaces/ApiErrorResult\";\r\n\r\nexport interface CoverListItem {\r\n  value: number;\r\n  text: string;\r\n  disabled: boolean;\r\n  style: string | null;\r\n}\r\n\r\ninterface DeleteEventModel {\r\n  LocationId: number;\r\n  ScheduleEventId: number;\r\n  EventTypeId: EventType;\r\n  EventStatusId: EventStatus;\r\n  RecUpdateType?: RecurrenceUpdateType;\r\n}\r\n\r\ninterface CoverRequestModel {\r\n  ScheduleEventId: number;\r\n  LocationId: number;\r\n  BusinessId: number;\r\n  BroadcastCoverRequestMessage: boolean;\r\n  CoverMessage: string;\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function undoCoverRequest(\r\n  user: ApplicationUser,\r\n  scheduleEventId: number\r\n) {\r\n  // eslint-disable-next-line max-len\r\n  const url = `api/v1/employee/schedule-events/cover-request/undo?scheduleEventId=${scheduleEventId}`;\r\n  return await apiHelper.put(user, url);\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function createCoverRequest(\r\n  user: ApplicationUser,\r\n  scheduleEventId: number,\r\n  locationId: number,\r\n  businessId: number,\r\n  broadCastMessage: boolean,\r\n  coverMessage: string,\r\n  toEmployeeId: number | null\r\n) {\r\n  const url = \"api/v1/employee/schedule-events/cover-request/submit\";\r\n  const data = {\r\n    ScheduleEventId: scheduleEventId,\r\n    LocationId: locationId,\r\n    BusinessId: businessId,\r\n    BroadcastCoverRequestMessage: broadCastMessage,\r\n    CoverMessage: coverMessage,\r\n    DirectToEmployeeId: toEmployeeId,\r\n  } as CoverRequestModel;\r\n\r\n  return await apiHelper.put(user, url, data);\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function makeShiftRequest(\r\n  user: ApplicationUser,\r\n  scheduleEventId: number,\r\n  locationId: number,\r\n  businessId: number,\r\n  broadCastMessage: boolean,\r\n  coverMessage: string\r\n) {\r\n  const url = \"api/v2/requests/shift-request/submit\";\r\n  const data = {\r\n    ScheduleEventId: scheduleEventId,\r\n    LocationId: locationId,\r\n    BusinessId: businessId,\r\n    BroadcastCoverRequestMessage: broadCastMessage,\r\n    CoverMessage: coverMessage,\r\n  } as CoverRequestModel;\r\n\r\n  return (await apiHelper.put(user, url, data)) as ApiErrorResult;\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function removeShiftRequest(\r\n  user: ApplicationUser,\r\n  locationId: number,\r\n  scheduleEventId: number,\r\n  eventType: EventType,\r\n  eventStatus: EventStatus,\r\n  recUpdateType?: RecurrenceUpdateType\r\n) {\r\n  const url = \"api/v1/employee/schedule-events/delete\";\r\n  const data = {\r\n    LocationId: locationId,\r\n    ScheduleEventId: scheduleEventId,\r\n    EventTypeId: eventType,\r\n    EventStatusId: eventStatus,\r\n    RecUpdateType: recUpdateType,\r\n  } as DeleteEventModel;\r\n\r\n  return await apiHelper.post(user, url, data);\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function approveShiftRequest(\r\n  user: ApplicationUser,\r\n  msgId: number\r\n) {\r\n  const url = \"api/v2/requests/shift-request/approve\";\r\n  const data = { msgId };\r\n\r\n  return await apiHelper.post(user, url, data) as ApiErrorResult;\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function deleteEvent(\r\n  user: ApplicationUser,\r\n  locationId: number,\r\n  scheduleEventId: number,\r\n  eventType: EventType,\r\n  eventStatus: EventStatus,\r\n  recUpdateType?: RecurrenceUpdateType\r\n) {\r\n  const url = \"api/v1/employee/schedule-events/delete\";\r\n  const data = {\r\n    LocationId: locationId,\r\n    ScheduleEventId: scheduleEventId,\r\n    EventTypeId: eventType,\r\n    EventStatusId: eventStatus,\r\n    RecUpdateType: recUpdateType,\r\n  } as DeleteEventModel;\r\n\r\n  return await apiHelper.post(user, url, data);\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function getCoverRequestListItems(\r\n  user: ApplicationUser,\r\n  scheduleEventId: number,\r\n  isDirectCoverList: boolean\r\n) {\r\n  const url = \"api/v2/requests/transfers/to-list\";\r\n\r\n  const data = {\r\n    scheduleEventId,\r\n    directCoverList: isDirectCoverList,\r\n  };\r\n\r\n  return (await apiHelper.post(user, url, data)) as CoverListItem[];\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function transferCoverToEmployee(\r\n  user: ApplicationUser,\r\n  transferToEmployeeId: number,\r\n  coverRequestEventId: number\r\n) {\r\n  const url = \"api/v2/requests/transfers/transfer\";\r\n  const data = {\r\n    transferToEmployeeId,\r\n    coverRequestEventId\r\n  };\r\n\r\n  return await(apiHelper.post(user, url, data)) as ApiErrorResult;\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function undoCoverApproved(user: ApplicationUser, scheduleEventId: number) {\r\n  const url = \"api/v2/requests/undo-cover\";\r\n  const data = { scheduleEventId };\r\n\r\n  return await(apiHelper.post(user, url, data)) as ApiErrorResult;\r\n}\r\n\r\nexport const requestsApi = {\r\n  approveShiftRequest,\r\n  undoCoverRequest,\r\n  createCoverRequest,\r\n  makeShiftRequest,\r\n  removeShiftRequest,\r\n  deleteEvent,\r\n  getCoverRequestListItems,\r\n  transferCoverToEmployee,\r\n  undoCoverApproved\r\n};\r\n","import React, {useContext, useState} from \"react\";\r\nimport {IonButton, IonModal} from \"@ionic/react\";\r\nimport \"../../../global-styles.scss\";\r\nimport {AuthorizedItems} from \"../../../orbital-interfaces/AuthorizedItems\";\r\nimport {EditorReducerAction, EditorValues} from \"../EditEventModalState\";\r\nimport {authHelper} from \"../../../util/authHelper\";\r\nimport {requestsApi} from \"../../../api/requestsApi\";\r\nimport {ApplicationUserContext} from \"../../../context/ApplicationUserContext\";\r\nimport useDialogBox from \"../../../hooks/useDialogBox\";\r\nimport {EventType, EventStatus} from \"../../../enums\";\r\nimport EventRequestModalEx from \"./EventRequestModalEx\";\r\nimport {useShowLoading} from \"../../../hooks/useShowLoading\";\r\n\r\ninterface EventRequestEditorProps {\r\n  auth: AuthorizedItems;\r\n  update: React.Dispatch<EditorReducerAction>;\r\n  cancelEditModal: (message: string) => void;\r\n  editorValues: EditorValues;\r\n  messageId?: number | undefined;\r\n}\r\n\r\nexport enum EventRequestEnum {\r\n  None,\r\n  UndoCoverRequest,\r\n  CreateShiftRequest,\r\n  DeleteRequest,\r\n  CreateCoverRequest,\r\n  ApproveShiftRequest,\r\n  UndoCover\r\n}\r\n\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction getEventRequestType(ev: EditorValues, auth: AuthorizedItems): EventRequestEnum {\r\n  const isAdmin = authHelper.isAdminForThisEvent(ev, auth);\r\n\r\n  if (ev.scheduleEventId <= 0) {\r\n    return EventRequestEnum.None;\r\n  }\r\n\r\n  if ((ev.transferToScheduleEventId !== null || ev.transferFromScheduleEventId !== null) &&\r\n      ev.eventStatus === EventStatus.Approved &&\r\n      (ev.eventType === EventType.Cover || ev.eventType === EventType.Shift)) {\r\n    if (isAdmin) {\r\n      return EventRequestEnum.UndoCover;\r\n    }\r\n  }\r\n\r\n  // For Cover-Requests\r\n  if (ev.eventType === EventType.Cover && ev.eventStatus === EventStatus.Request)  {\r\n    if (ev.employee.id === auth.employeeId) {\r\n      return isAdmin ? EventRequestEnum.None :  EventRequestEnum.UndoCoverRequest;\r\n    }\r\n\r\n    if (authHelper.hasPosition(auth, ev.position.position.id)) {\r\n      return EventRequestEnum.CreateShiftRequest;\r\n    }\r\n\r\n    return EventRequestEnum.None;\r\n  }\r\n\r\n  // For Shift-Requests\r\n  if (ev.eventType === EventType.Shift && ev.eventStatus === EventStatus.Request) {\r\n    if (isAdmin) {\r\n      return EventRequestEnum.ApproveShiftRequest;\r\n    }\r\n\r\n    if (ev.employee.id === auth.employeeId) {\r\n      return EventRequestEnum.DeleteRequest;\r\n    }\r\n  }\r\n\r\n\r\n  // For Shift-Approveds\r\n  if (ev.eventType === EventType.Shift &&\r\n      ev.eventStatus === EventStatus.Approved &&\r\n      ev.employee.id === auth.employeeId) {\r\n    return EventRequestEnum.CreateCoverRequest;\r\n  }\r\n\r\n  return EventRequestEnum.None;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction getButtonText(ev: EditorValues, auth: AuthorizedItems) {\r\n  const isAdmin = authHelper.isAdminForThisEvent(ev, auth);\r\n\r\n  if (ev.eventStatus === EventStatus.Approved && (ev.eventType === EventType.Cover || ev.eventType === EventType.Shift) &&\r\n    (ev.transferFromScheduleEventId !== null || ev.transferToScheduleEventId !== null) && isAdmin) {\r\n    return \"Undo Cover-Approved\";\r\n  }\r\n\r\n  if (ev.eventType === EventType.Shift && ev.eventStatus === EventStatus.Approved) {\r\n    return \"Create Cover-Request\";\r\n  }\r\n\r\n  if (ev.eventType === EventType.Shift && ev.eventStatus === EventStatus.Request) {\r\n    if (isAdmin) {\r\n      return \"Approve Shift-Request\";\r\n\r\n    }\r\n    if (ev.employee.id === auth.employeeId) {\r\n      return \"Delete Shift-Request\";\r\n    }\r\n  }\r\n\r\n  if (ev.eventType === EventType.Cover && ev.eventStatus === EventStatus.Request) {\r\n    if (ev.employee.id === auth.employeeId) {\r\n      return \"Undo Cover-Request\";\r\n    } else {\r\n      return \"Make Shift-Request\";\r\n    }\r\n  }\r\n\r\n\r\n  return \"UNKNOWN\";\r\n}\r\n\r\n\r\n// --------------------------------------------------------------------------------------\r\n//\r\n// --------------------------------------------------------------------------------------\r\nconst EventRequestEditorEx: React.FC<EventRequestEditorProps> = ({\r\n  auth,\r\n  cancelEditModal,\r\n  editorValues,\r\n  messageId\r\n}: EventRequestEditorProps) => {\r\n  const { user } = useContext(ApplicationUserContext);\r\n  const [showRequestModal, setShowRequestModal] = useState(false);\r\n  const dlg = useDialogBox();\r\n  const loading = useShowLoading(\"Please wait...\");\r\n\r\n  const requestType = getEventRequestType(editorValues, auth);\r\n  const buttonText = getButtonText(editorValues, auth);\r\n  const onComplete = (message: string) => {\r\n    setShowRequestModal(false);\r\n    cancelEditModal(message);\r\n  };\r\n\r\n  // -----------------------------------------------------------------------------------\r\n  const onApply = (employeeId: number | null, notes: string, sendMessage: boolean) => {\r\n    loading.setShowLoading(true);\r\n    switch (requestType) {\r\n      case EventRequestEnum.CreateCoverRequest:\r\n        requestsApi\r\n          .createCoverRequest(\r\n            user,\r\n            editorValues.scheduleEventId,\r\n            editorValues.locationId,\r\n            0,\r\n            sendMessage,\r\n            notes,\r\n            employeeId\r\n          )\r\n          .then(() => {\r\n            loading.setShowLoading(false);\r\n            onComplete(\"Cover-Request Created\");\r\n          });\r\n        break;\r\n\r\n      case EventRequestEnum.CreateShiftRequest:\r\n        requestsApi\r\n          .makeShiftRequest(\r\n            user,\r\n            editorValues.scheduleEventId,\r\n            editorValues.locationId,\r\n            0,\r\n            sendMessage,\r\n            notes\r\n          )\r\n          .then((results) => {\r\n            loading.setShowLoading(false);\r\n            if (results.error) {\r\n              dlg.showAlert(\"Shift-Request Failed\", results.message, () => {});\r\n            } else {\r\n              onComplete(results.message); // \"Shift-Request Created\"\r\n            }\r\n          });\r\n        break;\r\n\r\n      case EventRequestEnum.DeleteRequest:\r\n        requestsApi\r\n          .removeShiftRequest(\r\n            user,\r\n            editorValues.locationId,\r\n            editorValues.scheduleEventId,\r\n            editorValues.eventType,\r\n            editorValues.eventStatus,\r\n            undefined\r\n          )\r\n          .then(() => {\r\n            loading.setShowLoading(false);\r\n            onComplete(\"Shift-Request Removed\");\r\n          });\r\n        break;\r\n\r\n      case EventRequestEnum.UndoCoverRequest:\r\n        requestsApi.undoCoverRequest(user, editorValues.scheduleEventId).then(() => {\r\n          loading.setShowLoading(false);\r\n          onComplete(\"Removed Cover-Request\");\r\n        });\r\n        break;\r\n\r\n      case EventRequestEnum.ApproveShiftRequest:\r\n        if (messageId === null || messageId === undefined) {\r\n          break;\r\n        }\r\n\r\n        requestsApi.approveShiftRequest(user, messageId).then(res => {\r\n          loading.setShowLoading(false);\r\n          if (res.error) {\r\n            dlg.showAlert(\"Could not approve\", res.message, () => {});\r\n          } else {\r\n            onComplete(\"Approved\");\r\n          }\r\n        });\r\n\r\n        break;\r\n\r\n      case EventRequestEnum.UndoCover:\r\n        requestsApi.undoCoverApproved(user, editorValues.scheduleEventId).then(res => {\r\n          loading.setShowLoading(false);\r\n          if (res.error) {\r\n            dlg.showAlert(\"Could not undo Cover\", res.message, () => {});\r\n          } else {\r\n            onComplete(\"Cover Undone\");\r\n          }\r\n        });\r\n\r\n        break;\r\n    }\r\n  };\r\n\r\n  if (!authHelper.isAuthItemsValid(auth) || requestType === EventRequestEnum.None) {\r\n    return <></>;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <IonButton\r\n        className=\"apply-button\"\r\n        expand=\"block\"\r\n        onClick={() => {\r\n          setShowRequestModal(true);\r\n        }}\r\n      >\r\n        {buttonText}\r\n      </IonButton>\r\n\r\n      <IonModal\r\n        isOpen={showRequestModal}\r\n        cssClass=\"mini-modal event-request-modal\"\r\n        onDidDismiss={() => setShowRequestModal(false)}\r\n      >\r\n        <EventRequestModalEx\r\n          onCancel={() => {\r\n            setShowRequestModal(false);\r\n          }}\r\n          onOk={onApply}\r\n          editorValues={editorValues}\r\n          eventRequestType={requestType}\r\n          buttonText={buttonText}\r\n        />\r\n        {dlg.alertBoxJsx}\r\n        {loading.showLoadingJsx}\r\n      </IonModal>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default EventRequestEditorEx;\r\n","import React from \"react\";\r\nimport { IonLabel, IonTextarea, IonCol, IonRow } from \"@ionic/react\";\r\nimport \"../../../global-styles.scss\";\r\nimport \"./EventStartEndEditor\";\r\nimport { AuthorizedItems } from \"../../../orbital-interfaces/AuthorizedItems\";\r\nimport { EditorValues, EditorReducerAction } from \"../EditEventModalState\";\r\n\r\ninterface EventNotesEditorProps {\r\n  auth: AuthorizedItems;\r\n  editorValues: EditorValues;\r\n  update: React.Dispatch<EditorReducerAction>;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst EventNotesEditor: React.FC<EventNotesEditorProps> = ({\r\n  editorValues,\r\n  update,\r\n}: EventNotesEditorProps) => {\r\n  const onNotesUpdate = (newNote?: string | null) => {\r\n    if (!newNote) {\r\n      newNote = \"\";\r\n    }\r\n\r\n    if (newNote !== editorValues.notes) {\r\n      update({ type: \"NOTES-UPDATED\", notes: newNote });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <IonRow>\r\n        <IonCol size=\"3\">\r\n          <IonLabel className=\"label\">Notes</IonLabel>\r\n        </IonCol>\r\n        <IonCol size=\"9\">\r\n          <IonTextarea\r\n            className=\"textarea\"\r\n            placeholder=\"Enter event note\"\r\n            maxlength={120}\r\n            spellcheck={true}\r\n            rows={4}\r\n            value={editorValues.notes}\r\n            disabled={editorValues.isReadonly || editorValues.isConfirmed}\r\n            onIonChange={(e) => onNotesUpdate(e.detail.value)}\r\n          />\r\n        </IonCol>\r\n      </IonRow>\r\n      <div className=\"character-counter\">{editorValues.notes?.length ?? 0}/120</div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EventNotesEditor;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { IonLabel, IonCol, IonRow, IonInput } from \"@ionic/react\";\r\nimport \"./EventStartEndEditor\";\r\nimport {AuthorizedItems} from \"../../../orbital-interfaces/AuthorizedItems\";\r\nimport {LocationSettings} from \"../../../orbital-interfaces/LocationSettings\";\r\nimport { EditorValues, EditorReducerAction } from \"../EditEventModalState\";\r\nimport {authHelper} from \"../../../util/authHelper\";\r\nimport {EventType} from \"../../../enums\";\r\n\r\ninterface EventClockoutValueEditorProps {\r\n  auth: AuthorizedItems;\r\n  editorValues: EditorValues;\r\n  update: React.Dispatch<EditorReducerAction>;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst EventClockoutValueEditor: React.FC<EventClockoutValueEditorProps> = ({\r\n  auth,\r\n  editorValues,\r\n  update,\r\n}: EventClockoutValueEditorProps) => {\r\n  const [isVisible, setIsVisible] = useState(false);\r\n  const [locSettings, setLocSettings] = useState(\r\n    null as LocationSettings | null\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (\r\n      editorValues.locationId === 0 ||\r\n      (locSettings && editorValues.locationId === locSettings.LocationId)\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    if (!auth || !auth.locations || auth.locations.length === 0) {\r\n      return;\r\n    }\r\n\r\n    if (!editorValues.locationId) {\r\n      return;\r\n    }\r\n\r\n    const newLocSettings = authHelper.getLocSettingsForLocationId(\r\n      auth,\r\n      editorValues.locationId\r\n    );\r\n    setLocSettings(newLocSettings);\r\n    // eslint-disable-next-line\r\n  }, [editorValues.locationId, auth]);\r\n\r\n  useEffect(() => {\r\n    if (!locSettings) {\r\n      return;\r\n    }\r\n\r\n    setIsVisible(\r\n      locSettings!.ClockOutValueLabel !== undefined &&\r\n        locSettings!.ClockOutValueLabel !== null &&\r\n        locSettings!.ClockOutValueLabel.length > 0 &&\r\n        editorValues.eventType === EventType.Clock &&\r\n        !editorValues.isClockedIn\r\n    );\r\n  }, [editorValues.eventType, editorValues.isClockedIn, locSettings]);\r\n\r\n  const onClockoutValueUpdated = (newValue?: string | null) => {\r\n    if (newValue === null) {\r\n      newValue = undefined;\r\n    }\r\n\r\n    if (newValue === editorValues.clockoutValue) {\r\n      return;\r\n    }\r\n\r\n    update({\r\n      type: \"CLOCKOUTVALUE-UPDATED\",\r\n      locSettings: locSettings!,\r\n      clockoutValue: newValue,\r\n    });\r\n  };\r\n\r\n  if (!isVisible || locSettings === null) {\r\n    return <div />;\r\n  }\r\n\r\n  return (\r\n    <IonRow>\r\n      <IonCol size=\"3\">\r\n        <IonLabel className=\"label\">{locSettings.ClockOutValueLabel}</IonLabel>\r\n      </IonCol>\r\n      <IonCol size=\"9\">\r\n        <IonInput\r\n          className=\"input-textbox\"\r\n          placeholder=\"Enter value\"\r\n          disabled={editorValues.isReadonly || editorValues.isConfirmed}\r\n          value={editorValues.clockoutValue}\r\n          onIonChange={(e) => onClockoutValueUpdated(e.detail.value)}\r\n        />\r\n      </IonCol>\r\n    </IonRow>\r\n  );\r\n};\r\n\r\nexport default EventClockoutValueEditor;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { IonCheckbox } from \"@ionic/react\";\r\nimport \"../../../global-styles.scss\";\r\nimport {LocationSettings} from \"../../../orbital-interfaces/LocationSettings\";\r\nimport { timeHelper as th } from \"../../../util/timeHelper\";\r\nimport { addDays, format, getDay } from \"date-fns\";\r\nimport { EditorReducerAction, EditorValues } from \"../EditEventModalState\";\r\n\r\ninterface WeekdayListProps {\r\n  locSettings: LocationSettings | null;\r\n  editorValues: EditorValues;\r\n  update: React.Dispatch<EditorReducerAction>;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst WeekdayList: React.FC<WeekdayListProps> = ({\r\n  locSettings,\r\n  editorValues,\r\n  update,\r\n}: WeekdayListProps) => {\r\n  const [checkList, setCheckList] = useState([\r\n    false,\r\n    false,\r\n    false,\r\n    false,\r\n    false,\r\n    false,\r\n    false,\r\n  ]);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (!editorValues.repeatWeekdays) {\r\n      setCheckList([false, false, false, false, false, false, false]);\r\n    } else {\r\n      const newState = [false, false, false, false, false, false, false];\r\n      for (let i = 0; i < editorValues.repeatWeekdays.length; i++) {\r\n        newState[parseInt(editorValues.repeatWeekdays[i])] = true;\r\n      }\r\n\r\n      setCheckList(newState);\r\n    }\r\n  }, [editorValues.repeatWeekdays]);\r\n\r\n  if (locSettings === null) {\r\n    return <div />;\r\n  }\r\n\r\n  const weekStart = th.getWeekStart(\r\n    new Date(),\r\n    locSettings.DayWeekStartsOn,\r\n    locSettings.DayStartTime\r\n  );\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  function onCheckboxChecked(dayOfWeek: number) {\r\n    const newCheckState = checkList.slice();\r\n    newCheckState[dayOfWeek] = !checkList[dayOfWeek];\r\n    setCheckList(newCheckState);\r\n\r\n    let repeatWeekdays = \"\";\r\n    for (let i = 0; i < newCheckState.length; i++) {\r\n      if (newCheckState[i]) {\r\n        repeatWeekdays += i;\r\n      }\r\n    }\r\n\r\n    update({\r\n      type: \"REPEATING-UPDATED\",\r\n      repeatWeekDays: repeatWeekdays,\r\n      repeatInterval: editorValues.repeatInterval,\r\n      recurrenceType: editorValues.recurrenceType,\r\n      recurrenceEnd: editorValues.recurrenceEnd,\r\n      recurrenceStart: editorValues.recurrenceStart,\r\n    });\r\n  }\r\n\r\n  return (\r\n    <div className=\"weeklist-container\">\r\n      {[0, 1, 2, 3, 4, 5, 6].map((num: number) => {\r\n        const thisDate = addDays(weekStart, num);\r\n        const dayOfWeek = getDay(thisDate);\r\n\r\n        return (\r\n          <span key={num} className=\"day\">\r\n            <IonCheckbox\r\n              className=\"day-checkbox\"\r\n              disabled={editorValues.isReadonly}\r\n              onClick={() => onCheckboxChecked(dayOfWeek)}\r\n              checked={checkList[dayOfWeek]}\r\n            />\r\n            <span className=\"day-abbr\">\r\n              {format(thisDate, \"EE\").substr(0, 2)}\r\n            </span>\r\n          </span>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default WeekdayList;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport {\r\n  IonCheckbox,\r\n  IonCol,\r\n  IonDatetime,\r\n  IonIcon,\r\n  IonInput,\r\n  IonLabel,\r\n  IonRow,\r\n  IonSelect,\r\n  IonSelectOption,\r\n} from \"@ionic/react\";\r\nimport \"../../../global-styles.scss\";\r\nimport { calendar, refresh } from \"ionicons/icons\";\r\nimport {AuthorizedItems} from \"../../../orbital-interfaces/AuthorizedItems\";\r\nimport {LocationSettings} from \"../../../orbital-interfaces/LocationSettings\";\r\nimport {EventType, RecurrenceType} from \"../../../enums\";\r\nimport {authHelper} from \"../../../util/authHelper\";\r\nimport WeekdayList from \"./WeekdayList\";\r\nimport { EditorReducerAction, EditorValues } from \"../EditEventModalState\";\r\nimport {timeHelper as th} from \"../../../util/timeHelper\";\r\n\r\ninterface RecurringEventSectionProps {\r\n  auth: AuthorizedItems;\r\n  editorValues: EditorValues;\r\n  update: React.Dispatch<EditorReducerAction>;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst RecurringEventSection: React.FC<RecurringEventSectionProps> = ({\r\n  auth,\r\n  editorValues,\r\n  update,\r\n}: RecurringEventSectionProps) => {\r\n  const [locSettings, setLocSettings] = useState(\r\n    null as LocationSettings | null\r\n  );\r\n  const [isVisible, setIsVisible] = useState(false);\r\n  const [isChecked, setIsChecked] = useState(false);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (editorValues.scheduleEventId === -1) {\r\n      return;\r\n    }\r\n\r\n    if (editorValues.locationId > 0) {\r\n      setLocSettings(\r\n        authHelper.getLocSettingsForLocationId(auth, editorValues.locationId)\r\n      );\r\n    } else if (editorValues.locationId === 0) {\r\n      setLocSettings(auth.locations[0].settings);\r\n    }\r\n    // eslint-disable-next-line\r\n  }, [editorValues.locationId, editorValues.scheduleEventId]);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (editorValues.scheduleEventId === -1) {\r\n      return;\r\n    }\r\n\r\n    setIsVisible(\r\n      editorValues.eventType === EventType.Shift ||\r\n      editorValues.eventType === EventType.Unavailable\r\n    );\r\n  }, [editorValues.eventType, editorValues.scheduleEventId]);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (!isVisible || editorValues.scheduleEventId === -1) {\r\n      return;\r\n    }\r\n\r\n    if (editorValues.recurrenceStart) {\r\n      setIsChecked(true);\r\n    } else {\r\n      if (isChecked) {\r\n      } else {\r\n      }\r\n    }\r\n  }, [\r\n    isChecked,\r\n    isVisible,\r\n    editorValues.recurrenceStart,\r\n    editorValues.scheduleEventId,\r\n  ]);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  function onRepeatingChecked() {\r\n    if (!isChecked) {\r\n      update({\r\n        type: \"REPEATING-UPDATED\",\r\n        repeatWeekDays: undefined,\r\n        repeatInterval: 1,\r\n        recurrenceType: RecurrenceType.Weekly,\r\n        recurrenceEnd: undefined,\r\n        recurrenceStart: th.formatDateTimeAsMvcString(new Date()),\r\n      });\r\n    } else {\r\n      update({\r\n        type: \"REPEATING-UPDATED\",\r\n        repeatWeekDays: undefined,\r\n        repeatInterval: undefined,\r\n        recurrenceType: undefined,\r\n        recurrenceEnd: undefined,\r\n        recurrenceStart: undefined,\r\n      });\r\n    }\r\n\r\n    setIsChecked(!isChecked);\r\n  }\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  function onRecurrenceStartChanged(newValue: string | null | undefined) {\r\n    if (!newValue) {\r\n      update({\r\n        type: \"REPEATING-UPDATED\",\r\n        repeatWeekDays: editorValues.repeatWeekdays,\r\n        repeatInterval: editorValues.repeatInterval,\r\n        recurrenceType: editorValues.recurrenceType,\r\n        recurrenceEnd: editorValues.recurrenceEnd,\r\n        recurrenceStart: undefined,\r\n      });\r\n    } else {\r\n      update({\r\n        type: \"REPEATING-UPDATED\",\r\n        repeatWeekDays: editorValues.repeatWeekdays,\r\n        repeatInterval: editorValues.repeatInterval,\r\n        recurrenceType: editorValues.recurrenceType,\r\n        recurrenceEnd: editorValues.recurrenceEnd,\r\n        recurrenceStart: newValue,\r\n      });\r\n    }\r\n  }\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  function onRecurrenceEndChanged(newValue: string | null | undefined) {\r\n    if (!newValue) {\r\n      update({\r\n        type: \"REPEATING-UPDATED\",\r\n        repeatWeekDays: editorValues.repeatWeekdays,\r\n        repeatInterval: editorValues.repeatInterval,\r\n        recurrenceType: editorValues.recurrenceType,\r\n        recurrenceEnd: undefined,\r\n        recurrenceStart: editorValues.recurrenceStart,\r\n      });\r\n    } else {\r\n      update({\r\n        type: \"REPEATING-UPDATED\",\r\n        repeatWeekDays: editorValues.repeatWeekdays,\r\n        repeatInterval: editorValues.repeatInterval,\r\n        recurrenceType: editorValues.recurrenceType,\r\n        recurrenceEnd: newValue,\r\n        recurrenceStart: editorValues.recurrenceStart,\r\n      });\r\n    }\r\n  }\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  function onRecurrenceTypeChanged(newValue: string | null | undefined) {\r\n    if (!newValue) {\r\n      update({\r\n        type: \"REPEATING-UPDATED\",\r\n        repeatWeekDays: editorValues.repeatWeekdays,\r\n        repeatInterval: editorValues.repeatInterval,\r\n        recurrenceType: undefined,\r\n        recurrenceEnd: editorValues.recurrenceEnd,\r\n        recurrenceStart: editorValues.recurrenceStart,\r\n      });\r\n    } else {\r\n      update({\r\n        type: \"REPEATING-UPDATED\",\r\n        repeatWeekDays: editorValues.repeatWeekdays,\r\n        repeatInterval: editorValues.repeatInterval,\r\n        recurrenceType: parseInt(newValue),\r\n        recurrenceEnd: editorValues.recurrenceEnd,\r\n        recurrenceStart: editorValues.recurrenceStart,\r\n      });\r\n    }\r\n  }\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  function onRepeatIntervalChanged(newValue: string | null | undefined) {\r\n    if (!newValue) {\r\n      update({\r\n        type: \"REPEATING-UPDATED\",\r\n        repeatWeekDays: editorValues.repeatWeekdays,\r\n        repeatInterval: undefined,\r\n        recurrenceType: editorValues.recurrenceType,\r\n        recurrenceEnd: editorValues.recurrenceEnd,\r\n        recurrenceStart: editorValues.recurrenceStart,\r\n      });\r\n    } else {\r\n      update({\r\n        type: \"REPEATING-UPDATED\",\r\n        repeatWeekDays: editorValues.repeatWeekdays,\r\n        repeatInterval: parseInt(newValue),\r\n        recurrenceType: editorValues.recurrenceType,\r\n        recurrenceEnd: editorValues.recurrenceEnd,\r\n        recurrenceStart: editorValues.recurrenceStart,\r\n      });\r\n    }\r\n  }\r\n\r\n  if (!isVisible) {\r\n    return <span />;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <IonRow>\r\n        <IonCol size=\"3\">\r\n          <IonLabel className=\"label\">(R)epeats</IonLabel>\r\n        </IonCol>\r\n\r\n        <IonCol size=\"2\">\r\n          <IonCheckbox\r\n            checked={isChecked}\r\n            onClick={onRepeatingChecked}\r\n            disabled={editorValues.isReadonly || editorValues.isConfirmed}\r\n          />\r\n        </IonCol>\r\n      </IonRow>\r\n\r\n      {isChecked && (\r\n        <>\r\n          <IonRow>\r\n            <IonCol size=\"1\">\r\n              <IonIcon icon={calendar} mode=\"md\" />\r\n            </IonCol>\r\n            <IonCol size=\"5\">\r\n              <IonDatetime\r\n                mode=\"ios\"\r\n                value={editorValues.recurrenceStart}\r\n                className=\"select\"\r\n                displayFormat=\"M/D/YY, DDD\"\r\n                pickerFormat=\"MMM DD YYYY\"\r\n                disabled={editorValues.isReadonly || editorValues.isConfirmed}\r\n                min=\"2005-01-01\"\r\n                max=\"2030-01-01\"\r\n                onIonChange={(e) => {\r\n                  onRecurrenceStartChanged(e.detail.value);\r\n                }}\r\n              />\r\n            </IonCol>\r\n            <IonCol size=\"1\">\r\n              <IonIcon\r\n                icon={calendar}\r\n                mode=\"md\"\r\n                style={{ textAlign: \"right\" }}\r\n              />\r\n            </IonCol>\r\n            <IonCol size=\"5\">\r\n              <IonDatetime\r\n                mode=\"ios\"\r\n                value={editorValues.recurrenceEnd}\r\n                className=\"select\"\r\n                displayFormat=\"M/D/YY, DDD\"\r\n                pickerFormat=\"MMM DD YYYY\"\r\n                disabled={editorValues.isReadonly || editorValues.isConfirmed}\r\n                min=\"2005-01-01\"\r\n                max=\"2030-01-01\"\r\n                onIonChange={(e) => {\r\n                  onRecurrenceEndChanged(e.detail.value);\r\n                }}\r\n              />\r\n            </IonCol>\r\n          </IonRow>\r\n          <IonRow>\r\n            <IonCol size=\"1\">\r\n              <IonIcon icon={refresh} mode=\"md\" />\r\n            </IonCol>\r\n            <IonCol size=\"5\">\r\n              <IonSelect\r\n                mode=\"ios\"\r\n                interface=\"action-sheet\"\r\n                className=\"select\"\r\n                value={editorValues.recurrenceType}\r\n                disabled={editorValues.isReadonly || editorValues.isConfirmed}\r\n                onIonChange={(e) => {\r\n                  onRecurrenceTypeChanged(e.detail.value);\r\n                }}\r\n              >\r\n                <IonSelectOption value={RecurrenceType.Weekly}>\r\n                  Weekly\r\n                </IonSelectOption>\r\n                <IonSelectOption value={RecurrenceType.MonthlyByDayOfMonth}>\r\n                  Monthly (Day of Month)\r\n                </IonSelectOption>\r\n                <IonSelectOption value={RecurrenceType.MonthlyByDayOfWeek}>\r\n                  Monthly (Day of Week)\r\n                </IonSelectOption>\r\n              </IonSelect>\r\n            </IonCol>\r\n            <IonCol size=\"1\">#</IonCol>\r\n            <IonCol size=\"5\">\r\n              <IonInput\r\n                className=\"input-textbox\"\r\n                disabled={editorValues.isReadonly || editorValues.isConfirmed}\r\n                value={\r\n                  editorValues.repeatInterval\r\n                    ? editorValues.repeatInterval.toString()\r\n                    : undefined\r\n                }\r\n                onIonChange={(e) => onRepeatIntervalChanged(e.detail.value)}\r\n              />\r\n            </IonCol>\r\n          </IonRow>\r\n          <IonRow>\r\n            <IonCol size=\"12\">\r\n              <WeekdayList\r\n                locSettings={locSettings}\r\n                editorValues={editorValues}\r\n                update={update}\r\n              />\r\n            </IonCol>\r\n          </IonRow>\r\n        </>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default RecurringEventSection;\r\n","import React from \"react\";\r\nimport {\r\n  IonButton,\r\n  IonCol,\r\n  IonContent,\r\n  IonGrid,\r\n  IonHeader,\r\n  IonRow,\r\n  IonTitle,\r\n  IonToolbar,\r\n  IonFooter,\r\n} from \"@ionic/react\";\r\nimport { RecurrenceUpdateType } from \"../../enums\";\r\nimport \"../../global-styles.scss\";\r\n\r\ninterface RecurrenceUpdateTypeSelectorProps {\r\n  onSelect: (selection: RecurrenceUpdateType | null) => void;\r\n  updateType: \"NO\" | \"UPDATE\" | \"DELETE\";\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst RecurrenceUpdateTypeSelector: React.FC<RecurrenceUpdateTypeSelectorProps> = ({\r\n  onSelect,\r\n  updateType,\r\n}: RecurrenceUpdateTypeSelectorProps) => {\r\n  if (updateType === \"NO\") {\r\n    return <div />;\r\n  }\r\n\r\n  const onButtonClick = (choice: RecurrenceUpdateType | null) => {\r\n    onSelect(choice);\r\n  };\r\n\r\n  const titleText =\r\n    updateType === \"UPDATE\" ? \"Update Repeating\" : \"Delete Repeating\";\r\n\r\n  return (\r\n    <>\r\n      <IonHeader mode=\"ios\">\r\n        <IonToolbar>\r\n          <IonTitle>{titleText}</IonTitle>\r\n        </IonToolbar>\r\n      </IonHeader>\r\n      <IonContent>\r\n        <IonGrid>\r\n          <IonRow>\r\n            <IonCol size=\"12\">\r\n              <IonButton\r\n                expand=\"block\"\r\n                color=\"danger\"\r\n                className=\"apply-button\"\r\n                onClick={() =>\r\n                  onButtonClick(RecurrenceUpdateType.UpdateSingleEvent)\r\n                }\r\n              >\r\n                This event\r\n              </IonButton>\r\n            </IonCol>\r\n          </IonRow>\r\n          <IonRow>\r\n            <IonCol size=\"12\">\r\n              <IonButton\r\n                expand=\"block\"\r\n                color=\"danger\"\r\n                className=\"apply-button\"\r\n                onClick={() =>\r\n                  onButtonClick(RecurrenceUpdateType.UpdateEntireSeries)\r\n                }\r\n              >\r\n                Entire series\r\n              </IonButton>\r\n            </IonCol>\r\n          </IonRow>\r\n          <IonRow>\r\n            <IonCol size=\"12\">\r\n              <IonButton\r\n                expand=\"block\"\r\n                color=\"danger\"\r\n                className=\"apply-button\"\r\n                onClick={() =>\r\n                  onButtonClick(RecurrenceUpdateType.UpdateSeriesForward)\r\n                }\r\n              >\r\n                This event forward\r\n              </IonButton>\r\n            </IonCol>\r\n          </IonRow>\r\n        </IonGrid>\r\n      </IonContent>\r\n      <IonFooter>\r\n        <IonButton\r\n          expand=\"block\"\r\n          className=\"cancel-button\"\r\n          onClick={() => onButtonClick(null)}\r\n        >\r\n          Cancel\r\n        </IonButton>\r\n      </IonFooter>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default RecurrenceUpdateTypeSelector;\r\n","import React, {useContext, useEffect, useState} from \"react\";\r\nimport {\r\n  IonButton,\r\n  IonButtons,\r\n  IonCol,\r\n  IonContent,\r\n  IonFooter,\r\n  IonGrid,\r\n  IonHeader,\r\n  IonIcon,\r\n  IonRow,\r\n  IonSelect,\r\n  IonSelectOption,\r\n  IonTextarea,\r\n  IonTitle,\r\n  IonToolbar,\r\n} from \"@ionic/react\";\r\n// import \"./EventRequestModal.scss\";\r\nimport \"../../../global-styles.scss\";\r\nimport {requestsApi, CoverListItem} from \"../../../api/requestsApi\";\r\nimport {ApplicationUserContext} from \"../../../context/ApplicationUserContext\";\r\nimport {EditorValues} from \"../EditEventModalState\";\r\nimport {EventRequestEnum} from \"./EventRequestEditorEx\";\r\nimport {authHelper} from \"../../../util/authHelper\";\r\nimport {AuthorizedItemsContext} from \"../../../context/AuthorizedItemsContext\";\r\nimport {close} from \"ionicons/icons\";\r\n\r\ninterface EventRequestModalProps {\r\n  onCancel: () => void;\r\n  onOk: (\r\n    employeeId: number | null,\r\n    notes: string,\r\n    sendMessage: boolean\r\n  ) => void;\r\n  editorValues: EditorValues;\r\n  eventRequestType: EventRequestEnum;\r\n  buttonText: string;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst EventRequestModalEx: React.FC<EventRequestModalProps> = ({\r\n  onCancel,\r\n  onOk,\r\n  editorValues,\r\n  eventRequestType,\r\n  buttonText\r\n}: EventRequestModalProps) => {\r\n  const { user } = useContext(ApplicationUserContext);\r\n  const { auth } = useContext(AuthorizedItemsContext);\r\n  const [notes, setNotes] = useState(\"\" as string | null | undefined);\r\n  const [selectedEmployeeId, setSelectedEmployeeId] = useState(\r\n    null as number | null\r\n  );\r\n  const [coverList, setCoverList] = useState(null as CoverListItem[] | null);\r\n  const locSettings = authHelper.getLocSettingsForLocationId(auth, editorValues.locationId)\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (\r\n      eventRequestType === EventRequestEnum.CreateCoverRequest &&\r\n      editorValues.scheduleEventId > 0\r\n    ) {\r\n      requestsApi\r\n        .getCoverRequestListItems(user, editorValues.scheduleEventId, true)\r\n        .then((results) => {\r\n          setCoverList(results);\r\n          if (results && results.length > 0) {\r\n            setSelectedEmployeeId(results[0].value);\r\n          }\r\n        });\r\n    }\r\n\r\n    // eslint-disable-next-line\r\n  }, [editorValues.scheduleEventId, eventRequestType]);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onOkClick = () => {\r\n    const newNotes = notes ?? \"\";\r\n    onOk(selectedEmployeeId, newNotes, false);\r\n  };\r\n\r\n  if (eventRequestType === EventRequestEnum.None) {\r\n    return <></>;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <IonContent>\r\n        <IonHeader mode=\"ios\">\r\n          <IonToolbar>\r\n            <IonTitle>{buttonText}</IonTitle>\r\n            <IonButtons slot=\"end\">\r\n              <IonButton onClick={onCancel}>\r\n                <IonIcon icon={close} mode=\"ios\" slot=\"icon-only\" />\r\n              </IonButton>\r\n            </IonButtons>\r\n          </IonToolbar>\r\n        </IonHeader>\r\n        <IonGrid>\r\n          <IonRow\r\n            hidden={\r\n              !locSettings.EnableDirectCoverRequest ||\r\n              eventRequestType !== EventRequestEnum.CreateCoverRequest\r\n            }\r\n          >\r\n            <IonCol className=\"label\" size=\"3\">\r\n              To\r\n            </IonCol>\r\n            <IonCol size=\"9\">\r\n              <IonSelect\r\n                className=\"select\"\r\n                value={selectedEmployeeId}\r\n                onIonChange={(e) => {\r\n                  setSelectedEmployeeId(parseInt(e.detail.value));\r\n                }}\r\n              >\r\n                {coverList &&\r\n                coverList.map((cover) => (\r\n                  <IonSelectOption\r\n                    key={cover.value}\r\n                    value={cover.value}\r\n                    disabled={cover.disabled}\r\n                  >\r\n                    {cover.text}\r\n                  </IonSelectOption>\r\n                ))}\r\n              </IonSelect>\r\n            </IonCol>\r\n          </IonRow>\r\n\r\n          <IonRow\r\n            hidden={eventRequestType === EventRequestEnum.CreateCoverRequest}\r\n          >\r\n            <IonCol size=\"12\">\r\n              {eventRequestType === EventRequestEnum.UndoCoverRequest && (\r\n                <div className=\"usage-message\">\r\n                  This will remove your Cover-Request, setting the event\r\n                  to Shift-Approved.\r\n                </div>\r\n              )}\r\n              {eventRequestType === EventRequestEnum.ApproveShiftRequest && (\r\n                <div className=\"usage-message\">\r\n                  This will approve the Shift-Request from {editorValues.employee.name}\r\n                </div>\r\n              )}\r\n              {eventRequestType === EventRequestEnum.CreateShiftRequest && (\r\n                <div className=\"usage-message\">\r\n                  This will create a Shift-Request to be approved by an admin.\r\n                </div>\r\n              )}\r\n              {eventRequestType === EventRequestEnum.DeleteRequest && (\r\n                <div className=\"usage-message\">\r\n                  This will delete your Request.\r\n                </div>\r\n              )}\r\n            </IonCol>\r\n          </IonRow>\r\n\r\n          <IonRow\r\n            hidden={eventRequestType !== EventRequestEnum.CreateCoverRequest}\r\n          >\r\n            <IonCol className=\"label\" size=\"3\">\r\n              Notes\r\n            </IonCol>\r\n            <IonCol size=\"9\">\r\n              <IonTextarea\r\n                className=\"select\"\r\n                maxlength={200}\r\n                rows={4}\r\n                value={notes}\r\n                onIonChange={(e) => {\r\n                  setNotes(e.detail.value);\r\n                }}\r\n              />\r\n            </IonCol>\r\n          </IonRow>\r\n\r\n          <IonRow>\r\n            <IonCol className=\"label\" size=\"3\" />\r\n            <IonCol size=\"9\" className=\"error-message\">\r\n              <div />\r\n            </IonCol>\r\n          </IonRow>\r\n        </IonGrid>\r\n      </IonContent>\r\n      <IonFooter>\r\n        <IonButton expand=\"block\" color=\"secondary\" onClick={onOkClick}>\r\n          OK\r\n        </IonButton>\r\n      </IonFooter>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default EventRequestModalEx;\r\n","import React, {useContext, useEffect, useState} from \"react\";\r\nimport {IonCol, IonLabel, IonRow, IonSelect, IonSelectOption,} from \"@ionic/react\";\r\nimport \"../../../global-styles.scss\";\r\nimport {AuthorizedItems} from \"../../../orbital-interfaces/AuthorizedItems\";\r\nimport {EditorReducerAction, EditorValues} from \"../EditEventModalState\";\r\nimport {requestsApi, CoverListItem} from \"../../../api/requestsApi\";\r\nimport {ApplicationUserContext} from \"../../../context/ApplicationUserContext\";\r\nimport {EventType, EventStatus} from \"../../../enums\";\r\n\r\ninterface EventTransferToEditorProps {\r\n  auth: AuthorizedItems;\r\n  editorValues: EditorValues;\r\n  update: React.Dispatch<EditorReducerAction>;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst EventTransferToEditor: React.FC<EventTransferToEditorProps> = ({\r\n editorValues,\r\n update,\r\n}: EventTransferToEditorProps) => {\r\n  const {user} = useContext(ApplicationUserContext);\r\n  const [coverList, setCoverList] = useState([] as CoverListItem[]);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (editorValues.scheduleEventId <= 0 || !user.isLoggedin) {\r\n      return;\r\n    }\r\n\r\n    requestsApi.getCoverRequestListItems(\r\n      user,\r\n      editorValues.scheduleEventId,\r\n      false).then(res => {\r\n       setCoverList(res);\r\n\r\n    });\r\n  }, [editorValues.scheduleEventId, user]);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  function onTransferToChange(selected: number | null | undefined) {\r\n    if (selected !== undefined && selected !== editorValues.transferToEmployeeId) {\r\n      update({type: \"TRANSFERTO-EMPLOYEE-UPDATED\", transferToEmployeeId: selected});\r\n    }\r\n  }\r\n\r\n  if ((editorValues.eventType !== EventType.Cover || editorValues.eventStatus !== EventStatus.Request) &&\r\n      editorValues.transferToEmployeeId === null) {\r\n    return <></>;\r\n  }\r\n\r\n  return (\r\n    <IonRow>\r\n      <IonCol size=\"3\">\r\n        <IonLabel className=\"label\">Transfer To</IonLabel>\r\n      </IonCol>\r\n      <IonCol size=\"9\">\r\n        <IonSelect\r\n          mode=\"ios\"\r\n          className=\"select\"\r\n          placeholder=\"None\"\r\n          interface=\"action-sheet\"\r\n          disabled={editorValues.isReadonly || editorValues.isConfirmed}\r\n          value={editorValues.transferToEmployeeId}\r\n          onIonChange={(e) => {\r\n            onTransferToChange(e.detail.value);\r\n          }}\r\n        >\r\n          {coverList.map((cov) => (\r\n            <IonSelectOption\r\n              key={cov.value}\r\n              value={cov.value === 0 ? null : cov.value}\r\n              disabled={cov.disabled}\r\n            >\r\n              {cov.text}\r\n            </IonSelectOption>\r\n          ))}\r\n        </IonSelect>\r\n      </IonCol>\r\n    </IonRow>\r\n  );\r\n};\r\n\r\nexport default EventTransferToEditor;\r\n","import React, { useEffect, useReducer, useState } from \"react\";\r\nimport {\r\n  IonButton,\r\n  IonButtons,\r\n  IonIcon,\r\n  IonContent,\r\n  IonFooter,\r\n  IonHeader,\r\n  IonGrid,\r\n  IonRow,\r\n  IonCol,\r\n  IonTitle,\r\n  IonToolbar,\r\n  IonModal,\r\n} from \"@ionic/react\";\r\nimport { arrowBackOutline } from \"ionicons/icons\";\r\nimport \"../../global-styles.scss\";\r\nimport {AuthorizedItems} from \"../../orbital-interfaces/AuthorizedItems\";\r\nimport EventTypeStatusEditor from \"./editor/EventTypeStatusEditor\";\r\nimport EventPositionEditor from \"./editor/EventPositionEditor\";\r\nimport EventEmployeeEditor from \"./editor/EventEmployeeEditor\";\r\nimport EventStartEndEditor from \"./editor/EventStartEndEditor\";\r\nimport EventBreakEditor from \"./editor/EventBreakEditor\";\r\nimport EventTagEditor from \"./editor/EventTagEditor\";\r\nimport EventConfirmEditor from \"./editor/EventConfirmEditor\";\r\nimport EventIsClockedInEditor from \"./editor/EventIsClockedInEditor\";\r\nimport { editorValueReducer, EditorValues } from \"./EditEventModalState\";\r\nimport {scheduleEventsApi} from \"../../api/scheduleEventsApi\";\r\nimport {requestsApi} from \"../../api/requestsApi\";\r\nimport { ApplicationUserContext } from \"../../context/ApplicationUserContext\";\r\nimport useDialogBox from \"../../hooks/useDialogBox\";\r\nimport { ScheduleEvent } from \"../../orbital-interfaces/ScheduleEvent\";\r\nimport EventNotesEditor from \"./editor/EventNotesEditor\";\r\nimport EventClockoutValueEditor from \"./editor/EventClockoutValueEditor\";\r\nimport { createBrowserHistory } from \"history\";\r\nimport RecurringEventSection from \"./editor/RecurringEventSection\";\r\nimport { RecurrenceUpdateType } from \"../../enums\";\r\nimport RecurrenceUpdateTypeSelector from \"./RecurrenceUpdateTypeSelector\";\r\nimport useOrbitalDialogBox from \"../../hooks/useOrbitalDialogBox\";\r\nimport { useShowLoading } from \"../../hooks/useShowLoading\";\r\nimport {log} from \"../../util/logger\";\r\nimport {timeHelper as th} from \"../../util/timeHelper\";\r\nimport EventRequestEditorEx from \"./editor/EventRequestEditorEx\";\r\nimport EventTransferToEditor from \"./editor/EventTransferToEditor\";\r\n\r\ninterface ScheduleFilterModalProps {\r\n  scheduleEventId: number | null;\r\n  auth: AuthorizedItems;\r\n  onDismissModal: (toastMessage?: string) => void;\r\n  onCancelModal: () => void;\r\n  isOpen: boolean;\r\n  initialEvent: EditorValues;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction fixDatesForIPhone(se: ScheduleEvent): void {\r\n  se.EventStart = th.convertTimeWithoutTimeZoneToLocalTime(se.EventStart);\r\n  se.EventEnd = th.convertTimeWithoutTimeZoneToLocalTime(se.EventEnd);\r\n\r\n  if (se.EventBreaks) {\r\n    for(let i = 0; i < se.EventBreaks.length; i++) {\r\n      se.EventBreaks[i].BreakStart =\r\n        th.convertTimeWithoutTimeZoneToLocalTime(se.EventBreaks[i].BreakStart);\r\n\r\n      if (se.EventBreaks[i].BreakEnd) {\r\n        th.convertTimeWithoutTimeZoneToLocalTime(se.EventBreaks[i].BreakEnd);\r\n      }\r\n    }\r\n  }}\r\n\r\n// --------------------------------------------------------------------------------------\r\n//\r\n// --------------------------------------------------------------------------------------\r\nconst EditEventModal: React.FC<ScheduleFilterModalProps> = ({\r\n  auth,\r\n  scheduleEventId,\r\n  onDismissModal,\r\n  onCancelModal,\r\n  isOpen,\r\n  initialEvent,\r\n}) => {\r\n  const loading = useShowLoading(\"Please wait...\");\r\n  const dlg = useDialogBox();\r\n  const { user } = React.useContext(ApplicationUserContext);\r\n  const [editorValues, updateEditorValues] = useReducer(\r\n    editorValueReducer,\r\n    initialEvent\r\n  );\r\n\r\n  const [scheduleEvent, setScheduleEvent] = useState(\r\n    null as ScheduleEvent | null\r\n  );\r\n\r\n  const [recurrenceUpdateType, setRecurrenceUpdateType] = useState(\r\n    null as RecurrenceUpdateType | null\r\n  );\r\n\r\n  const [\r\n    showRecurrenceUpdateTypeSelector,\r\n    setShowRecurrenceUpdateTypeSelector,\r\n  ] = useState(\"NO\" as \"NO\" | \"UPDATE\" | \"DELETE\");\r\n\r\n  const [buttonClicked, setButtonClicked] = useState(\r\n    \"NONE\" as \"NONE\" | \"CREATEUPDATE\" | \"DELETE\"\r\n  );\r\n\r\n  const isEditing = scheduleEventId !== null;\r\n  const dialog = useOrbitalDialogBox();\r\n  let title = \"New Event\";\r\n  let buttonText = \"CREATE\";\r\n\r\n  if (isEditing) {\r\n    title = \"Edit Event\";\r\n    buttonText = \"UPDATE\";\r\n  }\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (!isOpen) {\r\n      return;\r\n    }\r\n\r\n    if (!auth || !auth.locations || auth.locations.length === 0) {\r\n      return;\r\n    }\r\n\r\n    if (scheduleEventId &&\r\n       (scheduleEvent === null || (scheduleEventId !== scheduleEvent.ScheduleEventId))) {\r\n\r\n      loading.setShowLoading(true);\r\n      log(\"edit_event_get_scheduleevent\", { user: user.username, scheduleEventId: scheduleEventId});\r\n      scheduleEventsApi\r\n        .getScheduleEvent(user, scheduleEventId)\r\n        .then((scheduleEvent) => {\r\n          loading.setShowLoading(false);\r\n          if (!scheduleEvent) {\r\n            dlg.showAlert(\r\n              \"No Event\",\r\n              \"The event may have been removed or you no longer have access\",\r\n              onCancel\r\n            );\r\n            return;\r\n          }\r\n\r\n          fixDatesForIPhone(scheduleEvent);\r\n\r\n\r\n          setScheduleEvent(scheduleEvent);\r\n          updateEditorValues({\r\n            type: \"BEGIN-UPDATE\",\r\n            ev: scheduleEvent,\r\n            auth,\r\n          });\r\n        });\r\n    } else {\r\n      if (scheduleEvent !== null) {\r\n        setScheduleEvent(null);\r\n      }\r\n\r\n      updateEditorValues({ type: \"CREATE-EVENT\", auth });\r\n    }\r\n\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [scheduleEventId, user, isOpen, auth]);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (recurrenceUpdateType !== null && buttonClicked !== \"NONE\") {\r\n      if (buttonClicked === \"CREATEUPDATE\") {\r\n        createOrUpdate();\r\n      } else {\r\n        deleteEvent(\r\n          editorValues.recurrenceId !== null &&\r\n          editorValues.recurrenceId !== undefined\r\n        );\r\n      }\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [recurrenceUpdateType, buttonClicked]);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const createOrUpdate = () => {\r\n    const apiCall =\r\n      editorValues.scheduleEventId === 0\r\n        ? scheduleEventsApi.createScheduleEvent\r\n        : scheduleEventsApi.updateScheduleEvent;\r\n\r\n    const logEvent = editorValues.scheduleEventId === 0 ? \"edit_event_create\" : \"edit_event_update\";\r\n    const successMessage = editorValues.scheduleEventId === 0 ? \"Event Created\" : \"Event Updated\";\r\n\r\n\r\n    apiCall(user, editorValues, recurrenceUpdateType).then((result) => {\r\n      if (result.error) {\r\n        dlg.showAlert(\"Cannot update\", result.message, () => {});\r\n      } else {\r\n        log(logEvent, { user: user.username, scheduleEventId: scheduleEventId});\r\n\r\n        if (editorValues.transferToEmployeeId !== null && editorValues.scheduleEventId > 0) {\r\n          requestsApi.transferCoverToEmployee(\r\n            user,\r\n            editorValues.transferToEmployeeId,\r\n            editorValues.scheduleEventId).then(res => {\r\n            if (res.error) {\r\n              dlg.showAlert(\"Cannot transfer\", result.message, () => {});\r\n            } else {\r\n              onDismissModal(\"Transferred\");\r\n            }\r\n          });\r\n        } else {\r\n          onDismissModal(successMessage);\r\n        }\r\n      }\r\n    });\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onConfirmButtonClicked = () => {\r\n    // Since the update has not updated editor values, we're essentially toggling\r\n    // the confirmed setting.  Update with what it is currently *not* set to.\r\n    const confirmed = !editorValues.isConfirmed;\r\n    scheduleEventsApi.updateConfirmedScheduleEvent(\r\n      user,\r\n      editorValues.scheduleEventId,\r\n      confirmed).then(res => {\r\n        if (res.error) {\r\n          dlg.showAlert(\"Could not \" + confirmed ? \"confirm\" : \"unconfirm\",\r\n            res.message, () => {});\r\n        } else {\r\n          onDismissModal(confirmed ? \"Confirmed\" : \"Unconfirmed\");\r\n        }\r\n      });\r\n  }\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const deleteEvent = (skipPrompt: boolean) => {\r\n    const goDelete = () => {\r\n      scheduleEventsApi\r\n        .deleteScheduleEvent(\r\n          user,\r\n          editorValues.scheduleEventId,\r\n          recurrenceUpdateType\r\n        )\r\n        .then((result) => {\r\n          if (result.error) {\r\n            dlg.showAlert(\"Cannot delete\", result.message, () => {\r\n              onDismissModal(\"Could not delete event\");\r\n            });\r\n          } else {\r\n            log(\"edit_event_delete\", { user: user.username, scheduleEventId: scheduleEventId});\r\n            onDismissModal(\"Deleted Event\");\r\n          }\r\n        });\r\n    };\r\n\r\n    if (skipPrompt) {\r\n      goDelete();\r\n    } else {\r\n      dialog.showDialog(\r\n        \"Delete event?\",\r\n        \"\",\r\n        [{ text: \"Delete\", color: \"danger\", value: 1 }],\r\n        (selection) => {\r\n          if (selection === 1) {\r\n            goDelete();\r\n          }\r\n        }\r\n      );\r\n    }\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onCreateOrUpdateClick = () => {\r\n    setButtonClicked(\"CREATEUPDATE\");\r\n    if (editorValues.recurrenceId) {\r\n      if (recurrenceUpdateType !== null) {\r\n        createOrUpdate();\r\n      } else {\r\n        setShowRecurrenceUpdateTypeSelector(\"UPDATE\");\r\n      }\r\n    } else {\r\n      createOrUpdate();\r\n    }\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onRecurrenceUpdateTypeSelect = (\r\n    selection: RecurrenceUpdateType | null\r\n  ) => {\r\n    setShowRecurrenceUpdateTypeSelector(\"NO\");\r\n    setRecurrenceUpdateType(selection);\r\n    if (selection === null) {\r\n      setButtonClicked(\"NONE\");\r\n    }\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onDeleteClick = () => {\r\n    setButtonClicked(\"DELETE\");\r\n    if (editorValues.recurrenceId) {\r\n      if (recurrenceUpdateType !== null) {\r\n        deleteEvent(true);\r\n      } else {\r\n        setShowRecurrenceUpdateTypeSelector(\"DELETE\");\r\n      }\r\n    } else {\r\n      deleteEvent(\r\n        editorValues.recurrenceId !== null &&\r\n        editorValues.recurrenceId !== undefined\r\n      );\r\n    }\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onCancel = () => {\r\n    updateEditorValues({ type: \"CANCEL\" });\r\n    const history = createBrowserHistory();\r\n    history.push(\"/tabs/schedule\");\r\n    onCancelModal();\r\n  };\r\n\r\n  if (!isOpen || !auth || !auth.locations || auth.locations.length === 0) {\r\n    return (\r\n      <>\r\n        <div>Loading</div>\r\n        {dlg.alertBoxJsx}\r\n      </>\r\n    );\r\n  } else {\r\n    return (\r\n      <>\r\n        <IonHeader className=\"ion-no-border\">\r\n          <IonToolbar>\r\n            <IonButtons slot=\"start\">\r\n              <IonButton onClick={onCancel}>\r\n                <IonIcon icon={arrowBackOutline} mode=\"md\" slot=\"icon-only\" />\r\n              </IonButton>\r\n            </IonButtons>\r\n            <IonTitle>{title}</IonTitle>\r\n          </IonToolbar>\r\n        </IonHeader>\r\n\r\n        <IonContent class=\"outer-content\">\r\n          <IonGrid>\r\n            <EventTypeStatusEditor\r\n              editorValues={editorValues}\r\n              update={updateEditorValues}\r\n              auth={auth}\r\n            />\r\n\r\n            <IonRow>\r\n              <EventConfirmEditor\r\n                auth={auth}\r\n                editorValues={editorValues}\r\n                update={updateEditorValues}\r\n                onEmployeeUpdated={onConfirmButtonClicked}\r\n              />\r\n              <EventIsClockedInEditor\r\n                auth={auth}\r\n                editorValues={editorValues}\r\n                update={updateEditorValues}\r\n              />\r\n            </IonRow>\r\n\r\n            <IonRow>\r\n              <IonCol size=\"12\">\r\n                <div style={{ width: \"100%\", borderBottom: \"1px solid #ddd\" }} />\r\n              </IonCol>\r\n            </IonRow>\r\n\r\n            <EventPositionEditor\r\n              auth={auth}\r\n              editorValues={editorValues}\r\n              update={updateEditorValues}\r\n            />\r\n\r\n            <EventEmployeeEditor\r\n              auth={auth}\r\n              editorValues={editorValues}\r\n              update={updateEditorValues}\r\n            />\r\n\r\n            <EventStartEndEditor\r\n              auth={auth}\r\n              editorValues={editorValues}\r\n              update={updateEditorValues}\r\n            />\r\n\r\n            <RecurringEventSection\r\n              auth={auth}\r\n              editorValues={editorValues}\r\n              update={updateEditorValues}\r\n            />\r\n\r\n            <IonRow>\r\n              <IonCol size=\"12\">\r\n                <div style={{ width: \"100%\", borderBottom: \"1px solid #ddd\" }} />\r\n              </IonCol>\r\n            </IonRow>\r\n\r\n            <EventBreakEditor\r\n              auth={auth}\r\n              editorValues={editorValues}\r\n              update={updateEditorValues}\r\n            />\r\n\r\n            <EventTagEditor\r\n              auth={auth}\r\n              editorValues={editorValues}\r\n              update={updateEditorValues}\r\n            />\r\n\r\n            <EventTransferToEditor\r\n              auth={auth}\r\n              editorValues={editorValues}\r\n              update={updateEditorValues}\r\n            />\r\n\r\n            <EventClockoutValueEditor\r\n              auth={auth}\r\n              editorValues={editorValues}\r\n              update={updateEditorValues}\r\n            />\r\n\r\n            <EventNotesEditor\r\n              auth={auth}\r\n              editorValues={editorValues}\r\n              update={updateEditorValues}\r\n            />\r\n          </IonGrid>\r\n\r\n          {dlg.alertBoxJsx}\r\n          {dialog.dialogBoxJsx}\r\n          {loading.showLoadingJsx}\r\n\r\n          <IonModal\r\n            isOpen={showRecurrenceUpdateTypeSelector !== \"NO\"}\r\n            onDidDismiss={() => {\r\n              onRecurrenceUpdateTypeSelect(null);\r\n            }}\r\n            cssClass=\"mini-modal recurrence-update-modal\"\r\n          >\r\n            <RecurrenceUpdateTypeSelector\r\n              onSelect={onRecurrenceUpdateTypeSelect}\r\n              updateType={showRecurrenceUpdateTypeSelector}\r\n            />\r\n          </IonModal>\r\n        </IonContent>\r\n\r\n        <IonFooter>\r\n          {editorValues.isReadonly && (\r\n            <EventRequestEditorEx\r\n              auth={auth}\r\n              update={updateEditorValues}\r\n              cancelEditModal={(message) => onDismissModal(message)}\r\n              editorValues={editorValues}\r\n            />\r\n          )}\r\n          <IonButton\r\n            className=\"apply-button\"\r\n            expand=\"block\"\r\n            onClick={onCreateOrUpdateClick}\r\n            disabled={!editorValues.valid}\r\n            hidden={editorValues.isReadonly}\r\n          >\r\n            {buttonText}\r\n          </IonButton>\r\n          <IonButton\r\n            className=\"delete-button\"\r\n            expand=\"block\"\r\n            onClick={onDeleteClick}\r\n            hidden={\r\n              editorValues.isReadonly || editorValues.scheduleEventId <= 0\r\n            }\r\n          >\r\n            DELETE\r\n          </IonButton>\r\n        </IonFooter>\r\n      </>\r\n    );\r\n  }\r\n};\r\n\r\nexport default EditEventModal;\r\n","import React from \"react\";\r\nimport \"../../global-styles.scss\";\r\nimport Skeleton from \"react-loading-skeleton\";\r\n\r\ninterface EventCardSkeletonProps {\r\n  threeRows?: boolean;\r\n}\r\n\r\nconst EventCardSkeleton: React.FC<EventCardSkeletonProps> = ({\r\n  threeRows,\r\n}: EventCardSkeletonProps) => {\r\n  return (\r\n    <button className=\"card\">\r\n      <div className=\"card-first-col\">\r\n        <div className=\"day-name\">\r\n          <Skeleton width={40} height={40} />{\" \"}\r\n        </div>\r\n      </div>\r\n      <div style={{ padding: \"0px 10px\" }}>\r\n        <div>\r\n          <Skeleton width={5} height={40} />\r\n        </div>\r\n      </div>\r\n      <div>\r\n        <div>\r\n          <Skeleton width={240} height={40} />\r\n        </div>\r\n      </div>\r\n    </button>\r\n  );\r\n};\r\n\r\nexport default EventCardSkeleton;\r\n","import { useEffect, useRef } from \"react\";\r\n\r\nexport function useInterval(\r\n  callback: () => void,\r\n  isRunning: boolean,\r\n  delay: number\r\n) {\r\n  const savedProps = useRef<() => void>();\r\n\r\n  // Remember the latest callback.\r\n  useEffect(() => {\r\n    savedProps.current = callback;\r\n  }, [callback]);\r\n\r\n  // Set up the interval.\r\n  useEffect(() => {\r\n    function tick() {\r\n      if (savedProps.current && isRunning) {\r\n        savedProps.current();\r\n      }\r\n    }\r\n\r\n    if (delay !== null) {\r\n      const id = setInterval(tick, delay);\r\n      return () => clearInterval(id);\r\n    }\r\n  }, [delay, isRunning]);\r\n}\r\n","import React, {useCallback, useEffect, useRef, useState} from \"react\";\nimport {\n  IonButton,\n  IonButtons,\n  IonContent,\n  IonHeader,\n  IonIcon,\n  IonMenuButton,\n  IonModal,\n  IonPage,\n  IonSegment,\n  IonSegmentButton,\n  IonTitle,\n  IonToolbar,\n  useIonViewWillEnter,\n  useIonViewWillLeave,\n} from \"@ionic/react\";\nimport {add, funnel} from \"ionicons/icons\";\nimport \"../global-styles.scss\";\nimport {timeHelper as th} from \"../util/timeHelper\";\nimport {addDays, startOfDay} from \"date-fns\";\nimport {AuthorizedItems} from \"../orbital-interfaces/AuthorizedItems\";\nimport {scheduleEventsApi} from \"../api/scheduleEventsApi\";\nimport {DailyNotes} from \"../orbital-interfaces/DailyNotes\";\nimport {RefresherEventDetail} from \"@ionic/core\";\nimport {EventInformation, HoursList} from \"../orbital-interfaces/TEC\";\nimport {EventFilter, EventFilterView} from \"../orbital-interfaces/EventFilter\";\nimport WeekChooser from \"../components/SchedulePageComponents/WeekChooser\";\nimport EventList from \"../components/SchedulePageComponents/EventList\";\nimport ScheduleFilterModal from \"../components/SchedulePageComponents/ScheduleFilterModal\";\nimport useIonicRefresher from \"../hooks/useIonicRefresher\";\nimport EditEventModal from \"../components/EditEvent/EditEventModal\";\nimport useSimpleToast from \"../hooks/useSimpleToast\";\nimport {AuthorizedItemsContext} from \"../context/AuthorizedItemsContext\";\nimport {ApplicationUserContext} from \"../context/ApplicationUserContext\";\nimport {RouteComponentProps} from \"react-router\";\nimport Skeleton from \"react-loading-skeleton\";\nimport EventCardSkeleton from \"../components/SchedulePageComponents/EventCardSkeleton\";\nimport NoEventsToShow from \"../components/SchedulePageComponents/NoEventsToShow\";\nimport {useInterval} from \"../hooks/useInterval\";\nimport {getEditorValuesFromEventInformation, INITIAL_EDITOR_VAUES,} from \"../components/EditEvent/EditEventModalState\";\nimport {EventGroup, EventStatus} from \"../enums\";\nimport {scheduleEventHelper} from \"../util/scheduleEventHelper\";\nimport {getConstants} from \"../api/environment\";\nimport {authHelper} from \"../util/authHelper\";\nimport {filterStore} from \"../data/filterStore\";\n\nconst initialEvents: EventInformation[] = [];\nconst initialDailyNotes: DailyNotes[] = [];\n\ninterface SchedulePageProps\n  extends RouteComponentProps<{\n    scheduleEventId?: string;\n  }> {}\n\n\ninterface EventListRef {\n  scrollToDate: (d: Date) => void;\n}\n\n\n// --------------------------------------------------------------------------------------\nfunction eventPassesFilter(ev: EventInformation, filter: EventFilter): boolean {\n  if (!filter.positionIds.includes(ev.PositionId)) {\n    return false;\n  }\n\n  if (filter.tagId !== undefined && filter.tagId !== -1)\n  {\n    if (filter.tagId !== ev.TagId)\n    {\n      return false;\n    }\n  }\n\n  return scheduleEventHelper.eventMatchesFilter(\n    filter.eventTypeId,\n    filter.eventStatusId,\n    ev.EventTypeId,\n    ev.EventStatusId\n  )\n}\n\n// --------------------------------------------------------------------------------------\nfunction dailyNotePassesFilter(auth: AuthorizedItems, dn: DailyNotes, filter: EventFilter): boolean {\n  if (dn.DepartmentId === -1) {\n    if (!filter.positionIds\n      .map(pid => {return authHelper.getLocationIdFromPositionid(auth, pid)})\n      .includes(dn.LocationId)) {\n      return false;\n    }\n  } else if (dn.DepartmentId > 0) {\n    if (!filter.positionIds\n      .map(pid => {return authHelper.getDepartmentFromPositionId(auth, pid)?.id})\n      .includes(dn.DepartmentId)) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n// ------------------------------------------------------------------------------------\nfunction getAllScheduleEvents(events: EventInformation[], f: EventFilter) {\n  return events.filter((ev) =>\n    scheduleEventHelper.eventMatchesFilter(\n      f.eventTypeId,\n      f.eventStatusId,\n      ev.EventTypeId,\n      ev.EventStatusId\n    )\n  );\n}\n\n// ------------------------------------------------------------------------------------\nfunction getMyScheduleEvents(\n  events: EventInformation[],\n  auth: AuthorizedItems,\n  f: EventFilter\n) {\n  return events.filter(\n    (ev) =>\n      scheduleEventHelper.eventMatchesFilter(\n        f.eventTypeId,\n        f.eventStatusId,\n        ev.EventTypeId,\n        ev.EventStatusId\n      ) && ev.EmployeeId === auth.employeeId\n  );\n}\n\n// ------------------------------------------------------------------------------------\nfunction getRequestScheduleEvents(events: EventInformation[]) {\n  return events.filter((ev) => ev.EventStatusId === EventStatus.Request);\n}\n\n// ------------------------------------------------------------------------------------\n//\n// ------------------------------------------------------------------------------------\n// eslint-disable-next-line react/prop-types\nconst SchedulePage: React.FC<SchedulePageProps> = ({ match }) => {\n  const eventListRef = useRef(null as EventListRef | null);\n  const { user } = React.useContext(ApplicationUserContext);\n  const { auth, refreshAuth } = React.useContext(AuthorizedItemsContext);\n  const toast = useSimpleToast();\n  const refresher = useIonicRefresher(\n    (e: CustomEvent<RefresherEventDetail>) => {\n      getScheduleEvents(auth, filter, e);\n    }\n  );\n\n  const startDate =\n    auth && auth.locations && auth.locations.length > 0\n      ? th.getWeekStart(\n          startOfDay(new Date()),\n          auth.locations[0].settings.DayWeekStartsOn,\n          auth.locations[0].settings.DayStartTime\n        )\n      : th.getWeekStart(startOfDay(new Date()), \"Monday\", \"\");\n\n  const [myScheduleEvents, setMyScheduleEvents] = useState(initialEvents);\n  const [myDailyNotes, setMyDailyNotes] = useState(initialDailyNotes);\n  const [myFilteredScheduleEvents, setMyFilteredScheduleEvents] = useState(initialEvents);\n  const [myFilteredDailyNotes, setMyFilteredDailyNotes] = useState(initialDailyNotes);\n  const [myTotalTime, setMyTotalTime] = useState([] as HoursList[]);\n\n  const [requestScheduleEvents, setRequestScheduleEvents] = useState(initialEvents);\n  const [requestDailyNotes, setRequestDailyNotes] = useState(initialDailyNotes);\n  const [requestFilteredScheduleEvents, setRequestFilteredScheduleEvents] = useState(initialEvents);\n  const [requestFilteredDailyNotes, setRequestFilteredDailyNotes] = useState(initialDailyNotes);\n  const [requestHoursPerDay, setRequestHoursPerDay] = useState([] as HoursList[]);\n\n  const [allScheduleEvents, setAllScheduleEvents] = useState(initialEvents);\n  const [allDailyNotes, setAllDailyNotes] = useState(initialDailyNotes);\n  const [allFilteredScheduleEvents, setAllFilteredScheduleEvents] = useState(initialEvents);\n  const [allFilteredDailyNotes, setAllFilteredDailyNotes] = useState(initialDailyNotes);\n  const [allHoursPerDay, setAllHoursPerDay] = useState([] as HoursList[]);\n\n  const [showLoading, setShowLoading] = useState(true);\n  const [isShowing, setIsShowing] = useState(false);\n  const [segment, setSegment] = useState<\"my\" | \"requests\" | \"all\">(\"my\");\n  const [showFilterModal, setShowFilterModal] = useState(false);\n  const [showEventModal, setShowEventModal] = useState(false);\n  const [editEventId, setEditEventId] = useState(null as number | null);\n  const [initialEditEvent, setInitialEditEvent] = useState(INITIAL_EDITOR_VAUES);\n  const storedFilter = filterStore.getFilter(auth);\n\n  const [filter, setFilter] = useState({\n    tagId: storedFilter.tagId,\n    positionIds: storedFilter.positionIds,\n    dnLocIds: storedFilter.dnLocIds,\n    settingsLocId: storedFilter.settingsLocId,\n    eventTypeId: storedFilter.eventTypeId,\n    eventStatusId: storedFilter.eventStatusId,\n    start: startDate,\n    end: addDays(startDate, 7),\n    filterByEmployee: false,\n    view: EventFilterView.schedule\n  } as EventFilter);\n\n  // ------------------------------------------------------------------------------------\n  useIonViewWillEnter(() => {\n    setIsShowing(true);\n  });\n\n  // ------------------------------------------------------------------------------------\n  useIonViewWillLeave(() => {\n    setIsShowing(false);\n  });\n\n  // ------------------------------------------------------------------------------------\n  useInterval(\n    () => {\n      refreshAuth(false, user).then((newAuth) => {\n        if (newAuth) {\n          getScheduleEvents(newAuth, filter);\n        }\n      });\n    },\n    isShowing && !showEventModal && !showFilterModal,\n    getConstants(user).refreshScheduleTimer\n  );\n\n  // ------------------------------------------------------------------------------------\n  useEffect(() => {\n    if (user.isLoggedin && filter !== undefined) {\n      setShowLoading(true);\n      getScheduleEvents(auth, filter);\n    }\n\n    // eslint-disable-next-line\n  }, [user.isLoggedin]);\n\n  // ------------------------------------------------------------------------------------\n  useEffect(() => {\n    // eslint-disable-next-line react/prop-types\n    if (match.params.scheduleEventId) {\n      // eslint-disable-next-line react/prop-types\n      setEditEventId(parseInt(match.params.scheduleEventId));\n      setShowEventModal(true);\n    }\n\n    // eslint-disable-next-line react/prop-types\n  }, [match.params.scheduleEventId]);\n\n  // ------------------------------------------------------------------------------------\n  const onEventClick = useCallback((ev: EventInformation) => {\n      setEditEventId(ev.ScheduleEventId);\n      setInitialEditEvent(getEditorValuesFromEventInformation(auth, ev));\n      setShowEventModal(true);\n    },\n\n    // eslint-disable-next-line\n    [auth.locations]\n  );\n\n  if (!authHelper.isAuthItemsValid(auth)) {\n    return <div />;\n  }\n\n  // ------------------------------------------------------------------------------------\n  const getScheduleEvents = (\n    auth: AuthorizedItems,\n    f: EventFilter,\n    e?: CustomEvent<RefresherEventDetail>\n  ) => {\n    const defaultFilter = filterStore.getDefaultFilter(auth, f);\n    const apiFilter: EventFilter = {\n      ...defaultFilter,\n      start: f.start,\n      end: f.end,\n      filterByEmployee: false,\n      eventTypeId: EventGroup.All,\n      eventStatusId: EventGroup.All,\n    };\n\n    scheduleEventsApi.getScheduleEventsByFilter(user, apiFilter).then((res) => {\n      setShowLoading(false);\n\n      if (e) {\n        e.detail.complete();\n      }\n\n      const mySE = getMyScheduleEvents(res.events, auth, apiFilter);\n      setMyScheduleEvents(mySE);\n      setMyDailyNotes(res.dailyNotes);\n      setMyFilteredScheduleEvents(mySE.filter(se => eventPassesFilter(se, f)));\n      const filteredDailyNotes = res.dailyNotes.filter(dn => dailyNotePassesFilter(auth, dn, f));\n      setMyFilteredDailyNotes(filteredDailyNotes);\n      setMyTotalTime([res.totalTimeForEmployee]);\n\n      const requestSE = getRequestScheduleEvents(res.events);\n      setRequestScheduleEvents(requestSE);\n      setRequestDailyNotes([]);\n      setRequestFilteredScheduleEvents(requestSE.filter(se => eventPassesFilter(se, {\n        ...f,\n        eventStatusId: EventStatus.Request,\n        eventTypeId: EventGroup.All\n      })));\n      setRequestFilteredDailyNotes([]);\n      setRequestHoursPerDay(res.hoursPerDay);\n\n      const allSE = getAllScheduleEvents(res.events, apiFilter);\n      setAllScheduleEvents(allSE);\n      setAllDailyNotes(res.dailyNotes);\n      setAllFilteredScheduleEvents(allSE.filter(se => eventPassesFilter(se, f)));\n      setAllFilteredDailyNotes(filteredDailyNotes);\n      setAllHoursPerDay(res.hoursPerDay);\n    });\n  };\n\n  // ------------------------------------------------------------------------------------\n  const onDismissFilterModal = (f: EventFilter, filterApplied: boolean) => {\n    setFilter(f);\n    if (filterApplied) {\n      toast.showToast(\"Filter applied\");\n      filterStore.putFilter(f);\n\n      setMyFilteredScheduleEvents(myScheduleEvents.filter(se => eventPassesFilter(se, f)));\n      setMyFilteredDailyNotes(myDailyNotes.filter(dn => dailyNotePassesFilter(auth, dn, f)));\n\n      setRequestFilteredScheduleEvents(requestScheduleEvents.filter(se => eventPassesFilter(se, {\n        ...f,\n        eventStatusId: EventStatus.Request,\n        eventTypeId: EventGroup.All\n        })));\n      setRequestFilteredDailyNotes(requestDailyNotes.filter(dn => dailyNotePassesFilter(auth, dn, f)));\n\n      setAllFilteredScheduleEvents(allScheduleEvents.filter(se => eventPassesFilter(se, f)));\n      setAllFilteredDailyNotes(allDailyNotes.filter(dn => dailyNotePassesFilter(auth, dn, f)));\n\n    } else {\n      filterStore.clear();\n\n      setMyFilteredScheduleEvents(myScheduleEvents);\n      setMyFilteredDailyNotes(myDailyNotes);\n\n      setRequestFilteredScheduleEvents(requestScheduleEvents);\n      setRequestFilteredDailyNotes(requestDailyNotes);\n\n      setAllFilteredScheduleEvents(allScheduleEvents);\n      setAllFilteredDailyNotes(allDailyNotes);\n    }\n\n    setShowFilterModal(false);\n\n  };\n\n  // ------------------------------------------------------------------------------------\n  const onEventUpdated = (toastMessage?: string) => {\n    if (toastMessage) {\n      toast.showToast(toastMessage!);\n    }\n\n    getScheduleEvents(auth, filter);\n    setShowEventModal(false);\n  };\n\n  // ------------------------------------------------------------------------------------\n  const setStartDate = (date: Date) => {\n    if (date === filter.start) {\n      return;\n    }\n\n    const newFilter = {\n      ...filter,\n      start: date,\n      end: addDays(date, 7),\n    };\n\n    setFilter(newFilter);\n    setShowLoading(true);\n    getScheduleEvents(auth, newFilter);\n  };\n\n  // ------------------------------------------------------------------------------------\n  const onSegmentChange = (segmentName: \"my\" | \"requests\" | \"all\") => {\n    setSegment(segmentName);\n  };\n\n  // ------------------------------------------------------------------------------------\n  const forceRefresh = (toastMessage: string) => {\n    if (toastMessage && toastMessage.length > 0) {\n      toast.showToast(toastMessage);\n    }\n\n    getScheduleEvents(auth, filter);\n  };\n\n  const onWeekdayClick = (date: Date) => {\n    eventListRef.current!.scrollToDate(date);\n  }\n\n  return (\n    <IonPage id=\"schedule-page\">\n      <IonHeader className=\"ion-no-border\">\n        <IonToolbar mode=\"md\">\n          <IonButtons slot=\"start\">\n            <IonMenuButton />\n          </IonButtons>\n          <IonTitle slot=\"start\">Schedule</IonTitle>\n          <IonButtons slot=\"end\">\n            <IonButton\n              onClick={() => {\n                setEditEventId(null);\n                setShowEventModal(true);\n              }}\n            >\n              <IonIcon icon={add} mode=\"md\" slot=\"icon-only\" />\n            </IonButton>\n            <IonButton onClick={() => setShowFilterModal(true)}>\n              <div className={filterStore.isFilterApplied(auth, filter) ? \"filter-applied\" : \"filter-not-applied\"}>&#183;</div>\n              <IonIcon icon={funnel} mode=\"ios\" slot=\"icon-only\" />\n            </IonButton>\n          </IonButtons>\n        </IonToolbar>\n      </IonHeader>\n\n      <IonSegment mode=\"md\" value={segment}>\n        <IonSegmentButton\n          mode=\"md\"\n          value=\"my\"\n          onClick={() => onSegmentChange(\"my\")}\n        >\n          MY\n        </IonSegmentButton>\n        <IonSegmentButton\n          mode=\"md\"\n          value=\"requests\"\n          onClick={() => onSegmentChange(\"requests\")}\n        >\n          REQUESTS\n        </IonSegmentButton>\n        <IonSegmentButton\n          mode=\"md\"\n          value=\"all\"\n          onClick={() => onSegmentChange(\"all\")}\n        >\n          ALL\n        </IonSegmentButton>\n      </IonSegment>\n      <WeekChooser\n        startDate={th.getWeekStart(\n          filter.start,\n          auth.locations[0].settings.DayWeekStartsOn,\n          \"\"\n        )}\n        setStartDate={setStartDate}\n        onWeekdayClick={onWeekdayClick}\n      />\n      <IonContent>\n        {refresher.ionicRefresherJsx}\n        {!showLoading && segment === \"my\" && myScheduleEvents?.length === 0 && (\n          <NoEventsToShow />\n        )}\n\n        {!showLoading && segment === \"my\" && myScheduleEvents?.length > 0 && (\n          <EventList\n            events={myFilteredScheduleEvents}\n            listType={segment}\n            notes={myFilteredDailyNotes}\n            hoursPerDay={myTotalTime}\n            auth={auth}\n            onEdit={onEventClick}\n            onForceRefresh={forceRefresh}\n            ref={eventListRef}\n            weekStart={filter.start}\n          />\n        )}\n\n        {!showLoading &&\n          segment === \"requests\" &&\n          requestScheduleEvents.length === 0 && <NoEventsToShow />}\n\n        {!showLoading &&\n          segment === \"requests\" &&\n          requestScheduleEvents.length > 0 && (\n            <EventList\n              events={requestFilteredScheduleEvents}\n              listType={segment}\n              notes={requestFilteredDailyNotes}\n              hoursPerDay={requestHoursPerDay}\n              auth={auth}\n              onEdit={onEventClick}\n              onForceRefresh={forceRefresh}\n              ref={eventListRef}\n              weekStart={filter.start}\n            />\n          )}\n\n        {!showLoading &&\n          segment === \"all\" &&\n          allScheduleEvents?.length === 0 && <NoEventsToShow />}\n\n        {!showLoading && segment === \"all\" && allScheduleEvents?.length > 0 && (\n          <EventList\n            events={allFilteredScheduleEvents}\n            listType={segment}\n            notes={allFilteredDailyNotes}\n            hoursPerDay={allHoursPerDay}\n            auth={auth}\n            onEdit={onEventClick}\n            onForceRefresh={forceRefresh}\n            ref={eventListRef}\n            weekStart={filter.start}\n          />\n        )}\n\n        {showLoading && (\n          <>\n            <div style={{ marginTop: \"10px\" }} />\n            <Skeleton height={40} width={310} />\n            <br />\n            <EventCardSkeleton threeRows={segment !== \"my\"} />\n            <EventCardSkeleton threeRows={segment !== \"my\"} />\n            <EventCardSkeleton threeRows={segment !== \"my\"} />\n          </>\n        )}\n      </IonContent>\n\n      {toast.simpleToastJsx}\n\n      <IonModal\n        isOpen={showFilterModal}\n        onDidDismiss={() => setShowFilterModal(false)}\n      >\n        <ScheduleFilterModal\n          filter={filter}\n          auth={auth}\n          onDismissModal={onDismissFilterModal}\n          isOpen={showFilterModal}\n          onCancelModal={() => setShowFilterModal(false)}\n        />\n      </IonModal>\n\n      <IonModal\n        isOpen={showEventModal}\n        onDidDismiss={() => setShowEventModal(false)}\n      >\n        <EditEventModal\n          isOpen={showEventModal}\n          auth={auth}\n          onCancelModal={() => setShowEventModal(false)}\n          onDismissModal={(toastMessage) => onEventUpdated(toastMessage)}\n          scheduleEventId={editEventId}\n          initialEvent={initialEditEvent}\n        />\n      </IonModal>\n    </IonPage>\n  );\n};\n\nexport default SchedulePage;\n","import React, { useEffect, useState } from \"react\";\r\nimport {\r\n  IonButton,\r\n  IonButtons,\r\n  IonIcon,\r\n  IonContent,\r\n  IonHeader,\r\n  IonTitle,\r\n  IonToolbar,\r\n} from \"@ionic/react\";\r\nimport { close } from \"ionicons/icons\";\r\nimport \"../../global-styles.scss\";\r\nimport {AuthorizedItems} from \"../../orbital-interfaces/AuthorizedItems\";\r\nimport {BreakType, UnscheduledBreakOptions} from \"../../enums\";\r\nimport { TimeClockSettingsData } from \"../../orbital-interfaces/TimeClockSettingsData\";\r\nimport { timeHelper as th } from \"../../util/timeHelper\";\r\n\r\ninterface ScheduleFilterModalProps {\r\n  auth: AuthorizedItems;\r\n  tcData: TimeClockSettingsData;\r\n  onDismissModal: (selection: BreakItem) => void;\r\n}\r\n\r\nexport interface BreakItem {\r\n  key: string;\r\n  name: string;\r\n  breakType: BreakType;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst BreakSelectionModal: React.FC<ScheduleFilterModalProps> = ({\r\n  auth,\r\n  onDismissModal,\r\n  tcData,\r\n}: ScheduleFilterModalProps) => {\r\n  const [breakList, setBreakList] = useState([] as BreakItem[]);\r\n  const cancelOption = {\r\n    key: \"Cancel\",\r\n    name: \"\",\r\n    breakType: BreakType.UnscheduledUnpaid,\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (auth.locations.length === 0 || !tcData.ClockedInScheduleEvent) {\r\n      return;\r\n    }\r\n\r\n    const locSettings = auth.locations.filter(\r\n      (l) => l.id === tcData.ClockedInScheduleEvent!.LocationId\r\n    )[0].settings;\r\n    const breaks: BreakItem[] = [];\r\n\r\n    if (tcData.ScheduleEventsForClockIn.length > 0) {\r\n      tcData.ScheduleEventsForClockIn[0].EventBreaks.map((b) => {\r\n        return breaks.push({\r\n          key: b.BreakStart,\r\n          name: th.getEventBreakStartEndString(b),\r\n          breakType: BreakType.Scheduled,\r\n        });\r\n      });\r\n    }\r\n\r\n    switch (locSettings.UnscheduledBreakOptions) {\r\n      case UnscheduledBreakOptions.Both:\r\n        breaks.push({\r\n          key: \"UnScheduledUnpaid\",\r\n          name: \"Unscheduled\",\r\n          breakType: BreakType.UnscheduledUnpaid,\r\n        });\r\n        breaks.push({\r\n          key: \"UnScheduledPaid\",\r\n          name: \"Unscheduled $\",\r\n          breakType: BreakType.UnscheduledPaid,\r\n        });\r\n        break;\r\n\r\n      case UnscheduledBreakOptions.Paid:\r\n        breaks.push({\r\n          key: \"UnScheduledPaid\",\r\n          name: \"Unscheduled $\",\r\n          breakType: BreakType.UnscheduledPaid,\r\n        });\r\n        break;\r\n\r\n      case UnscheduledBreakOptions.Unpaid:\r\n        breaks.push({\r\n          key: \"UnScheduledUnpaid\",\r\n          name: \"Unscheduled\",\r\n          breakType: BreakType.UnscheduledUnpaid,\r\n        });\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    }\r\n\r\n    setBreakList(breaks);\r\n  }, [tcData, auth]);\r\n\r\n  return (\r\n    <>\r\n      <IonHeader mode=\"ios\">\r\n        <IonToolbar>\r\n          <IonTitle>Choose Break</IonTitle>\r\n          <IonButtons slot=\"end\">\r\n            <IonButton onClick={() => onDismissModal(cancelOption)}>\r\n              <IonIcon icon={ close } mode=\"ios\" slot=\"icon-only\" />\r\n            </IonButton>\r\n          </IonButtons>\r\n        </IonToolbar>\r\n      </IonHeader>\r\n\r\n      <IonContent class=\"outer-content\">\r\n        {breakList.map((brk) => (\r\n          <IonButton\r\n            className=\"apply-button\"\r\n            expand=\"block\"\r\n            key={brk.key}\r\n            color=\"secondary\"\r\n            onClick={() => {\r\n              onDismissModal(brk);\r\n            }}\r\n          >\r\n            {brk.name}\r\n          </IonButton>\r\n        ))}\r\n      </IonContent>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default BreakSelectionModal;\r\n","import { EndBreakResponse } from \"../orbital-interfaces/EndBreakResponse\";\r\nimport { StartBreakResponse } from \"../orbital-interfaces/StartBreakResponse\";\r\nimport { ScheduleEvent } from \"../orbital-interfaces/ScheduleEvent\";\r\nimport { ClockOutResponse } from \"../orbital-interfaces/ClockOutResponse\";\r\nimport { ClockInResponse } from \"../orbital-interfaces/ClockInResponse\";\r\nimport { SwitchPositionOrTagResponse } from \"../orbital-interfaces/SwitchPositionOrTagResponse\";\r\nimport { TimeClockSettingsData } from \"../orbital-interfaces/TimeClockSettingsData\";\r\nimport { ApplicationUser } from \"../context/ApplicationUserContext\";\r\nimport apiHelper from \"./orbitalApiHelper\";\r\nimport { ClockInGeoLocations } from \"../orbital-interfaces/ClockInGeoLocations\";\r\nimport {BreakType} from \"../enums\";\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function getTimeClockSettings(\r\n  user: ApplicationUser,\r\n  lat: number | undefined,\r\n  lng: number | undefined\r\n) {\r\n  return (await apiHelper.get(\r\n    user,\r\n    `api/v1/employee/timeclock/?lat=${lat}&lng=${lng}`\r\n  )) as TimeClockSettingsData;\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function clockIn(\r\n  user: ApplicationUser,\r\n  positionId: number,\r\n  tagId: number | null,\r\n  lat: number | undefined,\r\n  lng: number | undefined\r\n) {\r\n  // eslint-disable-next-line max-len\r\n  const baseUrl = `/api/v2/employee/timeclock/clockin/${positionId}/${tagId}?lat=${lat}&lng=${lng}`;\r\n  return (await apiHelper.post(user, baseUrl, {})) as ClockInResponse;\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function clockOut(\r\n  user: ApplicationUser,\r\n  lat: number | undefined,\r\n  lng: number | undefined,\r\n  clockOutValue?: number,\r\n) {\r\n  const clockoutDataModel = {\r\n    ClockOutValue: clockOutValue,\r\n    TimeClockBreak: null,\r\n    BreakStart: null,\r\n  };\r\n\r\n  return (await apiHelper.post(\r\n    user,\r\n    `/api/v2/employee/timeclock/clockout?lat=${lat}&lng=${lng}`,\r\n    clockoutDataModel\r\n  )) as ClockOutResponse;\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function switchPositionOrTag(\r\n  user: ApplicationUser,\r\n  positionId: number,\r\n  tagId: number | null,\r\n  lat: number | undefined,\r\n  lng: number | undefined  ,\r\n  clockOutValue?: number\r\n) {\r\n  // eslint-disable-next-line max-len\r\n  const baseUrl = `/api/v2/employee/timeclock/switch/${positionId}/${tagId}?lat=${lat}&lng=${lng}`;\r\n  const clockoutDataModel = {\r\n    ClockOutValue: clockOutValue,\r\n    TimeClockBreak: null,\r\n    BreakStart: null,\r\n  };\r\n\r\n  return (await apiHelper.post(\r\n    user,\r\n    baseUrl,\r\n    clockoutDataModel\r\n  )) as SwitchPositionOrTagResponse;\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function startBreak(\r\n  user: ApplicationUser,\r\n  clockEvent: ScheduleEvent,\r\n  shiftEvent: ScheduleEvent | null,\r\n  breakType: BreakType,\r\n  lat: number | undefined,\r\n  lng: number | undefined,\r\n  breakStart?: string\r\n) {\r\n  const baseUrl = `/api/v2/employee/timeclock/startbreak?lat=${lat}&lng=${lng}`;\r\n  const breakStartOptions = {\r\n    clockEventId: clockEvent.ScheduleEventId,\r\n    shiftEventId: shiftEvent ? shiftEvent!.ScheduleEventId : null,\r\n    shiftBreakStart: breakStart,\r\n    breakType,\r\n  };\r\n\r\n  return (await apiHelper.post(\r\n    user,\r\n    baseUrl,\r\n    breakStartOptions\r\n  )) as StartBreakResponse;\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function endBreak(\r\n  user: ApplicationUser,\r\n  clockEvent: ScheduleEvent,\r\n  shiftEvent: ScheduleEvent | null,\r\n  lat: number | undefined,\r\n  lng: number | undefined\r\n) {\r\n  const shiftEventId = shiftEvent ? shiftEvent.ScheduleEventId : \"\";\r\n  // eslint-disable-next-line max-len\r\n  const baseUrl =\r\n    shiftEvent !== null\r\n      ? `/api/v2/employee/timeclock/endbreak/${clockEvent.ScheduleEventId}/${shiftEventId}?lat=${lat}&lng=${lng}`\r\n      : `/api/v2/employee/timeclock/endbreak/${clockEvent.ScheduleEventId}/-1?lat=${lat}&lng=${lng}`;\r\n\r\n  return (await apiHelper.post(user, baseUrl, {})) as EndBreakResponse;\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function getGeoLocations(user: ApplicationUser) {\r\n  const baseUrl = \"/api/v2/employee/timeclock/geolocations\";\r\n  return (await apiHelper.get(user, baseUrl)) as ClockInGeoLocations[];\r\n}\r\n\r\nexport const timeClockApi = {\r\n  getTimeClockSettings,\r\n  clockIn,\r\n  clockOut,\r\n  switchPositionOrTag,\r\n  startBreak,\r\n  endBreak,\r\n  getGeoLocations,\r\n};\r\n","import React, { useState } from \"react\";\r\nimport {\r\n  IonButtons,\r\n  IonButton,\r\n  IonIcon,\r\n  IonCol,\r\n  IonContent,\r\n  IonFooter,\r\n  IonInput,\r\n  IonGrid,\r\n  IonHeader,\r\n  IonRow,\r\n  IonTitle,\r\n  IonToolbar,\r\n} from \"@ionic/react\";\r\nimport \"../../global-styles.scss\";\r\nimport { close } from \"ionicons/icons\";\r\nimport {LocationSettings} from \"../../orbital-interfaces/LocationSettings\";\r\n\r\ninterface ClockoutModalProps {\r\n  onCancel: () => void;\r\n  onOk: (clockoutValue?: number) => void;\r\n  locSettings: LocationSettings;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst ClockoutModal: React.FC<ClockoutModalProps> = ({\r\n  onCancel,\r\n  onOk,\r\n  locSettings,\r\n}: ClockoutModalProps) => {\r\n  const [clockoutValue, setClockoutValue] = useState(\r\n    undefined as number | undefined\r\n  );\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onOkClick = () => {\r\n    onOk(clockoutValue);\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  function onClockoutValueUpdate(val: string | undefined | null) {\r\n    if (!val) {\r\n      if (clockoutValue !== undefined) {\r\n        setClockoutValue(undefined);\r\n      }\r\n\r\n      return;\r\n    }\r\n\r\n    setClockoutValue(parseFloat(val));\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <IonHeader mode=\"ios\">\r\n        <IonToolbar>\r\n          <IonTitle>Clock Out</IonTitle>\r\n          <IonButtons slot=\"end\">\r\n            <IonButton onClick={onCancel}>\r\n              <IonIcon icon={close} mode=\"ios\" slot=\"icon-only\" />\r\n            </IonButton>\r\n          </IonButtons>\r\n        </IonToolbar>\r\n      </IonHeader>\r\n      <IonContent>\r\n        <IonGrid>\r\n          <IonRow>\r\n            <IonCol className=\"label\" size=\"5\">\r\n              {locSettings.ClockOutValueLabel}\r\n            </IonCol>\r\n            <IonCol size=\"7\">\r\n              <IonInput\r\n                placeholder=\"Enter value\"\r\n                type=\"number\"\r\n                className=\"input\"\r\n                autoCorrect=\"off\"\r\n                clearInput={true}\r\n                value={clockoutValue?.toString()}\r\n                onIonChange={(e) => {\r\n                  onClockoutValueUpdate(e.detail.value);\r\n                }}\r\n              />\r\n            </IonCol>\r\n          </IonRow>\r\n        </IonGrid>\r\n      </IonContent>\r\n      <IonFooter>\r\n        <IonButton\r\n          expand=\"block\"\r\n          onClick={onOkClick}\r\n          className=\"clockout-button\"\r\n        >\r\n          CLOCK OUT\r\n        </IonButton>\r\n      </IonFooter>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ClockoutModal;\r\n","import React, { useState, useEffect } from \"react\";\r\n// import \"./ClockPanel.scss\";\r\nimport \"../../global-styles.scss\";\r\nimport { IonButton } from \"@ionic/react\";\r\nimport { TimeClockSettingsData } from \"../../orbital-interfaces/TimeClockSettingsData\";\r\nimport {LocationSettings} from \"../../orbital-interfaces/LocationSettings\";\r\n\r\ninterface SwitchPositionOrTagButtonProps {\r\n  tcData: TimeClockSettingsData;\r\n  locSettings: LocationSettings;\r\n  selectedPosId: number;\r\n  selectedTagId: number | null;\r\n  onSwitch: () => void;\r\n}\r\n\r\nconst SwitchPositionOrTagButton: React.FC<SwitchPositionOrTagButtonProps> = ({\r\n  tcData,\r\n  locSettings,\r\n  selectedPosId,\r\n  selectedTagId,\r\n  onSwitch,\r\n}: SwitchPositionOrTagButtonProps) => {\r\n  const [disabled, setDisabled] = useState(true);\r\n\r\n  const hiddenJsx = <span />;\r\n\r\n  useEffect(() => {\r\n    if (tcData.UserClockedIn) {\r\n      const curPosId = tcData.ClockedInScheduleEvent!.PositionId;\r\n      let curTagId = tcData.ClockedInScheduleEvent!.TagId;\r\n      if (!curTagId) {\r\n        curTagId = -1;\r\n      }\r\n\r\n      if (curPosId !== selectedPosId) {\r\n        setDisabled(false);\r\n      } else if (curTagId !== selectedTagId) {\r\n        setDisabled(false);\r\n      } else {\r\n        setDisabled(true);\r\n      }\r\n    }\r\n  }, [\r\n    tcData.UserClockedIn,\r\n    tcData.ClockedInScheduleEvent,\r\n    selectedPosId,\r\n    selectedTagId,\r\n  ]);\r\n\r\n  if (\r\n    !locSettings.ClockInWithDifferentTag &&\r\n    !locSettings.EnablePositionChangeForEmployeePosition\r\n  ) {\r\n    return hiddenJsx;\r\n  }\r\n\r\n  if (!tcData.UserClockedIn) {\r\n    return hiddenJsx;\r\n  }\r\n\r\n  return (\r\n    <IonButton\r\n      className=\"ion-no-margin\"\r\n      disabled={disabled}\r\n      color=\"secondary\"\r\n      expand=\"block\"\r\n      onClick={onSwitch}\r\n    >\r\n      SWITCH\r\n    </IonButton>\r\n  );\r\n};\r\n\r\nexport default SwitchPositionOrTagButton;\r\n","import React, { useRef, useEffect, useState } from \"react\";\r\nimport \"../../global-styles.scss\";\r\nimport { ApplicationUserContext } from \"../../context/ApplicationUserContext\";\r\nimport {timeClockApi} from \"../../api/timeClockApi\";\r\nimport { ClockInGeoLocations } from \"../../orbital-interfaces/ClockInGeoLocations\";\r\nimport { IonButton, IonIcon } from \"@ionic/react\";\r\nimport { arrowUpCircle, arrowDownCircle } from \"ionicons/icons\";\r\nimport {GeolocationPosition} from \"@capacitor/core\";\r\n\r\n// -----------------------------------------------------------------------------------------------\r\nfunction calculateNearestLocationMessage(\r\n  lat: number | undefined,\r\n  lng: number | undefined,\r\n  locations: ClockInGeoLocations[]\r\n): string {\r\n  if (!lat || !lng || locations.length === 0) {\r\n    return \"\";\r\n  }\r\n\r\n  if (\r\n    !google ||\r\n    !google.maps ||\r\n    !google.maps.geometry ||\r\n    !google.maps.geometry.spherical ||\r\n    !google.maps.geometry.spherical.computeDistanceBetween\r\n  ) {\r\n    return \"\";\r\n  }\r\n\r\n  const userPos = new google.maps.LatLng(lat, lng);\r\n  const MAX_DISTANCE = 999999999;\r\n  let closestLocation = null as ClockInGeoLocations | null;\r\n  let minDistance = MAX_DISTANCE;\r\n  for (let i = 0; i < locations.length; i++) {\r\n    const curLoc = locations[i];\r\n    if (!curLoc.lat || !curLoc.lng) {\r\n      continue;\r\n    }\r\n    const locPos = new google.maps.LatLng(curLoc.lat, curLoc.lng);\r\n    const distance =\r\n      google.maps.geometry.spherical.computeDistanceBetween(userPos, locPos) *\r\n        3.28084 -\r\n      curLoc.proximity;\r\n    if (distance < minDistance) {\r\n      minDistance = distance;\r\n      closestLocation = curLoc;\r\n    }\r\n  }\r\n\r\n  if (minDistance === MAX_DISTANCE) {\r\n    return \"\";\r\n  }\r\n\r\n  if (minDistance < 0) {\r\n    return \"At \" + closestLocation!.locationName;\r\n  }\r\n\r\n  const miles = minDistance * 0.000189394;\r\n  if (miles > 0.1) {\r\n    return `${Math.round((miles + Number.EPSILON) * 10) / 10} mi to ${\r\n      closestLocation!.locationName\r\n    }`;\r\n  }\r\n\r\n  return `${Math.round(minDistance)} ft to ${closestLocation!.locationName}`;\r\n}\r\n\r\n// -----------------------------------------------------------------------------------------------\r\nfunction validPos(p: GeolocationPosition | Position | null) {\r\n  if (p === null) {\r\n    return false;\r\n  }\r\n\r\n  return !(p.coords.latitude === undefined || p.coords.longitude === undefined);\r\n}\r\n\r\ninterface MapComponentProps {\r\n  pos: GeolocationPosition | Position | null;\r\n}\r\n\r\n// -----------------------------------------------------------------------------------------------\r\n//\r\n// -----------------------------------------------------------------------------------------------\r\nconst Map: React.FC<MapComponentProps> = ({pos}: MapComponentProps) => {\r\n  const mapEle = useRef<HTMLDivElement | null>(null);\r\n  const map = useRef<google.maps.Map>();\r\n  const userCircle = useRef<google.maps.Circle>();\r\n  const { user } = React.useContext(ApplicationUserContext);\r\n  const [message, setMessage] = useState(\"\");\r\n  const [geoLocations, setGeoLocations] = useState([] as ClockInGeoLocations[]);\r\n  const [showMap, setShowMap] = useState(false);\r\n\r\n  // -----------------------------------------------------------------------------------------------\r\n  function onShowMapButtonClick() {\r\n    const newShowMap = !showMap;\r\n\r\n    if (pos !== null) {\r\n      setShowMap(newShowMap);\r\n      setMessage(\r\n        calculateNearestLocationMessage(\r\n          pos.coords.latitude,\r\n          pos.coords.longitude,\r\n          geoLocations\r\n        )\r\n      );\r\n    }\r\n  }\r\n\r\n  // -----------------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (mapEle.current === null || !validPos(pos)) {\r\n      return;\r\n    }\r\n\r\n    if (map.current !== undefined) {\r\n      if (map.current && validPos(pos!)) {\r\n        const userPos = new google.maps.LatLng(pos!.coords.latitude, pos!.coords.longitude);\r\n        map.current.setCenter(userPos);\r\n        if (userCircle.current) {\r\n          userCircle.current.setMap(null);\r\n        }\r\n\r\n        userCircle.current = new google.maps.Circle({\r\n          strokeColor: \"#FF0000\",\r\n          strokeOpacity: 0.8,\r\n          strokeWeight: 2,\r\n          fillColor: \"#FF0000\",\r\n          fillOpacity: 0.25,\r\n          radius: 6.5,\r\n          center: userPos,\r\n          map: map.current,\r\n        });\r\n      }\r\n\r\n      setMessage(\r\n        calculateNearestLocationMessage(\r\n          pos!.coords.latitude,\r\n          pos!.coords.longitude,\r\n          geoLocations\r\n        )\r\n      );\r\n\r\n      return;\r\n    }\r\n\r\n    map.current = new google.maps.Map(mapEle.current, {\r\n      center: {\r\n        lat: pos!.coords.latitude,\r\n        lng: pos!.coords.longitude,\r\n      },\r\n      zoom: 16,\r\n      disableDefaultUI: true,\r\n      fullscreenControl: false,\r\n    });\r\n\r\n    addMarkers();\r\n\r\n    google.maps.event.addListenerOnce(map.current, \"idle\", () => {\r\n      if (mapEle.current) {\r\n        mapEle.current.classList.add(\"show-map\");\r\n      }\r\n    });\r\n\r\n    function addMarkers() {\r\n      if (validPos(pos)) {\r\n        userCircle.current = new google.maps.Circle({\r\n          strokeColor: \"#FF0000\",\r\n          strokeOpacity: 0.8,\r\n          strokeWeight: 2,\r\n          fillColor: \"#FF0000\",\r\n          fillOpacity: 0.25,\r\n          radius: 6.5,\r\n          center: { lat: pos!.coords.latitude, lng: pos!.coords.longitude },\r\n          map: map.current,\r\n        });\r\n      }\r\n\r\n      timeClockApi.getGeoLocations(user).then((clockLocations) => {\r\n        setGeoLocations(clockLocations);\r\n        clockLocations.forEach((markerData) => {\r\n          const infoWindow = new google.maps.InfoWindow({\r\n            content: `<h5>${markerData.addr}</h5>`,\r\n          });\r\n\r\n          if (markerData.lat && markerData.lng) {\r\n            const position = new google.maps.LatLng(\r\n              markerData!.lat,\r\n              markerData!.lng\r\n            );\r\n\r\n            const marker = new google.maps.Marker({\r\n              position,\r\n              map: map.current!,\r\n              title: markerData.addr,\r\n            });\r\n\r\n            new google.maps.Circle({\r\n              strokeColor: \"#FF0000\",\r\n              strokeOpacity: 0.5,\r\n              strokeWeight: 1,\r\n              fillColor: \"#DD0000\",\r\n              fillOpacity: 0.2,\r\n              radius: markerData.proximity * 0.3048, // feet to meters\r\n              center: position,\r\n              map: map.current,\r\n            });\r\n            marker.addListener(\"click\", () => {\r\n              infoWindow.open(map.current!, marker);\r\n            });\r\n          }\r\n        });\r\n\r\n        if (validPos(pos))\r\n        {\r\n          setMessage(\r\n            calculateNearestLocationMessage(\r\n              pos!.coords.latitude,\r\n              pos!.coords.longitude,\r\n              clockLocations\r\n            )\r\n          );\r\n        }\r\n      });\r\n    }\r\n\r\n    // eslint-disable-next-line\r\n  }, [pos, google, google.maps]);\r\n\r\n  return (\r\n    <>\r\n      <IonButton className=\"map-button\" onClick={onShowMapButtonClick}>\r\n        {message}\r\n        <IonIcon\r\n          id=\"show-map-button\"\r\n          icon={showMap ? arrowDownCircle : arrowUpCircle}\r\n        />\r\n      </IonButton>\r\n      <div id=\"map-container\" hidden={!showMap}>\r\n        <div ref={mapEle} className=\"map-canvas\" />\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Map;\r\n","import { IonAlert } from \"@ionic/react\";\r\nimport React, { useState } from \"react\";\r\n\r\nfunction useYesOrCancelDialogBox() {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [alertData, setAlertData] = useState({\r\n    message: \"\",\r\n    onCancel: () => {},\r\n    onYes: () => {},\r\n  });\r\n\r\n  const showDialog = (\r\n    message: string,\r\n    onYes: () => void,\r\n    onCancel: () => void\r\n  ) => {\r\n    setAlertData({\r\n      message,\r\n      onYes,\r\n      onCancel,\r\n    });\r\n\r\n    setIsOpen(true);\r\n  };\r\n\r\n  const dialogJsx = (\r\n    <IonAlert\r\n      mode=\"ios\"\r\n      isOpen={isOpen}\r\n      onDidDismiss={() => {\r\n        setIsOpen(false);\r\n      }}\r\n      message={alertData.message}\r\n      buttons={[\r\n        {\r\n          text: \"Cancel\",\r\n          role: \"cancel\",\r\n          cssClass: \"secondary\",\r\n          handler: alertData.onCancel,\r\n        },\r\n\r\n        {\r\n          text: \"Yes\",\r\n          handler: alertData.onYes,\r\n        },\r\n      ]}\r\n    />\r\n  );\r\n\r\n  return {\r\n    showDialog,\r\n    dialogJsx,\r\n  };\r\n}\r\n\r\nexport default useYesOrCancelDialogBox;\r\n","import React, { useEffect, useState } from \"react\";\r\n// import \"./ClockPanel.scss\";\r\nimport \"../../global-styles.scss\";\r\nimport { ApplicationUserContext } from \"../../context/ApplicationUserContext\";\r\nimport { AuthorizedItemsContext } from \"../../context/AuthorizedItemsContext\";\r\nimport {authHelper} from \"../../util/authHelper\";\r\nimport Map from \"./Map\";\r\nimport useYesOrCancelDialogBox from \"../../hooks/useYesOrCancelDialogBox\";\r\nimport useSimpleToast from \"../../hooks/useSimpleToast\";\r\nimport {Capacitor, Geolocation, GeolocationPosition} from \"@capacitor/core\";\r\nimport env, {getConstants} from \"../../api/environment\";\r\n\r\ninterface GeoLocationComponentProps {\r\n  updateCallback: (lat?: number, lng?: number) => void;\r\n  isShowing: boolean;\r\n}\r\n\r\n// Possible values for code, https://developer.mozilla.org/en-US/docs/Web/API/GeolocationPositionError\r\n// 1: PERMISSION_DENIED\r\n// 2: POSITION_UNAVAILABLE\r\n// 3: TIMEOUT\r\ninterface GeolocationPositionError {\r\n  code: number;\r\n}\r\n\r\nconst geoPositionOptions = {\r\n  enableHighAccuracy: true,\r\n  maximumAge: 1000,\r\n};\r\n\r\n\r\n// ------------------------------------------------------------------------------------\r\nfunction isGoogleMapsLoaded(): boolean {\r\n  const loaded = !(\r\n    google === undefined ||\r\n    google.maps === undefined ||\r\n    google.maps.geometry === undefined ||\r\n    google.maps.geometry.spherical === undefined ||\r\n    google.maps.geometry.spherical.computeDistanceBetween === undefined ||\r\n    google.maps.LatLng === undefined\r\n  );\r\n\r\n  if (!loaded) {\r\n    console.log(\"WARNING: google maps not yet loaded\");\r\n  }\r\n\r\n  return loaded;\r\n}\r\n\r\n// ------------------------------------------------------------------------------------\r\n//\r\n// ------------------------------------------------------------------------------------\r\nconst GeoLocationComponent: React.FC<GeoLocationComponentProps> = ({\r\n  updateCallback,\r\n  isShowing\r\n}: GeoLocationComponentProps) => {\r\n  const { user } = React.useContext(ApplicationUserContext);\r\n  const { auth } = React.useContext(AuthorizedItemsContext);\r\n  const [watchPositionId, setWatchPositionId] = useState(\"\" as string | number);\r\n  const [currentPosition, setCurrentPosition] = useState(null as GeolocationPosition | Position | null);\r\n  const yesCancelDlg = useYesOrCancelDialogBox();\r\n  const toast = useSimpleToast();\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n\r\n    // ----------------------------------------------------------------------------------------------\r\n    function startWatchPosition(\r\n      callback: (lat?: number, lng?: number) => void\r\n    ): string | number {\r\n\r\n      const watchPositionCallBack = (position: GeolocationPosition | Position) => {\r\n        if (!position || !position.coords) {\r\n          return;\r\n        }\r\n\r\n        let positionChanged = false;\r\n        if (currentPosition === null) {\r\n          positionChanged = true;\r\n        } else {\r\n          if (isGoogleMapsLoaded())\r\n          {\r\n            const oldPos = new google.maps.LatLng(\r\n              currentPosition.coords.latitude,\r\n              currentPosition.coords.longitude\r\n            );\r\n\r\n            const newPos = new google.maps.LatLng(\r\n              position.coords.latitude,\r\n              position.coords.longitude\r\n            );\r\n\r\n            const distance =\r\n              google.maps.geometry.spherical.computeDistanceBetween(\r\n                oldPos,\r\n                newPos\r\n              ) * 3.28084;\r\n\r\n            const minChange = getConstants(user).minimumFeetForGeolocationUpdate;\r\n            positionChanged = distance > minChange;\r\n          } else {\r\n            positionChanged = true;\r\n          }\r\n        }\r\n\r\n        if (positionChanged)\r\n        {\r\n          console.log(\"GEO: position changed\");\r\n          setCurrentPosition(position);\r\n          callback(position.coords.latitude, position.coords.longitude);\r\n        }\r\n      };\r\n\r\n      const errCallback = (err: GeolocationPositionError) => {\r\n        console.log(\"GEO: Could not get geolocation, error code \" + err.code);\r\n        if (err.code === 1) {\r\n          // permission denied\r\n          callback();\r\n        }\r\n      };\r\n\r\n      let watchId = \"\" as string | number;\r\n      if (\r\n        env.settings.hasCapacitor &&\r\n        Capacitor.isPluginAvailable(\"Geolocation\")\r\n      ) {\r\n        console.log(\"GEO: Using Cap plugin to watch position\");\r\n        try {\r\n          watchId = Geolocation.watchPosition(\r\n            geoPositionOptions,\r\n            watchPositionCallBack\r\n          );\r\n\r\n          Geolocation.getCurrentPosition(geoPositionOptions).then(pos => {\r\n            watchPositionCallBack(pos);\r\n          });\r\n        } catch (err) {\r\n          errCallback({ code: 1 });\r\n        }\r\n      } else if (navigator && navigator.geolocation) {\r\n        console.log(\"GEO: Using browser API\");\r\n        watchId = navigator.geolocation.watchPosition(\r\n          // @ts-ignore  (watchPositionCallBack's GeolocationPosition param is wonky between Cap & Nav\r\n          watchPositionCallBack,\r\n          errCallback,\r\n          geoPositionOptions\r\n        );\r\n\r\n        navigator.geolocation.getCurrentPosition((pos) => {\r\n          watchPositionCallBack(pos);\r\n        });\r\n      } else {\r\n        console.log(\r\n          \"GEO: Location unavailable via cap/nav\"\r\n        );\r\n        return \"\";\r\n      }\r\n\r\n      console.log(\"GEO: start watching, watchId \" + watchId);\r\n      return watchId;\r\n    }\r\n\r\n    // ----------------------------------------------------------------------------------------------\r\n    function clearWatchPosition(watchId: string | number) {\r\n      if (watchId === \"\") {\r\n        return;\r\n      }\r\n\r\n      if (\r\n        env.settings.hasCapacitor &&\r\n        Capacitor.isPluginAvailable(\"Geolocation\")\r\n      ) {\r\n        Geolocation.clearWatch({ id: watchId as string }).then(() => {\r\n          console.log(`GEO: cleared watchId ${watchId} from Capacitor plugin`);\r\n        });\r\n      } else if (navigator && navigator.geolocation) {\r\n        navigator.geolocation.clearWatch(watchId as number);\r\n        console.log(`GEO: cleared watchId ${watchId} from browser API`);\r\n      }\r\n    }\r\n\r\n    if (authHelper.requiresGeolocation(auth.locations)) {\r\n      if (isShowing) {\r\n        setWatchPositionId(startWatchPosition(updateCallback));\r\n      } else {\r\n        clearWatchPosition(watchPositionId);\r\n        setCurrentPosition(null);\r\n        setWatchPositionId(\"\");\r\n      }\r\n    }\r\n    // eslint-disable-next-line\r\n  }, [\r\n    isShowing, user.isLoggedin\r\n  ]);\r\n\r\n  return (\r\n    <>\r\n      {auth &&\r\n      auth.locations &&\r\n      auth.locations.length > 0 &&\r\n      authHelper.requiresGeolocation(auth.locations) && <Map pos={currentPosition} />}\r\n      {yesCancelDlg.dialogJsx}\r\n      {toast.simpleToastJsx}\r\n    </>\r\n  );\r\n\r\n\r\n\r\n};\r\n\r\nexport default GeoLocationComponent;\r\n","import React, { useState, useEffect, useRef } from \"react\";\r\nimport {\r\n  IonAlert,\r\n  IonLoading,\r\n  IonSelect,\r\n  IonModal,\r\n  IonLabel,\r\n  IonSelectOption,\r\n  IonIcon,\r\n  IonButton,\r\n  useIonViewWillEnter,\r\n  useIonViewWillLeave,\r\n  IonGrid,\r\n  IonRow,\r\n  IonCol,\r\n} from \"@ionic/react\";\r\nimport {\r\n  UnscheduledBreakOptions,\r\n  BreakType,\r\n  ClockInRequirement,\r\n  StartBreakResponseCode,\r\n  EndBreakResponseCode,\r\n} from \"../../enums\";\r\nimport \"../../global-styles.scss\";\r\nimport {LocationSettings} from \"../../orbital-interfaces/LocationSettings\";\r\nimport { TimeClockSettingsData } from \"../../orbital-interfaces/TimeClockSettingsData\";\r\nimport { time, cafe } from \"ionicons/icons\";\r\nimport BreakSelectorModal, { BreakItem } from \"./BreakSelectorModal\";\r\nimport {arrayHelper} from \"../../util/arrayHelper\";\r\nimport {timeClockApi} from \"../../api/timeClockApi\";\r\nimport { format, parseISO } from \"date-fns\";\r\nimport { ApplicationUserContext } from \"../../context/ApplicationUserContext\";\r\nimport { AuthorizedItemsContext } from \"../../context/AuthorizedItemsContext\";\r\nimport ClockoutModal from \"./ClockoutModal\";\r\nimport SwitchPositionOrTagButton from \"./SwitchPositionOrTagButton\";\r\nimport { useInterval } from \"../../hooks/useInterval\";\r\nimport GeoLocationComponent from \"./GeoLocationComponent\";\r\nimport useSimpleToast from \"../../hooks/useSimpleToast\";\r\nimport { getConstants } from \"../../api/environment\";\r\nimport {authHelper} from \"../../util/authHelper\";\r\n\r\ninterface ClockPanelProps {\r\n  onUpdate: () => void;\r\n  refreshToggle: boolean;\r\n}\r\n\r\ninterface List {\r\n  id: number;\r\n  name: string;\r\n}\r\n\r\nconst ClockPanel: React.FC<ClockPanelProps> = ({\r\n  onUpdate,\r\n  refreshToggle,\r\n}: ClockPanelProps) => {\r\n  const { user } = React.useContext(ApplicationUserContext);\r\n  const { auth } = React.useContext(AuthorizedItemsContext);\r\n  const [posList, setPosList] = useState([] as List[]);\r\n  const [selectedPosId, setSelectedPosId] = useState(0);\r\n  const positionRef = useRef(0);\r\n  const [tagSwitchingEnabled, setTagSwitchingEnabled] = useState(false);\r\n  const [tagList, setTagList] = useState([] as List[]);\r\n  const [selectedTagId, setSelectedTagId] = useState(null as number | null);\r\n  const tagRef = useRef(null as number | null);\r\n  const [breakSetting, setBreakSetting] = useState<\r\n    \"START BREAK\" | \"END BREAK\" | \"NONE\"\r\n  >(\"START BREAK\");\r\n  const [locSettings, setLocSettings] = useState({} as LocationSettings);\r\n  const [showBreakSelectorModal, setShowBreakSelectorModal] = useState(false);\r\n  const [showLoading, setShowLoading] = useState(false);\r\n  const [loadingMessage, setLoadingMessage] = useState(\"Please wait...\");\r\n  const [showAlertData, setShowAlertData] = useState({\r\n    show: false,\r\n    header: \"Alert\",\r\n    message: \"\",\r\n  });\r\n  const [tcData, setTCData] = useState(null as TimeClockSettingsData | null);\r\n  const [showClockoutModal, setShowClockoutModal] = useState(false);\r\n  const [refresh, setRefresh] = useState(false);\r\n  const [isShowing, setIsShowing] = useState(false);\r\n  const toast = useSimpleToast();\r\n  const [lat, setLat] = useState(undefined as number | undefined);\r\n  const [lng, setLng] = useState(undefined as number | undefined);\r\n\r\n  useIonViewWillEnter(() => {\r\n    setIsShowing(true);\r\n  });\r\n\r\n  useIonViewWillLeave(() => {\r\n    setIsShowing(false);\r\n  });\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (refresh !== refreshToggle) {\r\n      setRefresh(refreshToggle);\r\n    }\r\n\r\n    updateTimeClockData(lat, lng);\r\n\r\n    // eslint-disable-next-line\r\n  }, [refreshToggle]);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (!tcData || !auth || !auth.locations || auth.locations.length === 0) {\r\n      return;\r\n    }\r\n\r\n    if (tcData.ShowTimeClock) {\r\n      const uniqueLocationIds = arrayHelper.unique(\r\n        tcData.PositionsToClockInto.map((p) => p.LocationId)\r\n      );\r\n      const uniqueDeptIds = arrayHelper.unique(\r\n        tcData.PositionsToClockInto.map((p) => p.DepartmentId)\r\n      );\r\n      let plist: List[];\r\n      if (uniqueLocationIds.length > 1) {\r\n        plist = tcData.PositionsToClockInto.map((p) => {\r\n          return {\r\n            id: p.PositionId,\r\n            name: p.PositionNameWithLocAndDeptAbbreviation,\r\n          };\r\n        });\r\n      } else if (uniqueDeptIds.length > 1) {\r\n        plist = tcData.PositionsToClockInto.map((p) => {\r\n          return { id: p.PositionId, name: p.PositionNameWithDeptAbbreviation };\r\n        });\r\n      } else {\r\n        plist = tcData.PositionsToClockInto.map((p) => {\r\n          return { id: p.PositionId, name: p.PositionName };\r\n        });\r\n      }\r\n\r\n      let curPosId = selectedPosId;\r\n      if (curPosId === 0) {\r\n        if (tcData.UserClockedIn) {\r\n          curPosId = tcData.ClockedInScheduleEvent!.PositionId;\r\n          setSelectedPosId(curPosId);\r\n        } else if (\r\n          tcData.ScheduleEventsForClockIn &&\r\n          tcData.ScheduleEventsForClockIn.length > 0\r\n        ) {\r\n          curPosId = tcData.ScheduleEventsForClockIn[0].PositionId;\r\n          setSelectedPosId(curPosId);\r\n        } else if (plist.length > 0) {\r\n          curPosId = plist[0].id;\r\n          setSelectedPosId(curPosId);\r\n        } else {\r\n          curPosId = 0;\r\n        }\r\n      }\r\n\r\n      const curLocId = tcData.UserClockedIn\r\n        ? tcData.ClockedInScheduleEvent!.LocationId\r\n        : curPosId !== 0\r\n        ? auth.locations.filter((l) =>\r\n            l.departments.flatMap((d) =>\r\n              d.positions.flatMap((p) => p.id === curPosId)\r\n            )\r\n          )[0].id\r\n        : auth.locations[0].id;\r\n\r\n      const locSettings = auth.locations.filter((l) => l.id === curLocId)[0]\r\n        .settings;\r\n      setLocSettings(locSettings);\r\n\r\n      if (\r\n        locSettings.EnableEnhancedBreakManagement &&\r\n        (locSettings.UnscheduledBreakOptions !== UnscheduledBreakOptions.None ||\r\n          (tcData.ClockedInScheduleEvent!.EventBreaks &&\r\n            tcData.ClockedInScheduleEvent!.EventBreaks.length > 0))\r\n      ) {\r\n        setBreakSetting(\r\n          tcData.UserClockedIn && tcData.CurrentEventBreak\r\n            ? \"END BREAK\"\r\n            : \"START BREAK\"\r\n        );\r\n      } else {\r\n        setBreakSetting(\"NONE\");\r\n      }\r\n\r\n      setPosList(plist);\r\n      setTags(curPosId);\r\n    }\r\n    // eslint-disable-next-line\r\n  }, [auth, tcData, lat, lng]);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useInterval(\r\n    () => {\r\n      updateTimeClockData(lat, lng);\r\n    },\r\n    isShowing,\r\n    getConstants(user).refreshTimeclockSettingsTimer\r\n  );\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onGeoLocationUpdated = (newLat?: number, newLng?: number) => {\r\n    if (lat !== newLat) {\r\n      setLat(newLat);\r\n    }\r\n\r\n    if (lng !== newLng) {\r\n      setLng(newLng);\r\n    }\r\n\r\n    updateTimeClockData(newLat, newLng);\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const updateTimeClockData = (\r\n    curLat?: number | undefined,\r\n    curLng?: number | undefined\r\n  ) => {\r\n    timeClockApi.getTimeClockSettings(user, curLat, curLng).then((results) => {\r\n      setTCData(results);\r\n    });\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const setTags = (currentPositionId: number): number => {\r\n    if (!tcData) {\r\n      return -1;\r\n    }\r\n\r\n    const curLocId = tcData.UserClockedIn\r\n      ? tcData.ClockedInScheduleEvent!.LocationId\r\n      : auth.locations.filter((l) =>\r\n          l.departments.flatMap((d) =>\r\n            d.positions.flatMap((p) => p.id === currentPositionId)\r\n          )\r\n        )[0].id;\r\n    const locSettings = auth.locations.filter((l) => l.id === curLocId)[0]\r\n      .settings;\r\n\r\n    if (\r\n      locSettings.ClockInWithDifferentTag &&\r\n      tcData.TagsPerPosition[currentPositionId] &&\r\n      tcData.TagsPerPosition[currentPositionId].length > 1\r\n    ) {\r\n      setTagSwitchingEnabled(true);\r\n      const tagList = tcData.TagsPerPosition[currentPositionId].map((t) => {\r\n        return { id: t.TagId, name: t.TagName };\r\n      });\r\n      tagList.unshift({ id: -1, name: \"NONE\" });\r\n      setTagList(tagList);\r\n    } else {\r\n      setTagSwitchingEnabled(false);\r\n      return -1;\r\n    }\r\n\r\n    let tagId = -1;\r\n    if (tcData.UserClockedIn) {\r\n      if (tcData.ClockedInScheduleEvent!.TagId) {\r\n        tagId = tcData.ClockedInScheduleEvent!.TagId;\r\n      } else if (tcData.ClockedInScheduleEvent!.TagId === null) {\r\n        tagId = -1;\r\n      } else {\r\n        tagId = -1;\r\n      }\r\n    } else if (\r\n      tcData.TagsPerPosition[currentPositionId] &&\r\n      tcData.TagsPerPosition[currentPositionId].length > 0\r\n    ) {\r\n      if (\r\n        tcData.ScheduleEventsForClockIn &&\r\n        tcData.ScheduleEventsForClockIn[0] &&\r\n        tcData.ScheduleEventsForClockIn[0].TagId\r\n      ) {\r\n        tagId = tcData.ScheduleEventsForClockIn[0].TagId;\r\n      } else {\r\n        tagId = -1;\r\n      }\r\n    }\r\n\r\n    setSelectedTagId(tagId);\r\n    return tagId;\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onPositionChange = (newVal: number) => {\r\n    if (newVal !== selectedPosId && newVal !== positionRef.current) {\r\n      setSelectedPosId(newVal);\r\n      setTags(newVal);\r\n    }\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onTagChange = (newVal: number) => {\r\n    if (newVal !== selectedTagId && newVal !== tagRef.current) {\r\n      setSelectedTagId(newVal);\r\n    }\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const showAlert = (header: string, message: string) => {\r\n    setShowAlertData({ show: true, header, message });\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onBreakSelectorModalClose = (brk: BreakItem) => {\r\n    if (!tcData) {\r\n      return;\r\n    }\r\n\r\n    setShowBreakSelectorModal(false);\r\n    if (brk.key === \"Cancel\") {\r\n      return;\r\n    }\r\n\r\n    setLoadingMessage(\"Starting Break...\");\r\n    setShowLoading(true);\r\n\r\n    timeClockApi\r\n      .startBreak(\r\n        user,\r\n        tcData.ClockedInScheduleEvent!,\r\n        tcData.ScheduleEventsForClockIn[0],\r\n        brk.breakType,\r\n        lat,\r\n        lng,\r\n        brk.breakType === BreakType.Scheduled ? brk.key : undefined\r\n      )\r\n      .then((response) => {\r\n        setShowLoading(false);\r\n        if (\r\n          response.StartBreakResponseCode === StartBreakResponseCode.Success\r\n        ) {\r\n          toast.showToast(\r\n            \"Break started at \" +\r\n              format(parseISO(response.BreakStart), \"h:mmaaa\")\r\n          );\r\n          onUpdate();\r\n          updateTimeClockData(lat, lng);\r\n        } else {\r\n          showAlert(\r\n            \"Could not start break\",\r\n            `Unable to start break, ${response.Message}`\r\n          );\r\n        }\r\n      });\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const clockout = (clockOutValue?: number) => {\r\n    if (showClockoutModal) {\r\n      setShowClockoutModal(false);\r\n    }\r\n\r\n    setLoadingMessage(\"Clocking Out...\");\r\n    setShowLoading(true);\r\n\r\n    timeClockApi.clockOut(user, lat, lng, clockOutValue).then((response) => {\r\n      setShowLoading(false);\r\n      if (response.ClockOutResponseCode === 0) {\r\n        toast.showToast(\r\n          \"Clocked out at \" +\r\n            format(parseISO(response.ClockOutEvent.EventEnd), \"h:mmaaa\")\r\n        );\r\n        onUpdate();\r\n        updateTimeClockData(lat, lng);\r\n      } else {\r\n        showAlert(\r\n          \"Could not Clock Out\",\r\n          `Unable to Clock out, ${response.Message}`\r\n        );\r\n      }\r\n    });\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onClockOutClick = () => {\r\n    if (locSettings.ClockOutValueLabel) {\r\n      setShowClockoutModal(true);\r\n    } else {\r\n      clockout();\r\n    }\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onClockInClick = () => {\r\n    setLoadingMessage(\"Clocking in...\");\r\n    setShowLoading(true);\r\n\r\n    timeClockApi\r\n      .clockIn(user, selectedPosId, selectedTagId, lat, lng)\r\n      .then((response) => {\r\n        setShowLoading(false);\r\n        if (response.ClockInResponseCode === 0) {\r\n          toast.showToast(\r\n            \"Clocked in at \" +\r\n              format(parseISO(response.ClockInEvent.EventStart), \"h:mmaaa\")\r\n          );\r\n          onUpdate();\r\n          updateTimeClockData(lat, lng);\r\n        } else {\r\n          showAlert(\r\n            \"Could not Clock In\",\r\n            `Unable to Clock in, ${response.Message}`\r\n          );\r\n        }\r\n      });\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onBreakButtonClick = () => {\r\n    if (breakSetting === \"NONE\" || !tcData) {\r\n      return;\r\n    }\r\n\r\n    if (breakSetting === \"END BREAK\") {\r\n      setLoadingMessage(\"Ending Break...\");\r\n      setShowLoading(true);\r\n\r\n      timeClockApi\r\n        .endBreak(\r\n          user,\r\n          tcData.ClockedInScheduleEvent!,\r\n          tcData.ScheduleEventsForClockIn.length > 0\r\n            ? tcData.ScheduleEventsForClockIn[0]\r\n            : null,\r\n          lat,\r\n          lng\r\n        )\r\n        .then((response) => {\r\n          setShowLoading(false);\r\n          if (response.EndBreakResponseCode === EndBreakResponseCode.Success) {\r\n            toast.showToast(\r\n              `Ended break at ${format(parseISO(response.BreakEnd), \"h:mmaaa\")}`\r\n            );\r\n            onUpdate();\r\n            updateTimeClockData(lat, lng);\r\n          } else {\r\n            showAlert(\"Did not come off break\", response.Message);\r\n          }\r\n        });\r\n\r\n      return;\r\n    }\r\n\r\n    if (\r\n      locSettings.UnscheduledBreakOptions !== UnscheduledBreakOptions.None ||\r\n      (tcData.ClockedInScheduleEvent!.EventBreaks &&\r\n        tcData.ClockedInScheduleEvent!.EventBreaks.length > 0)\r\n    ) {\r\n      setShowBreakSelectorModal(true);\r\n    } else {\r\n      showAlert(\r\n        \"No implemented\",\r\n        \"Not implemented in ClockPanel.tsx for this scenario\"\r\n      );\r\n    }\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onSwitchClick = () => {\r\n    setLoadingMessage(\"Switching...\");\r\n    setShowLoading(true);\r\n\r\n    timeClockApi\r\n      .switchPositionOrTag(user, selectedPosId, selectedTagId, lat, lng)\r\n      .then((response) => {\r\n        setShowLoading(false);\r\n        if (response.AllowedToSwitchPositions || response.AllowedToSwitchTags) {\r\n          toast.showToast(\"Switched\");\r\n          onUpdate();\r\n          updateTimeClockData(lat, lng);\r\n        } else {\r\n          showAlert(\r\n            \"Could not switch\",\r\n            `${response.ClockInMessage} ${response.ClockOutMessage}`\r\n          );\r\n        }\r\n      });\r\n  };\r\n\r\n  if (!auth || !tcData) {\r\n    return <div>Loading...</div>;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <IonGrid className=\"clock-controls\">\r\n        {toast.simpleToastJsx}\r\n        <IonLoading\r\n          isOpen={showLoading}\r\n          onDidDismiss={() => setShowLoading(false)}\r\n          spinner=\"dots\"\r\n          message={loadingMessage}\r\n        />\r\n        {authHelper.requiresGeolocation(auth.locations) && (\r\n          <IonRow>\r\n            <IonCol size=\"12\">\r\n              <GeoLocationComponent\r\n                updateCallback={onGeoLocationUpdated}\r\n                isShowing={isShowing}\r\n              />\r\n            </IonCol>\r\n          </IonRow>\r\n        )}\r\n        {tcData.PositionsToClockInto && tcData.PositionsToClockInto.length > 1 && (\r\n          <IonRow>\r\n            <IonCol size=\"3\">\r\n              <IonLabel>Position</IonLabel>\r\n            </IonCol>\r\n            <IonCol size=\"9\">\r\n              <IonSelect\r\n                className=\"select\"\r\n                mode=\"ios\"\r\n                interface=\"action-sheet\"\r\n                onIonChange={(e) => onPositionChange(e.detail.value)}\r\n                disabled={\r\n                  !(\r\n                    ((tcData.UserClockedIn && tcData.UserMayClockOut) ||\r\n                      (!tcData.UserClockedIn && tcData.UserMayClockIn)) &&\r\n                    locSettings.ClockInRequirement !==\r\n                      ClockInRequirement.MatchingShift\r\n                  )\r\n                }\r\n                value={selectedPosId}\r\n              >\r\n                {posList.map((pos) => (\r\n                  <IonSelectOption key={pos.id} value={pos.id}>\r\n                    {pos.name}\r\n                  </IonSelectOption>\r\n                ))}\r\n              </IonSelect>\r\n            </IonCol>\r\n          </IonRow>\r\n        )}\r\n        {tagSwitchingEnabled && (\r\n          <IonRow>\r\n            <IonCol size=\"3\">\r\n              <IonLabel>~Tag</IonLabel>\r\n            </IonCol>\r\n            <IonCol size=\"9\">\r\n              <IonSelect\r\n                className=\"select\"\r\n                mode=\"ios\"\r\n                interface=\"action-sheet\"\r\n                onIonChange={(e) => onTagChange(e.detail.value)}\r\n                disabled={\r\n                  !(\r\n                    ((tcData.UserClockedIn && tcData.UserMayClockOut) ||\r\n                      (!tcData.UserClockedIn && tcData.UserMayClockIn)) &&\r\n                    locSettings.ClockInRequirement !==\r\n                      ClockInRequirement.MatchingShift\r\n                  )\r\n                }\r\n                value={selectedTagId}\r\n              >\r\n                {tagList.map((t) => (\r\n                  <IonSelectOption key={t.id} value={t.id}>\r\n                    {t.name}\r\n                  </IonSelectOption>\r\n                ))}\r\n              </IonSelect>\r\n            </IonCol>\r\n          </IonRow>\r\n        )}\r\n        {((tcData.PositionsToClockInto && tcData.PositionsToClockInto.length > 1) || tagSwitchingEnabled) && (\r\n          <IonRow>\r\n            <IonCol size=\"12\" className=\"ion-no-margin\">\r\n              <SwitchPositionOrTagButton\r\n                tcData={tcData}\r\n                locSettings={locSettings}\r\n                selectedPosId={selectedPosId}\r\n                selectedTagId={selectedTagId}\r\n                onSwitch={onSwitchClick}\r\n              />\r\n            </IonCol>\r\n          </IonRow>\r\n        )}\r\n        {!tcData.UserClockedIn && (\r\n          <IonRow>\r\n            <IonCol size=\"12\" className=\"ion-no-margin\">\r\n              <IonButton\r\n                className=\"clockin-button\"\r\n                onClick={onClockInClick}\r\n                disabled={!tcData.UserMayClockIn}\r\n              >\r\n                <IonIcon mode=\"md\" icon={time} /> CLOCK IN\r\n              </IonButton>\r\n            </IonCol>\r\n          </IonRow>\r\n        )}\r\n\r\n        {tcData.UserClockedIn && (\r\n          <IonRow>\r\n            <IonCol className=\"clockout-button-container\">\r\n              <IonButton\r\n                className=\"clockout-button\"\r\n                disabled={!tcData.UserMayClockOut}\r\n                expand=\"block\"\r\n                onClick={onClockOutClick}\r\n              >\r\n                <IonIcon mode=\"md\" icon={time} /> CLOCK OUT\r\n              </IonButton>\r\n\r\n              {breakSetting !== \"NONE\" && (\r\n                <IonButton\r\n                  onClick={onBreakButtonClick}\r\n                  expand=\"block\"\r\n                  className=\"break-button\"\r\n                  disabled={!tcData.UserMayClockOut}\r\n                >\r\n                  <IonIcon icon={cafe} />\r\n                  {breakSetting}\r\n                </IonButton>\r\n              )}\r\n            </IonCol>\r\n          </IonRow>\r\n        )}\r\n      </IonGrid>\r\n\r\n      <IonModal\r\n        isOpen={showBreakSelectorModal}\r\n        cssClass=\"mini-modal break-selector-modal\"\r\n      >\r\n        <BreakSelectorModal\r\n          auth={auth}\r\n          tcData={tcData}\r\n          onDismissModal={(selection) => onBreakSelectorModalClose(selection)}\r\n        />\r\n      </IonModal>\r\n\r\n      <IonModal\r\n        cssClass=\"mini-modal clockout-modal\"\r\n        isOpen={showClockoutModal}\r\n        onDidDismiss={() => {\r\n          setShowClockoutModal(false);\r\n        }}\r\n      >\r\n        <ClockoutModal\r\n          onCancel={() => {\r\n            setShowClockoutModal(false);\r\n          }}\r\n          onOk={clockout}\r\n          locSettings={locSettings}\r\n        />\r\n      </IonModal>\r\n\r\n      <IonAlert\r\n        isOpen={showAlertData.show}\r\n        onDidDismiss={() => setShowAlertData({ ...showAlertData, show: false })}\r\n        header={showAlertData.header}\r\n        message={showAlertData.message}\r\n        buttons={[\"OK\"]}\r\n      />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ClockPanel;\r\n","import React from \"react\";\n// import \"./PayrollPeriodChooser.scss\";\nimport \"../../global-styles.scss\";\nimport { IonIcon } from \"@ionic/react\";\nimport { arrowBack, arrowForward } from \"ionicons/icons\";\nimport { addDays, format } from \"date-fns\";\n\ninterface PayrollPeriodChooserProps {\n  startDate: Date | null;\n  endDate: Date | null;\n  onNextPayPeriod: () => void;\n  onPrevPayPeriod: () => void;\n}\n\nfunction getPayPeriodDateText(start: Date | null, end: Date | null) {\n  if (!start || !end) {\n    return \" \";\n  }\n\n  if (start.getMonth() !== end.getMonth()) {\n    return (\n      format(start, \"MMM d\").toUpperCase() +\n      \" - \" +\n      format(addDays(end, -1), \"MMM d\").toUpperCase()\n    );\n  }\n\n  return (\n    format(start, \"MMM d\").toUpperCase() + \" - \" + format(addDays(end, -1), \"d\")\n  );\n}\n\n// --------------------------------------------------------------------------------------\n//\n// --------------------------------------------------------------------------------------\nconst PayrollPeriodChooser: React.FC<PayrollPeriodChooserProps> = ({\n  startDate,\n  endDate,\n  onNextPayPeriod,\n  onPrevPayPeriod,\n}: PayrollPeriodChooserProps) => {\n  const isLoading = startDate === null || endDate === null;\n  const payPeriodDateText = isLoading\n    ? \"\"\n    : getPayPeriodDateText(startDate, endDate);\n\n  return (\n    <div className=\"chooser\">\n      <div className=\"top\">\n        <button onClick={onPrevPayPeriod} className=\"arrow\" key={-1}>\n          <IonIcon mode=\"ios\" icon={arrowBack} />\n        </button>\n\n        <div className=\"month-year-container\">\n          <div className=\"datetime-picker-container\">\n            <div className=\"datetime-picker\">{payPeriodDateText}</div>\n          </div>\n        </div>\n\n        <button onClick={onNextPayPeriod} className=\"arrow\" key={7}>\n          <IonIcon mode=\"ios\" icon={arrowForward} />\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default PayrollPeriodChooser;\n","import { ApplicationUser } from \"../context/ApplicationUserContext\";\r\nimport apiHelper from \"./orbitalApiHelper\";\r\nimport { timeHelper as th } from \"../util/timeHelper\";\r\nimport {PayrollPeriodData} from \"../orbital-interfaces/PayrollPeriodData\";\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function getPayPeriodDateForEmployee(\r\n  user: ApplicationUser,\r\n  locationId: number,\r\n  date: Date\r\n) {\r\n  const dateStr = th.formatDateTimeAsMvcString(date);\r\n  return (await apiHelper.get(\r\n    user,\r\n    \"api/v2/payroll/get/\" + locationId + \"/\" + dateStr\r\n  )) as PayrollPeriodData;\r\n}\r\n\r\nexport const payrollPeriodApi = {\r\n  getPayPeriodDateForEmployee,\r\n};\r\n","import React from \"react\";\r\nimport { OrbitalTime } from \"../../orbital-interfaces/OrbitalTime\";\r\nimport {LocationSettings} from \"../../orbital-interfaces/LocationSettings\";\r\nimport { timeHelper as th } from \"../../util/timeHelper\";\r\ninterface PayrollDetailListProps {\r\n  time: OrbitalTime | null;\r\n  locSettings: LocationSettings;\r\n  fontColor: string;\r\n}\r\n\r\nfunction getHoursString(locsettings: LocationSettings, time: OrbitalTime) {\r\n  return th.getTimeStringFromOrbitalTime(locsettings, time);\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst PayrollOrbitalTimeItem: React.FC<PayrollDetailListProps> = ({\r\n  time,\r\n  locSettings,\r\n  fontColor,\r\n}: PayrollDetailListProps) => {\r\n  if (time === null) {\r\n    return <span> -- </span>;\r\n  }\r\n\r\n  const displayColor = time.ActualHours === 0.0 ? \"#ddd\" : fontColor;\r\n\r\n  return (\r\n    <span style={{ color: displayColor }}>\r\n      {getHoursString(locSettings, time)}\r\n    </span>\r\n  );\r\n};\r\n\r\nexport default PayrollOrbitalTimeItem;\r\n","import React, { useContext } from \"react\";\r\nimport {\r\n  IonContent,\r\n  IonRow,\r\n  IonCol,\r\n  IonButtons,\r\n  IonButton,\r\n  IonIcon,\r\n  IonGrid,\r\n  IonHeader,\r\n  IonTitle,\r\n  IonToolbar,\r\n} from \"@ionic/react\";\r\nimport \"../../global-styles.scss\";\r\nimport { close } from \"ionicons/icons\";\r\nimport { parseISO } from \"date-fns\";\r\nimport {PayrollPeriodDateItem} from \"../../orbital-interfaces/PayrollPeriodData\";\r\nimport { timeHelper as th } from \"../../util/timeHelper\";\r\nimport {AuthorizedItems} from \"../../orbital-interfaces/AuthorizedItems\";\r\nimport {LocationSettings} from \"../../orbital-interfaces/LocationSettings\";\r\nimport PayrollOrbitalTimeItem from \"./PayrollOrbitalTimeItem\";\r\nimport { AuthorizedItemsContext } from \"../../context/AuthorizedItemsContext\";\r\n\r\ninterface AddBreakModalProps {\r\n  onClose: () => void;\r\n  data: PayrollPeriodDateItem;\r\n  locSettings: LocationSettings;\r\n}\r\n\r\nfunction getAbsentName(auth: AuthorizedItems, id: number) {\r\n  return auth.payrollEvents.filter((pe) => pe.id === id)[0].name;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst PayrollDetailModal: React.FC<AddBreakModalProps> = ({\r\n  onClose,\r\n  data,\r\n  locSettings,\r\n}: AddBreakModalProps) => {\r\n  const { auth } = useContext(AuthorizedItemsContext);\r\n\r\n  if (!data) {\r\n    return <div>loading</div>;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <IonHeader mode=\"ios\">\r\n        <IonToolbar>\r\n          <IonTitle>{th.getDateString(parseISO(data.date))}</IonTitle>\r\n          <IonButtons slot=\"end\">\r\n            <IonButton onClick={onClose}>\r\n              <IonIcon icon={ close } mode=\"ios\" slot=\"icon-only\" />\r\n            </IonButton>\r\n          </IonButtons>\r\n        </IonToolbar>\r\n      </IonHeader>\r\n      <IonContent>\r\n        <IonGrid>\r\n          {data.regular.ActualHours > 0.0 && (\r\n            <IonRow>\r\n              <IonCol size=\"7\">Regular</IonCol>\r\n              <IonCol size=\"5\">\r\n                <PayrollOrbitalTimeItem\r\n                  time={data.regular}\r\n                  locSettings={locSettings}\r\n                  fontColor=\"black\"\r\n                />\r\n              </IonCol>\r\n            </IonRow>\r\n          )}\r\n\r\n          {data.dailyOvertime.ActualHours > 0.0 && (\r\n            <IonRow>\r\n              <IonCol size=\"7\">Daily Overtime</IonCol>\r\n              <IonCol size=\"5\">\r\n                <PayrollOrbitalTimeItem\r\n                  time={data.dailyOvertime}\r\n                  locSettings={locSettings}\r\n                  fontColor=\"red\"\r\n                />\r\n              </IonCol>\r\n            </IonRow>\r\n          )}\r\n\r\n          {data.weeklyOvertime.ActualHours > 0.0 && (\r\n            <IonRow>\r\n              <IonCol size=\"7\">Weekly Overtime</IonCol>\r\n              <IonCol size=\"5\">\r\n                <PayrollOrbitalTimeItem\r\n                  time={data.weeklyOvertime}\r\n                  locSettings={locSettings}\r\n                  fontColor=\"red\"\r\n                />\r\n              </IonCol>\r\n            </IonRow>\r\n          )}\r\n\r\n          {data.special.ActualHours > 0.0 && (\r\n            <IonRow>\r\n              <IonCol size=\"7\">Special Dates</IonCol>\r\n              <IonCol size=\"5\">\r\n                <PayrollOrbitalTimeItem\r\n                  time={data.special}\r\n                  locSettings={locSettings}\r\n                  fontColor=\"black\"\r\n                />\r\n              </IonCol>\r\n            </IonRow>\r\n          )}\r\n\r\n          {data.timePerAbsent &&\r\n            data.timePerAbsent.map((hpa) => {\r\n              return (\r\n                <IonRow key={hpa.absentId}>\r\n                  <IonCol size=\"7\">{getAbsentName(auth, hpa.absentId)}</IonCol>\r\n                  <IonCol size=\"5\">\r\n                    <PayrollOrbitalTimeItem\r\n                      time={hpa.time}\r\n                      locSettings={locSettings}\r\n                      fontColor=\"#AD850C\"\r\n                    />\r\n                  </IonCol>\r\n                </IonRow>\r\n              );\r\n            })}\r\n        </IonGrid>\r\n      </IonContent>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PayrollDetailModal;\r\n","import React, { useContext, useState } from \"react\";\r\nimport { IonRow, IonCol, IonModal } from \"@ionic/react\";\r\nimport { format, parseISO } from \"date-fns\";\r\nimport {PayrollPeriodDateItem} from \"../../orbital-interfaces/PayrollPeriodData\";\r\nimport PayrollOrbitalTimeItem from \"./PayrollOrbitalTimeItem\";\r\nimport { AuthorizedItemsContext } from \"../../context/AuthorizedItemsContext\";\r\nimport {authHelper} from \"../../util/authHelper\";\r\nimport { ColumnEnum } from \"./PayrollDetailList\";\r\nimport PayrollDetailModal from \"./PayrollDetailModal\";\r\nimport Skeleton from \"react-loading-skeleton\";\r\n\r\ninterface PayrollDetailListProps {\r\n  payrollRow: PayrollPeriodDateItem | null;\r\n  colsToDisplay: ColumnEnum;\r\n  colSize: string;\r\n}\r\n\r\nfunction formatDateString(d: string) {\r\n  // return format(parseISO(d), \"EEE d\").toUpperCase();\r\n  return format(parseISO(d), \"EEE d\");\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst PayrollDetailRow: React.FC<PayrollDetailListProps> = ({\r\n  payrollRow,\r\n  colsToDisplay,\r\n  colSize,\r\n}: PayrollDetailListProps) => {\r\n  const { auth } = useContext(AuthorizedItemsContext);\r\n  const locSettings = authHelper.getLocSettingsForLocationId(\r\n    auth,\r\n    auth.locations[0].id\r\n  );\r\n  const [showDetailModal, setShowDetailModal] = useState(false);\r\n\r\n  if (payrollRow === null) {\r\n    return (\r\n      <IonRow>\r\n        <IonCol size=\"3\">\r\n          <Skeleton width={60} />\r\n        </IonCol>\r\n        <IonCol size=\"3\">\r\n          <Skeleton width={60} />\r\n        </IonCol>\r\n        <IonCol size=\"3\">\r\n          <Skeleton width={60} />\r\n        </IonCol>\r\n        <IonCol size=\"3\">\r\n          <Skeleton width={60} />\r\n        </IonCol>\r\n      </IonRow>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <IonRow>\r\n        <IonCol size={colSize}>\r\n          <button\r\n            className=\"payperiod-list-buttons\"\r\n            onClick={() => setShowDetailModal(true)}\r\n          >\r\n            {formatDateString(payrollRow!.date)}\r\n          </button>\r\n        </IonCol>\r\n\r\n        <IonCol\r\n          size={colSize}\r\n          color=\"secondary\"\r\n          hidden={(colsToDisplay & ColumnEnum.Regular) !== ColumnEnum.Regular}\r\n        >\r\n          <PayrollOrbitalTimeItem\r\n            time={payrollRow?.regular}\r\n            locSettings={locSettings}\r\n            fontColor=\"black\"\r\n          />\r\n        </IonCol>\r\n\r\n        <IonCol\r\n          size={colSize}\r\n          hidden={\r\n            (colsToDisplay & ColumnEnum.DailyOvertime) !==\r\n            ColumnEnum.DailyOvertime\r\n          }\r\n        >\r\n          <PayrollOrbitalTimeItem\r\n            time={payrollRow?.dailyOvertime}\r\n            locSettings={locSettings}\r\n            fontColor=\"red\"\r\n          />\r\n        </IonCol>\r\n\r\n        <IonCol\r\n          size={colSize}\r\n          hidden={\r\n            (colsToDisplay & ColumnEnum.WeeklyOvertime) !==\r\n            ColumnEnum.WeeklyOvertime\r\n          }\r\n        >\r\n          <PayrollOrbitalTimeItem\r\n            time={payrollRow?.weeklyOvertime}\r\n            locSettings={locSettings}\r\n            fontColor=\"red\"\r\n          />\r\n        </IonCol>\r\n\r\n        <IonCol\r\n          size={colSize}\r\n          hidden={(colsToDisplay & ColumnEnum.Special) !== ColumnEnum.Special}\r\n        >\r\n          <PayrollOrbitalTimeItem\r\n            time={payrollRow?.special}\r\n            locSettings={locSettings}\r\n            fontColor=\"black\"\r\n          />\r\n        </IonCol>\r\n\r\n        <IonCol\r\n          size={colSize}\r\n          hidden={(colsToDisplay & ColumnEnum.Absent) !== ColumnEnum.Absent}\r\n        >\r\n          <PayrollOrbitalTimeItem\r\n            time={payrollRow?.absent}\r\n            locSettings={locSettings}\r\n            fontColor=\"black\"\r\n          />\r\n        </IonCol>\r\n      </IonRow>\r\n\r\n      <IonModal\r\n        cssClass=\"mini-modal detail-modal\"\r\n        isOpen={showDetailModal}\r\n        onDidDismiss={() => setShowDetailModal(false)}\r\n      >\r\n        <PayrollDetailModal\r\n          onClose={() => setShowDetailModal(false)}\r\n          locSettings={locSettings}\r\n          data={payrollRow!}\r\n        />\r\n      </IonModal>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PayrollDetailRow;\r\n","import React, { useContext, useEffect, useState } from \"react\";\r\nimport { IonGrid, IonRow, IonCol } from \"@ionic/react\";\r\nimport {PayrollPeriodData} from \"../../orbital-interfaces/PayrollPeriodData\";\r\nimport \"../../global-styles.scss\";\r\nimport PayrollDetailRow from \"./PayrollDetailRow\";\r\nimport { AuthorizedItemsContext } from \"../../context/AuthorizedItemsContext\";\r\nimport {authHelper} from \"../../util/authHelper\";\r\nimport PayrollOrbitalTimeItem from \"./PayrollOrbitalTimeItem\";\r\nimport Skeleton from \"react-loading-skeleton\";\r\n\r\ninterface PayrollDetailListProps {\r\n  payrollData: PayrollPeriodData | null;\r\n}\r\n\r\nexport enum ColumnEnum {\r\n  None = 0,\r\n  Regular = 1 << 0,\r\n  DailyOvertime = 1 << 1,\r\n  WeeklyOvertime = 1 << 2,\r\n  Special = 1 << 3,\r\n  Absent = 1 << 4,\r\n  All = ~(~0 << 5),\r\n}\r\n\r\nfunction getColumnsToDisplay(\r\n  payrollData: PayrollPeriodData\r\n): { count: number; cols: ColumnEnum } {\r\n  let cols = ColumnEnum.Regular;\r\n  let count = 2;\r\n\r\n  if (payrollData.totalDailyOvertime.ActualHours > 0.0) {\r\n    cols |= ColumnEnum.DailyOvertime;\r\n    count++;\r\n  }\r\n\r\n  if (payrollData.totalWeeklyOvertime.ActualHours > 0.0) {\r\n    cols |= ColumnEnum.WeeklyOvertime;\r\n    count++;\r\n  }\r\n\r\n  if (payrollData.totalSpecial.ActualHours > 0.0) {\r\n    cols |= ColumnEnum.Special;\r\n    count++;\r\n  }\r\n\r\n  if (payrollData.totalAbsent.ActualHours > 0.0) {\r\n    cols |= ColumnEnum.Absent;\r\n    count++;\r\n  }\r\n\r\n  return { cols, count };\r\n}\r\n// --------------------------------------------------------------------------------------\r\nconst PayrollDetailList: React.FC<PayrollDetailListProps> = ({\r\n  payrollData,\r\n}: PayrollDetailListProps) => {\r\n  const { auth } = useContext(AuthorizedItemsContext);\r\n  const locSettings = authHelper.getLocSettingsForLocationId(\r\n    auth,\r\n    auth.locations[0].id\r\n  );\r\n  const [colsToDisplay, setColsToDisplay] = useState(ColumnEnum.None);\r\n  const [colSize, setColSize] = useState(\"3\");\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (!payrollData) {\r\n      return;\r\n    }\r\n\r\n    const { count, cols } = getColumnsToDisplay(payrollData);\r\n    setColsToDisplay(cols);\r\n    setColSize(count >= 5 ? \"2\" : \"3\");\r\n  }, [payrollData]);\r\n\r\n  if (payrollData === null) {\r\n    return (\r\n      <div className=\"grid-container\">\r\n        <IonGrid class=\"ion-text-end\">\r\n          <IonRow className=\"list-header\" class=\"ion-text-center\">\r\n            <IonCol size=\"3\">\r\n              <Skeleton width={40} />\r\n            </IonCol>\r\n            <IonCol size=\"3\">\r\n              <Skeleton width={40} />\r\n            </IonCol>\r\n            <IonCol size=\"3\">\r\n              <Skeleton width={40} />\r\n            </IonCol>\r\n            <IonCol size=\"3\">\r\n              <Skeleton width={40} />\r\n            </IonCol>\r\n          </IonRow>\r\n          {[1, 2, 3, 4, 5, 6, 7, 8, 9, 10].map((x) => {\r\n            return (\r\n              <PayrollDetailRow\r\n                payrollRow={null}\r\n                colSize=\"3\"\r\n                colsToDisplay={ColumnEnum.None}\r\n                key={x}\r\n              />\r\n            );\r\n          })}\r\n        </IonGrid>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"grid-container\">\r\n      <IonGrid class=\"ion-text-end\">\r\n        <IonRow className=\"list-header\" class=\"ion-text-center\">\r\n          <IonCol size={colSize}>DATE</IonCol>\r\n          <IonCol\r\n            size={colSize}\r\n            hidden={(colsToDisplay & ColumnEnum.Regular) !== ColumnEnum.Regular}\r\n          >\r\n            REG\r\n          </IonCol>\r\n          <IonCol\r\n            size={colSize}\r\n            hidden={\r\n              (colsToDisplay & ColumnEnum.DailyOvertime) !==\r\n              ColumnEnum.DailyOvertime\r\n            }\r\n          >\r\n            DAILY OT\r\n          </IonCol>\r\n          <IonCol\r\n            size={colSize}\r\n            hidden={\r\n              (colsToDisplay & ColumnEnum.WeeklyOvertime) !==\r\n              ColumnEnum.WeeklyOvertime\r\n            }\r\n          >\r\n            WKLY OT\r\n          </IonCol>\r\n          <IonCol\r\n            size={colSize}\r\n            hidden={(colsToDisplay & ColumnEnum.Special) !== ColumnEnum.Special}\r\n          >\r\n            SPECIAL\r\n          </IonCol>\r\n          <IonCol\r\n            size={colSize}\r\n            hidden={(colsToDisplay & ColumnEnum.Absent) !== ColumnEnum.Absent}\r\n          >\r\n            ABSENT\r\n          </IonCol>\r\n        </IonRow>\r\n        {payrollData?.list.map((row) => (\r\n          <PayrollDetailRow\r\n            key={row.date}\r\n            payrollRow={row}\r\n            colsToDisplay={colsToDisplay}\r\n            colSize={colSize}\r\n          />\r\n        ))}\r\n        <IonRow className=\"list-footer\">\r\n          <IonCol size={colSize}>TOTAL</IonCol>\r\n          <IonCol\r\n            size={colSize}\r\n            hidden={(colsToDisplay & ColumnEnum.Regular) !== ColumnEnum.Regular}\r\n          >\r\n            <PayrollOrbitalTimeItem\r\n              time={payrollData?.totalRegular}\r\n              locSettings={locSettings}\r\n              fontColor=\"black\"\r\n            />\r\n          </IonCol>\r\n          <IonCol\r\n            size={colSize}\r\n            hidden={\r\n              (colsToDisplay & ColumnEnum.DailyOvertime) !==\r\n              ColumnEnum.DailyOvertime\r\n            }\r\n          >\r\n            <PayrollOrbitalTimeItem\r\n              time={payrollData?.totalDailyOvertime}\r\n              locSettings={locSettings}\r\n              fontColor=\"red\"\r\n            />\r\n          </IonCol>\r\n          <IonCol\r\n            size={colSize}\r\n            hidden={\r\n              (colsToDisplay & ColumnEnum.WeeklyOvertime) !==\r\n              ColumnEnum.WeeklyOvertime\r\n            }\r\n          >\r\n            <PayrollOrbitalTimeItem\r\n              time={payrollData?.totalWeeklyOvertime}\r\n              locSettings={locSettings}\r\n              fontColor=\"red\"\r\n            />\r\n          </IonCol>\r\n          <IonCol\r\n            size={colSize}\r\n            hidden={(colsToDisplay & ColumnEnum.Special) !== ColumnEnum.Special}\r\n          >\r\n            <PayrollOrbitalTimeItem\r\n              time={payrollData?.totalSpecial}\r\n              locSettings={locSettings}\r\n              fontColor=\"black\"\r\n            />\r\n          </IonCol>\r\n          <IonCol\r\n            size={colSize}\r\n            hidden={(colsToDisplay & ColumnEnum.Absent) !== ColumnEnum.Absent}\r\n          >\r\n            <PayrollOrbitalTimeItem\r\n              time={payrollData?.totalAbsent}\r\n              locSettings={locSettings}\r\n              fontColor=\"black\"\r\n            />\r\n          </IonCol>\r\n        </IonRow>\r\n      </IonGrid>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PayrollDetailList;\r\n","import React, { useState, useEffect } from \"react\";\r\n// import \"./ClockPanel.scss\";\r\nimport \"../../global-styles.scss\";\r\nimport { addDays, parseISO } from \"date-fns\";\r\nimport { ApplicationUserContext } from \"../../context/ApplicationUserContext\";\r\nimport { AuthorizedItemsContext } from \"../../context/AuthorizedItemsContext\";\r\nimport PayrollPeriodChooser from \"./PayrollPeriodChooser\";\r\nimport {PayrollPeriodData} from \"../../orbital-interfaces/PayrollPeriodData\";\r\nimport {payrollPeriodApi} from \"../../api/payrollPeriodApi\";\r\nimport useDialogBox from \"../../hooks/useDialogBox\";\r\nimport PayrollDetailList from \"./PayrollDetailList\";\r\nimport { RefresherEventDetail } from \"@ionic/core\";\r\nimport useIonicRefresher from \"../../hooks/useIonicRefresher\";\r\nimport { IonContent } from \"@ionic/react\";\r\n\r\ninterface PayrollPeriodsTabProps {\r\n  date: Date | null;\r\n}\r\n\r\nconst PayrollPeriodsTab: React.FC<PayrollPeriodsTabProps> = ({\r\n  date,\r\n}: PayrollPeriodsTabProps) => {\r\n  const { user } = React.useContext(ApplicationUserContext);\r\n  const { auth } = React.useContext(AuthorizedItemsContext);\r\n  const [currentDate, setCurrentDate] = useState(null as Date | null);\r\n  const [startDate, setStartDate] = useState(null as Date | null);\r\n  const [endDate, setEndDate] = useState(null as Date | null);\r\n  const [payrollData, setPayrollData] = useState(\r\n    null as PayrollPeriodData | null\r\n  );\r\n  const dlg = useDialogBox();\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const doRefresh = (e: CustomEvent<RefresherEventDetail>) => {\r\n    getData(e);\r\n  };\r\n\r\n  const refresher = useIonicRefresher(doRefresh);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    let newStartDate = date;\r\n    if (date === null) {\r\n      newStartDate = new Date();\r\n    }\r\n\r\n    setCurrentDate(newStartDate);\r\n  }, [date]);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (currentDate == null) {\r\n      return;\r\n    }\r\n\r\n    getData();\r\n    // eslint-disable-next-line\r\n  }, [currentDate]);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  function getData(e?: CustomEvent<RefresherEventDetail>) {\r\n    payrollPeriodApi.getPayPeriodDateForEmployee(\r\n      user,\r\n      auth.locations[0].id,\r\n      currentDate!\r\n    ).then((data) => {\r\n      if (data.error) {\r\n        dlg.showAlert(\r\n          \"Error\",\r\n          \"Could not retrieve Payroll data: \" + data.message,\r\n          () => {}\r\n        );\r\n        return;\r\n      }\r\n\r\n      setStartDate(parseISO(data.start));\r\n      setEndDate(parseISO(data.end));\r\n      setPayrollData(data);\r\n      if (e) {\r\n        e.detail.complete();\r\n      }\r\n    });\r\n  }\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onNextPayPeriod = () => {\r\n    setCurrentDate(addDays(endDate!, 1));\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onPrevPayPeriod = () => {\r\n    setCurrentDate(addDays(startDate!, -1));\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <PayrollPeriodChooser\r\n        startDate={startDate}\r\n        endDate={endDate}\r\n        onNextPayPeriod={onNextPayPeriod}\r\n        onPrevPayPeriod={onPrevPayPeriod}\r\n      />\r\n      <IonContent>\r\n        {refresher.ionicRefresherJsx}\r\n        {auth && auth.locations && auth.locations.length > 0 && (\r\n          <PayrollDetailList payrollData={payrollData} />\r\n        )}\r\n        {dlg.alertBoxJsx}\r\n      </IonContent>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PayrollPeriodsTab;\r\n","import React, { useContext, useEffect, useState } from \"react\";\r\nimport \"../../global-styles.scss\";\r\nimport { ApplicationUserContext } from \"../../context/ApplicationUserContext\";\r\nimport useDialogBox from \"../../hooks/useDialogBox\";\r\nimport {\r\n  IonContent,\r\n  IonModal,\r\n  IonSpinner,\r\n  useIonViewWillEnter,\r\n  useIonViewWillLeave,\r\n} from \"@ionic/react\";\r\nimport { timeHelper as th } from \"../../util/timeHelper\";\r\nimport { EventInformation, HoursList } from \"../../orbital-interfaces/TEC\";\r\nimport EditEventModal from \"../EditEvent/EditEventModal\";\r\nimport { RefresherEventDetail } from \"@ionic/core\";\r\nimport useIonicRefresher from \"../../hooks/useIonicRefresher\";\r\nimport { AuthorizedItems } from \"../../orbital-interfaces/AuthorizedItems\";\r\nimport Skeleton from \"react-loading-skeleton\";\r\nimport EventCardSkeleton from \"../../components/SchedulePageComponents/EventCardSkeleton\";\r\nimport {getEditorValuesFromEventInformation, INITIAL_EDITOR_VAUES,} from \"../EditEvent/EditEventModalState\";\r\nimport {AuthorizedItemsContext} from \"../../context/AuthorizedItemsContext\";\r\nimport {useInterval} from \"../../hooks/useInterval\";\r\nimport {getConstants} from \"../../api/environment\";\r\nimport {EventFilter, EventFilterView} from \"../../orbital-interfaces/EventFilter\";\r\nimport {EventGroup} from \"../../enums\";\r\nimport {scheduleEventsApi} from \"../../api/scheduleEventsApi\";\r\nimport {authHelper} from \"../../util/authHelper\";\r\nimport {addHours} from \"date-fns\";\r\nimport {DailyNotes} from \"../../orbital-interfaces/DailyNotes\";\r\nimport EventList from \"../SchedulePageComponents/EventList\";\r\nimport useSimpleToast from \"../../hooks/useSimpleToast\";\r\n\r\ninterface ClockTodayTabProps {\r\n  refreshToggle: boolean;\r\n  onUpdate: () => void;\r\n}\r\n\r\n// ------------------------------------------------------------------------------------\r\nfunction createTodayFilter(auth: AuthorizedItems): EventFilter {\r\n  const positionIds = authHelper.getPositionIdsForEmployee(auth);\r\n  const locationIds = [] as number[];\r\n  for (let i = 0; i < positionIds.length; i++) {\r\n    const locId = authHelper.getLocationIdFromPositionid(auth, positionIds[i]);\r\n    if (!locationIds.includes(locId)) {\r\n      locationIds.push(locId);\r\n    }\r\n  }\r\n\r\n  const locSettings = authHelper.getLocSettingsForLocationId(\r\n    auth,\r\n    locationIds[0]\r\n  );\r\n  const start = th.getTodayStartForLocation(new Date(), locSettings);\r\n  const end = addHours(start, 24);\r\n\r\n  return {\r\n    settingsLocId: locationIds[0],\r\n    positionIds,\r\n    start,\r\n    end,\r\n    filterByEmployee: true,\r\n    dnLocIds: locationIds,\r\n    tagId: undefined,\r\n    eventTypeId: EventGroup.All,\r\n    eventStatusId: EventGroup.All,\r\n    view: EventFilterView.clock,\r\n  };\r\n}\r\n\r\n// ------------------------------------------------------------------------------------\r\n//\r\n// ------------------------------------------------------------------------------------\r\nconst ClockTodayTab: React.FC<ClockTodayTabProps> = ({\r\n  refreshToggle,\r\n  onUpdate,\r\n}: ClockTodayTabProps) => {\r\n  const doRefresh = (e: CustomEvent<RefresherEventDetail>) => {\r\n    getData(e);\r\n  };\r\n\r\n  const [scheduleEvents, setScheduleEvents] = useState(\r\n    [] as EventInformation[]\r\n  );\r\n  const [dailyNotes, setDailyNotes] = useState([] as DailyNotes[]);\r\n  const [hoursPerDay, setHoursPerDay] = useState([] as HoursList[]);\r\n  const toast = useSimpleToast();\r\n  const refresher = useIonicRefresher(doRefresh);\r\n  const { user } = React.useContext(ApplicationUserContext);\r\n  const dlg = useDialogBox();\r\n  const [showEventModal, setShowEventModal] = useState(false);\r\n  const [editEventId, setEditEventId] = useState(null as number | null);\r\n  const [initialEditEvent, setInitialEditEvent] = useState(\r\n    INITIAL_EDITOR_VAUES\r\n  );\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isShowing, setIsShowing] = useState(false);\r\n  const { auth } = useContext(AuthorizedItemsContext);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useIonViewWillEnter(() => {\r\n    setIsShowing(true);\r\n  });\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useIonViewWillLeave(() => {\r\n    setIsShowing(false);\r\n  });\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const forceRefresh = (toastMessage: string) => {\r\n    if (toastMessage && toastMessage.length > 0) {\r\n      toast.showToast(toastMessage);\r\n    }\r\n\r\n    getData();\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useInterval(\r\n    () => {\r\n      getData();\r\n    },\r\n    isShowing && !showEventModal,\r\n    getConstants(user).refreshScheduleTimer\r\n  );\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onEventClick = (ev: EventInformation) => {\r\n    setEditEventId(ev.ScheduleEventId);\r\n    setInitialEditEvent(getEditorValuesFromEventInformation(auth, ev));\r\n    setShowEventModal(true);\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  function getData(e?: CustomEvent<RefresherEventDetail>) {\r\n    try {\r\n      const apiFilter = createTodayFilter(auth);\r\n      scheduleEventsApi.getScheduleEventsByFilter(user, apiFilter).then(\r\n        (res) => {\r\n          setIsLoading(false);\r\n\r\n          if (e) {\r\n            e.detail.complete();\r\n          }\r\n\r\n          onUpdate();\r\n          setScheduleEvents(res.events);\r\n          setDailyNotes(res.dailyNotes);\r\n          setHoursPerDay(res.hoursPerDay);\r\n        }\r\n      );\r\n    } catch (e) {\r\n      console.log(\"Error in ClockTodayTab.getData: \" + e.message);\r\n    }\r\n  }\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    // eslint-disable-next-line\r\n    if (user && user.isLoggedin) {\r\n      setIsLoading(true);\r\n      getData(undefined);\r\n    }\r\n\r\n    // eslint-disable-next-line\r\n  }, [refreshToggle]);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onEventUpdated = () => {\r\n    getData(undefined);\r\n    setShowEventModal(false);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <IonContent>\r\n        {refresher.ionicRefresherJsx}\r\n        {isLoading &&\r\n          ((dailyNotes && dailyNotes.length > 0) ||\r\n            (scheduleEvents && scheduleEvents.length > 0)) && (\r\n            <IonSpinner className=\"center\" name=\"dots\" />\r\n          )}\r\n\r\n        {isLoading && (dailyNotes.length === 0 || scheduleEvents.length === 0) && (\r\n          <>\r\n            <div style={{ marginTop: \"10px\" }} />\r\n            <Skeleton height={40} width={310} />\r\n            <br />\r\n            <EventCardSkeleton threeRows={false} />\r\n            <EventCardSkeleton threeRows={false} />\r\n          </>\r\n        )}\r\n\r\n        {!isLoading && (\r\n          <EventList\r\n            events={scheduleEvents}\r\n            listType={\"today\"}\r\n            notes={dailyNotes}\r\n            hoursPerDay={hoursPerDay}\r\n            auth={auth}\r\n            onEdit={onEventClick}\r\n            onForceRefresh={forceRefresh}\r\n            weekStart={new Date()}\r\n          />\r\n        )}\r\n      </IonContent>\r\n\r\n      {toast.simpleToastJsx}\r\n\r\n      <IonModal\r\n        isOpen={showEventModal}\r\n        onDidDismiss={() => setShowEventModal(false)}\r\n      >\r\n        <EditEventModal\r\n          isOpen={showEventModal}\r\n          auth={auth}\r\n          onCancelModal={() => setShowEventModal(false)}\r\n          onDismissModal={() => onEventUpdated()}\r\n          scheduleEventId={editEventId}\r\n          initialEvent={initialEditEvent}\r\n        />\r\n      </IonModal>\r\n\r\n      {dlg.alertBoxJsx}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ClockTodayTab;\r\n","import React, { useState } from \"react\";\r\nimport {\r\n  IonFooter,\r\n  IonSegment,\r\n  IonSegmentButton,\r\n  IonHeader,\r\n  IonToolbar,\r\n  IonTitle,\r\n  IonPage,\r\n  IonButtons,\r\n  IonMenuButton,\r\n} from \"@ionic/react\";\r\n// import \"./ClockPage.scss\";\r\nimport \"../global-styles.scss\";\r\nimport ClockPanel from \"../components/ClockPageComponents/ClockPanel\";\r\nimport PayrollPeriodsTab from \"../components/ClockPageComponents/PayrollPeriodsTab\";\r\nimport ClockTodayTab from \"../components/ClockPageComponents/ClockTodayTab\";\r\n\r\nconst ClockPage: React.FC = () => {\r\n  const [segment, setSegment] = useState<\"today\" | \"pay-periods\">(\"today\");\r\n  const [refreshToggle, setRefreshToggle] = useState(false);\r\n  const [refreshTimeClockToggle, setRefreshTimeClockToggle] = useState(false);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onClockPanelUpdate = () => {\r\n    setRefreshToggle(!refreshToggle);\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onTodayPanelUpdate = () => {\r\n    console.log(\"onTodayPanelUpdate\");\r\n    setRefreshTimeClockToggle(!refreshTimeClockToggle);\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onSegmentChange = (segmentName: any) => {\r\n    setSegment(segmentName);\r\n  };\r\n\r\n  return (\r\n    <IonPage>\r\n      <IonHeader className=\"ion-no-border\">\r\n        <IonToolbar mode=\"md\">\r\n          <IonButtons slot=\"start\">\r\n            <IonMenuButton />\r\n          </IonButtons>\r\n          <IonTitle slot=\"start\">Clock</IonTitle>\r\n        </IonToolbar>\r\n      </IonHeader>\r\n\r\n      <IonSegment\r\n        mode=\"md\"\r\n        onIonChange={(e) => onSegmentChange(e.detail.value)}\r\n      >\r\n        <IonSegmentButton mode=\"md\" value=\"today\">\r\n          TODAY\r\n        </IonSegmentButton>\r\n\r\n        <IonSegmentButton mode=\"md\" value=\"pay-periods\">\r\n          PAY PERIOD\r\n        </IonSegmentButton>\r\n      </IonSegment>\r\n\r\n      {segment === \"today\" && (\r\n        <ClockTodayTab\r\n          refreshToggle={refreshToggle}\r\n          onUpdate={onTodayPanelUpdate}\r\n        />\r\n      )}\r\n\r\n      {segment === \"pay-periods\" && <PayrollPeriodsTab date={null} />}\r\n\r\n      <IonFooter>\r\n        {segment === \"today\" && (\r\n          <ClockPanel\r\n            refreshToggle={refreshTimeClockToggle}\r\n            onUpdate={onClockPanelUpdate}\r\n          />\r\n        )}\r\n      </IonFooter>\r\n    </IonPage>\r\n  );\r\n};\r\n\r\nexport default ClockPage;\r\n","import React from \"react\";\r\nimport { Message } from \"../../orbital-interfaces/Message\";\r\nimport { timeHelper as th } from \"../../util/timeHelper\";\r\n// import \"./MessageItem.scss\";\r\nimport \"../../global-styles.scss\";\r\nimport { bookmark } from \"ionicons/icons\";\r\nimport { IonIcon } from \"@ionic/react\";\r\n\r\ninterface MessageItemProps {\r\n  message: Message;\r\n  onMessageClick: () => void;\r\n}\r\n\r\n// ==============================================================================\r\nconst MessageItem: React.FC<MessageItemProps> = ({\r\n  message,\r\n  onMessageClick,\r\n}: MessageItemProps) => {\r\n  if (!message) {\r\n    return <div />;\r\n  }\r\n\r\n  const fontWeightForSubject = message.isViewed ? \"normal\" : \"bold\";\r\n\r\n  return (\r\n    <button className=\"message\" onClick={onMessageClick}>\r\n      <div className=\"top-line\">\r\n        <span className=\"subject\" style={{ fontWeight: fontWeightForSubject }}>\r\n          {message.isPinned && (\r\n            <IonIcon icon={bookmark} style={{ color: \"gray\" }} />\r\n          )}\r\n          {message.subject}\r\n        </span>\r\n        <span className=\"time\">\r\n          {th.messageDateString(message.deliveryDateTime)}{\" \"}\r\n        </span>\r\n      </div>\r\n      <div className=\"bottom-line\">{message.previewLine}</div>\r\n    </button>\r\n  );\r\n};\r\n\r\nexport default MessageItem;\r\n","import React, { useState } from \"react\";\r\nimport {\r\n  IonButton,\r\n  IonButtons,\r\n  IonIcon,\r\n  IonContent,\r\n  IonFooter,\r\n  IonHeader,\r\n  IonItem,\r\n  IonLabel,\r\n  IonSelect,\r\n  IonSelectOption,\r\n  IonTitle,\r\n  IonToolbar,\r\n} from \"@ionic/react\";\r\nimport \"../../global-styles.scss\";\r\nimport { arrowBackOutline } from \"ionicons/icons\";\r\nimport ToggleListEx from \"../ToggleListEx\";\r\nimport { NotificationTypeModel } from \"../../orbital-interfaces/NotificationTypeModel\";\r\n\r\nexport interface FilterData {\r\n  msgTypes: { messageTypeId: number; name: string }[];\r\n  employees: { employeeId: number; name: string }[];\r\n}\r\n\r\nexport interface FilterResult {\r\n  msgTypeIds: number[];\r\n  employeeId: number;\r\n}\r\n\r\ninterface MessagesFilterModalProps {\r\n  onDismissModal: (result: FilterResult) => void;\r\n  onCancelModal: () => void;\r\n  filterData: FilterData;\r\n}\r\n\r\nconst MessagesFilterModal: React.FC<MessagesFilterModalProps> = ({\r\n  onDismissModal,\r\n  onCancelModal,\r\n  filterData,\r\n}: MessagesFilterModalProps) => {\r\n  const [filterResult, setFilterResult] = useState({\r\n    msgTypeIds: filterData.msgTypes\r\n      ? filterData.msgTypes.map((mt) => mt.messageTypeId)\r\n      : ([] as number[]),\r\n    employeeId: -1,\r\n  } as FilterResult);\r\n\r\n  const [isDirty, setIsDirty] = useState(false);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onCloseModal = () => {\r\n    onDismissModal(filterResult);\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onCancel = () => {\r\n    onCancelModal();\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onResetAll = () => {\r\n    setFilterResult({\r\n      msgTypeIds: filterData.msgTypes.map((mt) => mt.messageTypeId),\r\n      employeeId: -1,\r\n    });\r\n    setIsDirty(false);\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onMessageTypeChange = (newSelection: NotificationTypeModel[]) => {\r\n    setFilterResult({\r\n      ...filterResult,\r\n      msgTypeIds: newSelection.map((mt) => mt.id),\r\n    });\r\n    setIsDirty(true);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <IonHeader className=\"ion-no-border\">\r\n        <IonToolbar>\r\n          <IonButtons slot=\"start\">\r\n            <IonButton onClick={onCancel}>\r\n              <IonIcon icon={arrowBackOutline} slot=\"icon-only\" />\r\n            </IonButton>\r\n          </IonButtons>\r\n          <IonTitle>Filter</IonTitle>\r\n          <IonButtons slot=\"end\">\r\n            <IonButton onClick={onResetAll}>RESET</IonButton>\r\n          </IonButtons>\r\n        </IonToolbar>\r\n      </IonHeader>\r\n\r\n      <IonContent class=\"outer-content\">\r\n        <IonItem>\r\n          <IonLabel>From</IonLabel>\r\n          <IonSelect\r\n            mode=\"ios\"\r\n            interface=\"action-sheet\"\r\n            value={filterResult.employeeId}\r\n            onIonChange={(e) => {\r\n              setFilterResult({ ...filterResult, employeeId: e.detail.value });\r\n              setIsDirty(true);\r\n            }}\r\n          >\r\n            <IonSelectOption key={-1} value={-1}>\r\n              EVERYONE\r\n            </IonSelectOption>\r\n            {filterData &&\r\n              filterData.employees &&\r\n              filterData.employees.map((emp) => (\r\n                <IonSelectOption key={emp.employeeId} value={emp.employeeId}>\r\n                  {emp.name}\r\n                </IonSelectOption>\r\n              ))}\r\n          </IonSelect>\r\n        </IonItem>\r\n        <IonItem lines=\"none\">\r\n          <IonLabel>Message Types</IonLabel>\r\n        </IonItem>\r\n        {filterData.msgTypes && (\r\n          <ToggleListEx\r\n            list={filterData.msgTypes.map((mt) => {\r\n              return { id: mt.messageTypeId, name: mt.name, description: \"\" };\r\n            })}\r\n            selected={filterData.msgTypes\r\n              .filter((mt) =>\r\n                filterResult.msgTypeIds.includes(mt.messageTypeId)\r\n              )\r\n              .map((mt) => {\r\n                return { id: mt.messageTypeId, name: mt.name, description: \"\" };\r\n              })}\r\n            selectionChanged={onMessageTypeChange}\r\n          />\r\n        )}\r\n      </IonContent>\r\n\r\n      <IonFooter>\r\n        <IonButton\r\n          className=\"apply-button\"\r\n          expand=\"block\"\r\n          onClick={onCloseModal}\r\n          disabled={!isDirty}\r\n        >\r\n          APPLY FILTER\r\n        </IonButton>\r\n      </IonFooter>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default MessagesFilterModal;\r\n","import { KeyedCollection } from \"../util/KeyedCollection\";\r\n\r\nexport interface MessageType {\r\n  id: number;\r\n  typeName: string;\r\n  description: string;\r\n}\r\n\r\nconst types: MessageType[] = [\r\n  { id: 1, typeName: \"CoverRequestMessage\", description: \"Cover-Request\" },\r\n  { id: 2, typeName: \"CoverApprovedMessage\", description: \"Cover-Approved\" },\r\n  {\r\n    id: 3,\r\n    typeName: \"DirectCoverRequestMessage\",\r\n    description: \"Direct Cover-Request\",\r\n  },\r\n  { id: 5, typeName: \"ShiftRequestMessage\", description: \"Shift-Request\" },\r\n  { id: 6, typeName: \"ShiftRequestDeniedMessage\", description: \"Shift-Denied\" },\r\n  {\r\n    id: 10,\r\n    typeName: \"ShiftRequestReceivedMessage\",\r\n    description: \"Shift-Request Received\",\r\n  },\r\n  {\r\n    id: 20,\r\n    typeName: \"NoClockInAlertMessage\",\r\n    description: \"No Clock In Alert\",\r\n  },\r\n  {\r\n    id: 21,\r\n    typeName: \"NoClockOutAlertMessage\",\r\n    description: \"No Clock Out Alert\",\r\n  },\r\n  {\r\n    id: 22,\r\n    typeName: \"LateClockInMessage\",\r\n    description: \"Late Clock In Alert\",\r\n  },\r\n  {\r\n    id: 23,\r\n    typeName: \"EarlyClockOutAlertMessage\",\r\n    description: \"Early Clock Out Alert\",\r\n  },\r\n  {\r\n    id: 50,\r\n    typeName: \"ScheduleEventUpdatedMessage\",\r\n    description: \"Schedule Event Updated\",\r\n  },\r\n  {\r\n    id: 60,\r\n    typeName: \"PublishedScheduleUpdatedMessage\",\r\n    description: \"Published Schedule Updated\",\r\n  },\r\n  {\r\n    id: 80,\r\n    typeName: \"PasswordRecoveryMessage\",\r\n    description: \"Password Recovery\",\r\n  },\r\n  {\r\n    id: 81,\r\n    typeName: \"VerifyCellPhoneMessage\",\r\n    description: \"Verify Cell Phone\",\r\n  },\r\n  {\r\n    id: 82,\r\n    typeName: \"VerifyCellPhoneCompleteMessage\",\r\n    description: \"Verify Cell Phone Completed\",\r\n  },\r\n  { id: 83, typeName: \"VerifyEmailMessage\", description: \"Verify Email\" },\r\n  { id: 100, typeName: \"CustomMessage\", description: \"Custom Messages\" },\r\n  {\r\n    id: 101,\r\n    typeName: \"WeeklyScheduleForEmployeeMessage\",\r\n    description: \"Employee Weekly Schedule\",\r\n  },\r\n  { id: 555, typeName: \"WelcomeMessage\", description: \"Welcome\" },\r\n  {\r\n    id: 603,\r\n    typeName: \"UpdatePaymentInformationMessage\",\r\n    description: \"Update Payment Information\",\r\n  },\r\n  {\r\n    id: 700,\r\n    typeName: \"UpgradeSubscriptionMessage\",\r\n    description: \"Upgrade Subscription (to Orbital)\",\r\n  },\r\n  { id: 701, typeName: \"FailedSignupMessage\", description: \"Failed Signup\" },\r\n  { id: 702, typeName: \"GenericErrorMessage\", description: \"Error Message\" },\r\n  { id: 704, typeName: \"SignupMessage\", description: \"Signup Completed\" },\r\n  {\r\n    id: 705,\r\n    typeName: \"DatesOutOfSyncMessage\",\r\n    description: \"Dates Out of Sync\",\r\n  },\r\n  {\r\n    id: 708,\r\n    typeName: \"CancelSubscriptionMessage\",\r\n    description: \"Canceled Subscription  \",\r\n  },\r\n];\r\n\r\nexport const messageTypes = new KeyedCollection<MessageType>();\r\n\r\ntypes.map((t) => messageTypes.add(\"\" + t.id, t));\r\n","import { Message } from \"../orbital-interfaces/Message\";\r\nimport { ApplicationUser } from \"../context/ApplicationUserContext\";\r\nimport apiHelper from \"./orbitalApiHelper\";\r\nimport {ApiErrorResult} from \"../orbital-interfaces/ApiErrorResult\";\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function getUserMessage(user: ApplicationUser, msgId: number) {\r\n  return (await apiHelper.get(\r\n    user,\r\n    \"api/v2/employee/messages/\" + msgId\r\n  )) as Message;\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function getUserMessages(user: ApplicationUser) {\r\n  return (await apiHelper.get(user, \"api/v2/employee/messages\")) as Message[];\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function getReadCount(user: ApplicationUser, msgId: number) {\r\n  return (await apiHelper.get(\r\n    user,\r\n    \"api/v1/employee/messages/\" + msgId + \"/readCount\"\r\n  )) as number;\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function setIsPinned(\r\n  user: ApplicationUser,\r\n  msgId: number,\r\n  isPinned: boolean\r\n) {\r\n  return await apiHelper.post(\r\n    user,\r\n    \"api/v1/employee/messages/\" + msgId + \"/togglePin\",\r\n    { isPinned }\r\n  );\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function setIsViewed(\r\n  user: ApplicationUser,\r\n  msgId: number,\r\n  isViewed: boolean\r\n) {\r\n  return await apiHelper.post(\r\n    user,\r\n    \"api/v1/employee/messages/\" + msgId + \"/toggleView\",\r\n    { isViewed }\r\n  );\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function deleteMessage(user: ApplicationUser, msgId: number) {\r\n  return await apiHelper.del(user, \"api/v1/employee/messages/\" + msgId);\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function getUnreadCount(user: ApplicationUser) {\r\n  if (!user.isLoggedin) {\r\n    return 0;\r\n  }\r\n\r\n  return (await apiHelper.get(\r\n    user,\r\n    \"api/v2/employee/messages/unreadCount\"\r\n  )) as number;\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------\r\nasync function sendMessage(\r\n  user: ApplicationUser,\r\n  locId: number,\r\n  channel: number,\r\n  empIds: number[],\r\n  text: string\r\n) {\r\n  return (await apiHelper.post(user, \"api/v2/employee/messages/send\", {\r\n    locId,\r\n    channel,\r\n    empIds,\r\n    text,\r\n  })) as ApiErrorResult;\r\n}\r\n\r\nexport const messageApi = {\r\n  getUserMessage,\r\n  getUserMessages,\r\n  getReadCount,\r\n  setIsPinned,\r\n  setIsViewed,\r\n  deleteMessage,\r\n  getUnreadCount,\r\n  sendMessage,\r\n};\r\n","import React, { useState, useEffect, useContext } from \"react\";\r\nimport { ApplicationUserContext } from \"./ApplicationUserContext\";\r\nimport {messageApi} from \"../api/messageApi\";\r\nimport { useInterval } from \"../hooks/useInterval\";\r\nimport { getConstants } from \"../api/environment\";\r\n\r\nexport interface IMessagesState {\r\n  unreadMessagesCount: number;\r\n  unreadMessageCountWhenViewed: number;\r\n\r\n}\r\n\r\nexport interface IMessagesContext extends IMessagesState {\r\n  refreshCount: () => void;\r\n  messagesViewed: () => void;\r\n  hasNewMessages: boolean;\r\n}\r\n\r\nconst INITIAL_MESSAGES_CONTEXT: IMessagesContext = {\r\n  unreadMessagesCount: 0,\r\n  unreadMessageCountWhenViewed: 0,\r\n  refreshCount: () => {},\r\n  messagesViewed: () => {},\r\n  hasNewMessages: false\r\n};\r\n\r\nexport const MessagesContext = React.createContext<IMessagesContext>(\r\n  INITIAL_MESSAGES_CONTEXT\r\n);\r\n\r\nconst COUNT_STORAGE_KEY = \"unreadMessageCountWhenViewed\";\r\n\r\n// ------------------------------------------------------------------------------------\r\nfunction getCountFromStorage(): number {\r\n  const fromStorageCount = localStorage.getItem(COUNT_STORAGE_KEY);\r\n  if (fromStorageCount !== null) {\r\n    return parseInt(fromStorageCount);\r\n  }\r\n\r\n  return 0;\r\n}\r\n\r\n// ------------------------------------------------------------------------------------\r\nfunction putCountIntoStorage(cnt: number) {\r\n  localStorage.setItem(COUNT_STORAGE_KEY, cnt.toString());\r\n}\r\n\r\n\r\n// --------------------------------------------------------------------------------------\r\n//\r\n// --------------------------------------------------------------------------------------\r\nexport const MessagesContextProvider = (props: any) => {\r\n  const { user } = useContext(ApplicationUserContext);\r\n  const [messagesState, internalSetMessagesState] = useState<IMessagesState>({\r\n    unreadMessagesCount: 0,\r\n    unreadMessageCountWhenViewed: 0\r\n  });\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  function refreshCount() {\r\n    getUnreadCount();\r\n  }\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  function messagesViewed() {\r\n    const newViewCount = messagesState.unreadMessagesCount;\r\n\r\n    if (newViewCount !== messagesState.unreadMessageCountWhenViewed) {\r\n      internalSetMessagesState({\r\n        ...messagesState,\r\n        unreadMessageCountWhenViewed: newViewCount\r\n      });\r\n\r\n      putCountIntoStorage(newViewCount);\r\n    }\r\n  }\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  function getUnreadCount() {\r\n    if (user.isLoggedin) {\r\n      messageApi.getUnreadCount(user).then((newUnreadCount) => {\r\n\r\n        let newUnreadMessageCountWhenViewed = messagesState.unreadMessageCountWhenViewed;\r\n        if (newUnreadMessageCountWhenViewed === 0) {\r\n          newUnreadMessageCountWhenViewed = getCountFromStorage();\r\n        }\r\n\r\n        if (newUnreadCount < newUnreadMessageCountWhenViewed) {\r\n          newUnreadMessageCountWhenViewed = newUnreadCount;\r\n          putCountIntoStorage(newUnreadMessageCountWhenViewed);\r\n        }\r\n\r\n        if (newUnreadCount !== messagesState.unreadMessagesCount ||\r\n            newUnreadMessageCountWhenViewed !== messagesState.unreadMessageCountWhenViewed) {\r\n          const newState: IMessagesState = {\r\n            unreadMessageCountWhenViewed: newUnreadMessageCountWhenViewed,\r\n            unreadMessagesCount: newUnreadCount\r\n          };\r\n\r\n          internalSetMessagesState(newState);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (user.isLoggedin) {\r\n      getUnreadCount();\r\n    }\r\n    // eslint-disable-next-line\r\n  }, [user.isLoggedin]);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useInterval(\r\n    () => {\r\n      getUnreadCount();\r\n    },\r\n    true,\r\n    getConstants(user).checkUnreadMessageCountTimer\r\n  );\r\n\r\n  return (\r\n    <MessagesContext.Provider\r\n      value={{\r\n        refreshCount,\r\n        messagesViewed,\r\n        unreadMessagesCount: messagesState.unreadMessagesCount,\r\n        unreadMessageCountWhenViewed: messagesState.unreadMessageCountWhenViewed,\r\n        hasNewMessages:\r\n          messagesState.unreadMessagesCount > messagesState.unreadMessageCountWhenViewed\r\n      }}\r\n    >\r\n      {props.children}\r\n    </MessagesContext.Provider>\r\n  );\r\n};\r\n","import React, { useContext, useEffect, useState } from \"react\";\r\nimport {\r\n  IonButton,\r\n  IonButtons,\r\n  IonIcon,\r\n  IonContent,\r\n  IonFooter,\r\n  IonHeader,\r\n  IonGrid,\r\n  IonRow,\r\n  IonCol,\r\n  IonToolbar,\r\n} from \"@ionic/react\";\r\nimport { arrowBackOutline, bookmark, trash } from \"ionicons/icons\";\r\nimport \"../../global-styles.scss\";\r\nimport { ApplicationUserContext } from \"../../context/ApplicationUserContext\";\r\nimport useDialogBox from \"../../hooks/useDialogBox\";\r\nimport { Message } from \"../../orbital-interfaces/Message\";\r\nimport { AuthorizedItemsContext } from \"../../context/AuthorizedItemsContext\";\r\nimport { timeHelper as th } from \"../../util/timeHelper\";\r\nimport {scheduleEventsApi} from \"../../api/scheduleEventsApi\";\r\nimport {messageApi} from \"../../api/messageApi\";\r\nimport { ScheduleEvent } from \"../../orbital-interfaces/ScheduleEvent\";\r\nimport { MessagesReducerAction } from \"../../pages/MessagesPage\";\r\nimport useYesOrCancelDialogBox from \"../../hooks/useYesOrCancelDialogBox\";\r\nimport { MessagesContext } from \"../../context/MessagesContext\";\r\nimport EventRequestEditorEx from \"../EditEvent/editor/EventRequestEditorEx\";\r\nimport {getEditorValuesFromScheduleEvent} from \"../EditEvent/EditEventModalState\";\r\n\r\ninterface ViewMessageModalProps {\r\n  message: Message | null;\r\n  onCloseModal: (msg: string | null) => void;\r\n  updateMessages: React.Dispatch<MessagesReducerAction>;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nconst ViewMessagetModal: React.FC<ViewMessageModalProps> = ({\r\n  message,\r\n  onCloseModal,\r\n  updateMessages,\r\n}) => {\r\n  const dlg = useDialogBox();\r\n  const yesCancelDlg = useYesOrCancelDialogBox();\r\n  const { user } = React.useContext(ApplicationUserContext);\r\n  const { auth } = React.useContext(AuthorizedItemsContext);\r\n  const [scheduleEvent, setScheduleEvent] = useState(null as ScheduleEvent | null);\r\n  const [readCount, setReadCount] = useState(null as number | null);\r\n  const [usageText, setUsageText] = useState(null as string | null);\r\n  const [pinned, setPinned] = useState(false);\r\n  const { refreshCount } = useContext(MessagesContext);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (!message) {\r\n      return;\r\n    }\r\n\r\n    if (message.scheduleEventId) {\r\n      scheduleEventsApi\r\n        .getScheduleEvent(user, message.scheduleEventId)\r\n        .then((event) => {\r\n          if (event) {\r\n            setScheduleEvent(event);\r\n          }\r\n        });\r\n    } else {\r\n      if (scheduleEvent) {\r\n        setScheduleEvent(null);\r\n        setUsageText(null);\r\n      }\r\n    }\r\n\r\n    messageApi.getReadCount(user, message.messageId).then((newReadCount) => {\r\n      setReadCount(newReadCount);\r\n    });\r\n\r\n    if (!message.isViewed) {\r\n      messageApi.setIsViewed(user, message.messageId, true).then(() => {\r\n        updateMessages({\r\n          type: \"UPDATE-VIEWED\",\r\n          msgId: message.messageId,\r\n          isViewed: true,\r\n        });\r\n      });\r\n    }\r\n\r\n    setPinned(message.isPinned);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [message?.messageId]);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onPinnedClick = () => {\r\n    const newPinValue = !pinned;\r\n    messageApi.setIsPinned(user, message!.messageId, newPinValue).then(() => {\r\n      setPinned(newPinValue);\r\n      updateMessages({\r\n        type: \"UPDATE-PINNED\",\r\n        msgId: message!.messageId,\r\n        isPinned: newPinValue,\r\n      });\r\n    });\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onDeleteClick = () => {\r\n    yesCancelDlg.showDialog(\r\n      \"Delete this message?\",\r\n      () => {\r\n        messageApi.deleteMessage(user, message!.messageId).then(() => {\r\n          updateMessages({ type: \"DELETE\", msgId: message!.messageId });\r\n          onCancel(\"Message Deleted\");\r\n        });\r\n      },\r\n      () => { }\r\n    );\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onCancel = (msg: string | null) => {\r\n    if (!message?.isViewed) {\r\n      refreshCount();\r\n    }\r\n\r\n    onCloseModal(msg);\r\n  };\r\n\r\n  if (!message || !auth || !auth.locations || auth.locations.length === 0) {\r\n    return (\r\n      <>\r\n        <div>Loading</div>\r\n        {dlg.alertBoxJsx}\r\n      </>\r\n    );\r\n  } else {\r\n    return (\r\n      <>\r\n        <IonHeader className=\"ion-no-border\">\r\n          <IonToolbar>\r\n            <IonButtons slot=\"start\">\r\n              <IonButton\r\n                onClick={() => {\r\n                  onCancel(null);\r\n                }}\r\n              >\r\n                <IonIcon icon={arrowBackOutline} mode=\"md\" slot=\"icon-only\" />\r\n              </IonButton>\r\n            </IonButtons>\r\n            <IonButtons slot=\"end\">\r\n              <IonButton\r\n                onClick={() => {\r\n                  onPinnedClick();\r\n                }}\r\n              >\r\n                <IonIcon\r\n                  icon={bookmark}\r\n                  style={pinned ? { color: \"black\" } : { color: \"lightgray\" }}\r\n                />\r\n              </IonButton>\r\n              <IonButton\r\n                onClick={() => {\r\n                  onDeleteClick();\r\n                }}\r\n              >\r\n                <IonIcon icon={trash} />\r\n              </IonButton>\r\n            </IonButtons>\r\n          </IonToolbar>\r\n        </IonHeader>\r\n\r\n        <IonContent class=\"outer-contentMessage\">\r\n          <IonGrid>\r\n            <IonRow class=\"messageIonRow-header\">\r\n              <IonCol class=\"messageHeaderSubject\" size=\"12\" >\r\n                {message!.subject}\r\n              </IonCol>\r\n\r\n              <IonCol class=\"messageHeaderDetails\" size=\"12\">\r\n                From: {message!.fromEmployeeFirstName}{\" \"}\r\n                {message!.fromEmployeeLastName}\r\n              </IonCol>\r\n\r\n              <IonCol class=\"messageHeaderDetails\" size=\"9\" >\r\n                {th.getMessageDeliveryTimeString(message!.deliveryDateTime)}\r\n              </IonCol>\r\n\r\n              <IonCol class=\"readCounter\" size=\"3\" >\r\n                {readCount !== null && <span>{readCount} Read</span>}\r\n              </IonCol>\r\n            </IonRow>\r\n            <div/>\r\n\r\n            <IonRow class=\"messageIonRow-content\">\r\n              <IonCol class=\"messageBlock\" size=\"12\">\r\n                <div\r\n                  dangerouslySetInnerHTML={{ __html: message?.messageText }}\r\n                />\r\n              </IonCol>\r\n            </IonRow>\r\n\r\n            {usageText !== null && (\r\n              <IonRow>\r\n                <IonCol size=\"12\">{usageText}</IonCol>\r\n              </IonRow>\r\n            )}\r\n          </IonGrid>\r\n\r\n          {dlg.alertBoxJsx}\r\n          {yesCancelDlg.dialogJsx}\r\n        </IonContent>\r\n\r\n        <IonFooter>\r\n          {scheduleEvent !== null && (\r\n            <EventRequestEditorEx\r\n              auth={auth}\r\n              update={() => {}}\r\n              cancelEditModal={onCancel}\r\n              editorValues={getEditorValuesFromScheduleEvent(auth, scheduleEvent)}\r\n              messageId={message.messageId}\r\n            />\r\n          )}\r\n        </IonFooter>\r\n      </>\r\n    );\r\n  }\r\n};\r\n\r\nexport default ViewMessagetModal;\r\n","import React, { useContext, useState } from \"react\";\r\nimport { IonItem, IonLabel, IonSelect, IonSelectOption } from \"@ionic/react\";\r\nimport \"../../../global-styles.scss\";\r\nimport { AuthorizedItemsContext } from \"../../../context/AuthorizedItemsContext\";\r\nimport {authHelper, PositionEx } from \"../../../util/authHelper\";\r\nimport {\r\n  AuthorizedItems,\r\n  AuthorizedLocation,\r\n  AuthorizedPosition,\r\n} from \"../../../orbital-interfaces/AuthorizedItems\";\r\nimport {Role} from \"../../../enums\";\r\n\r\ninterface PositionSelectorProps {\r\n  currentPosition: PositionEx;\r\n  onPositionUpdate: (pos: PositionEx) => void;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction isAdminAtLocation(\r\n  auth: AuthorizedItems,\r\n  location: AuthorizedLocation\r\n) {\r\n  if (auth.role === Role.LocationAdmin || auth.role === Role.BusinessAdmin) {\r\n    return true;\r\n  }\r\n\r\n  if (auth.role === Role.Employee) {\r\n    return false;\r\n  }\r\n\r\n  return location.departments.find((d) => d.isDeptAdmin) !== undefined;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction setPositionForLocation(\r\n  auth: AuthorizedItems,\r\n  locationId: number\r\n): PositionEx {\r\n  const location = authHelper.getLocationFromLocationId(auth, locationId);\r\n  if (location === null) {\r\n    throw new Error(\"Can't find location\");\r\n  }\r\n\r\n  return {\r\n    location,\r\n    department: null,\r\n    position: null,\r\n  };\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction setPositionForDepartment(\r\n  auth: AuthorizedItems,\r\n  pos: PositionEx,\r\n  departmentId: number | null\r\n): PositionEx {\r\n  if (departmentId === null) {\r\n    return setPositionForLocation(auth, pos.location.id);\r\n  }\r\n\r\n  const department = pos.location.departments.filter(\r\n    (d) => d.id === departmentId\r\n  )[0];\r\n  return {\r\n    location: pos.location,\r\n    department,\r\n    position: null,\r\n  };\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction setPositionForPosition(\r\n  auth: AuthorizedItems,\r\n  pos: PositionEx,\r\n  positionId: number | null\r\n): PositionEx {\r\n  if (positionId === null) {\r\n    return {\r\n      location: pos.location,\r\n      department: pos.department,\r\n      position: null,\r\n    };\r\n  }\r\n\r\n  const position = pos.department!.positions.filter(\r\n    (p) => p.id === positionId\r\n  )[0];\r\n  return {\r\n    location: pos.location,\r\n    department: pos.department,\r\n    position,\r\n  };\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction getPositionListForSelection(sel: PositionEx): AuthorizedPosition[] {\r\n  if (sel.department !== null) {\r\n    return sel.department.positions;\r\n  }\r\n\r\n  return sel.location.departments.flatMap((d) => d.positions);\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\n//\r\n// --------------------------------------------------------------------------------------\r\nconst PositionSelector: React.FC<PositionSelectorProps> = ({\r\n  currentPosition,\r\n  onPositionUpdate,\r\n}) => {\r\n  const { auth } = useContext(AuthorizedItemsContext);\r\n  const [selectedPosition, setSelectedPosition] = useState(currentPosition);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const updateLocation = (locId: number | undefined | null) => {\r\n    if (!locId) {\r\n      return;\r\n    }\r\n\r\n    const newPos = setPositionForLocation(auth, locId);\r\n    setSelectedPosition(newPos);\r\n    onPositionUpdate(newPos);\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const updateDepartment = (depId: number | undefined | null) => {\r\n    if (depId === undefined) {\r\n      return;\r\n    }\r\n\r\n    const newPos = setPositionForDepartment(auth, selectedPosition, depId);\r\n    setSelectedPosition(newPos);\r\n    onPositionUpdate(newPos);\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const updatePosition = (posId: number | undefined | null) => {\r\n    if (posId === undefined) {\r\n      return;\r\n    }\r\n\r\n    const newPos = setPositionForPosition(auth, selectedPosition, posId);\r\n    setSelectedPosition(newPos);\r\n    onPositionUpdate(newPos);\r\n  };\r\n\r\n  if (!auth || !auth.locations || auth.locations.length === 0) {\r\n    return (\r\n      <>\r\n        <div>Loading</div>\r\n      </>\r\n    );\r\n  } else {\r\n    return (\r\n      <>\r\n        <IonItem>\r\n          <IonLabel>Location</IonLabel>\r\n          <IonSelect\r\n            mode=\"ios\"\r\n            interface=\"action-sheet\"\r\n            value={selectedPosition.location.id}\r\n            onIonChange={(e) => updateLocation(e.detail.value)}\r\n          >\r\n            {auth.locations\r\n              .filter((l) => isAdminAtLocation(auth, l))\r\n              .map((loc) => (\r\n                <IonSelectOption key={loc.id} value={loc.id}>\r\n                  {loc.name}\r\n                </IonSelectOption>\r\n              ))}\r\n          </IonSelect>\r\n        </IonItem>\r\n        <IonItem>\r\n          <IonLabel>Department</IonLabel>\r\n          <IonSelect\r\n            mode=\"ios\"\r\n            interface=\"action-sheet\"\r\n            value={\r\n              selectedPosition.department === null\r\n                ? null\r\n                : selectedPosition.department.id\r\n            }\r\n            onIonChange={(e) => updateDepartment(e.detail.value)}\r\n          >\r\n            <IonSelectOption key={-1} value={null}>\r\n              All Departments\r\n            </IonSelectOption>\r\n            {selectedPosition.location.departments &&\r\n              selectedPosition.location.departments\r\n                .filter((dep) => authHelper.isDeptAdmin(auth, dep.id))\r\n                .map((dep) => (\r\n                  <IonSelectOption key={dep.id} value={dep.id}>\r\n                    {dep.name}\r\n                  </IonSelectOption>\r\n                ))}\r\n          </IonSelect>\r\n        </IonItem>\r\n        <IonItem>\r\n          <IonLabel>Position</IonLabel>\r\n          <IonSelect\r\n            mode=\"ios\"\r\n            interface=\"action-sheet\"\r\n            value={\r\n              selectedPosition.position === null\r\n                ? null\r\n                : selectedPosition.position.id\r\n            }\r\n            onIonChange={(e) => updatePosition(e.detail.value)}\r\n          >\r\n            <IonSelectOption key={-1} value={null}>\r\n              All Positions\r\n            </IonSelectOption>\r\n            {getPositionListForSelection(selectedPosition).map((pos) => (\r\n              <IonSelectOption key={pos.id} value={pos.id}>\r\n                {selectedPosition.department === null\r\n                  ? authHelper.getDepartmentFromPositionId(auth, pos.id)!.abbr +\r\n                    \"/\" +\r\n                    pos.name\r\n                  : pos.name}\r\n              </IonSelectOption>\r\n            ))}\r\n          </IonSelect>\r\n        </IonItem>\r\n      </>\r\n    );\r\n  }\r\n};\r\n\r\nexport default PositionSelector;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport {\r\n  IonCheckbox,\r\n  IonContent,\r\n  IonRow,\r\n  IonCol,\r\n  IonButtons,\r\n  IonButton,\r\n  IonFooter,\r\n  IonGrid,\r\n  IonHeader,\r\n  IonTitle,\r\n  IonToolbar,\r\n  IonIcon,\r\n} from \"@ionic/react\";\r\nimport \"../../../global-styles.scss\";\r\nimport {EmployeeCommunication} from \"../../../orbital-interfaces/EmployeeCommunication\";\r\nimport { mail, notifications, phonePortrait, close } from \"ionicons/icons\";\r\n\r\ninterface EmployeeSelectorModalProps {\r\n  onCancel: () => void;\r\n  onOk: (employees: EmployeeCommunication[]) => void;\r\n  employeeList: EmployeeCommunication[];\r\n  selectedEmployeeList: EmployeeCommunication[];\r\n  channel: number;\r\n}\r\n\r\nconst emailIcon = <IonIcon icon={mail} />;\r\nconst textIcon = <IonIcon icon={phonePortrait} />;\r\nconst pushIcon = <IonIcon icon={notifications} />;\r\n\r\n// --------------------------------------------------------------------------------------\r\nexport function isEmployeeEnabled(\r\n  emp: EmployeeCommunication,\r\n  channel: number\r\n): boolean {\r\n  switch (channel) {\r\n    case -1:\r\n      return emp.hasEmail || emp.hasText || emp.hasPush;\r\n    case 1:\r\n      return emp.hasEmail;\r\n    case 2:\r\n      return emp.hasText;\r\n    case 3:\r\n      return emp.hasPush;\r\n    default:\r\n      return false;\r\n  }\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\n//\r\n// --------------------------------------------------------------------------------------\r\nconst EmployeeSelectorModal: React.FC<EmployeeSelectorModalProps> = ({\r\n  onCancel,\r\n  onOk,\r\n  employeeList,\r\n  selectedEmployeeList,\r\n  channel,\r\n}: EmployeeSelectorModalProps) => {\r\n  const [list, setList] = useState([] as EmployeeCommunication[]);\r\n  const [isAllChecked, setIsAllChecked] = useState(false);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    const newList = employeeList.map((e) => {\r\n      return {\r\n        id: e.id,\r\n        name: e.name,\r\n        hasEmail: e.hasEmail,\r\n        hasText: e.hasText,\r\n        hasPush: e.hasPush,\r\n        isChecked: selectedEmployeeList.some((s) => s.id === e.id),\r\n      };\r\n    });\r\n\r\n    setList(newList);\r\n  }, [employeeList, selectedEmployeeList]);\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  function onOkClick() {\r\n    onOk(list.filter((e) => e.isChecked));\r\n  }\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  function onEmployeeChecked(empId: number) {\r\n    let checkCount = 0;\r\n    const newList = list.map((e) => {\r\n      if (!isEmployeeEnabled(e, channel)) {\r\n        return { ...e, isChecked: false };\r\n      }\r\n\r\n      if (e.isChecked) {\r\n        if (e.id === empId) {\r\n          return { ...e, isChecked: false };\r\n        } else {\r\n          checkCount++;\r\n          return { ...e, isChecked: isEmployeeEnabled(e, channel) };\r\n        }\r\n      } else {\r\n        if (e.id === empId) {\r\n          checkCount++;\r\n          return { ...e, isChecked: isEmployeeEnabled(e, channel) };\r\n        } else {\r\n          return { ...e, isChecked: false };\r\n        }\r\n      }\r\n    });\r\n\r\n    const allCheckCount = employeeList.filter((e) =>\r\n      isEmployeeEnabled(e, channel)\r\n    ).length;\r\n\r\n    setIsAllChecked(checkCount === allCheckCount);\r\n    setList(newList);\r\n  }\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  function onAllClick() {\r\n    const newValue = !isAllChecked;\r\n\r\n    const newList = list.map((e) => {\r\n      if (!isEmployeeEnabled(e, channel)) {\r\n        return { ...e, isChecked: false };\r\n      }\r\n\r\n      return { ...e, isChecked: newValue };\r\n    });\r\n\r\n    setList(newList);\r\n    setIsAllChecked(newValue);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <IonHeader mode=\"ios\">\r\n        <IonToolbar>\r\n          <IonTitle>Employees</IonTitle>\r\n          <IonButtons slot=\"end\">\r\n            <IonButton onClick={onCancel}>\r\n              <IonIcon icon={close} mode=\"ios\" slot=\"icon-only\" />\r\n            </IonButton>\r\n          </IonButtons>\r\n        </IonToolbar>\r\n      </IonHeader>\r\n      <IonContent>\r\n        <IonGrid>\r\n          <IonRow key={-1}>\r\n            <IonCol size=\"3\">\r\n              <IonCheckbox\r\n                className=\"checkbox\"\r\n                checked={isAllChecked}\r\n                onClick={onAllClick}\r\n              />\r\n            </IonCol>\r\n            <IonCol className=\"label\" size=\"6\">\r\n              Select All\r\n            </IonCol>\r\n            <IonCol size=\"1\">{emailIcon}</IonCol>\r\n            <IonCol size=\"1\">{textIcon}</IonCol>\r\n            <IonCol size=\"1\">{pushIcon}</IonCol>\r\n          </IonRow>\r\n          {list.map((emp) => (\r\n            <IonRow key={emp.id}>\r\n              <IonCol size=\"3\">\r\n                <IonCheckbox\r\n                  className=\"checkbox\"\r\n                  checked={emp.isChecked}\r\n                  disabled={!isEmployeeEnabled(emp, channel)}\r\n                  onClick={() => {\r\n                    onEmployeeChecked(emp.id);\r\n                  }}\r\n                />\r\n              </IonCol>\r\n              <IonCol className=\"label\" size=\"6\">\r\n                {emp.name}\r\n              </IonCol>\r\n              <IonCol size=\"1\">{emp.hasEmail && emailIcon}</IonCol>\r\n              <IonCol size=\"1\">{emp.hasText && textIcon}</IonCol>\r\n              <IonCol size=\"1\">{emp.hasText && pushIcon}</IonCol>\r\n            </IonRow>\r\n          ))}\r\n        </IonGrid>\r\n      </IonContent>\r\n      <IonFooter>\r\n        <IonButton expand=\"block\" color=\"secondary\" onClick={onOkClick}>\r\n          OK\r\n        </IonButton>\r\n      </IonFooter>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default EmployeeSelectorModal;\r\n","import React, { useContext, useEffect, useState } from \"react\";\r\nimport {\r\n  IonButton,\r\n  IonItem,\r\n  IonLabel,\r\n  IonSelect,\r\n  IonSelectOption,\r\n  IonModal,\r\n} from \"@ionic/react\";\r\nimport \"../../../global-styles.scss\";\r\nimport { AuthorizedItemsContext } from \"../../../context/AuthorizedItemsContext\";\r\nimport {AuthorizedItems} from \"../../../orbital-interfaces/AuthorizedItems\";\r\nimport {Role} from \"../../../enums\";\r\nimport { PositionEx } from \"../../../util/authHelper\";\r\nimport PositionSelector from \"./PositionSelector\";\r\nimport {employeesApi} from \"../../../api/employeesApi\";\r\nimport {EmployeeCommunication} from \"../../../orbital-interfaces/EmployeeCommunication\";\r\nimport { ApplicationUserContext } from \"../../../context/ApplicationUserContext\";\r\nimport EmployeeSelectorModal, {\r\n  isEmployeeEnabled,\r\n} from \"./EmployeeSelectorModal\";\r\nimport { useShowLoading } from \"../../../hooks/useShowLoading\";\r\n\r\ninterface MessageChannel {\r\n  id: number;\r\n  text: string;\r\n}\r\n\r\nconst messageChannels: MessageChannel[] = [\r\n  { id: -1, text: \"All Channels\" },\r\n  { id: 1, text: \"Email\" },\r\n  { id: 2, text: \"Text\" },\r\n  { id: 3, text: \"Push Notification\" },\r\n];\r\n\r\ninterface EmployeesSelectorProps {\r\n  onUpdate: (\r\n    empList: EmployeeCommunication[],\r\n    locId: number,\r\n    channel: number\r\n  ) => void;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction getFirstAvailablePosition(auth: AuthorizedItems): PositionEx {\r\n  for (let i = 0; i < auth.locations.length; i++) {\r\n    const curLoc = auth.locations[i];\r\n\r\n    if (curLoc.adminAllDepts) {\r\n      return {\r\n        location: curLoc,\r\n        department: null,\r\n        position: null,\r\n      };\r\n    }\r\n\r\n    for (let j = 0; j < curLoc.departments.length; j++) {\r\n      const curDep = curLoc.departments[j];\r\n      if (curDep.isDeptAdmin) {\r\n        return {\r\n          location: curLoc,\r\n          department: curDep,\r\n          position: null,\r\n        };\r\n      }\r\n    }\r\n  }\r\n\r\n  throw new Error(\r\n    \"Could not find a department where this user could send messages\"\r\n  );\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\nfunction getEmployeeButtonName(selList: EmployeeCommunication[]) {\r\n  if (selList.length === 0) {\r\n    return \"None Selected\";\r\n  }\r\n\r\n  if (selList.length === 1) {\r\n    return selList[0].name;\r\n  }\r\n\r\n  return `${selList.length} Selected`;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\n//\r\n// --------------------------------------------------------------------------------------\r\nconst EmployeesSelector: React.FC<EmployeesSelectorProps> = ({ onUpdate }) => {\r\n  const { user } = useContext(ApplicationUserContext);\r\n  const { auth } = useContext(AuthorizedItemsContext);\r\n  const [selectedRole, setSelectedRole] = useState(\"All\" as \"All\" | Role);\r\n  const [selectedPosition, setSelectedPosition] = useState(\r\n    getFirstAvailablePosition(auth)\r\n  );\r\n  const [selectedChannel, setSelectedChannel] = useState(-1);\r\n  const [selectedEmployees, setSelectedEmployees] = useState(\r\n    [] as EmployeeCommunication[]\r\n  );\r\n  const [employeeList, setEmployeeList] = useState(\r\n    [] as EmployeeCommunication[]\r\n  );\r\n\r\n  const [showEmployeeModal, setShowEmployeeModal] = useState(false);\r\n\r\n  const onAddMessageModalCancel = () => {\r\n    setShowEmployeeModal(false);\r\n  };\r\n\r\n  const loading = useShowLoading(\"Retreiving employee list\");\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  function fetchEmployees(\r\n    locId: number,\r\n    depId: number,\r\n    posId: number,\r\n    channel: number,\r\n    role: string\r\n  ) {\r\n    loading.setShowLoading(true);\r\n    employeesApi\r\n      .getEmployeeListForCommunication(user, locId, depId, posId, channel, role)\r\n      .then((emp) => {\r\n        setEmployeeList(emp);\r\n      })\r\n      .finally(() => {\r\n        loading.setShowLoading(false);\r\n      });\r\n  }\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onRoleUpdate = (newRole: \"All\" | Role) => {\r\n    if (newRole !== selectedRole) {\r\n      setSelectedRole(newRole);\r\n      setSelectedEmployees([]);\r\n      fetchEmployees(\r\n        selectedPosition.location.id,\r\n        selectedPosition.department === null\r\n          ? -1\r\n          : selectedPosition.department.id,\r\n        selectedPosition.position === null ? -1 : selectedPosition.position.id,\r\n        selectedChannel,\r\n        newRole\r\n      );\r\n    }\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onPositionUpdate = (posEx: PositionEx) => {\r\n    setSelectedPosition(posEx);\r\n    setSelectedEmployees([]);\r\n    fetchEmployees(\r\n      posEx.location.id,\r\n      posEx.department === null ? -1 : posEx.department.id,\r\n      posEx.position === null ? -1 : posEx.position.id,\r\n      selectedChannel,\r\n      selectedRole\r\n    );\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onChannelUpdate = (newChannelId: number | null | undefined) => {\r\n    if (newChannelId === null || newChannelId === undefined) {\r\n      return;\r\n    }\r\n\r\n    if (newChannelId !== selectedChannel) {\r\n      setSelectedEmployees([]);\r\n      setSelectedChannel(newChannelId);\r\n    }\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onEmployeeUpdate = (newEmployeeList: EmployeeCommunication[]) => {\r\n    setSelectedEmployees(newEmployeeList);\r\n    setShowEmployeeModal(false);\r\n    onUpdate(newEmployeeList, selectedPosition.location.id, selectedChannel);\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (auth.locations && auth.locations.length > 0) {\r\n      fetchEmployees(auth.locations[0].id, -1, -1, 0, \"All\");\r\n    }\r\n\r\n    // eslint-disable-next-line\r\n  }, [auth.locations]);\r\n\r\n  if (!auth || !auth.locations || auth.locations.length === 0) {\r\n    return (\r\n      <>\r\n        <div>Loading</div>\r\n      </>\r\n    );\r\n  } else {\r\n    return (\r\n      <>\r\n        <IonItem>\r\n          <IonLabel>Role</IonLabel>\r\n          <IonSelect\r\n            mode=\"ios\"\r\n            interface=\"action-sheet\"\r\n            value={selectedRole}\r\n            onIonChange={(e) => {\r\n              onRoleUpdate(e.detail.value);\r\n            }}\r\n          >\r\n            <IonSelectOption value={\"All\"} key={-1}>\r\n              All\r\n            </IonSelectOption>\r\n            <IonSelectOption value={Role.BusinessAdmin} key={2}>\r\n              Business Admin\r\n            </IonSelectOption>\r\n            <IonSelectOption value={Role.LocationAdmin} key={3}>\r\n              Location Admin\r\n            </IonSelectOption>\r\n            <IonSelectOption value={Role.Admin} key={4}>\r\n              Admin\r\n            </IonSelectOption>\r\n            <IonSelectOption value={Role.Employee} key={5}>\r\n              Employee\r\n            </IonSelectOption>\r\n          </IonSelect>\r\n        </IonItem>\r\n        <PositionSelector\r\n          currentPosition={selectedPosition}\r\n          onPositionUpdate={onPositionUpdate}\r\n        />\r\n        <IonItem>\r\n          <IonLabel>Send To</IonLabel>\r\n          <IonSelect\r\n            mode=\"ios\"\r\n            interface=\"action-sheet\"\r\n            value={selectedChannel}\r\n            onIonChange={(e) => onChannelUpdate(e.detail.value)}\r\n          >\r\n            {messageChannels.map((channel) => (\r\n              <IonSelectOption key={channel.id} value={channel.id}>\r\n                {channel.text}\r\n              </IonSelectOption>\r\n            ))}\r\n          </IonSelect>\r\n        </IonItem>\r\n        <IonItem>\r\n          <IonLabel>\r\n            Employees (\r\n            {\r\n              employeeList.filter((e) => isEmployeeEnabled(e, selectedChannel))\r\n                .length\r\n            }{\" \"}\r\n            / {employeeList.length})\r\n          </IonLabel>\r\n          <IonButton\r\n          className=\"button-selectEmployees-messages\"\r\n          onClick={() => setShowEmployeeModal(true)}>\r\n            {getEmployeeButtonName(selectedEmployees)}\r\n          </IonButton>\r\n        </IonItem>\r\n        {loading.showLoadingJsx}\r\n        <IonModal\r\n          mode=\"ios\"\r\n          cssClass=\"mini-modal add-break-modal\"\r\n          onDidDismiss={() => setShowEmployeeModal(false)}\r\n          isOpen={showEmployeeModal}\r\n        >\r\n          <EmployeeSelectorModal\r\n            channel={selectedChannel}\r\n            onCancel={onAddMessageModalCancel}\r\n            onOk={onEmployeeUpdate}\r\n            employeeList={employeeList}\r\n            selectedEmployeeList={selectedEmployees}\r\n          />\r\n        </IonModal>\r\n      </>\r\n    );\r\n  }\r\n};\r\n\r\nexport default EmployeesSelector;\r\n","import React, { useContext, useState } from \"react\";\r\nimport {\r\n  IonButton,\r\n  IonButtons,\r\n  IonIcon,\r\n  IonContent,\r\n  IonHeader,\r\n  IonTitle,\r\n  IonToolbar,\r\n  IonList,\r\n  IonItem,\r\n  IonTextarea,\r\n  IonFooter,\r\n} from \"@ionic/react\";\r\nimport \"../../../global-styles.scss\";\r\nimport { arrowBackOutline } from \"ionicons/icons\";\r\nimport { AuthorizedItemsContext } from \"../../../context/AuthorizedItemsContext\";\r\nimport EmployeesSelector from \"./EmployeesSelector\";\r\nimport {EmployeeCommunication} from \"../../../orbital-interfaces/EmployeeCommunication\";\r\nimport {messageApi} from \"../../../api/messageApi\";\r\nimport { useShowLoading } from \"../../../hooks/useShowLoading\";\r\nimport { ApplicationUserContext } from \"../../../context/ApplicationUserContext\";\r\nimport useDialogBox from \"../../../hooks/useDialogBox\";\r\n\r\ninterface CreateMessageModalProps {\r\n  onCloseModal: (toastMessage: string) => void;\r\n  isOpen: boolean;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\n//\r\n// --------------------------------------------------------------------------------------\r\nconst CreateMessageModal: React.FC<CreateMessageModalProps> = ({\r\n  onCloseModal,\r\n  isOpen,\r\n}) => {\r\n  const { user } = useContext(ApplicationUserContext);\r\n  const { auth } = useContext(AuthorizedItemsContext);\r\n  const [messageText, setMessageText] = useState(\"\");\r\n  const [employeeIds, setEmployeeIds] = useState([] as number[]);\r\n  const [locationId, setLocationId] = useState(0);\r\n  const [channel, setChannel] = useState(0);\r\n  const sendingMessage = useShowLoading(\"Sending\");\r\n  const dialog = useDialogBox();\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onSendClick = () => {\r\n    sendingMessage.setShowLoading(true);\r\n    messageApi\r\n      .sendMessage(user, locationId, channel, employeeIds, messageText)\r\n      .then((res) => {\r\n        sendingMessage.setShowLoading(false);\r\n        if (res.error) {\r\n          dialog.showAlert(\r\n            \"Could not send\",\r\n            \"Could not send message. \" + res.message,\r\n            () => {}\r\n          );\r\n        } else {\r\n          if (employeeIds.length === 1) {\r\n            onCloseModal(\"Message sent\");\r\n          } else {\r\n            onCloseModal(\"Messages sent\");\r\n          }\r\n        }\r\n      });\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onMessageTextUpdate = (newText: string | undefined | null) => {\r\n    if (newText !== null && newText !== undefined && newText !== messageText) {\r\n      setMessageText(newText);\r\n    }\r\n  };\r\n\r\n  // --------------------------------------------------------------------------------------\r\n  const onEmployeeListUpdate = (\r\n    newEmpList: EmployeeCommunication[],\r\n    newLocId: number,\r\n    newChannel: number\r\n  ) => {\r\n    setEmployeeIds(\r\n      newEmpList.map((e) => {\r\n        return e.id;\r\n      })\r\n    );\r\n\r\n    if (newLocId !== locationId) {\r\n      setLocationId(newLocId);\r\n    }\r\n\r\n    if (newChannel !== channel) {\r\n      setChannel(newChannel);\r\n    }\r\n  };\r\n\r\n  if (!isOpen || !auth || !auth.locations || auth.locations.length === 0) {\r\n    return <div>Loading</div>;\r\n  } else {\r\n    return (\r\n      <>\r\n        <IonHeader className=\"ion-no-border\">\r\n          <IonToolbar>\r\n            <IonButtons slot=\"start\">\r\n              <IonButton onClick={() => onCloseModal(\"\")}>\r\n                <IonIcon icon={arrowBackOutline} slot=\"icon-only\" />\r\n              </IonButton>\r\n            </IonButtons>\r\n            <IonTitle>New Message</IonTitle>\r\n          </IonToolbar>\r\n        </IonHeader>\r\n\r\n        <IonContent class=\"edit-daily-modal-content\">\r\n          <IonList>\r\n            <EmployeesSelector onUpdate={onEmployeeListUpdate} />\r\n            <IonItem\r\n              lines=\"none\"\r\n            >\r\n              <IonTextarea\r\n                value={messageText}\r\n                placeholder={\"Enter message\"}\r\n                spellcheck={true}\r\n                wrap=\"hard\"\r\n                autoGrow={true}\r\n                debounce={250}\r\n                onIonChange={(e) => {\r\n                  onMessageTextUpdate(e.detail.value);\r\n                }}\r\n              />\r\n            </IonItem>\r\n          </IonList>\r\n          {sendingMessage.showLoadingJsx}\r\n        </IonContent>\r\n        <IonFooter>\r\n          <IonButton\r\n            className=\"apply-button\"\r\n            expand=\"block\"\r\n            onClick={onSendClick}\r\n            disabled={\r\n              employeeIds.length === 0 ||\r\n              messageText.length === 0 ||\r\n              sendingMessage.showLoading\r\n            }\r\n          >\r\n            Send\r\n          </IonButton>\r\n        </IonFooter>\r\n      </>\r\n    );\r\n  }\r\n};\r\n\r\nexport default CreateMessageModal;\r\n","import React, { useState, useEffect, useReducer } from \"react\";\r\nimport {\r\n  IonModal,\r\n  IonHeader,\r\n  IonButton,\r\n  IonIcon,\r\n  IonToolbar,\r\n  IonTitle,\r\n  IonContent,\r\n  IonPage,\r\n  IonButtons,\r\n  IonMenuButton, useIonViewDidEnter, useIonViewDidLeave,\r\n} from \"@ionic/react\";\r\nimport \"../global-styles.scss\";\r\nimport { funnel, add } from \"ionicons/icons\";\r\nimport useIonicRefresher from \"../hooks/useIonicRefresher\";\r\nimport { Message } from \"../orbital-interfaces/Message\";\r\nimport MessageItem from \"../components/MessagesPageComponents/MessageItem\";\r\nimport MessagesFilterModal, {\r\n  FilterData,\r\n  FilterResult,\r\n} from \"../components/MessagesPageComponents/MessagesFilterModal\";\r\nimport { messageTypes } from \"../orbital-interfaces/MessageTypes\";\r\nimport {arrayHelper} from \"../util/arrayHelper\";\r\nimport {messageApi} from \"../api/messageApi\";\r\nimport { ApplicationUserContext } from \"../context/ApplicationUserContext\";\r\nimport { RefresherEventDetail } from \"@ionic/core\";\r\nimport ViewMessagetModal from \"../components/MessagesPageComponents/ViewMessageModal\";\r\nimport useSimpleToast from \"../hooks/useSimpleToast\";\r\nimport { RouteComponentProps } from \"react-router\";\r\nimport Skeleton from \"react-loading-skeleton\";\r\nimport CreateMessageModal from \"../components/MessagesPageComponents/create/CreateMessageModal\";\r\nimport { AuthorizedItemsContext } from \"../context/AuthorizedItemsContext\";\r\nimport {authHelper} from \"../util/authHelper\";\r\nimport { MessagesContext } from \"../context/MessagesContext\";\r\n\r\nconst initialMessages: Message[] = [];\r\n\r\nexport type MessagesReducerAction =\r\n  | { type: \"LOADED-FROM-API\"; data: Message[] }\r\n  | { type: \"CLEAR\" }\r\n  | { type: \"UPDATE-PINNED\"; msgId: number; isPinned: boolean }\r\n  | { type: \"UPDATE-VIEWED\"; msgId: number; isViewed: boolean }\r\n  | { type: \"DELETE\"; msgId: number };\r\n\r\n// ------------------------------------------------------------------------------------------------\r\nexport const messagesReducer = (\r\n  currentState: Message[],\r\n  action: MessagesReducerAction\r\n): Message[] => {\r\n  switch (action.type) {\r\n    case \"LOADED-FROM-API\":\r\n      return action.data;\r\n    case \"CLEAR\":\r\n      return [] as Message[];\r\n    case \"UPDATE-PINNED\":\r\n      return currentState.map((m) =>\r\n        m.messageId === action.msgId ? { ...m, isPinned: action.isPinned } : m\r\n      );\r\n    case \"UPDATE-VIEWED\":\r\n      return currentState.map((m) => {\r\n        return m.messageId === action.msgId\r\n          ? { ...m, isViewed: action.isViewed }\r\n          : m;\r\n      });\r\n    case \"DELETE\":\r\n      return currentState.filter((m) => m.messageId !== action.msgId);\r\n  }\r\n};\r\n\r\ninterface MessagesPageProps\r\n  extends RouteComponentProps<{\r\n    messageId?: string;\r\n  }> {}\r\n\r\n// eslint-disable-next-line react/prop-types\r\nconst MessagesPage: React.FC<MessagesPageProps> = ({ match, history }) => {\r\n  const { user } = React.useContext(ApplicationUserContext);\r\n  const { auth, refreshAuth } = React.useContext(AuthorizedItemsContext);\r\n  const { unreadMessagesCount, messagesViewed } = React.useContext(MessagesContext);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useIonViewDidEnter(() => {\r\n    messagesViewed();\r\n  }, [messagesViewed]);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useIonViewDidLeave(() => {\r\n    messagesViewed();\r\n  }, [messagesViewed]);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (!auth || !auth.locations || auth.locations.length === 0) {\r\n      refreshAuth(false, user);\r\n    }\r\n\r\n    // eslint-disable-next-line\r\n  }, [auth]);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const doRefresh = (e: CustomEvent<RefresherEventDetail>) => {\r\n    refreshMessages(e);\r\n  };\r\n\r\n  const refresher = useIonicRefresher(doRefresh);\r\n  const [showFilterModal, setShowFilterModal] = useState(false);\r\n  const [isLoadingMessages, setIsLoadingMessages] = useState(true);\r\n  const [messages, updateMessages] = useReducer(messagesReducer, []);\r\n  const [filteredMessages, setFilteredMessages] = useState(initialMessages);\r\n  const [filterData, setFilterData] = useState({} as FilterData);\r\n  const [filterResult, setFilterResult] = useState({} as FilterResult);\r\n  const [viewMessage, setViewMessage] = useState(null as Message | null);\r\n  const toast = useSimpleToast();\r\n  const [showCreateMessage, setShowCreateMessage] = useState(false);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    if (\r\n      user &&\r\n      user.isLoggedin &&\r\n      auth &&\r\n      auth.locations &&\r\n      auth.locations.length > 0\r\n    ) {\r\n      return refreshMessages(undefined);\r\n    }\r\n\r\n    // eslint-disable-next-line\r\n  }, [user.isLoggedin, unreadMessagesCount, auth]);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    filterMessages(filterResult, messages);\r\n\r\n    // eslint-disable-next-line\r\n  }, [messages]);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  useEffect(() => {\r\n    // eslint-disable-next-line react/prop-types\r\n    if (match.params.messageId && viewMessage === null) {\r\n      messageApi\r\n        // eslint-disable-next-line react/prop-types\r\n        .getUserMessage(user, parseInt(match.params.messageId))\r\n        .then((msg) => {\r\n          if (!msg) {\r\n            toast.showToast(\"The requested message has been removed\");\r\n            // eslint-disable-next-line react/prop-types\r\n            history.push(\"/tabs/messages/\");\r\n          }\r\n\r\n          setViewMessage(msg);\r\n        });\r\n    }\r\n\r\n    // eslint-disable-next-line\r\n  }, [match.params.messageId]);\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const refreshMessages = (e?: CustomEvent<RefresherEventDetail>) => {\r\n    let isSubscribed = true;\r\n\r\n    if (messages.length === 0 && isLoadingMessages === false) {\r\n      setIsLoadingMessages(true);\r\n    }\r\n\r\n    messageApi.getUserMessages(user).then((msgs) => {\r\n      if (!isSubscribed) {\r\n        return;\r\n      }\r\n\r\n      updateMessages({ type: \"LOADED-FROM-API\", data: msgs });\r\n      filterMessages(filterResult, msgs);\r\n      setIsLoadingMessages(false);\r\n\r\n      if (e) {\r\n        e.detail.complete();\r\n      }\r\n    });\r\n\r\n    return () => {\r\n      isSubscribed = false;\r\n    };\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const filterClose = (updatedFilter: FilterResult) => {\r\n    setFilterResult(updatedFilter);\r\n    filterMessages(updatedFilter, messages);\r\n    setShowFilterModal(false);\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const filterMessages = (f: FilterResult, msgs: Message[]) => {\r\n    if (!f || !f.msgTypeIds) {\r\n      setFilteredMessages(msgs);\r\n      return;\r\n    }\r\n\r\n    if (f.employeeId !== -1) {\r\n      if (f.msgTypeIds.length > 0) {\r\n        setFilteredMessages(\r\n          msgs.filter(\r\n            (m) =>\r\n              m.fromEmployeeId === f.employeeId &&\r\n              arrayHelper.contains(f.msgTypeIds, m.messageTypeId)\r\n          )\r\n        );\r\n      } else {\r\n        setFilteredMessages(\r\n          msgs.filter((m) => m.fromEmployeeId === f.employeeId)\r\n        );\r\n      }\r\n    } else if (f.msgTypeIds.length > 0) {\r\n      setFilteredMessages(\r\n        msgs.filter((m) => arrayHelper.contains(f.msgTypeIds, m.messageTypeId))\r\n      );\r\n    } else {\r\n      setFilteredMessages(msgs);\r\n    }\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onCloseMessageModal = (msg: string | null) => {\r\n    setViewMessage(null);\r\n    if (msg) {\r\n      toast.showToast(msg);\r\n    }\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const onCloseCreateMessageModal = (toastMessage: string | null) => {\r\n    setShowCreateMessage(false);\r\n    if (toastMessage !== null && toastMessage.length > 0) {\r\n      toast.showToast(toastMessage);\r\n    }\r\n\r\n    setTimeout(() => {\r\n      refreshMessages();\r\n    }, 4000);\r\n  };\r\n\r\n  // ------------------------------------------------------------------------------------\r\n  const showFilter = () => {\r\n    const employees = arrayHelper.uniqueObject(\r\n      messages.map((msg) => {\r\n        return {\r\n          employeeId: msg.fromEmployeeId,\r\n          name: msg.fromEmployeeFirstName + \" \" + msg.fromEmployeeLastName,\r\n        };\r\n      }),\r\n      (x, y) => {\r\n        return x.employeeId === y.employeeId;\r\n      }\r\n    );\r\n    const msgTypes = arrayHelper.uniqueObject(\r\n      messages.map((msg) => {\r\n        return {\r\n          messageTypeId: msg.messageTypeId,\r\n          name: messageTypes.item(String(msg.messageTypeId)).description,\r\n        };\r\n      }),\r\n      (x, y) => {\r\n        return x.messageTypeId === y.messageTypeId;\r\n      }\r\n    );\r\n\r\n    setFilterData({ msgTypes, employees });\r\n\r\n    setShowFilterModal(true);\r\n  };\r\n\r\n  return (\r\n    <IonPage>\r\n      <IonHeader className=\"ion-no-border\">\r\n        <IonToolbar mode=\"md\">\r\n          <IonButtons slot=\"start\">\r\n            <IonMenuButton />\r\n          </IonButtons>\r\n          <IonTitle slot=\"start\">Messages</IonTitle>\r\n          <IonButtons slot=\"end\">\r\n            <IonButton\r\n              hidden={\r\n                auth.locations.find((l) =>\r\n                  l.departments.find((d) => authHelper.isDeptAdmin(auth, d.id))\r\n                ) === undefined\r\n              }\r\n              onClick={() => {\r\n                setShowCreateMessage(true);\r\n              }}\r\n            >\r\n              <IonIcon icon={add} mode=\"md\" slot=\"icon-only\" />\r\n            </IonButton>\r\n            <IonButton onClick={showFilter}>\r\n              <IonIcon icon={funnel} mode=\"ios\" slot=\"icon-only\" />\r\n            </IonButton>\r\n          </IonButtons>\r\n        </IonToolbar>\r\n      </IonHeader>\r\n\r\n      <IonContent className=\"outer-content\">\r\n        {refresher.ionicRefresherJsx}\r\n        {isLoadingMessages && (\r\n          <>\r\n            {[\r\n              1,\r\n              2,\r\n              3,\r\n              4,\r\n              5,\r\n              6,\r\n            ].map((x) => {\r\n              return (\r\n                <div key={x} style={{ margin: \"10px 8px\" }}>\r\n                  <Skeleton width={300} height={40} />\r\n                </div>\r\n              );\r\n            })}\r\n          </>\r\n        )}\r\n        {!isLoadingMessages && filteredMessages.length === 0 && (\r\n          <div className=\"no-messagesOrEvents-text\">No Messages</div>\r\n        )}\r\n        <div className=\"message-list\">\r\n          {!isLoadingMessages &&\r\n            filteredMessages.length > 0 &&\r\n            filteredMessages\r\n              .filter((m) => m.isPinned)\r\n              .map((msg) => (\r\n                <MessageItem\r\n                  key={msg.messageId}\r\n                  message={msg}\r\n                  onMessageClick={() => setViewMessage(msg)}\r\n                />\r\n              ))}\r\n        </div>\r\n\r\n        <div className=\"message-list\">\r\n          {!isLoadingMessages &&\r\n            filteredMessages.length > 0 &&\r\n            filteredMessages\r\n              .filter((m) => !m.isPinned)\r\n              .map((msg) => (\r\n                <MessageItem\r\n                  key={msg.messageId}\r\n                  message={msg}\r\n                  onMessageClick={() => setViewMessage(msg)}\r\n                />\r\n              ))}\r\n        </div>\r\n      </IonContent>\r\n\r\n      <IonModal isOpen={showFilterModal}>\r\n        <MessagesFilterModal\r\n          filterData={filterData}\r\n          onDismissModal={filterClose}\r\n          onCancelModal={() => setShowFilterModal(false)}\r\n        />\r\n      </IonModal>\r\n\r\n      <IonModal isOpen={viewMessage !== null}>\r\n        <ViewMessagetModal\r\n          message={viewMessage}\r\n          updateMessages={updateMessages}\r\n          onCloseModal={onCloseMessageModal}\r\n        />\r\n      </IonModal>\r\n\r\n      <IonModal isOpen={showCreateMessage}>\r\n        <CreateMessageModal\r\n          onCloseModal={onCloseCreateMessageModal}\r\n          isOpen={showCreateMessage}\r\n        />\r\n      </IonModal>\r\n\r\n      {toast.simpleToastJsx}\r\n    </IonPage>\r\n  );\r\n};\r\n\r\nexport default MessagesPage;\r\n","import React, { useContext } from \"react\";\r\nimport { IonIcon, IonLabel } from \"@ionic/react\";\r\nimport { chatbubblesOutline } from \"ionicons/icons\";\r\n// import \"./MainTabs.scss\";\r\nimport \"../global-styles.scss\";\r\nimport { MessagesContext } from \"../context/MessagesContext\";\r\n\r\n// ------------------------------------------------------------------------------------\r\n//\r\n// ------------------------------------------------------------------------------------\r\nconst MessagesTabButton: React.FC = () => {\r\n  const { unreadMessagesCount, hasNewMessages } = useContext(MessagesContext);\r\n\r\n  return (\r\n    <>\r\n      <div className={hasNewMessages ? \"hasMessages\" : \"noMessages\"}>\r\n        {unreadMessagesCount}\r\n      </div>\r\n      <IonIcon icon={chatbubblesOutline} />\r\n      <IonLabel>Messages</IonLabel>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default MessagesTabButton;\r\n","import React, {useContext} from \"react\";\r\nimport {\r\n  IonTabs,\r\n  IonRouterOutlet,\r\n  IonTabBar,\r\n  IonTabButton,\r\n  IonIcon,\r\n  IonLabel,\r\n} from \"@ionic/react\";\r\nimport { Route, Redirect } from \"react-router\";\r\nimport { calendarOutline, timeOutline } from \"ionicons/icons\";\r\nimport SchedulePage from \"./SchedulePage\";\r\nimport ClockPage from \"./ClockPage\";\r\nimport MessagesPage from \"./MessagesPage\";\r\nimport MessagesTabButton from \"./MessagesTabButton\";\r\n// import \"./MainTabs.scss\";\r\nimport \"../global-styles.scss\";\r\nimport {AuthorizedItemsContext} from \"../context/AuthorizedItemsContext\";\r\n\r\ninterface MainTabsProps {}\r\n\r\nconst MainTabs: React.FC<MainTabsProps> = () => {\r\n  const {auth} = useContext(AuthorizedItemsContext);\r\n\r\n  return (\r\n    <IonTabs>\r\n      <IonRouterOutlet>\r\n        <Redirect exact={true} path=\"/tabs\" to=\"/tabs/schedule\" />\r\n\r\n        <Route\r\n          path=\"/tabs/schedule/:scheduleEventId\"\r\n          render={(routeProps) => <SchedulePage {...routeProps} />}\r\n        />\r\n\r\n        <Route\r\n          path=\"/tabs/schedule\"\r\n          render={(routeProps) => <SchedulePage {...routeProps} />}\r\n          exact={true}\r\n        />\r\n\r\n        <Route\r\n          path=\"/tabs/messages/:messageId\"\r\n          render={(routeProps) => <MessagesPage {...routeProps} />}\r\n        />\r\n\r\n        <Route\r\n          path=\"/tabs/messages\"\r\n          render={(routeProps) => <MessagesPage {...routeProps} />}\r\n          exact={true}\r\n        />\r\n\r\n        <Route  path=\"/tabs/clock\" render={() => <ClockPage />} exact={true} />\r\n      </IonRouterOutlet>\r\n      <IonTabBar slot=\"bottom\">\r\n        <IonTabButton key=\"1\" tab=\"schedule\" href=\"/tabs/schedule\">\r\n          <IonIcon icon={calendarOutline} />\r\n          <IonLabel>Schedule</IonLabel>\r\n        </IonTabButton>\r\n        <IonTabButton hidden={!auth.timeClock} key=\"2\" tab=\"clock\" href=\"/tabs/clock\">\r\n          <IonIcon icon={timeOutline} />\r\n          <IonLabel>Clock</IonLabel>\r\n        </IonTabButton>\r\n        <IonTabButton key=\"3\" tab=\"map\" href=\"/tabs/messages\">\r\n          <MessagesTabButton />\r\n        </IonTabButton>\r\n      </IonTabBar>\r\n    </IonTabs>\r\n  );\r\n};\r\n\r\nexport default MainTabs;\r\n","import React from \"react\";\r\nimport { Redirect } from \"react-router\";\r\nimport MainTabs from \"./../pages/MainTabs\";\r\nimport { ApplicationUserContext } from \"../context/ApplicationUserContext\";\r\n\r\ninterface StateProps {}\r\n\r\nconst AuthGate: React.FC<StateProps> = () => {\r\n  const { user } = React.useContext(ApplicationUserContext);\r\n\r\n  if (user.loading) {\r\n    return <div></div>;\r\n  }\r\n\r\n  if (user.isLoggedin) {\r\n    return <MainTabs />;\r\n  }\r\n\r\n  return <Redirect to=\"/login\" />;\r\n};\r\n\r\nexport default AuthGate;\r\n","import React from \"react\";\r\nimport {IonContent, IonList, IonPage, useIonViewDidEnter} from \"@ionic/react\";\r\nimport { RouteComponentProps } from \"react-router\";\r\nimport { ApplicationUserContext } from \"../context/ApplicationUserContext\";\r\nimport \"../global-styles.scss\";\r\nimport { log } from \"../util/logger\";\r\nimport { AuthorizedItemsContext } from \"../context/AuthorizedItemsContext\";\r\n\r\ninterface LogoutProps extends RouteComponentProps {}\r\n\r\nconst Logout: React.FC<LogoutProps> = ({ history }: RouteComponentProps) => {\r\n  const { user, logout } = React.useContext(ApplicationUserContext);\r\n  const { clearAuth } = React.useContext(AuthorizedItemsContext);\r\n\r\n  useIonViewDidEnter(() => {\r\n    Promise.all([clearAuth(), logout()]).then(() => {\r\n      localStorage.clear();\r\n      log(\"logout\", { user: user.username });\r\n      console.log(`logged out (${user.username})`);\r\n      setTimeout(() => {\r\n        history.push(\"/login\", { direction: \"none\" });\r\n        history.goForward();\r\n      }, 250);\r\n    });\r\n  });\r\n\r\n  return (\r\n    <IonPage id=\"logout-page\">\r\n      <IonContent className=\"login-content\">\r\n        <div className=\"login-logo\">\r\n          <img\r\n            className=\"logo\"\r\n            src=\"assets/img/OS Logo - 4pt Rounded _ 2 Tone Orange.svg\"\r\n            alt=\"Orbital Shift Logo\"\r\n          />\r\n        </div>\r\n\r\n        <IonList className=\"form-list\" >\r\n          <div className=\"item\">\r\n            <div className=\"label\">User</div>\r\n          </div>\r\n        </IonList>\r\n      </IonContent>\r\n    </IonPage>\r\n  );\r\n};\r\n\r\nexport default Logout;\r\n","import React from \"react\";\r\nimport {IonContent, IonLoading} from \"@ionic/react\";\r\nimport \"../global-styles.scss\";\r\nimport env from '../api/environment';\r\n\r\nconst SplashComponent: React.FC = () => {\r\n  return (\r\n    <>\r\n      <IonContent id=\"splash\">\r\n        <div className=\"login-logo\">\r\n          <img\r\n            className=\"logo\"\r\n            src=\"assets/img/OS Logo - 4pt Rounded _ 2 Tone Orange.svg\"\r\n            alt=\"Orbital Shift Logo\"\r\n          />\r\n        </div>\r\n\r\n\r\n        <IonLoading\r\n          isOpen={true}\r\n          spinner=\"dots\"\r\n          message={\"Loading...\"}\r\n          showBackdrop={false}\r\n          duration={0}\r\n        />\r\n\r\n\r\n        <footer>\r\n          {env.settings.appVersionString} ({env.settings.buildDate})\r\n        </footer>\r\n      </IonContent>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default SplashComponent;\r\n","import React, {useContext, useEffect} from \"react\";\r\nimport { Route, BrowserRouter, Redirect } from \"react-router-dom\";\r\nimport { IonApp, IonRouterOutlet, IonSplitPane } from \"@ionic/react\";\r\nimport { IonReactRouter } from \"@ionic/react-router\";\r\nimport Menu from \"./components/Menu\";\r\nimport { initialize, log } from \"./util/logger\";\r\n\r\n/* Core CSS required for Ionic components to work properly */\r\nimport \"@ionic/react/css/core.css\";\r\n\r\n/* Basic CSS for apps built with Ionic */\r\nimport \"@ionic/react/css/normalize.css\";\r\nimport \"@ionic/react/css/structure.css\";\r\nimport \"@ionic/react/css/typography.css\";\r\n\r\n/* Optional CSS utils that can be commented out */\r\nimport \"@ionic/react/css/padding.css\";\r\nimport \"@ionic/react/css/float-elements.css\";\r\nimport \"@ionic/react/css/text-alignment.css\";\r\nimport \"@ionic/react/css/text-transformation.css\";\r\nimport \"@ionic/react/css/flex-utils.css\";\r\nimport \"@ionic/react/css/display.css\";\r\n\r\n/* Theme variables */\r\nimport \"./theme/variables.css\";\r\nimport Login from \"./pages/Login\";\r\nimport AuthGate from \"./components/AuthGate\";\r\n\r\nimport {ApplicationUserContext, ApplicationUserContextProvider} from \"./context/ApplicationUserContext\";\r\nimport Logout from \"./pages/Logout\";\r\nimport {AuthorizedItemsContext, AuthorizedItemsContextProvider} from \"./context/AuthorizedItemsContext\";\r\nimport env from \"./api/environment\";\r\nimport { ScreenOrientation } from \"@ionic-native/screen-orientation\";\r\nimport { MessagesContextProvider } from \"./context/MessagesContext\";\r\nimport {authHelper} from \"./util/authHelper\";\r\nimport SplashComponent from \"./components/SplashComponent\";\r\n\r\nconst MyApp: React.FC = () => {\r\n  const {user} = useContext(ApplicationUserContext);\r\n  const {auth, refreshAuth} = useContext(AuthorizedItemsContext);\r\n  useEffect(() => {\r\n    if (env.settings.hasCapacitor) {\r\n      ScreenOrientation.lock(ScreenOrientation.ORIENTATIONS.PORTRAIT).then(\r\n        () => {\r\n          console.log(\"screen locked to portrait\");\r\n        }\r\n      );\r\n    }\r\n\r\n    initialize();\r\n    log(\"app_render\", {\r\n      vers: env.settings.appVersionString,\r\n      platform: env.settings.platform,\r\n    });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (user.isLoggedin && !authHelper.isAuthItemsValid(auth)) {\r\n      refreshAuth(false, user);\r\n    }\r\n  }, [user.isLoggedin, auth, refreshAuth, user]);\r\n\r\n  let authGate: JSX.Element;\r\n  if (!user.isLoggedin) {\r\n    authGate = (\r\n      <>\r\n        <Route\r\n          path=\"/tabs\"\r\n          render={(routeProps) => <AuthGate {...routeProps} />}\r\n        />\r\n\r\n        <Route path=\"/\" exact={true}>\r\n          <Redirect to=\"/tabs/schedule\" />\r\n        </Route>\r\n      </>\r\n    );\r\n  }\r\n  else if (user.isLoggedin && authHelper.isAuthItemsValid(auth))\r\n  {\r\n    authGate = (\r\n      <>\r\n      <Route\r\n        path=\"/tabs\"\r\n        render={(routeProps) => <AuthGate {...routeProps} />}\r\n      />\r\n\r\n      <Route path=\"/\" exact={true}>\r\n        <Redirect to=\"/tabs/schedule\" />\r\n      </Route>\r\n      </>\r\n    );\r\n  } else {\r\n    // authGate = <>...</>;\r\n    authGate = <SplashComponent />\r\n  }\r\n\r\n\r\n  return (\r\n    <IonApp>\r\n      <IonReactRouter>\r\n        <IonReactRouter>\r\n          <IonSplitPane contentId=\"main\">\r\n            <Menu />\r\n            <IonRouterOutlet id=\"main\">\r\n              <Route\r\n                path=\"/login\"\r\n                render={(routeProps) => <Login {...routeProps} />}\r\n              />\r\n\r\n              <Route\r\n                path=\"/logout\"\r\n                render={(routeProps) => <Logout {...routeProps} />}\r\n              />\r\n\r\n              {authGate}\r\n\r\n\r\n            </IonRouterOutlet>\r\n          </IonSplitPane>\r\n        </IonReactRouter>\r\n      </IonReactRouter>\r\n    </IonApp>\r\n  );\r\n};\r\n\r\nconst App: React.FC = () => {\r\n  return (\r\n    <BrowserRouter>\r\n      <ApplicationUserContextProvider>\r\n        <AuthorizedItemsContextProvider>\r\n          <MessagesContextProvider>\r\n            <MyApp />\r\n          </MessagesContextProvider>\r\n        </AuthorizedItemsContextProvider>\r\n      </ApplicationUserContextProvider>\r\n    </BrowserRouter>\r\n  );\r\n};\r\n\r\nexport default App;\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport App from \"./App\";\r\n\r\nReactDOM.render(<App />, document.getElementById(\"root\"));\r\n"],"sourceRoot":""}